const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-D6jP1EA4.js","assets/webworkerAll-DJhLh9F_.js","assets/colorToUniform-Wv1YKiw2.js","assets/WebGPURenderer-ChVKvC3p.js","assets/SharedSystems-DrJc39BJ.js","assets/WebGLRenderer-D8udQsyz.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function lh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ld={exports:{}},sa={},cd={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I1;function Yg(){if(I1)return ze;I1=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function v(L){return L===null||typeof L!="object"?null:(L=g&&L[g]||L["@@iterator"],typeof L=="function"?L:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function b(L,K,ve){this.props=L,this.context=K,this.refs=S,this.updater=ve||x}b.prototype.isReactComponent={},b.prototype.setState=function(L,K){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,K,"setState")},b.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function k(){}k.prototype=b.prototype;function A(L,K,ve){this.props=L,this.context=K,this.refs=S,this.updater=ve||x}var M=A.prototype=new k;M.constructor=A,w(M,b.prototype),M.isPureReactComponent=!0;var E=Array.isArray,B=Object.prototype.hasOwnProperty,F={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function N(L,K,ve){var Pe,Ee={},Re=null,De=null;if(K!=null)for(Pe in K.ref!==void 0&&(De=K.ref),K.key!==void 0&&(Re=""+K.key),K)B.call(K,Pe)&&!I.hasOwnProperty(Pe)&&(Ee[Pe]=K[Pe]);var Le=arguments.length-2;if(Le===1)Ee.children=ve;else if(1<Le){for(var Ue=Array(Le),Ke=0;Ke<Le;Ke++)Ue[Ke]=arguments[Ke+2];Ee.children=Ue}if(L&&L.defaultProps)for(Pe in Le=L.defaultProps,Le)Ee[Pe]===void 0&&(Ee[Pe]=Le[Pe]);return{$$typeof:n,type:L,key:Re,ref:De,props:Ee,_owner:F.current}}function U(L,K){return{$$typeof:n,type:L.type,key:K,ref:L.ref,props:L.props,_owner:L._owner}}function q(L){return typeof L=="object"&&L!==null&&L.$$typeof===n}function H(L){var K={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(ve){return K[ve]})}var se=/\/+/g;function Z(L,K){return typeof L=="object"&&L!==null&&L.key!=null?H(""+L.key):K.toString(36)}function Q(L,K,ve,Pe,Ee){var Re=typeof L;(Re==="undefined"||Re==="boolean")&&(L=null);var De=!1;if(L===null)De=!0;else switch(Re){case"string":case"number":De=!0;break;case"object":switch(L.$$typeof){case n:case e:De=!0}}if(De)return De=L,Ee=Ee(De),L=Pe===""?"."+Z(De,0):Pe,E(Ee)?(ve="",L!=null&&(ve=L.replace(se,"$&/")+"/"),Q(Ee,K,ve,"",function(Ke){return Ke})):Ee!=null&&(q(Ee)&&(Ee=U(Ee,ve+(!Ee.key||De&&De.key===Ee.key?"":(""+Ee.key).replace(se,"$&/")+"/")+L)),K.push(Ee)),1;if(De=0,Pe=Pe===""?".":Pe+":",E(L))for(var Le=0;Le<L.length;Le++){Re=L[Le];var Ue=Pe+Z(Re,Le);De+=Q(Re,K,ve,Ue,Ee)}else if(Ue=v(L),typeof Ue=="function")for(L=Ue.call(L),Le=0;!(Re=L.next()).done;)Re=Re.value,Ue=Pe+Z(Re,Le++),De+=Q(Re,K,ve,Ue,Ee);else if(Re==="object")throw K=String(L),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return De}function ae(L,K,ve){if(L==null)return L;var Pe=[],Ee=0;return Q(L,Pe,"","",function(Re){return K.call(ve,Re,Ee++)}),Pe}function G(L){if(L._status===-1){var K=L._result;K=K(),K.then(function(ve){(L._status===0||L._status===-1)&&(L._status=1,L._result=ve)},function(ve){(L._status===0||L._status===-1)&&(L._status=2,L._result=ve)}),L._status===-1&&(L._status=0,L._result=K)}if(L._status===1)return L._result.default;throw L._result}var V={current:null},te={transition:null},Y={ReactCurrentDispatcher:V,ReactCurrentBatchConfig:te,ReactCurrentOwner:F};function ie(){throw Error("act(...) is not supported in production builds of React.")}return ze.Children={map:ae,forEach:function(L,K,ve){ae(L,function(){K.apply(this,arguments)},ve)},count:function(L){var K=0;return ae(L,function(){K++}),K},toArray:function(L){return ae(L,function(K){return K})||[]},only:function(L){if(!q(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},ze.Component=b,ze.Fragment=t,ze.Profiler=o,ze.PureComponent=A,ze.StrictMode=i,ze.Suspense=h,ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,ze.act=ie,ze.cloneElement=function(L,K,ve){if(L==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+L+".");var Pe=w({},L.props),Ee=L.key,Re=L.ref,De=L._owner;if(K!=null){if(K.ref!==void 0&&(Re=K.ref,De=F.current),K.key!==void 0&&(Ee=""+K.key),L.type&&L.type.defaultProps)var Le=L.type.defaultProps;for(Ue in K)B.call(K,Ue)&&!I.hasOwnProperty(Ue)&&(Pe[Ue]=K[Ue]===void 0&&Le!==void 0?Le[Ue]:K[Ue])}var Ue=arguments.length-2;if(Ue===1)Pe.children=ve;else if(1<Ue){Le=Array(Ue);for(var Ke=0;Ke<Ue;Ke++)Le[Ke]=arguments[Ke+2];Pe.children=Le}return{$$typeof:n,type:L.type,key:Ee,ref:Re,props:Pe,_owner:De}},ze.createContext=function(L){return L={$$typeof:c,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:a,_context:L},L.Consumer=L},ze.createElement=N,ze.createFactory=function(L){var K=N.bind(null,L);return K.type=L,K},ze.createRef=function(){return{current:null}},ze.forwardRef=function(L){return{$$typeof:u,render:L}},ze.isValidElement=q,ze.lazy=function(L){return{$$typeof:p,_payload:{_status:-1,_result:L},_init:G}},ze.memo=function(L,K){return{$$typeof:f,type:L,compare:K===void 0?null:K}},ze.startTransition=function(L){var K=te.transition;te.transition={};try{L()}finally{te.transition=K}},ze.unstable_act=ie,ze.useCallback=function(L,K){return V.current.useCallback(L,K)},ze.useContext=function(L){return V.current.useContext(L)},ze.useDebugValue=function(){},ze.useDeferredValue=function(L){return V.current.useDeferredValue(L)},ze.useEffect=function(L,K){return V.current.useEffect(L,K)},ze.useId=function(){return V.current.useId()},ze.useImperativeHandle=function(L,K,ve){return V.current.useImperativeHandle(L,K,ve)},ze.useInsertionEffect=function(L,K){return V.current.useInsertionEffect(L,K)},ze.useLayoutEffect=function(L,K){return V.current.useLayoutEffect(L,K)},ze.useMemo=function(L,K){return V.current.useMemo(L,K)},ze.useReducer=function(L,K,ve){return V.current.useReducer(L,K,ve)},ze.useRef=function(L){return V.current.useRef(L)},ze.useState=function(L){return V.current.useState(L)},ze.useSyncExternalStore=function(L,K,ve){return V.current.useSyncExternalStore(L,K,ve)},ze.useTransition=function(){return V.current.useTransition()},ze.version="18.3.1",ze}var $1;function ch(){return $1||($1=1,cd.exports=Yg()),cd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L1;function Xg(){if(L1)return sa;L1=1;var n=ch(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(u,h,f){var p,g={},v=null,x=null;f!==void 0&&(v=""+f),h.key!==void 0&&(v=""+h.key),h.ref!==void 0&&(x=h.ref);for(p in h)i.call(h,p)&&!a.hasOwnProperty(p)&&(g[p]=h[p]);if(u&&u.defaultProps)for(p in h=u.defaultProps,h)g[p]===void 0&&(g[p]=h[p]);return{$$typeof:e,type:u,key:v,ref:x,props:g,_owner:o.current}}return sa.Fragment=t,sa.jsx=c,sa.jsxs=c,sa}var z1;function qg(){return z1||(z1=1,ld.exports=Xg()),ld.exports}var T=qg(),ql={},ud={exports:{}},mn={},dd={exports:{}},hd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function Kg(){return F1||(F1=1,(function(n){function e(te,Y){var ie=te.length;te.push(Y);e:for(;0<ie;){var L=ie-1>>>1,K=te[L];if(0<o(K,Y))te[L]=Y,te[ie]=K,ie=L;else break e}}function t(te){return te.length===0?null:te[0]}function i(te){if(te.length===0)return null;var Y=te[0],ie=te.pop();if(ie!==Y){te[0]=ie;e:for(var L=0,K=te.length,ve=K>>>1;L<ve;){var Pe=2*(L+1)-1,Ee=te[Pe],Re=Pe+1,De=te[Re];if(0>o(Ee,ie))Re<K&&0>o(De,Ee)?(te[L]=De,te[Re]=ie,L=Re):(te[L]=Ee,te[Pe]=ie,L=Pe);else if(Re<K&&0>o(De,ie))te[L]=De,te[Re]=ie,L=Re;else break e}}return Y}function o(te,Y){var ie=te.sortIndex-Y.sortIndex;return ie!==0?ie:te.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var c=Date,u=c.now();n.unstable_now=function(){return c.now()-u}}var h=[],f=[],p=1,g=null,v=3,x=!1,w=!1,S=!1,b=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(te){for(var Y=t(f);Y!==null;){if(Y.callback===null)i(f);else if(Y.startTime<=te)i(f),Y.sortIndex=Y.expirationTime,e(h,Y);else break;Y=t(f)}}function E(te){if(S=!1,M(te),!w)if(t(h)!==null)w=!0,G(B);else{var Y=t(f);Y!==null&&V(E,Y.startTime-te)}}function B(te,Y){w=!1,S&&(S=!1,k(N),N=-1),x=!0;var ie=v;try{for(M(Y),g=t(h);g!==null&&(!(g.expirationTime>Y)||te&&!H());){var L=g.callback;if(typeof L=="function"){g.callback=null,v=g.priorityLevel;var K=L(g.expirationTime<=Y);Y=n.unstable_now(),typeof K=="function"?g.callback=K:g===t(h)&&i(h),M(Y)}else i(h);g=t(h)}if(g!==null)var ve=!0;else{var Pe=t(f);Pe!==null&&V(E,Pe.startTime-Y),ve=!1}return ve}finally{g=null,v=ie,x=!1}}var F=!1,I=null,N=-1,U=5,q=-1;function H(){return!(n.unstable_now()-q<U)}function se(){if(I!==null){var te=n.unstable_now();q=te;var Y=!0;try{Y=I(!0,te)}finally{Y?Z():(F=!1,I=null)}}else F=!1}var Z;if(typeof A=="function")Z=function(){A(se)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,ae=Q.port2;Q.port1.onmessage=se,Z=function(){ae.postMessage(null)}}else Z=function(){b(se,0)};function G(te){I=te,F||(F=!0,Z())}function V(te,Y){N=b(function(){te(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(te){te.callback=null},n.unstable_continueExecution=function(){w||x||(w=!0,G(B))},n.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<te?Math.floor(1e3/te):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_getFirstCallbackNode=function(){return t(h)},n.unstable_next=function(te){switch(v){case 1:case 2:case 3:var Y=3;break;default:Y=v}var ie=v;v=Y;try{return te()}finally{v=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(te,Y){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var ie=v;v=te;try{return Y()}finally{v=ie}},n.unstable_scheduleCallback=function(te,Y,ie){var L=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?L+ie:L):ie=L,te){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=ie+K,te={id:p++,callback:Y,priorityLevel:te,startTime:ie,expirationTime:K,sortIndex:-1},ie>L?(te.sortIndex=ie,e(f,te),t(h)===null&&te===t(f)&&(S?(k(N),N=-1):S=!0,V(E,ie-L))):(te.sortIndex=K,e(h,te),w||x||(w=!0,G(B))),te},n.unstable_shouldYield=H,n.unstable_wrapCallback=function(te){var Y=v;return function(){var ie=v;v=Y;try{return te.apply(this,arguments)}finally{v=ie}}}})(hd)),hd}var j1;function Qg(){return j1||(j1=1,dd.exports=Kg()),dd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B1;function Zg(){if(B1)return mn;B1=1;var n=ch(),e=Qg();function t(r){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+r,l=1;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function a(r,s){c(r,s),c(r+"Capture",s)}function c(r,s){for(o[r]=s,r=0;r<s.length;r++)i.add(s[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},g={};function v(r){return h.call(g,r)?!0:h.call(p,r)?!1:f.test(r)?g[r]=!0:(p[r]=!0,!1)}function x(r,s,l,d){if(l!==null&&l.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return d?!1:l!==null?!l.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function w(r,s,l,d){if(s===null||typeof s>"u"||x(r,s,l,d))return!0;if(d)return!1;if(l!==null)switch(l.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function S(r,s,l,d,m,y,_){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=d,this.attributeNamespace=m,this.mustUseProperty=l,this.propertyName=r,this.type=s,this.sanitizeURL=y,this.removeEmptyString=_}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){b[r]=new S(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var s=r[0];b[s]=new S(s,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){b[r]=new S(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){b[r]=new S(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){b[r]=new S(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){b[r]=new S(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){b[r]=new S(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){b[r]=new S(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){b[r]=new S(r,5,!1,r.toLowerCase(),null,!1,!1)});var k=/[\-:]([a-z])/g;function A(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var s=r.replace(k,A);b[s]=new S(s,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var s=r.replace(k,A);b[s]=new S(s,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var s=r.replace(k,A);b[s]=new S(s,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){b[r]=new S(r,1,!1,r.toLowerCase(),null,!1,!1)}),b.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){b[r]=new S(r,1,!1,r.toLowerCase(),null,!0,!0)});function M(r,s,l,d){var m=b.hasOwnProperty(s)?b[s]:null;(m!==null?m.type!==0:d||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(w(s,l,m,d)&&(l=null),d||m===null?v(s)&&(l===null?r.removeAttribute(s):r.setAttribute(s,""+l)):m.mustUseProperty?r[m.propertyName]=l===null?m.type===3?!1:"":l:(s=m.attributeName,d=m.attributeNamespace,l===null?r.removeAttribute(s):(m=m.type,l=m===3||m===4&&l===!0?"":""+l,d?r.setAttributeNS(d,s,l):r.setAttribute(s,l))))}var E=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,B=Symbol.for("react.element"),F=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),q=Symbol.for("react.provider"),H=Symbol.for("react.context"),se=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),V=Symbol.for("react.offscreen"),te=Symbol.iterator;function Y(r){return r===null||typeof r!="object"?null:(r=te&&r[te]||r["@@iterator"],typeof r=="function"?r:null)}var ie=Object.assign,L;function K(r){if(L===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);L=s&&s[1]||""}return`
`+L+r}var ve=!1;function Pe(r,s){if(!r||ve)return"";ve=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(W){var d=W}Reflect.construct(r,[],s)}else{try{s.call()}catch(W){d=W}r.call(s.prototype)}else{try{throw Error()}catch(W){d=W}r()}}catch(W){if(W&&d&&typeof W.stack=="string"){for(var m=W.stack.split(`
`),y=d.stack.split(`
`),_=m.length-1,P=y.length-1;1<=_&&0<=P&&m[_]!==y[P];)P--;for(;1<=_&&0<=P;_--,P--)if(m[_]!==y[P]){if(_!==1||P!==1)do if(_--,P--,0>P||m[_]!==y[P]){var R=`
`+m[_].replace(" at new "," at ");return r.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",r.displayName)),R}while(1<=_&&0<=P);break}}}finally{ve=!1,Error.prepareStackTrace=l}return(r=r?r.displayName||r.name:"")?K(r):""}function Ee(r){switch(r.tag){case 5:return K(r.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return r=Pe(r.type,!1),r;case 11:return r=Pe(r.type.render,!1),r;case 1:return r=Pe(r.type,!0),r;default:return""}}function Re(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case I:return"Fragment";case F:return"Portal";case U:return"Profiler";case N:return"StrictMode";case Z:return"Suspense";case Q:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case H:return(r.displayName||"Context")+".Consumer";case q:return(r._context.displayName||"Context")+".Provider";case se:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ae:return s=r.displayName||null,s!==null?s:Re(r.type)||"Memo";case G:s=r._payload,r=r._init;try{return Re(r(s))}catch{}}return null}function De(r){var s=r.type;switch(r.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=s.render,r=r.displayName||r.name||"",s.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Re(s);case 8:return s===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Le(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Ue(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ke(r){var s=Ue(r)?"checked":"value",l=Object.getOwnPropertyDescriptor(r.constructor.prototype,s),d=""+r[s];if(!r.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,y=l.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return m.call(this)},set:function(_){d=""+_,y.call(this,_)}}),Object.defineProperty(r,s,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(_){d=""+_},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function Mn(r){r._valueTracker||(r._valueTracker=Ke(r))}function vn(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var l=s.getValue(),d="";return r&&(d=Ue(r)?r.checked?"true":"false":r.value),r=d,r!==l?(s.setValue(r),!0):!1}function sn(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function on(r,s){var l=s.checked;return ie({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??r._wrapperState.initialChecked})}function an(r,s){var l=s.defaultValue==null?"":s.defaultValue,d=s.checked!=null?s.checked:s.defaultChecked;l=Le(s.value!=null?s.value:l),r._wrapperState={initialChecked:d,initialValue:l,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function rr(r,s){s=s.checked,s!=null&&M(r,"checked",s,!1)}function Nr(r,s){rr(r,s);var l=Le(s.value),d=s.type;if(l!=null)d==="number"?(l===0&&r.value===""||r.value!=l)&&(r.value=""+l):r.value!==""+l&&(r.value=""+l);else if(d==="submit"||d==="reset"){r.removeAttribute("value");return}s.hasOwnProperty("value")?ns(r,s.type,l):s.hasOwnProperty("defaultValue")&&ns(r,s.type,Le(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(r.defaultChecked=!!s.defaultChecked)}function ts(r,s,l){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var d=s.type;if(!(d!=="submit"&&d!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+r._wrapperState.initialValue,l||s===r.value||(r.value=s),r.defaultValue=s}l=r.name,l!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,l!==""&&(r.name=l)}function ns(r,s,l){(s!=="number"||sn(r.ownerDocument)!==r)&&(l==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+l&&(r.defaultValue=""+l))}var yi=Array.isArray;function Wr(r,s,l,d){if(r=r.options,s){s={};for(var m=0;m<l.length;m++)s["$"+l[m]]=!0;for(l=0;l<r.length;l++)m=s.hasOwnProperty("$"+r[l].value),r[l].selected!==m&&(r[l].selected=m),m&&d&&(r[l].defaultSelected=!0)}else{for(l=""+Le(l),s=null,m=0;m<r.length;m++){if(r[m].value===l){r[m].selected=!0,d&&(r[m].defaultSelected=!0);return}s!==null||r[m].disabled||(s=r[m])}s!==null&&(s.selected=!0)}}function Hr(r,s){if(s.dangerouslySetInnerHTML!=null)throw Error(t(91));return ie({},s,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function ao(r,s){var l=s.value;if(l==null){if(l=s.children,s=s.defaultValue,l!=null){if(s!=null)throw Error(t(92));if(yi(l)){if(1<l.length)throw Error(t(93));l=l[0]}s=l}s==null&&(s=""),l=s}r._wrapperState={initialValue:Le(l)}}function Oa(r,s){var l=Le(s.value),d=Le(s.defaultValue);l!=null&&(l=""+l,l!==r.value&&(r.value=l),s.defaultValue==null&&r.defaultValue!==l&&(r.defaultValue=l)),d!=null&&(r.defaultValue=""+d)}function _r(r){var s=r.textContent;s===r._wrapperState.initialValue&&s!==""&&s!==null&&(r.value=s)}function Na(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lo(r,s){return r==null||r==="http://www.w3.org/1999/xhtml"?Na(s):r==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Ur,rs=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,l,d,m){MSApp.execUnsafeLocalFunction(function(){return r(s,l,d,m)})}:r})(function(r,s){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=s;else{for(Ur=Ur||document.createElement("div"),Ur.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=Ur.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;s.firstChild;)r.appendChild(s.firstChild)}});function xi(r,s){if(s){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=s;return}}r.textContent=s}var wr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wa=["Webkit","ms","Moz","O"];Object.keys(wr).forEach(function(r){Wa.forEach(function(s){s=s+r.charAt(0).toUpperCase()+r.substring(1),wr[s]=wr[r]})});function Pn(r,s,l){return s==null||typeof s=="boolean"||s===""?"":l||typeof s!="number"||s===0||wr.hasOwnProperty(r)&&wr[r]?(""+s).trim():s+"px"}function is(r,s){r=r.style;for(var l in s)if(s.hasOwnProperty(l)){var d=l.indexOf("--")===0,m=Pn(l,s[l],d);l==="float"&&(l="cssFloat"),d?r.setProperty(l,m):r[l]=m}}var Ha=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gr(r,s){if(s){if(Ha[r]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(t(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(t(61))}if(s.style!=null&&typeof s.style!="object")throw Error(t(62))}}function ss(r,s){if(r.indexOf("-")===-1)return typeof s.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var co=null;function uo(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var vi=null,Dn=null,ir=null;function _i(r){if(r=Uo(r)){if(typeof vi!="function")throw Error(t(280));var s=r.stateNode;s&&(s=ul(s),vi(r.stateNode,r.type,s))}}function os(r){Dn?ir?ir.push(r):ir=[r]:Dn=r}function ho(){if(Dn){var r=Dn,s=ir;if(ir=Dn=null,_i(r),s)for(r=0;r<s.length;r++)_i(s[r])}}function fo(r,s){return r(s)}function po(){}var wi=!1;function Bt(r,s,l){if(wi)return r(s,l);wi=!0;try{return fo(r,s,l)}finally{wi=!1,(Dn!==null||ir!==null)&&(po(),ho())}}function sr(r,s){var l=r.stateNode;if(l===null)return null;var d=ul(l);if(d===null)return null;l=d[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(t(231,s,typeof l));return l}var St=!1;if(u)try{var On={};Object.defineProperty(On,"passive",{get:function(){St=!0}}),window.addEventListener("test",On,On),window.removeEventListener("test",On,On)}catch{St=!1}function as(r,s,l,d,m,y,_,P,R){var W=Array.prototype.slice.call(arguments,3);try{s.apply(l,W)}catch(ne){this.onError(ne)}}var qt=!1,Nn=null,Kt=!1,mo=null,Ua={onError:function(r){qt=!0,Nn=r}};function Th(r,s,l,d,m,y,_,P,R){qt=!1,Nn=null,as.apply(Ua,arguments)}function Ga(r,s,l,d,m,y,_,P,R){if(Th.apply(this,arguments),qt){if(qt){var W=Nn;qt=!1,Nn=null}else throw Error(t(198));Kt||(Kt=!0,mo=W)}}function Oe(r){var s=r,l=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(l=s.return),r=s.return;while(r)}return s.tag===3?l:null}function go(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function Et(r){if(Oe(r)!==r)throw Error(t(188))}function yo(r){var s=r.alternate;if(!s){if(s=Oe(r),s===null)throw Error(t(188));return s!==r?null:r}for(var l=r,d=s;;){var m=l.return;if(m===null)break;var y=m.alternate;if(y===null){if(d=m.return,d!==null){l=d;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===l)return Et(m),r;if(y===d)return Et(m),s;y=y.sibling}throw Error(t(188))}if(l.return!==d.return)l=m,d=y;else{for(var _=!1,P=m.child;P;){if(P===l){_=!0,l=m,d=y;break}if(P===d){_=!0,d=m,l=y;break}P=P.sibling}if(!_){for(P=y.child;P;){if(P===l){_=!0,l=y,d=m;break}if(P===d){_=!0,d=y,l=m;break}P=P.sibling}if(!_)throw Error(t(189))}}if(l.alternate!==d)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?r:s}function Va(r){return r=yo(r),r!==null?Wn(r):null}function Wn(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var s=Wn(r);if(s!==null)return s;r=r.sibling}return null}var xo=e.unstable_scheduleCallback,Ya=e.unstable_cancelCallback,$c=e.unstable_shouldYield,Lc=e.unstable_requestPaint,xt=e.unstable_now,Mh=e.unstable_getCurrentPriorityLevel,bi=e.unstable_ImmediatePriority,vo=e.unstable_UserBlockingPriority,ls=e.unstable_NormalPriority,Xa=e.unstable_LowPriority,_o=e.unstable_IdlePriority,or=null,ut=null;function zc(r){if(ut&&typeof ut.onCommitFiberRoot=="function")try{ut.onCommitFiberRoot(or,r,void 0,(r.current.flags&128)===128)}catch{}}var Qt=Math.clz32?Math.clz32:bo,ln=Math.log,wo=Math.LN2;function bo(r){return r>>>=0,r===0?32:31-(ln(r)/wo|0)|0}var Rt=64,Si=4194304;function Vr(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function cs(r,s){var l=r.pendingLanes;if(l===0)return 0;var d=0,m=r.suspendedLanes,y=r.pingedLanes,_=l&268435455;if(_!==0){var P=_&~m;P!==0?d=Vr(P):(y&=_,y!==0&&(d=Vr(y)))}else _=l&~m,_!==0?d=Vr(_):y!==0&&(d=Vr(y));if(d===0)return 0;if(s!==0&&s!==d&&(s&m)===0&&(m=d&-d,y=s&-s,m>=y||m===16&&(y&4194240)!==0))return s;if((d&4)!==0&&(d|=l&16),s=r.entangledLanes,s!==0)for(r=r.entanglements,s&=d;0<s;)l=31-Qt(s),m=1<<l,d|=r[l],s&=~m;return d}function Fc(r,s){switch(r){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function So(r,s){for(var l=r.suspendedLanes,d=r.pingedLanes,m=r.expirationTimes,y=r.pendingLanes;0<y;){var _=31-Qt(y),P=1<<_,R=m[_];R===-1?((P&l)===0||(P&d)!==0)&&(m[_]=Fc(P,s)):R<=s&&(r.expiredLanes|=P),y&=~P}}function ko(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function us(){var r=Rt;return Rt<<=1,(Rt&4194240)===0&&(Rt=64),r}function Co(r){for(var s=[],l=0;31>l;l++)s.push(r);return s}function ue(r,s,l){r.pendingLanes|=s,s!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,s=31-Qt(s),r[s]=l}function qa(r,s){var l=r.pendingLanes&~s;r.pendingLanes=s,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=s,r.mutableReadLanes&=s,r.entangledLanes&=s,s=r.entanglements;var d=r.eventTimes;for(r=r.expirationTimes;0<l;){var m=31-Qt(l),y=1<<m;s[m]=0,d[m]=-1,r[m]=-1,l&=~y}}function Yr(r,s){var l=r.entangledLanes|=s;for(r=r.entanglements;l;){var d=31-Qt(l),m=1<<d;m&s|r[d]&s&&(r[d]|=s),l&=~m}}var Xe=0;function Ka(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var ds,hs,Qa,fs,Ao,br=!1,ps=[],ar=null,lr=null,cr=null,ki=new Map,Ci=new Map,Hn=[],Ai="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Za(r,s){switch(r){case"focusin":case"focusout":ar=null;break;case"dragenter":case"dragleave":lr=null;break;case"mouseover":case"mouseout":cr=null;break;case"pointerover":case"pointerout":ki.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ci.delete(s.pointerId)}}function Sr(r,s,l,d,m,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:l,eventSystemFlags:d,nativeEvent:y,targetContainers:[m]},s!==null&&(s=Uo(s),s!==null&&hs(s)),r):(r.eventSystemFlags|=d,s=r.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),r)}function ms(r,s,l,d,m){switch(s){case"focusin":return ar=Sr(ar,r,s,l,d,m),!0;case"dragenter":return lr=Sr(lr,r,s,l,d,m),!0;case"mouseover":return cr=Sr(cr,r,s,l,d,m),!0;case"pointerover":var y=m.pointerId;return ki.set(y,Sr(ki.get(y)||null,r,s,l,d,m)),!0;case"gotpointercapture":return y=m.pointerId,Ci.set(y,Sr(Ci.get(y)||null,r,s,l,d,m)),!0}return!1}function To(r){var s=Li(r.target);if(s!==null){var l=Oe(s);if(l!==null){if(s=l.tag,s===13){if(s=go(l),s!==null){r.blockedOn=s,Ao(r.priority,function(){Qa(l)});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function gs(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var l=Eo(r.domEventName,r.eventSystemFlags,s[0],r.nativeEvent);if(l===null){l=r.nativeEvent;var d=new l.constructor(l.type,l);co=d,l.target.dispatchEvent(d),co=null}else return s=Uo(l),s!==null&&hs(s),r.blockedOn=l,!1;s.shift()}return!0}function Mo(r,s,l){gs(r)&&l.delete(s)}function Ja(){br=!1,ar!==null&&gs(ar)&&(ar=null),lr!==null&&gs(lr)&&(lr=null),cr!==null&&gs(cr)&&(cr=null),ki.forEach(Mo),Ci.forEach(Mo)}function Ti(r,s){r.blockedOn===s&&(r.blockedOn=null,br||(br=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ja)))}function Mi(r){function s(m){return Ti(m,r)}if(0<ps.length){Ti(ps[0],r);for(var l=1;l<ps.length;l++){var d=ps[l];d.blockedOn===r&&(d.blockedOn=null)}}for(ar!==null&&Ti(ar,r),lr!==null&&Ti(lr,r),cr!==null&&Ti(cr,r),ki.forEach(s),Ci.forEach(s),l=0;l<Hn.length;l++)d=Hn[l],d.blockedOn===r&&(d.blockedOn=null);for(;0<Hn.length&&(l=Hn[0],l.blockedOn===null);)To(l),l.blockedOn===null&&Hn.shift()}var Xr=E.ReactCurrentBatchConfig,ys=!0;function jc(r,s,l,d){var m=Xe,y=Xr.transition;Xr.transition=null;try{Xe=1,Po(r,s,l,d)}finally{Xe=m,Xr.transition=y}}function Bc(r,s,l,d){var m=Xe,y=Xr.transition;Xr.transition=null;try{Xe=4,Po(r,s,l,d)}finally{Xe=m,Xr.transition=y}}function Po(r,s,l,d){if(ys){var m=Eo(r,s,l,d);if(m===null)Zc(r,s,d,xs,l),Za(r,d);else if(ms(m,r,s,l,d))d.stopPropagation();else if(Za(r,d),s&4&&-1<Ai.indexOf(r)){for(;m!==null;){var y=Uo(m);if(y!==null&&ds(y),y=Eo(r,s,l,d),y===null&&Zc(r,s,d,xs,l),y===m)break;m=y}m!==null&&d.stopPropagation()}else Zc(r,s,d,null,l)}}var xs=null;function Eo(r,s,l,d){if(xs=null,r=uo(d),r=Li(r),r!==null)if(s=Oe(r),s===null)r=null;else if(l=s.tag,l===13){if(r=go(s),r!==null)return r;r=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null);return xs=r,null}function el(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Mh()){case bi:return 1;case vo:return 4;case ls:case Xa:return 16;case _o:return 536870912;default:return 16}default:return 16}}var ur=null,Pi=null,vs=null;function Ei(){if(vs)return vs;var r,s=Pi,l=s.length,d,m="value"in ur?ur.value:ur.textContent,y=m.length;for(r=0;r<l&&s[r]===m[r];r++);var _=l-r;for(d=1;d<=_&&s[l-d]===m[y-d];d++);return vs=m.slice(r,1<d?1-d:void 0)}function _s(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function dr(){return!0}function Ri(){return!1}function Zt(r){function s(l,d,m,y,_){this._reactName=l,this._targetInst=m,this.type=d,this.nativeEvent=y,this.target=_,this.currentTarget=null;for(var P in r)r.hasOwnProperty(P)&&(l=r[P],this[P]=l?l(y):y[P]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?dr:Ri,this.isPropagationStopped=Ri,this}return ie(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=dr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=dr)},persist:function(){},isPersistent:dr}),s}var qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ro=Zt(qr),kr=ie({},qr,{view:0,detail:0}),Dc=Zt(kr),Io,$o,Ii,ws=ie({},kr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dt,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ii&&(Ii&&r.type==="mousemove"?(Io=r.screenX-Ii.screenX,$o=r.screenY-Ii.screenY):$o=Io=0,Ii=r),Io)},movementY:function(r){return"movementY"in r?r.movementY:$o}}),tl=Zt(ws),Oc=ie({},ws,{dataTransfer:0}),Nc=Zt(Oc),C=ie({},kr,{relatedTarget:0}),z=Zt(C),D=ie({},qr,{animationName:0,elapsedTime:0,pseudoElement:0}),X=Zt(D),le=ie({},qr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ie=Zt(le),de=ie({},qr,{data:0}),we=Zt(de),Ae={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ge={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ze(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=Ge[r])?!!s[r]:!1}function dt(){return Ze}var _e=ie({},kr,{key:function(r){if(r.key){var s=Ae[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=_s(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?pe[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dt,charCode:function(r){return r.type==="keypress"?_s(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?_s(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Se=Zt(_e),Te=ie({},ws,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),We=Zt(Te),it=ie({},kr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dt}),ye=Zt(it),$e=ie({},qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),kt=Zt($e),Tt=ie({},ws,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),It=Zt(Tt),qe=[9,13,27,32],cn=u&&"CompositionEvent"in window,$i=null;u&&"documentMode"in document&&($i=document.documentMode);var Wc=u&&"TextEvent"in window&&!$i,_n=u&&(!cn||$i&&8<$i&&11>=$i),Lo=" ",je=!1;function pt(r,s){switch(r){case"keyup":return qe.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jt(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var en=!1;function nl(r,s){switch(r){case"compositionend":return Jt(s);case"keypress":return s.which!==32?null:(je=!0,Lo);case"textInput":return r=s.data,r===Lo&&je?null:r;default:return null}}function bs(r,s){if(en)return r==="compositionend"||!cn&&pt(r,s)?(r=Ei(),vs=Pi=ur=null,en=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return _n&&s.locale!=="ko"?null:s.data;default:return null}}var Ss={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zo(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!Ss[r.type]:s==="textarea"}function Ph(r,s,l,d){os(d),s=al(s,"onChange"),0<s.length&&(l=new Ro("onChange","change",null,l,d),r.push({event:l,listeners:s}))}var Fo=null,jo=null;function Ym(r){Yh(r,0)}function rl(r){var s=Ms(r);if(vn(s))return r}function Xm(r,s){if(r==="change")return s}var Eh=!1;if(u){var Hc;if(u){var Uc="oninput"in document;if(!Uc){var Rh=document.createElement("div");Rh.setAttribute("oninput","return;"),Uc=typeof Rh.oninput=="function"}Hc=Uc}else Hc=!1;Eh=Hc&&(!document.documentMode||9<document.documentMode)}function Ih(){Fo&&(Fo.detachEvent("onpropertychange",$h),jo=Fo=null)}function $h(r){if(r.propertyName==="value"&&rl(jo)){var s=[];Ph(s,jo,r,uo(r)),Bt(Ym,s)}}function qm(r,s,l){r==="focusin"?(Ih(),Fo=s,jo=l,Fo.attachEvent("onpropertychange",$h)):r==="focusout"&&Ih()}function Km(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return rl(jo)}function Qm(r,s){if(r==="click")return rl(s)}function Zm(r,s){if(r==="input"||r==="change")return rl(s)}function Jm(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Un=typeof Object.is=="function"?Object.is:Jm;function Bo(r,s){if(Un(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var l=Object.keys(r),d=Object.keys(s);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var m=l[d];if(!h.call(s,m)||!Un(r[m],s[m]))return!1}return!0}function Lh(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function zh(r,s){var l=Lh(r);r=0;for(var d;l;){if(l.nodeType===3){if(d=r+l.textContent.length,r<=s&&d>=s)return{node:l,offset:s-r};r=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Lh(l)}}function Fh(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?Fh(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function jh(){for(var r=window,s=sn();s instanceof r.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)r=s.contentWindow;else break;s=sn(r.document)}return s}function Gc(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}function eg(r){var s=jh(),l=r.focusedElem,d=r.selectionRange;if(s!==l&&l&&l.ownerDocument&&Fh(l.ownerDocument.documentElement,l)){if(d!==null&&Gc(l)){if(s=d.start,r=d.end,r===void 0&&(r=s),"selectionStart"in l)l.selectionStart=s,l.selectionEnd=Math.min(r,l.value.length);else if(r=(s=l.ownerDocument||document)&&s.defaultView||window,r.getSelection){r=r.getSelection();var m=l.textContent.length,y=Math.min(d.start,m);d=d.end===void 0?y:Math.min(d.end,m),!r.extend&&y>d&&(m=d,d=y,y=m),m=zh(l,y);var _=zh(l,d);m&&_&&(r.rangeCount!==1||r.anchorNode!==m.node||r.anchorOffset!==m.offset||r.focusNode!==_.node||r.focusOffset!==_.offset)&&(s=s.createRange(),s.setStart(m.node,m.offset),r.removeAllRanges(),y>d?(r.addRange(s),r.extend(_.node,_.offset)):(s.setEnd(_.node,_.offset),r.addRange(s)))}}for(s=[],r=l;r=r.parentNode;)r.nodeType===1&&s.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<s.length;l++)r=s[l],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var tg=u&&"documentMode"in document&&11>=document.documentMode,ks=null,Vc=null,Do=null,Yc=!1;function Bh(r,s,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Yc||ks==null||ks!==sn(d)||(d=ks,"selectionStart"in d&&Gc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Do&&Bo(Do,d)||(Do=d,d=al(Vc,"onSelect"),0<d.length&&(s=new Ro("onSelect","select",null,s,l),r.push({event:s,listeners:d}),s.target=ks)))}function il(r,s){var l={};return l[r.toLowerCase()]=s.toLowerCase(),l["Webkit"+r]="webkit"+s,l["Moz"+r]="moz"+s,l}var Cs={animationend:il("Animation","AnimationEnd"),animationiteration:il("Animation","AnimationIteration"),animationstart:il("Animation","AnimationStart"),transitionend:il("Transition","TransitionEnd")},Xc={},Dh={};u&&(Dh=document.createElement("div").style,"AnimationEvent"in window||(delete Cs.animationend.animation,delete Cs.animationiteration.animation,delete Cs.animationstart.animation),"TransitionEvent"in window||delete Cs.transitionend.transition);function sl(r){if(Xc[r])return Xc[r];if(!Cs[r])return r;var s=Cs[r],l;for(l in s)if(s.hasOwnProperty(l)&&l in Dh)return Xc[r]=s[l];return r}var Oh=sl("animationend"),Nh=sl("animationiteration"),Wh=sl("animationstart"),Hh=sl("transitionend"),Uh=new Map,Gh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kr(r,s){Uh.set(r,s),a(s,[r])}for(var qc=0;qc<Gh.length;qc++){var Kc=Gh[qc],ng=Kc.toLowerCase(),rg=Kc[0].toUpperCase()+Kc.slice(1);Kr(ng,"on"+rg)}Kr(Oh,"onAnimationEnd"),Kr(Nh,"onAnimationIteration"),Kr(Wh,"onAnimationStart"),Kr("dblclick","onDoubleClick"),Kr("focusin","onFocus"),Kr("focusout","onBlur"),Kr(Hh,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ig=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oo));function Vh(r,s,l){var d=r.type||"unknown-event";r.currentTarget=l,Ga(d,s,void 0,r),r.currentTarget=null}function Yh(r,s){s=(s&4)!==0;for(var l=0;l<r.length;l++){var d=r[l],m=d.event;d=d.listeners;e:{var y=void 0;if(s)for(var _=d.length-1;0<=_;_--){var P=d[_],R=P.instance,W=P.currentTarget;if(P=P.listener,R!==y&&m.isPropagationStopped())break e;Vh(m,P,W),y=R}else for(_=0;_<d.length;_++){if(P=d[_],R=P.instance,W=P.currentTarget,P=P.listener,R!==y&&m.isPropagationStopped())break e;Vh(m,P,W),y=R}}}if(Kt)throw r=mo,Kt=!1,mo=null,r}function st(r,s){var l=s[iu];l===void 0&&(l=s[iu]=new Set);var d=r+"__bubble";l.has(d)||(Xh(s,r,2,!1),l.add(d))}function Qc(r,s,l){var d=0;s&&(d|=4),Xh(l,r,d,s)}var ol="_reactListening"+Math.random().toString(36).slice(2);function No(r){if(!r[ol]){r[ol]=!0,i.forEach(function(l){l!=="selectionchange"&&(ig.has(l)||Qc(l,!1,r),Qc(l,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[ol]||(s[ol]=!0,Qc("selectionchange",!1,s))}}function Xh(r,s,l,d){switch(el(s)){case 1:var m=jc;break;case 4:m=Bc;break;default:m=Po}l=m.bind(null,s,l,r),m=void 0,!St||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),d?m!==void 0?r.addEventListener(s,l,{capture:!0,passive:m}):r.addEventListener(s,l,!0):m!==void 0?r.addEventListener(s,l,{passive:m}):r.addEventListener(s,l,!1)}function Zc(r,s,l,d,m){var y=d;if((s&1)===0&&(s&2)===0&&d!==null)e:for(;;){if(d===null)return;var _=d.tag;if(_===3||_===4){var P=d.stateNode.containerInfo;if(P===m||P.nodeType===8&&P.parentNode===m)break;if(_===4)for(_=d.return;_!==null;){var R=_.tag;if((R===3||R===4)&&(R=_.stateNode.containerInfo,R===m||R.nodeType===8&&R.parentNode===m))return;_=_.return}for(;P!==null;){if(_=Li(P),_===null)return;if(R=_.tag,R===5||R===6){d=y=_;continue e}P=P.parentNode}}d=d.return}Bt(function(){var W=y,ne=uo(l),re=[];e:{var J=Uh.get(r);if(J!==void 0){var ce=Ro,fe=r;switch(r){case"keypress":if(_s(l)===0)break e;case"keydown":case"keyup":ce=Se;break;case"focusin":fe="focus",ce=z;break;case"focusout":fe="blur",ce=z;break;case"beforeblur":case"afterblur":ce=z;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=tl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=Nc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=ye;break;case Oh:case Nh:case Wh:ce=X;break;case Hh:ce=kt;break;case"scroll":ce=Dc;break;case"wheel":ce=It;break;case"copy":case"cut":case"paste":ce=Ie;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=We}var me=(s&4)!==0,bt=!me&&r==="scroll",j=me?J!==null?J+"Capture":null:J;me=[];for(var $=W,O;$!==null;){O=$;var oe=O.stateNode;if(O.tag===5&&oe!==null&&(O=oe,j!==null&&(oe=sr($,j),oe!=null&&me.push(Wo($,oe,O)))),bt)break;$=$.return}0<me.length&&(J=new ce(J,fe,null,l,ne),re.push({event:J,listeners:me}))}}if((s&7)===0){e:{if(J=r==="mouseover"||r==="pointerover",ce=r==="mouseout"||r==="pointerout",J&&l!==co&&(fe=l.relatedTarget||l.fromElement)&&(Li(fe)||fe[Cr]))break e;if((ce||J)&&(J=ne.window===ne?ne:(J=ne.ownerDocument)?J.defaultView||J.parentWindow:window,ce?(fe=l.relatedTarget||l.toElement,ce=W,fe=fe?Li(fe):null,fe!==null&&(bt=Oe(fe),fe!==bt||fe.tag!==5&&fe.tag!==6)&&(fe=null)):(ce=null,fe=W),ce!==fe)){if(me=tl,oe="onMouseLeave",j="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(me=We,oe="onPointerLeave",j="onPointerEnter",$="pointer"),bt=ce==null?J:Ms(ce),O=fe==null?J:Ms(fe),J=new me(oe,$+"leave",ce,l,ne),J.target=bt,J.relatedTarget=O,oe=null,Li(ne)===W&&(me=new me(j,$+"enter",fe,l,ne),me.target=O,me.relatedTarget=bt,oe=me),bt=oe,ce&&fe)t:{for(me=ce,j=fe,$=0,O=me;O;O=As(O))$++;for(O=0,oe=j;oe;oe=As(oe))O++;for(;0<$-O;)me=As(me),$--;for(;0<O-$;)j=As(j),O--;for(;$--;){if(me===j||j!==null&&me===j.alternate)break t;me=As(me),j=As(j)}me=null}else me=null;ce!==null&&qh(re,J,ce,me,!1),fe!==null&&bt!==null&&qh(re,bt,fe,me,!0)}}e:{if(J=W?Ms(W):window,ce=J.nodeName&&J.nodeName.toLowerCase(),ce==="select"||ce==="input"&&J.type==="file")var ge=Xm;else if(zo(J))if(Eh)ge=Zm;else{ge=Km;var ke=qm}else(ce=J.nodeName)&&ce.toLowerCase()==="input"&&(J.type==="checkbox"||J.type==="radio")&&(ge=Qm);if(ge&&(ge=ge(r,W))){Ph(re,ge,l,ne);break e}ke&&ke(r,J,W),r==="focusout"&&(ke=J._wrapperState)&&ke.controlled&&J.type==="number"&&ns(J,"number",J.value)}switch(ke=W?Ms(W):window,r){case"focusin":(zo(ke)||ke.contentEditable==="true")&&(ks=ke,Vc=W,Do=null);break;case"focusout":Do=Vc=ks=null;break;case"mousedown":Yc=!0;break;case"contextmenu":case"mouseup":case"dragend":Yc=!1,Bh(re,l,ne);break;case"selectionchange":if(tg)break;case"keydown":case"keyup":Bh(re,l,ne)}var Ce;if(cn)e:{switch(r){case"compositionstart":var Me="onCompositionStart";break e;case"compositionend":Me="onCompositionEnd";break e;case"compositionupdate":Me="onCompositionUpdate";break e}Me=void 0}else en?pt(r,l)&&(Me="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(Me="onCompositionStart");Me&&(_n&&l.locale!=="ko"&&(en||Me!=="onCompositionStart"?Me==="onCompositionEnd"&&en&&(Ce=Ei()):(ur=ne,Pi="value"in ur?ur.value:ur.textContent,en=!0)),ke=al(W,Me),0<ke.length&&(Me=new we(Me,r,null,l,ne),re.push({event:Me,listeners:ke}),Ce?Me.data=Ce:(Ce=Jt(l),Ce!==null&&(Me.data=Ce)))),(Ce=Wc?nl(r,l):bs(r,l))&&(W=al(W,"onBeforeInput"),0<W.length&&(ne=new we("onBeforeInput","beforeinput",null,l,ne),re.push({event:ne,listeners:W}),ne.data=Ce))}Yh(re,s)})}function Wo(r,s,l){return{instance:r,listener:s,currentTarget:l}}function al(r,s){for(var l=s+"Capture",d=[];r!==null;){var m=r,y=m.stateNode;m.tag===5&&y!==null&&(m=y,y=sr(r,l),y!=null&&d.unshift(Wo(r,y,m)),y=sr(r,s),y!=null&&d.push(Wo(r,y,m))),r=r.return}return d}function As(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function qh(r,s,l,d,m){for(var y=s._reactName,_=[];l!==null&&l!==d;){var P=l,R=P.alternate,W=P.stateNode;if(R!==null&&R===d)break;P.tag===5&&W!==null&&(P=W,m?(R=sr(l,y),R!=null&&_.unshift(Wo(l,R,P))):m||(R=sr(l,y),R!=null&&_.push(Wo(l,R,P)))),l=l.return}_.length!==0&&r.push({event:s,listeners:_})}var sg=/\r\n?/g,og=/\u0000|\uFFFD/g;function Kh(r){return(typeof r=="string"?r:""+r).replace(sg,`
`).replace(og,"")}function ll(r,s,l){if(s=Kh(s),Kh(r)!==s&&l)throw Error(t(425))}function cl(){}var Jc=null,eu=null;function tu(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var nu=typeof setTimeout=="function"?setTimeout:void 0,ag=typeof clearTimeout=="function"?clearTimeout:void 0,Qh=typeof Promise=="function"?Promise:void 0,lg=typeof queueMicrotask=="function"?queueMicrotask:typeof Qh<"u"?function(r){return Qh.resolve(null).then(r).catch(cg)}:nu;function cg(r){setTimeout(function(){throw r})}function ru(r,s){var l=s,d=0;do{var m=l.nextSibling;if(r.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(d===0){r.removeChild(m),Mi(s);return}d--}else l!=="$"&&l!=="$?"&&l!=="$!"||d++;l=m}while(l);Mi(s)}function Qr(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return r}function Zh(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return r;s--}else l==="/$"&&s++}r=r.previousSibling}return null}var Ts=Math.random().toString(36).slice(2),hr="__reactFiber$"+Ts,Ho="__reactProps$"+Ts,Cr="__reactContainer$"+Ts,iu="__reactEvents$"+Ts,ug="__reactListeners$"+Ts,dg="__reactHandles$"+Ts;function Li(r){var s=r[hr];if(s)return s;for(var l=r.parentNode;l;){if(s=l[Cr]||l[hr]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(r=Zh(r);r!==null;){if(l=r[hr])return l;r=Zh(r)}return s}r=l,l=r.parentNode}return null}function Uo(r){return r=r[hr]||r[Cr],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Ms(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function ul(r){return r[Ho]||null}var su=[],Ps=-1;function Zr(r){return{current:r}}function ot(r){0>Ps||(r.current=su[Ps],su[Ps]=null,Ps--)}function nt(r,s){Ps++,su[Ps]=r.current,r.current=s}var Jr={},Ht=Zr(Jr),un=Zr(!1),zi=Jr;function Es(r,s){var l=r.type.contextTypes;if(!l)return Jr;var d=r.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===s)return d.__reactInternalMemoizedMaskedChildContext;var m={},y;for(y in l)m[y]=s[y];return d&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=s,r.__reactInternalMemoizedMaskedChildContext=m),m}function dn(r){return r=r.childContextTypes,r!=null}function dl(){ot(un),ot(Ht)}function Jh(r,s,l){if(Ht.current!==Jr)throw Error(t(168));nt(Ht,s),nt(un,l)}function ef(r,s,l){var d=r.stateNode;if(s=s.childContextTypes,typeof d.getChildContext!="function")return l;d=d.getChildContext();for(var m in d)if(!(m in s))throw Error(t(108,De(r)||"Unknown",m));return ie({},l,d)}function hl(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Jr,zi=Ht.current,nt(Ht,r),nt(un,un.current),!0}function tf(r,s,l){var d=r.stateNode;if(!d)throw Error(t(169));l?(r=ef(r,s,zi),d.__reactInternalMemoizedMergedChildContext=r,ot(un),ot(Ht),nt(Ht,r)):ot(un),nt(un,l)}var Ar=null,fl=!1,ou=!1;function nf(r){Ar===null?Ar=[r]:Ar.push(r)}function hg(r){fl=!0,nf(r)}function ei(){if(!ou&&Ar!==null){ou=!0;var r=0,s=Xe;try{var l=Ar;for(Xe=1;r<l.length;r++){var d=l[r];do d=d(!0);while(d!==null)}Ar=null,fl=!1}catch(m){throw Ar!==null&&(Ar=Ar.slice(r+1)),xo(bi,ei),m}finally{Xe=s,ou=!1}}return null}var Rs=[],Is=0,pl=null,ml=0,En=[],Rn=0,Fi=null,Tr=1,Mr="";function ji(r,s){Rs[Is++]=ml,Rs[Is++]=pl,pl=r,ml=s}function rf(r,s,l){En[Rn++]=Tr,En[Rn++]=Mr,En[Rn++]=Fi,Fi=r;var d=Tr;r=Mr;var m=32-Qt(d)-1;d&=~(1<<m),l+=1;var y=32-Qt(s)+m;if(30<y){var _=m-m%5;y=(d&(1<<_)-1).toString(32),d>>=_,m-=_,Tr=1<<32-Qt(s)+m|l<<m|d,Mr=y+r}else Tr=1<<y|l<<m|d,Mr=r}function au(r){r.return!==null&&(ji(r,1),rf(r,1,0))}function lu(r){for(;r===pl;)pl=Rs[--Is],Rs[Is]=null,ml=Rs[--Is],Rs[Is]=null;for(;r===Fi;)Fi=En[--Rn],En[Rn]=null,Mr=En[--Rn],En[Rn]=null,Tr=En[--Rn],En[Rn]=null}var wn=null,bn=null,ht=!1,Gn=null;function sf(r,s){var l=zn(5,null,null,0);l.elementType="DELETED",l.stateNode=s,l.return=r,s=r.deletions,s===null?(r.deletions=[l],r.flags|=16):s.push(l)}function of(r,s){switch(r.tag){case 5:var l=r.type;return s=s.nodeType!==1||l.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(r.stateNode=s,wn=r,bn=Qr(s.firstChild),!0):!1;case 6:return s=r.pendingProps===""||s.nodeType!==3?null:s,s!==null?(r.stateNode=s,wn=r,bn=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(l=Fi!==null?{id:Tr,overflow:Mr}:null,r.memoizedState={dehydrated:s,treeContext:l,retryLane:1073741824},l=zn(18,null,null,0),l.stateNode=s,l.return=r,r.child=l,wn=r,bn=null,!0):!1;default:return!1}}function cu(r){return(r.mode&1)!==0&&(r.flags&128)===0}function uu(r){if(ht){var s=bn;if(s){var l=s;if(!of(r,s)){if(cu(r))throw Error(t(418));s=Qr(l.nextSibling);var d=wn;s&&of(r,s)?sf(d,l):(r.flags=r.flags&-4097|2,ht=!1,wn=r)}}else{if(cu(r))throw Error(t(418));r.flags=r.flags&-4097|2,ht=!1,wn=r}}}function af(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;wn=r}function gl(r){if(r!==wn)return!1;if(!ht)return af(r),ht=!0,!1;var s;if((s=r.tag!==3)&&!(s=r.tag!==5)&&(s=r.type,s=s!=="head"&&s!=="body"&&!tu(r.type,r.memoizedProps)),s&&(s=bn)){if(cu(r))throw lf(),Error(t(418));for(;s;)sf(r,s),s=Qr(s.nextSibling)}if(af(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,s=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"){if(s===0){bn=Qr(r.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++}r=r.nextSibling}bn=null}}else bn=wn?Qr(r.stateNode.nextSibling):null;return!0}function lf(){for(var r=bn;r;)r=Qr(r.nextSibling)}function $s(){bn=wn=null,ht=!1}function du(r){Gn===null?Gn=[r]:Gn.push(r)}var fg=E.ReactCurrentBatchConfig;function Go(r,s,l){if(r=l.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var d=l.stateNode}if(!d)throw Error(t(147,r));var m=d,y=""+r;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===y?s.ref:(s=function(_){var P=m.refs;_===null?delete P[y]:P[y]=_},s._stringRef=y,s)}if(typeof r!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,r))}return r}function yl(r,s){throw r=Object.prototype.toString.call(s),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r))}function cf(r){var s=r._init;return s(r._payload)}function uf(r){function s(j,$){if(r){var O=j.deletions;O===null?(j.deletions=[$],j.flags|=16):O.push($)}}function l(j,$){if(!r)return null;for(;$!==null;)s(j,$),$=$.sibling;return null}function d(j,$){for(j=new Map;$!==null;)$.key!==null?j.set($.key,$):j.set($.index,$),$=$.sibling;return j}function m(j,$){return j=li(j,$),j.index=0,j.sibling=null,j}function y(j,$,O){return j.index=O,r?(O=j.alternate,O!==null?(O=O.index,O<$?(j.flags|=2,$):O):(j.flags|=2,$)):(j.flags|=1048576,$)}function _(j){return r&&j.alternate===null&&(j.flags|=2),j}function P(j,$,O,oe){return $===null||$.tag!==6?($=nd(O,j.mode,oe),$.return=j,$):($=m($,O),$.return=j,$)}function R(j,$,O,oe){var ge=O.type;return ge===I?ne(j,$,O.props.children,oe,O.key):$!==null&&($.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===G&&cf(ge)===$.type)?(oe=m($,O.props),oe.ref=Go(j,$,O),oe.return=j,oe):(oe=Nl(O.type,O.key,O.props,null,j.mode,oe),oe.ref=Go(j,$,O),oe.return=j,oe)}function W(j,$,O,oe){return $===null||$.tag!==4||$.stateNode.containerInfo!==O.containerInfo||$.stateNode.implementation!==O.implementation?($=rd(O,j.mode,oe),$.return=j,$):($=m($,O.children||[]),$.return=j,$)}function ne(j,$,O,oe,ge){return $===null||$.tag!==7?($=Gi(O,j.mode,oe,ge),$.return=j,$):($=m($,O),$.return=j,$)}function re(j,$,O){if(typeof $=="string"&&$!==""||typeof $=="number")return $=nd(""+$,j.mode,O),$.return=j,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case B:return O=Nl($.type,$.key,$.props,null,j.mode,O),O.ref=Go(j,null,$),O.return=j,O;case F:return $=rd($,j.mode,O),$.return=j,$;case G:var oe=$._init;return re(j,oe($._payload),O)}if(yi($)||Y($))return $=Gi($,j.mode,O,null),$.return=j,$;yl(j,$)}return null}function J(j,$,O,oe){var ge=$!==null?$.key:null;if(typeof O=="string"&&O!==""||typeof O=="number")return ge!==null?null:P(j,$,""+O,oe);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case B:return O.key===ge?R(j,$,O,oe):null;case F:return O.key===ge?W(j,$,O,oe):null;case G:return ge=O._init,J(j,$,ge(O._payload),oe)}if(yi(O)||Y(O))return ge!==null?null:ne(j,$,O,oe,null);yl(j,O)}return null}function ce(j,$,O,oe,ge){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return j=j.get(O)||null,P($,j,""+oe,ge);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case B:return j=j.get(oe.key===null?O:oe.key)||null,R($,j,oe,ge);case F:return j=j.get(oe.key===null?O:oe.key)||null,W($,j,oe,ge);case G:var ke=oe._init;return ce(j,$,O,ke(oe._payload),ge)}if(yi(oe)||Y(oe))return j=j.get(O)||null,ne($,j,oe,ge,null);yl($,oe)}return null}function fe(j,$,O,oe){for(var ge=null,ke=null,Ce=$,Me=$=0,zt=null;Ce!==null&&Me<O.length;Me++){Ce.index>Me?(zt=Ce,Ce=null):zt=Ce.sibling;var Ve=J(j,Ce,O[Me],oe);if(Ve===null){Ce===null&&(Ce=zt);break}r&&Ce&&Ve.alternate===null&&s(j,Ce),$=y(Ve,$,Me),ke===null?ge=Ve:ke.sibling=Ve,ke=Ve,Ce=zt}if(Me===O.length)return l(j,Ce),ht&&ji(j,Me),ge;if(Ce===null){for(;Me<O.length;Me++)Ce=re(j,O[Me],oe),Ce!==null&&($=y(Ce,$,Me),ke===null?ge=Ce:ke.sibling=Ce,ke=Ce);return ht&&ji(j,Me),ge}for(Ce=d(j,Ce);Me<O.length;Me++)zt=ce(Ce,j,Me,O[Me],oe),zt!==null&&(r&&zt.alternate!==null&&Ce.delete(zt.key===null?Me:zt.key),$=y(zt,$,Me),ke===null?ge=zt:ke.sibling=zt,ke=zt);return r&&Ce.forEach(function(ci){return s(j,ci)}),ht&&ji(j,Me),ge}function me(j,$,O,oe){var ge=Y(O);if(typeof ge!="function")throw Error(t(150));if(O=ge.call(O),O==null)throw Error(t(151));for(var ke=ge=null,Ce=$,Me=$=0,zt=null,Ve=O.next();Ce!==null&&!Ve.done;Me++,Ve=O.next()){Ce.index>Me?(zt=Ce,Ce=null):zt=Ce.sibling;var ci=J(j,Ce,Ve.value,oe);if(ci===null){Ce===null&&(Ce=zt);break}r&&Ce&&ci.alternate===null&&s(j,Ce),$=y(ci,$,Me),ke===null?ge=ci:ke.sibling=ci,ke=ci,Ce=zt}if(Ve.done)return l(j,Ce),ht&&ji(j,Me),ge;if(Ce===null){for(;!Ve.done;Me++,Ve=O.next())Ve=re(j,Ve.value,oe),Ve!==null&&($=y(Ve,$,Me),ke===null?ge=Ve:ke.sibling=Ve,ke=Ve);return ht&&ji(j,Me),ge}for(Ce=d(j,Ce);!Ve.done;Me++,Ve=O.next())Ve=ce(Ce,j,Me,Ve.value,oe),Ve!==null&&(r&&Ve.alternate!==null&&Ce.delete(Ve.key===null?Me:Ve.key),$=y(Ve,$,Me),ke===null?ge=Ve:ke.sibling=Ve,ke=Ve);return r&&Ce.forEach(function(Vg){return s(j,Vg)}),ht&&ji(j,Me),ge}function bt(j,$,O,oe){if(typeof O=="object"&&O!==null&&O.type===I&&O.key===null&&(O=O.props.children),typeof O=="object"&&O!==null){switch(O.$$typeof){case B:e:{for(var ge=O.key,ke=$;ke!==null;){if(ke.key===ge){if(ge=O.type,ge===I){if(ke.tag===7){l(j,ke.sibling),$=m(ke,O.props.children),$.return=j,j=$;break e}}else if(ke.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===G&&cf(ge)===ke.type){l(j,ke.sibling),$=m(ke,O.props),$.ref=Go(j,ke,O),$.return=j,j=$;break e}l(j,ke);break}else s(j,ke);ke=ke.sibling}O.type===I?($=Gi(O.props.children,j.mode,oe,O.key),$.return=j,j=$):(oe=Nl(O.type,O.key,O.props,null,j.mode,oe),oe.ref=Go(j,$,O),oe.return=j,j=oe)}return _(j);case F:e:{for(ke=O.key;$!==null;){if($.key===ke)if($.tag===4&&$.stateNode.containerInfo===O.containerInfo&&$.stateNode.implementation===O.implementation){l(j,$.sibling),$=m($,O.children||[]),$.return=j,j=$;break e}else{l(j,$);break}else s(j,$);$=$.sibling}$=rd(O,j.mode,oe),$.return=j,j=$}return _(j);case G:return ke=O._init,bt(j,$,ke(O._payload),oe)}if(yi(O))return fe(j,$,O,oe);if(Y(O))return me(j,$,O,oe);yl(j,O)}return typeof O=="string"&&O!==""||typeof O=="number"?(O=""+O,$!==null&&$.tag===6?(l(j,$.sibling),$=m($,O),$.return=j,j=$):(l(j,$),$=nd(O,j.mode,oe),$.return=j,j=$),_(j)):l(j,$)}return bt}var Ls=uf(!0),df=uf(!1),xl=Zr(null),vl=null,zs=null,hu=null;function fu(){hu=zs=vl=null}function pu(r){var s=xl.current;ot(xl),r._currentValue=s}function mu(r,s,l){for(;r!==null;){var d=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,d!==null&&(d.childLanes|=s)):d!==null&&(d.childLanes&s)!==s&&(d.childLanes|=s),r===l)break;r=r.return}}function Fs(r,s){vl=r,hu=zs=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&s)!==0&&(hn=!0),r.firstContext=null)}function In(r){var s=r._currentValue;if(hu!==r)if(r={context:r,memoizedValue:s,next:null},zs===null){if(vl===null)throw Error(t(308));zs=r,vl.dependencies={lanes:0,firstContext:r}}else zs=zs.next=r;return s}var Bi=null;function gu(r){Bi===null?Bi=[r]:Bi.push(r)}function hf(r,s,l,d){var m=s.interleaved;return m===null?(l.next=l,gu(s)):(l.next=m.next,m.next=l),s.interleaved=l,Pr(r,d)}function Pr(r,s){r.lanes|=s;var l=r.alternate;for(l!==null&&(l.lanes|=s),l=r,r=r.return;r!==null;)r.childLanes|=s,l=r.alternate,l!==null&&(l.childLanes|=s),l=r,r=r.return;return l.tag===3?l.stateNode:null}var ti=!1;function yu(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ff(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Er(r,s){return{eventTime:r,lane:s,tag:0,payload:null,callback:null,next:null}}function ni(r,s,l){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(He&2)!==0){var m=d.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),d.pending=s,Pr(r,l)}return m=d.interleaved,m===null?(s.next=s,gu(d)):(s.next=m.next,m.next=s),d.interleaved=s,Pr(r,l)}function _l(r,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194240)!==0)){var d=s.lanes;d&=r.pendingLanes,l|=d,s.lanes=l,Yr(r,l)}}function pf(r,s){var l=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var m=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var _={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};y===null?m=y=_:y=y.next=_,l=l.next}while(l!==null);y===null?m=y=s:y=y.next=s}else m=y=s;l={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:d.shared,effects:d.effects},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=s:r.next=s,l.lastBaseUpdate=s}function wl(r,s,l,d){var m=r.updateQueue;ti=!1;var y=m.firstBaseUpdate,_=m.lastBaseUpdate,P=m.shared.pending;if(P!==null){m.shared.pending=null;var R=P,W=R.next;R.next=null,_===null?y=W:_.next=W,_=R;var ne=r.alternate;ne!==null&&(ne=ne.updateQueue,P=ne.lastBaseUpdate,P!==_&&(P===null?ne.firstBaseUpdate=W:P.next=W,ne.lastBaseUpdate=R))}if(y!==null){var re=m.baseState;_=0,ne=W=R=null,P=y;do{var J=P.lane,ce=P.eventTime;if((d&J)===J){ne!==null&&(ne=ne.next={eventTime:ce,lane:0,tag:P.tag,payload:P.payload,callback:P.callback,next:null});e:{var fe=r,me=P;switch(J=s,ce=l,me.tag){case 1:if(fe=me.payload,typeof fe=="function"){re=fe.call(ce,re,J);break e}re=fe;break e;case 3:fe.flags=fe.flags&-65537|128;case 0:if(fe=me.payload,J=typeof fe=="function"?fe.call(ce,re,J):fe,J==null)break e;re=ie({},re,J);break e;case 2:ti=!0}}P.callback!==null&&P.lane!==0&&(r.flags|=64,J=m.effects,J===null?m.effects=[P]:J.push(P))}else ce={eventTime:ce,lane:J,tag:P.tag,payload:P.payload,callback:P.callback,next:null},ne===null?(W=ne=ce,R=re):ne=ne.next=ce,_|=J;if(P=P.next,P===null){if(P=m.shared.pending,P===null)break;J=P,P=J.next,J.next=null,m.lastBaseUpdate=J,m.shared.pending=null}}while(!0);if(ne===null&&(R=re),m.baseState=R,m.firstBaseUpdate=W,m.lastBaseUpdate=ne,s=m.shared.interleaved,s!==null){m=s;do _|=m.lane,m=m.next;while(m!==s)}else y===null&&(m.shared.lanes=0);Ni|=_,r.lanes=_,r.memoizedState=re}}function mf(r,s,l){if(r=s.effects,s.effects=null,r!==null)for(s=0;s<r.length;s++){var d=r[s],m=d.callback;if(m!==null){if(d.callback=null,d=l,typeof m!="function")throw Error(t(191,m));m.call(d)}}}var Vo={},fr=Zr(Vo),Yo=Zr(Vo),Xo=Zr(Vo);function Di(r){if(r===Vo)throw Error(t(174));return r}function xu(r,s){switch(nt(Xo,s),nt(Yo,r),nt(fr,Vo),r=s.nodeType,r){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:lo(null,"");break;default:r=r===8?s.parentNode:s,s=r.namespaceURI||null,r=r.tagName,s=lo(s,r)}ot(fr),nt(fr,s)}function js(){ot(fr),ot(Yo),ot(Xo)}function gf(r){Di(Xo.current);var s=Di(fr.current),l=lo(s,r.type);s!==l&&(nt(Yo,r),nt(fr,l))}function vu(r){Yo.current===r&&(ot(fr),ot(Yo))}var mt=Zr(0);function bl(r){for(var s=r;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var _u=[];function wu(){for(var r=0;r<_u.length;r++)_u[r]._workInProgressVersionPrimary=null;_u.length=0}var Sl=E.ReactCurrentDispatcher,bu=E.ReactCurrentBatchConfig,Oi=0,gt=null,Mt=null,$t=null,kl=!1,qo=!1,Ko=0,pg=0;function Ut(){throw Error(t(321))}function Su(r,s){if(s===null)return!1;for(var l=0;l<s.length&&l<r.length;l++)if(!Un(r[l],s[l]))return!1;return!0}function ku(r,s,l,d,m,y){if(Oi=y,gt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Sl.current=r===null||r.memoizedState===null?xg:vg,r=l(d,m),qo){y=0;do{if(qo=!1,Ko=0,25<=y)throw Error(t(301));y+=1,$t=Mt=null,s.updateQueue=null,Sl.current=_g,r=l(d,m)}while(qo)}if(Sl.current=Tl,s=Mt!==null&&Mt.next!==null,Oi=0,$t=Mt=gt=null,kl=!1,s)throw Error(t(300));return r}function Cu(){var r=Ko!==0;return Ko=0,r}function pr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?gt.memoizedState=$t=r:$t=$t.next=r,$t}function $n(){if(Mt===null){var r=gt.alternate;r=r!==null?r.memoizedState:null}else r=Mt.next;var s=$t===null?gt.memoizedState:$t.next;if(s!==null)$t=s,Mt=r;else{if(r===null)throw Error(t(310));Mt=r,r={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},$t===null?gt.memoizedState=$t=r:$t=$t.next=r}return $t}function Qo(r,s){return typeof s=="function"?s(r):s}function Au(r){var s=$n(),l=s.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=r;var d=Mt,m=d.baseQueue,y=l.pending;if(y!==null){if(m!==null){var _=m.next;m.next=y.next,y.next=_}d.baseQueue=m=y,l.pending=null}if(m!==null){y=m.next,d=d.baseState;var P=_=null,R=null,W=y;do{var ne=W.lane;if((Oi&ne)===ne)R!==null&&(R=R.next={lane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),d=W.hasEagerState?W.eagerState:r(d,W.action);else{var re={lane:ne,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null};R===null?(P=R=re,_=d):R=R.next=re,gt.lanes|=ne,Ni|=ne}W=W.next}while(W!==null&&W!==y);R===null?_=d:R.next=P,Un(d,s.memoizedState)||(hn=!0),s.memoizedState=d,s.baseState=_,s.baseQueue=R,l.lastRenderedState=d}if(r=l.interleaved,r!==null){m=r;do y=m.lane,gt.lanes|=y,Ni|=y,m=m.next;while(m!==r)}else m===null&&(l.lanes=0);return[s.memoizedState,l.dispatch]}function Tu(r){var s=$n(),l=s.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=r;var d=l.dispatch,m=l.pending,y=s.memoizedState;if(m!==null){l.pending=null;var _=m=m.next;do y=r(y,_.action),_=_.next;while(_!==m);Un(y,s.memoizedState)||(hn=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),l.lastRenderedState=y}return[y,d]}function yf(){}function xf(r,s){var l=gt,d=$n(),m=s(),y=!Un(d.memoizedState,m);if(y&&(d.memoizedState=m,hn=!0),d=d.queue,Mu(wf.bind(null,l,d,r),[r]),d.getSnapshot!==s||y||$t!==null&&$t.memoizedState.tag&1){if(l.flags|=2048,Zo(9,_f.bind(null,l,d,m,s),void 0,null),Lt===null)throw Error(t(349));(Oi&30)!==0||vf(l,s,m)}return m}function vf(r,s,l){r.flags|=16384,r={getSnapshot:s,value:l},s=gt.updateQueue,s===null?(s={lastEffect:null,stores:null},gt.updateQueue=s,s.stores=[r]):(l=s.stores,l===null?s.stores=[r]:l.push(r))}function _f(r,s,l,d){s.value=l,s.getSnapshot=d,bf(s)&&Sf(r)}function wf(r,s,l){return l(function(){bf(s)&&Sf(r)})}function bf(r){var s=r.getSnapshot;r=r.value;try{var l=s();return!Un(r,l)}catch{return!0}}function Sf(r){var s=Pr(r,1);s!==null&&qn(s,r,1,-1)}function kf(r){var s=pr();return typeof r=="function"&&(r=r()),s.memoizedState=s.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:r},s.queue=r,r=r.dispatch=yg.bind(null,gt,r),[s.memoizedState,r]}function Zo(r,s,l,d){return r={tag:r,create:s,destroy:l,deps:d,next:null},s=gt.updateQueue,s===null?(s={lastEffect:null,stores:null},gt.updateQueue=s,s.lastEffect=r.next=r):(l=s.lastEffect,l===null?s.lastEffect=r.next=r:(d=l.next,l.next=r,r.next=d,s.lastEffect=r)),r}function Cf(){return $n().memoizedState}function Cl(r,s,l,d){var m=pr();gt.flags|=r,m.memoizedState=Zo(1|s,l,void 0,d===void 0?null:d)}function Al(r,s,l,d){var m=$n();d=d===void 0?null:d;var y=void 0;if(Mt!==null){var _=Mt.memoizedState;if(y=_.destroy,d!==null&&Su(d,_.deps)){m.memoizedState=Zo(s,l,y,d);return}}gt.flags|=r,m.memoizedState=Zo(1|s,l,y,d)}function Af(r,s){return Cl(8390656,8,r,s)}function Mu(r,s){return Al(2048,8,r,s)}function Tf(r,s){return Al(4,2,r,s)}function Mf(r,s){return Al(4,4,r,s)}function Pf(r,s){if(typeof s=="function")return r=r(),s(r),function(){s(null)};if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function Ef(r,s,l){return l=l!=null?l.concat([r]):null,Al(4,4,Pf.bind(null,s,r),l)}function Pu(){}function Rf(r,s){var l=$n();s=s===void 0?null:s;var d=l.memoizedState;return d!==null&&s!==null&&Su(s,d[1])?d[0]:(l.memoizedState=[r,s],r)}function If(r,s){var l=$n();s=s===void 0?null:s;var d=l.memoizedState;return d!==null&&s!==null&&Su(s,d[1])?d[0]:(r=r(),l.memoizedState=[r,s],r)}function $f(r,s,l){return(Oi&21)===0?(r.baseState&&(r.baseState=!1,hn=!0),r.memoizedState=l):(Un(l,s)||(l=us(),gt.lanes|=l,Ni|=l,r.baseState=!0),s)}function mg(r,s){var l=Xe;Xe=l!==0&&4>l?l:4,r(!0);var d=bu.transition;bu.transition={};try{r(!1),s()}finally{Xe=l,bu.transition=d}}function Lf(){return $n().memoizedState}function gg(r,s,l){var d=oi(r);if(l={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null},zf(r))Ff(s,l);else if(l=hf(r,s,l,d),l!==null){var m=nn();qn(l,r,d,m),jf(l,s,d)}}function yg(r,s,l){var d=oi(r),m={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null};if(zf(r))Ff(s,m);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var _=s.lastRenderedState,P=y(_,l);if(m.hasEagerState=!0,m.eagerState=P,Un(P,_)){var R=s.interleaved;R===null?(m.next=m,gu(s)):(m.next=R.next,R.next=m),s.interleaved=m;return}}catch{}finally{}l=hf(r,s,m,d),l!==null&&(m=nn(),qn(l,r,d,m),jf(l,s,d))}}function zf(r){var s=r.alternate;return r===gt||s!==null&&s===gt}function Ff(r,s){qo=kl=!0;var l=r.pending;l===null?s.next=s:(s.next=l.next,l.next=s),r.pending=s}function jf(r,s,l){if((l&4194240)!==0){var d=s.lanes;d&=r.pendingLanes,l|=d,s.lanes=l,Yr(r,l)}}var Tl={readContext:In,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useInsertionEffect:Ut,useLayoutEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useMutableSource:Ut,useSyncExternalStore:Ut,useId:Ut,unstable_isNewReconciler:!1},xg={readContext:In,useCallback:function(r,s){return pr().memoizedState=[r,s===void 0?null:s],r},useContext:In,useEffect:Af,useImperativeHandle:function(r,s,l){return l=l!=null?l.concat([r]):null,Cl(4194308,4,Pf.bind(null,s,r),l)},useLayoutEffect:function(r,s){return Cl(4194308,4,r,s)},useInsertionEffect:function(r,s){return Cl(4,2,r,s)},useMemo:function(r,s){var l=pr();return s=s===void 0?null:s,r=r(),l.memoizedState=[r,s],r},useReducer:function(r,s,l){var d=pr();return s=l!==void 0?l(s):s,d.memoizedState=d.baseState=s,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:s},d.queue=r,r=r.dispatch=gg.bind(null,gt,r),[d.memoizedState,r]},useRef:function(r){var s=pr();return r={current:r},s.memoizedState=r},useState:kf,useDebugValue:Pu,useDeferredValue:function(r){return pr().memoizedState=r},useTransition:function(){var r=kf(!1),s=r[0];return r=mg.bind(null,r[1]),pr().memoizedState=r,[s,r]},useMutableSource:function(){},useSyncExternalStore:function(r,s,l){var d=gt,m=pr();if(ht){if(l===void 0)throw Error(t(407));l=l()}else{if(l=s(),Lt===null)throw Error(t(349));(Oi&30)!==0||vf(d,s,l)}m.memoizedState=l;var y={value:l,getSnapshot:s};return m.queue=y,Af(wf.bind(null,d,y,r),[r]),d.flags|=2048,Zo(9,_f.bind(null,d,y,l,s),void 0,null),l},useId:function(){var r=pr(),s=Lt.identifierPrefix;if(ht){var l=Mr,d=Tr;l=(d&~(1<<32-Qt(d)-1)).toString(32)+l,s=":"+s+"R"+l,l=Ko++,0<l&&(s+="H"+l.toString(32)),s+=":"}else l=pg++,s=":"+s+"r"+l.toString(32)+":";return r.memoizedState=s},unstable_isNewReconciler:!1},vg={readContext:In,useCallback:Rf,useContext:In,useEffect:Mu,useImperativeHandle:Ef,useInsertionEffect:Tf,useLayoutEffect:Mf,useMemo:If,useReducer:Au,useRef:Cf,useState:function(){return Au(Qo)},useDebugValue:Pu,useDeferredValue:function(r){var s=$n();return $f(s,Mt.memoizedState,r)},useTransition:function(){var r=Au(Qo)[0],s=$n().memoizedState;return[r,s]},useMutableSource:yf,useSyncExternalStore:xf,useId:Lf,unstable_isNewReconciler:!1},_g={readContext:In,useCallback:Rf,useContext:In,useEffect:Mu,useImperativeHandle:Ef,useInsertionEffect:Tf,useLayoutEffect:Mf,useMemo:If,useReducer:Tu,useRef:Cf,useState:function(){return Tu(Qo)},useDebugValue:Pu,useDeferredValue:function(r){var s=$n();return Mt===null?s.memoizedState=r:$f(s,Mt.memoizedState,r)},useTransition:function(){var r=Tu(Qo)[0],s=$n().memoizedState;return[r,s]},useMutableSource:yf,useSyncExternalStore:xf,useId:Lf,unstable_isNewReconciler:!1};function Vn(r,s){if(r&&r.defaultProps){s=ie({},s),r=r.defaultProps;for(var l in r)s[l]===void 0&&(s[l]=r[l]);return s}return s}function Eu(r,s,l,d){s=r.memoizedState,l=l(d,s),l=l==null?s:ie({},s,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var Ml={isMounted:function(r){return(r=r._reactInternals)?Oe(r)===r:!1},enqueueSetState:function(r,s,l){r=r._reactInternals;var d=nn(),m=oi(r),y=Er(d,m);y.payload=s,l!=null&&(y.callback=l),s=ni(r,y,m),s!==null&&(qn(s,r,m,d),_l(s,r,m))},enqueueReplaceState:function(r,s,l){r=r._reactInternals;var d=nn(),m=oi(r),y=Er(d,m);y.tag=1,y.payload=s,l!=null&&(y.callback=l),s=ni(r,y,m),s!==null&&(qn(s,r,m,d),_l(s,r,m))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var l=nn(),d=oi(r),m=Er(l,d);m.tag=2,s!=null&&(m.callback=s),s=ni(r,m,d),s!==null&&(qn(s,r,d,l),_l(s,r,d))}};function Bf(r,s,l,d,m,y,_){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,y,_):s.prototype&&s.prototype.isPureReactComponent?!Bo(l,d)||!Bo(m,y):!0}function Df(r,s,l){var d=!1,m=Jr,y=s.contextType;return typeof y=="object"&&y!==null?y=In(y):(m=dn(s)?zi:Ht.current,d=s.contextTypes,y=(d=d!=null)?Es(r,m):Jr),s=new s(l,y),r.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=Ml,r.stateNode=s,s._reactInternals=r,d&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=m,r.__reactInternalMemoizedMaskedChildContext=y),s}function Of(r,s,l,d){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,d),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,d),s.state!==r&&Ml.enqueueReplaceState(s,s.state,null)}function Ru(r,s,l,d){var m=r.stateNode;m.props=l,m.state=r.memoizedState,m.refs={},yu(r);var y=s.contextType;typeof y=="object"&&y!==null?m.context=In(y):(y=dn(s)?zi:Ht.current,m.context=Es(r,y)),m.state=r.memoizedState,y=s.getDerivedStateFromProps,typeof y=="function"&&(Eu(r,s,y,l),m.state=r.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(s=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),s!==m.state&&Ml.enqueueReplaceState(m,m.state,null),wl(r,l,m,d),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308)}function Bs(r,s){try{var l="",d=s;do l+=Ee(d),d=d.return;while(d);var m=l}catch(y){m=`
Error generating stack: `+y.message+`
`+y.stack}return{value:r,source:s,stack:m,digest:null}}function Iu(r,s,l){return{value:r,source:null,stack:l??null,digest:s??null}}function $u(r,s){try{console.error(s.value)}catch(l){setTimeout(function(){throw l})}}var wg=typeof WeakMap=="function"?WeakMap:Map;function Nf(r,s,l){l=Er(-1,l),l.tag=3,l.payload={element:null};var d=s.value;return l.callback=function(){zl||(zl=!0,Xu=d),$u(r,s)},l}function Wf(r,s,l){l=Er(-1,l),l.tag=3;var d=r.type.getDerivedStateFromError;if(typeof d=="function"){var m=s.value;l.payload=function(){return d(m)},l.callback=function(){$u(r,s)}}var y=r.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(l.callback=function(){$u(r,s),typeof d!="function"&&(ii===null?ii=new Set([this]):ii.add(this));var _=s.stack;this.componentDidCatch(s.value,{componentStack:_!==null?_:""})}),l}function Hf(r,s,l){var d=r.pingCache;if(d===null){d=r.pingCache=new wg;var m=new Set;d.set(s,m)}else m=d.get(s),m===void 0&&(m=new Set,d.set(s,m));m.has(l)||(m.add(l),r=zg.bind(null,r,s,l),s.then(r,r))}function Uf(r){do{var s;if((s=r.tag===13)&&(s=r.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return r;r=r.return}while(r!==null);return null}function Gf(r,s,l,d,m){return(r.mode&1)===0?(r===s?r.flags|=65536:(r.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(s=Er(-1,1),s.tag=2,ni(l,s,1))),l.lanes|=1),r):(r.flags|=65536,r.lanes=m,r)}var bg=E.ReactCurrentOwner,hn=!1;function tn(r,s,l,d){s.child=r===null?df(s,null,l,d):Ls(s,r.child,l,d)}function Vf(r,s,l,d,m){l=l.render;var y=s.ref;return Fs(s,m),d=ku(r,s,l,d,y,m),l=Cu(),r!==null&&!hn?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~m,Rr(r,s,m)):(ht&&l&&au(s),s.flags|=1,tn(r,s,d,m),s.child)}function Yf(r,s,l,d,m){if(r===null){var y=l.type;return typeof y=="function"&&!td(y)&&y.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(s.tag=15,s.type=y,Xf(r,s,y,d,m)):(r=Nl(l.type,null,d,s,s.mode,m),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,(r.lanes&m)===0){var _=y.memoizedProps;if(l=l.compare,l=l!==null?l:Bo,l(_,d)&&r.ref===s.ref)return Rr(r,s,m)}return s.flags|=1,r=li(y,d),r.ref=s.ref,r.return=s,s.child=r}function Xf(r,s,l,d,m){if(r!==null){var y=r.memoizedProps;if(Bo(y,d)&&r.ref===s.ref)if(hn=!1,s.pendingProps=d=y,(r.lanes&m)!==0)(r.flags&131072)!==0&&(hn=!0);else return s.lanes=r.lanes,Rr(r,s,m)}return Lu(r,s,l,d,m)}function qf(r,s,l){var d=s.pendingProps,m=d.children,y=r!==null?r.memoizedState:null;if(d.mode==="hidden")if((s.mode&1)===0)s.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(Os,Sn),Sn|=l;else{if((l&1073741824)===0)return r=y!==null?y.baseLanes|l:l,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:r,cachePool:null,transitions:null},s.updateQueue=null,nt(Os,Sn),Sn|=r,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=y!==null?y.baseLanes:l,nt(Os,Sn),Sn|=d}else y!==null?(d=y.baseLanes|l,s.memoizedState=null):d=l,nt(Os,Sn),Sn|=d;return tn(r,s,m,l),s.child}function Kf(r,s){var l=s.ref;(r===null&&l!==null||r!==null&&r.ref!==l)&&(s.flags|=512,s.flags|=2097152)}function Lu(r,s,l,d,m){var y=dn(l)?zi:Ht.current;return y=Es(s,y),Fs(s,m),l=ku(r,s,l,d,y,m),d=Cu(),r!==null&&!hn?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~m,Rr(r,s,m)):(ht&&d&&au(s),s.flags|=1,tn(r,s,l,m),s.child)}function Qf(r,s,l,d,m){if(dn(l)){var y=!0;hl(s)}else y=!1;if(Fs(s,m),s.stateNode===null)El(r,s),Df(s,l,d),Ru(s,l,d,m),d=!0;else if(r===null){var _=s.stateNode,P=s.memoizedProps;_.props=P;var R=_.context,W=l.contextType;typeof W=="object"&&W!==null?W=In(W):(W=dn(l)?zi:Ht.current,W=Es(s,W));var ne=l.getDerivedStateFromProps,re=typeof ne=="function"||typeof _.getSnapshotBeforeUpdate=="function";re||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(P!==d||R!==W)&&Of(s,_,d,W),ti=!1;var J=s.memoizedState;_.state=J,wl(s,d,_,m),R=s.memoizedState,P!==d||J!==R||un.current||ti?(typeof ne=="function"&&(Eu(s,l,ne,d),R=s.memoizedState),(P=ti||Bf(s,l,P,d,J,R,W))?(re||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(s.flags|=4194308)):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=d,s.memoizedState=R),_.props=d,_.state=R,_.context=W,d=P):(typeof _.componentDidMount=="function"&&(s.flags|=4194308),d=!1)}else{_=s.stateNode,ff(r,s),P=s.memoizedProps,W=s.type===s.elementType?P:Vn(s.type,P),_.props=W,re=s.pendingProps,J=_.context,R=l.contextType,typeof R=="object"&&R!==null?R=In(R):(R=dn(l)?zi:Ht.current,R=Es(s,R));var ce=l.getDerivedStateFromProps;(ne=typeof ce=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(P!==re||J!==R)&&Of(s,_,d,R),ti=!1,J=s.memoizedState,_.state=J,wl(s,d,_,m);var fe=s.memoizedState;P!==re||J!==fe||un.current||ti?(typeof ce=="function"&&(Eu(s,l,ce,d),fe=s.memoizedState),(W=ti||Bf(s,l,W,d,J,fe,R)||!1)?(ne||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(d,fe,R),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(d,fe,R)),typeof _.componentDidUpdate=="function"&&(s.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof _.componentDidUpdate!="function"||P===r.memoizedProps&&J===r.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||P===r.memoizedProps&&J===r.memoizedState||(s.flags|=1024),s.memoizedProps=d,s.memoizedState=fe),_.props=d,_.state=fe,_.context=R,d=W):(typeof _.componentDidUpdate!="function"||P===r.memoizedProps&&J===r.memoizedState||(s.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||P===r.memoizedProps&&J===r.memoizedState||(s.flags|=1024),d=!1)}return zu(r,s,l,d,y,m)}function zu(r,s,l,d,m,y){Kf(r,s);var _=(s.flags&128)!==0;if(!d&&!_)return m&&tf(s,l,!1),Rr(r,s,y);d=s.stateNode,bg.current=s;var P=_&&typeof l.getDerivedStateFromError!="function"?null:d.render();return s.flags|=1,r!==null&&_?(s.child=Ls(s,r.child,null,y),s.child=Ls(s,null,P,y)):tn(r,s,P,y),s.memoizedState=d.state,m&&tf(s,l,!0),s.child}function Zf(r){var s=r.stateNode;s.pendingContext?Jh(r,s.pendingContext,s.pendingContext!==s.context):s.context&&Jh(r,s.context,!1),xu(r,s.containerInfo)}function Jf(r,s,l,d,m){return $s(),du(m),s.flags|=256,tn(r,s,l,d),s.child}var Fu={dehydrated:null,treeContext:null,retryLane:0};function ju(r){return{baseLanes:r,cachePool:null,transitions:null}}function e1(r,s,l){var d=s.pendingProps,m=mt.current,y=!1,_=(s.flags&128)!==0,P;if((P=_)||(P=r!==null&&r.memoizedState===null?!1:(m&2)!==0),P?(y=!0,s.flags&=-129):(r===null||r.memoizedState!==null)&&(m|=1),nt(mt,m&1),r===null)return uu(s),r=s.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((s.mode&1)===0?s.lanes=1:r.data==="$!"?s.lanes=8:s.lanes=1073741824,null):(_=d.children,r=d.fallback,y?(d=s.mode,y=s.child,_={mode:"hidden",children:_},(d&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=_):y=Wl(_,d,0,null),r=Gi(r,d,l,null),y.return=s,r.return=s,y.sibling=r,s.child=y,s.child.memoizedState=ju(l),s.memoizedState=Fu,r):Bu(s,_));if(m=r.memoizedState,m!==null&&(P=m.dehydrated,P!==null))return Sg(r,s,_,d,P,m,l);if(y){y=d.fallback,_=s.mode,m=r.child,P=m.sibling;var R={mode:"hidden",children:d.children};return(_&1)===0&&s.child!==m?(d=s.child,d.childLanes=0,d.pendingProps=R,s.deletions=null):(d=li(m,R),d.subtreeFlags=m.subtreeFlags&14680064),P!==null?y=li(P,y):(y=Gi(y,_,l,null),y.flags|=2),y.return=s,d.return=s,d.sibling=y,s.child=d,d=y,y=s.child,_=r.child.memoizedState,_=_===null?ju(l):{baseLanes:_.baseLanes|l,cachePool:null,transitions:_.transitions},y.memoizedState=_,y.childLanes=r.childLanes&~l,s.memoizedState=Fu,d}return y=r.child,r=y.sibling,d=li(y,{mode:"visible",children:d.children}),(s.mode&1)===0&&(d.lanes=l),d.return=s,d.sibling=null,r!==null&&(l=s.deletions,l===null?(s.deletions=[r],s.flags|=16):l.push(r)),s.child=d,s.memoizedState=null,d}function Bu(r,s){return s=Wl({mode:"visible",children:s},r.mode,0,null),s.return=r,r.child=s}function Pl(r,s,l,d){return d!==null&&du(d),Ls(s,r.child,null,l),r=Bu(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function Sg(r,s,l,d,m,y,_){if(l)return s.flags&256?(s.flags&=-257,d=Iu(Error(t(422))),Pl(r,s,_,d)):s.memoizedState!==null?(s.child=r.child,s.flags|=128,null):(y=d.fallback,m=s.mode,d=Wl({mode:"visible",children:d.children},m,0,null),y=Gi(y,m,_,null),y.flags|=2,d.return=s,y.return=s,d.sibling=y,s.child=d,(s.mode&1)!==0&&Ls(s,r.child,null,_),s.child.memoizedState=ju(_),s.memoizedState=Fu,y);if((s.mode&1)===0)return Pl(r,s,_,null);if(m.data==="$!"){if(d=m.nextSibling&&m.nextSibling.dataset,d)var P=d.dgst;return d=P,y=Error(t(419)),d=Iu(y,d,void 0),Pl(r,s,_,d)}if(P=(_&r.childLanes)!==0,hn||P){if(d=Lt,d!==null){switch(_&-_){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(d.suspendedLanes|_))!==0?0:m,m!==0&&m!==y.retryLane&&(y.retryLane=m,Pr(r,m),qn(d,r,m,-1))}return ed(),d=Iu(Error(t(421))),Pl(r,s,_,d)}return m.data==="$?"?(s.flags|=128,s.child=r.child,s=Fg.bind(null,r),m._reactRetry=s,null):(r=y.treeContext,bn=Qr(m.nextSibling),wn=s,ht=!0,Gn=null,r!==null&&(En[Rn++]=Tr,En[Rn++]=Mr,En[Rn++]=Fi,Tr=r.id,Mr=r.overflow,Fi=s),s=Bu(s,d.children),s.flags|=4096,s)}function t1(r,s,l){r.lanes|=s;var d=r.alternate;d!==null&&(d.lanes|=s),mu(r.return,s,l)}function Du(r,s,l,d,m){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:m}:(y.isBackwards=s,y.rendering=null,y.renderingStartTime=0,y.last=d,y.tail=l,y.tailMode=m)}function n1(r,s,l){var d=s.pendingProps,m=d.revealOrder,y=d.tail;if(tn(r,s,d.children,l),d=mt.current,(d&2)!==0)d=d&1|2,s.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&t1(r,l,s);else if(r.tag===19)t1(r,l,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}d&=1}if(nt(mt,d),(s.mode&1)===0)s.memoizedState=null;else switch(m){case"forwards":for(l=s.child,m=null;l!==null;)r=l.alternate,r!==null&&bl(r)===null&&(m=l),l=l.sibling;l=m,l===null?(m=s.child,s.child=null):(m=l.sibling,l.sibling=null),Du(s,!1,m,l,y);break;case"backwards":for(l=null,m=s.child,s.child=null;m!==null;){if(r=m.alternate,r!==null&&bl(r)===null){s.child=m;break}r=m.sibling,m.sibling=l,l=m,m=r}Du(s,!0,l,null,y);break;case"together":Du(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function El(r,s){(s.mode&1)===0&&r!==null&&(r.alternate=null,s.alternate=null,s.flags|=2)}function Rr(r,s,l){if(r!==null&&(s.dependencies=r.dependencies),Ni|=s.lanes,(l&s.childLanes)===0)return null;if(r!==null&&s.child!==r.child)throw Error(t(153));if(s.child!==null){for(r=s.child,l=li(r,r.pendingProps),s.child=l,l.return=s;r.sibling!==null;)r=r.sibling,l=l.sibling=li(r,r.pendingProps),l.return=s;l.sibling=null}return s.child}function kg(r,s,l){switch(s.tag){case 3:Zf(s),$s();break;case 5:gf(s);break;case 1:dn(s.type)&&hl(s);break;case 4:xu(s,s.stateNode.containerInfo);break;case 10:var d=s.type._context,m=s.memoizedProps.value;nt(xl,d._currentValue),d._currentValue=m;break;case 13:if(d=s.memoizedState,d!==null)return d.dehydrated!==null?(nt(mt,mt.current&1),s.flags|=128,null):(l&s.child.childLanes)!==0?e1(r,s,l):(nt(mt,mt.current&1),r=Rr(r,s,l),r!==null?r.sibling:null);nt(mt,mt.current&1);break;case 19:if(d=(l&s.childLanes)!==0,(r.flags&128)!==0){if(d)return n1(r,s,l);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),nt(mt,mt.current),d)break;return null;case 22:case 23:return s.lanes=0,qf(r,s,l)}return Rr(r,s,l)}var r1,Ou,i1,s1;r1=function(r,s){for(var l=s.child;l!==null;){if(l.tag===5||l.tag===6)r.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},Ou=function(){},i1=function(r,s,l,d){var m=r.memoizedProps;if(m!==d){r=s.stateNode,Di(fr.current);var y=null;switch(l){case"input":m=on(r,m),d=on(r,d),y=[];break;case"select":m=ie({},m,{value:void 0}),d=ie({},d,{value:void 0}),y=[];break;case"textarea":m=Hr(r,m),d=Hr(r,d),y=[];break;default:typeof m.onClick!="function"&&typeof d.onClick=="function"&&(r.onclick=cl)}Gr(l,d);var _;l=null;for(W in m)if(!d.hasOwnProperty(W)&&m.hasOwnProperty(W)&&m[W]!=null)if(W==="style"){var P=m[W];for(_ in P)P.hasOwnProperty(_)&&(l||(l={}),l[_]="")}else W!=="dangerouslySetInnerHTML"&&W!=="children"&&W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(o.hasOwnProperty(W)?y||(y=[]):(y=y||[]).push(W,null));for(W in d){var R=d[W];if(P=m!=null?m[W]:void 0,d.hasOwnProperty(W)&&R!==P&&(R!=null||P!=null))if(W==="style")if(P){for(_ in P)!P.hasOwnProperty(_)||R&&R.hasOwnProperty(_)||(l||(l={}),l[_]="");for(_ in R)R.hasOwnProperty(_)&&P[_]!==R[_]&&(l||(l={}),l[_]=R[_])}else l||(y||(y=[]),y.push(W,l)),l=R;else W==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,P=P?P.__html:void 0,R!=null&&P!==R&&(y=y||[]).push(W,R)):W==="children"?typeof R!="string"&&typeof R!="number"||(y=y||[]).push(W,""+R):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&(o.hasOwnProperty(W)?(R!=null&&W==="onScroll"&&st("scroll",r),y||P===R||(y=[])):(y=y||[]).push(W,R))}l&&(y=y||[]).push("style",l);var W=y;(s.updateQueue=W)&&(s.flags|=4)}},s1=function(r,s,l,d){l!==d&&(s.flags|=4)};function Jo(r,s){if(!ht)switch(r.tailMode){case"hidden":s=r.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function Gt(r){var s=r.alternate!==null&&r.alternate.child===r.child,l=0,d=0;if(s)for(var m=r.child;m!==null;)l|=m.lanes|m.childLanes,d|=m.subtreeFlags&14680064,d|=m.flags&14680064,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)l|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=d,r.childLanes=l,s}function Cg(r,s,l){var d=s.pendingProps;switch(lu(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gt(s),null;case 1:return dn(s.type)&&dl(),Gt(s),null;case 3:return d=s.stateNode,js(),ot(un),ot(Ht),wu(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(r===null||r.child===null)&&(gl(s)?s.flags|=4:r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Gn!==null&&(Qu(Gn),Gn=null))),Ou(r,s),Gt(s),null;case 5:vu(s);var m=Di(Xo.current);if(l=s.type,r!==null&&s.stateNode!=null)i1(r,s,l,d,m),r.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!d){if(s.stateNode===null)throw Error(t(166));return Gt(s),null}if(r=Di(fr.current),gl(s)){d=s.stateNode,l=s.type;var y=s.memoizedProps;switch(d[hr]=s,d[Ho]=y,r=(s.mode&1)!==0,l){case"dialog":st("cancel",d),st("close",d);break;case"iframe":case"object":case"embed":st("load",d);break;case"video":case"audio":for(m=0;m<Oo.length;m++)st(Oo[m],d);break;case"source":st("error",d);break;case"img":case"image":case"link":st("error",d),st("load",d);break;case"details":st("toggle",d);break;case"input":an(d,y),st("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!y.multiple},st("invalid",d);break;case"textarea":ao(d,y),st("invalid",d)}Gr(l,y),m=null;for(var _ in y)if(y.hasOwnProperty(_)){var P=y[_];_==="children"?typeof P=="string"?d.textContent!==P&&(y.suppressHydrationWarning!==!0&&ll(d.textContent,P,r),m=["children",P]):typeof P=="number"&&d.textContent!==""+P&&(y.suppressHydrationWarning!==!0&&ll(d.textContent,P,r),m=["children",""+P]):o.hasOwnProperty(_)&&P!=null&&_==="onScroll"&&st("scroll",d)}switch(l){case"input":Mn(d),ts(d,y,!0);break;case"textarea":Mn(d),_r(d);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(d.onclick=cl)}d=m,s.updateQueue=d,d!==null&&(s.flags|=4)}else{_=m.nodeType===9?m:m.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Na(l)),r==="http://www.w3.org/1999/xhtml"?l==="script"?(r=_.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof d.is=="string"?r=_.createElement(l,{is:d.is}):(r=_.createElement(l),l==="select"&&(_=r,d.multiple?_.multiple=!0:d.size&&(_.size=d.size))):r=_.createElementNS(r,l),r[hr]=s,r[Ho]=d,r1(r,s,!1,!1),s.stateNode=r;e:{switch(_=ss(l,d),l){case"dialog":st("cancel",r),st("close",r),m=d;break;case"iframe":case"object":case"embed":st("load",r),m=d;break;case"video":case"audio":for(m=0;m<Oo.length;m++)st(Oo[m],r);m=d;break;case"source":st("error",r),m=d;break;case"img":case"image":case"link":st("error",r),st("load",r),m=d;break;case"details":st("toggle",r),m=d;break;case"input":an(r,d),m=on(r,d),st("invalid",r);break;case"option":m=d;break;case"select":r._wrapperState={wasMultiple:!!d.multiple},m=ie({},d,{value:void 0}),st("invalid",r);break;case"textarea":ao(r,d),m=Hr(r,d),st("invalid",r);break;default:m=d}Gr(l,m),P=m;for(y in P)if(P.hasOwnProperty(y)){var R=P[y];y==="style"?is(r,R):y==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&rs(r,R)):y==="children"?typeof R=="string"?(l!=="textarea"||R!=="")&&xi(r,R):typeof R=="number"&&xi(r,""+R):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(o.hasOwnProperty(y)?R!=null&&y==="onScroll"&&st("scroll",r):R!=null&&M(r,y,R,_))}switch(l){case"input":Mn(r),ts(r,d,!1);break;case"textarea":Mn(r),_r(r);break;case"option":d.value!=null&&r.setAttribute("value",""+Le(d.value));break;case"select":r.multiple=!!d.multiple,y=d.value,y!=null?Wr(r,!!d.multiple,y,!1):d.defaultValue!=null&&Wr(r,!!d.multiple,d.defaultValue,!0);break;default:typeof m.onClick=="function"&&(r.onclick=cl)}switch(l){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Gt(s),null;case 6:if(r&&s.stateNode!=null)s1(r,s,r.memoizedProps,d);else{if(typeof d!="string"&&s.stateNode===null)throw Error(t(166));if(l=Di(Xo.current),Di(fr.current),gl(s)){if(d=s.stateNode,l=s.memoizedProps,d[hr]=s,(y=d.nodeValue!==l)&&(r=wn,r!==null))switch(r.tag){case 3:ll(d.nodeValue,l,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&ll(d.nodeValue,l,(r.mode&1)!==0)}y&&(s.flags|=4)}else d=(l.nodeType===9?l:l.ownerDocument).createTextNode(d),d[hr]=s,s.stateNode=d}return Gt(s),null;case 13:if(ot(mt),d=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(ht&&bn!==null&&(s.mode&1)!==0&&(s.flags&128)===0)lf(),$s(),s.flags|=98560,y=!1;else if(y=gl(s),d!==null&&d.dehydrated!==null){if(r===null){if(!y)throw Error(t(318));if(y=s.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[hr]=s}else $s(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Gt(s),y=!1}else Gn!==null&&(Qu(Gn),Gn=null),y=!0;if(!y)return s.flags&65536?s:null}return(s.flags&128)!==0?(s.lanes=l,s):(d=d!==null,d!==(r!==null&&r.memoizedState!==null)&&d&&(s.child.flags|=8192,(s.mode&1)!==0&&(r===null||(mt.current&1)!==0?Pt===0&&(Pt=3):ed())),s.updateQueue!==null&&(s.flags|=4),Gt(s),null);case 4:return js(),Ou(r,s),r===null&&No(s.stateNode.containerInfo),Gt(s),null;case 10:return pu(s.type._context),Gt(s),null;case 17:return dn(s.type)&&dl(),Gt(s),null;case 19:if(ot(mt),y=s.memoizedState,y===null)return Gt(s),null;if(d=(s.flags&128)!==0,_=y.rendering,_===null)if(d)Jo(y,!1);else{if(Pt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(_=bl(r),_!==null){for(s.flags|=128,Jo(y,!1),d=_.updateQueue,d!==null&&(s.updateQueue=d,s.flags|=4),s.subtreeFlags=0,d=l,l=s.child;l!==null;)y=l,r=d,y.flags&=14680066,_=y.alternate,_===null?(y.childLanes=0,y.lanes=r,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=_.childLanes,y.lanes=_.lanes,y.child=_.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=_.memoizedProps,y.memoizedState=_.memoizedState,y.updateQueue=_.updateQueue,y.type=_.type,r=_.dependencies,y.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),l=l.sibling;return nt(mt,mt.current&1|2),s.child}r=r.sibling}y.tail!==null&&xt()>Ns&&(s.flags|=128,d=!0,Jo(y,!1),s.lanes=4194304)}else{if(!d)if(r=bl(_),r!==null){if(s.flags|=128,d=!0,l=r.updateQueue,l!==null&&(s.updateQueue=l,s.flags|=4),Jo(y,!0),y.tail===null&&y.tailMode==="hidden"&&!_.alternate&&!ht)return Gt(s),null}else 2*xt()-y.renderingStartTime>Ns&&l!==1073741824&&(s.flags|=128,d=!0,Jo(y,!1),s.lanes=4194304);y.isBackwards?(_.sibling=s.child,s.child=_):(l=y.last,l!==null?l.sibling=_:s.child=_,y.last=_)}return y.tail!==null?(s=y.tail,y.rendering=s,y.tail=s.sibling,y.renderingStartTime=xt(),s.sibling=null,l=mt.current,nt(mt,d?l&1|2:l&1),s):(Gt(s),null);case 22:case 23:return Ju(),d=s.memoizedState!==null,r!==null&&r.memoizedState!==null!==d&&(s.flags|=8192),d&&(s.mode&1)!==0?(Sn&1073741824)!==0&&(Gt(s),s.subtreeFlags&6&&(s.flags|=8192)):Gt(s),null;case 24:return null;case 25:return null}throw Error(t(156,s.tag))}function Ag(r,s){switch(lu(s),s.tag){case 1:return dn(s.type)&&dl(),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return js(),ot(un),ot(Ht),wu(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 5:return vu(s),null;case 13:if(ot(mt),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(t(340));$s()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return ot(mt),null;case 4:return js(),null;case 10:return pu(s.type._context),null;case 22:case 23:return Ju(),null;case 24:return null;default:return null}}var Rl=!1,Vt=!1,Tg=typeof WeakSet=="function"?WeakSet:Set,he=null;function Ds(r,s){var l=r.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(d){vt(r,s,d)}else l.current=null}function Nu(r,s,l){try{l()}catch(d){vt(r,s,d)}}var o1=!1;function Mg(r,s){if(Jc=ys,r=jh(),Gc(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var m=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var _=0,P=-1,R=-1,W=0,ne=0,re=r,J=null;t:for(;;){for(var ce;re!==l||m!==0&&re.nodeType!==3||(P=_+m),re!==y||d!==0&&re.nodeType!==3||(R=_+d),re.nodeType===3&&(_+=re.nodeValue.length),(ce=re.firstChild)!==null;)J=re,re=ce;for(;;){if(re===r)break t;if(J===l&&++W===m&&(P=_),J===y&&++ne===d&&(R=_),(ce=re.nextSibling)!==null)break;re=J,J=re.parentNode}re=ce}l=P===-1||R===-1?null:{start:P,end:R}}else l=null}l=l||{start:0,end:0}}else l=null;for(eu={focusedElem:r,selectionRange:l},ys=!1,he=s;he!==null;)if(s=he,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,he=r;else for(;he!==null;){s=he;try{var fe=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(fe!==null){var me=fe.memoizedProps,bt=fe.memoizedState,j=s.stateNode,$=j.getSnapshotBeforeUpdate(s.elementType===s.type?me:Vn(s.type,me),bt);j.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var O=s.stateNode.containerInfo;O.nodeType===1?O.textContent="":O.nodeType===9&&O.documentElement&&O.removeChild(O.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(oe){vt(s,s.return,oe)}if(r=s.sibling,r!==null){r.return=s.return,he=r;break}he=s.return}return fe=o1,o1=!1,fe}function ea(r,s,l){var d=s.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var m=d=d.next;do{if((m.tag&r)===r){var y=m.destroy;m.destroy=void 0,y!==void 0&&Nu(s,l,y)}m=m.next}while(m!==d)}}function Il(r,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&r)===r){var d=l.create;l.destroy=d()}l=l.next}while(l!==s)}}function Wu(r){var s=r.ref;if(s!==null){var l=r.stateNode;switch(r.tag){case 5:r=l;break;default:r=l}typeof s=="function"?s(r):s.current=r}}function a1(r){var s=r.alternate;s!==null&&(r.alternate=null,a1(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&(delete s[hr],delete s[Ho],delete s[iu],delete s[ug],delete s[dg])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function l1(r){return r.tag===5||r.tag===3||r.tag===4}function c1(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||l1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Hu(r,s,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,s?l.nodeType===8?l.parentNode.insertBefore(r,s):l.insertBefore(r,s):(l.nodeType===8?(s=l.parentNode,s.insertBefore(r,l)):(s=l,s.appendChild(r)),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=cl));else if(d!==4&&(r=r.child,r!==null))for(Hu(r,s,l),r=r.sibling;r!==null;)Hu(r,s,l),r=r.sibling}function Uu(r,s,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,s?l.insertBefore(r,s):l.appendChild(r);else if(d!==4&&(r=r.child,r!==null))for(Uu(r,s,l),r=r.sibling;r!==null;)Uu(r,s,l),r=r.sibling}var Dt=null,Yn=!1;function ri(r,s,l){for(l=l.child;l!==null;)u1(r,s,l),l=l.sibling}function u1(r,s,l){if(ut&&typeof ut.onCommitFiberUnmount=="function")try{ut.onCommitFiberUnmount(or,l)}catch{}switch(l.tag){case 5:Vt||Ds(l,s);case 6:var d=Dt,m=Yn;Dt=null,ri(r,s,l),Dt=d,Yn=m,Dt!==null&&(Yn?(r=Dt,l=l.stateNode,r.nodeType===8?r.parentNode.removeChild(l):r.removeChild(l)):Dt.removeChild(l.stateNode));break;case 18:Dt!==null&&(Yn?(r=Dt,l=l.stateNode,r.nodeType===8?ru(r.parentNode,l):r.nodeType===1&&ru(r,l),Mi(r)):ru(Dt,l.stateNode));break;case 4:d=Dt,m=Yn,Dt=l.stateNode.containerInfo,Yn=!0,ri(r,s,l),Dt=d,Yn=m;break;case 0:case 11:case 14:case 15:if(!Vt&&(d=l.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){m=d=d.next;do{var y=m,_=y.destroy;y=y.tag,_!==void 0&&((y&2)!==0||(y&4)!==0)&&Nu(l,s,_),m=m.next}while(m!==d)}ri(r,s,l);break;case 1:if(!Vt&&(Ds(l,s),d=l.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=l.memoizedProps,d.state=l.memoizedState,d.componentWillUnmount()}catch(P){vt(l,s,P)}ri(r,s,l);break;case 21:ri(r,s,l);break;case 22:l.mode&1?(Vt=(d=Vt)||l.memoizedState!==null,ri(r,s,l),Vt=d):ri(r,s,l);break;default:ri(r,s,l)}}function d1(r){var s=r.updateQueue;if(s!==null){r.updateQueue=null;var l=r.stateNode;l===null&&(l=r.stateNode=new Tg),s.forEach(function(d){var m=jg.bind(null,r,d);l.has(d)||(l.add(d),d.then(m,m))})}}function Xn(r,s){var l=s.deletions;if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];try{var y=r,_=s,P=_;e:for(;P!==null;){switch(P.tag){case 5:Dt=P.stateNode,Yn=!1;break e;case 3:Dt=P.stateNode.containerInfo,Yn=!0;break e;case 4:Dt=P.stateNode.containerInfo,Yn=!0;break e}P=P.return}if(Dt===null)throw Error(t(160));u1(y,_,m),Dt=null,Yn=!1;var R=m.alternate;R!==null&&(R.return=null),m.return=null}catch(W){vt(m,s,W)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)h1(s,r),s=s.sibling}function h1(r,s){var l=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Xn(s,r),mr(r),d&4){try{ea(3,r,r.return),Il(3,r)}catch(me){vt(r,r.return,me)}try{ea(5,r,r.return)}catch(me){vt(r,r.return,me)}}break;case 1:Xn(s,r),mr(r),d&512&&l!==null&&Ds(l,l.return);break;case 5:if(Xn(s,r),mr(r),d&512&&l!==null&&Ds(l,l.return),r.flags&32){var m=r.stateNode;try{xi(m,"")}catch(me){vt(r,r.return,me)}}if(d&4&&(m=r.stateNode,m!=null)){var y=r.memoizedProps,_=l!==null?l.memoizedProps:y,P=r.type,R=r.updateQueue;if(r.updateQueue=null,R!==null)try{P==="input"&&y.type==="radio"&&y.name!=null&&rr(m,y),ss(P,_);var W=ss(P,y);for(_=0;_<R.length;_+=2){var ne=R[_],re=R[_+1];ne==="style"?is(m,re):ne==="dangerouslySetInnerHTML"?rs(m,re):ne==="children"?xi(m,re):M(m,ne,re,W)}switch(P){case"input":Nr(m,y);break;case"textarea":Oa(m,y);break;case"select":var J=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!y.multiple;var ce=y.value;ce!=null?Wr(m,!!y.multiple,ce,!1):J!==!!y.multiple&&(y.defaultValue!=null?Wr(m,!!y.multiple,y.defaultValue,!0):Wr(m,!!y.multiple,y.multiple?[]:"",!1))}m[Ho]=y}catch(me){vt(r,r.return,me)}}break;case 6:if(Xn(s,r),mr(r),d&4){if(r.stateNode===null)throw Error(t(162));m=r.stateNode,y=r.memoizedProps;try{m.nodeValue=y}catch(me){vt(r,r.return,me)}}break;case 3:if(Xn(s,r),mr(r),d&4&&l!==null&&l.memoizedState.isDehydrated)try{Mi(s.containerInfo)}catch(me){vt(r,r.return,me)}break;case 4:Xn(s,r),mr(r);break;case 13:Xn(s,r),mr(r),m=r.child,m.flags&8192&&(y=m.memoizedState!==null,m.stateNode.isHidden=y,!y||m.alternate!==null&&m.alternate.memoizedState!==null||(Yu=xt())),d&4&&d1(r);break;case 22:if(ne=l!==null&&l.memoizedState!==null,r.mode&1?(Vt=(W=Vt)||ne,Xn(s,r),Vt=W):Xn(s,r),mr(r),d&8192){if(W=r.memoizedState!==null,(r.stateNode.isHidden=W)&&!ne&&(r.mode&1)!==0)for(he=r,ne=r.child;ne!==null;){for(re=he=ne;he!==null;){switch(J=he,ce=J.child,J.tag){case 0:case 11:case 14:case 15:ea(4,J,J.return);break;case 1:Ds(J,J.return);var fe=J.stateNode;if(typeof fe.componentWillUnmount=="function"){d=J,l=J.return;try{s=d,fe.props=s.memoizedProps,fe.state=s.memoizedState,fe.componentWillUnmount()}catch(me){vt(d,l,me)}}break;case 5:Ds(J,J.return);break;case 22:if(J.memoizedState!==null){m1(re);continue}}ce!==null?(ce.return=J,he=ce):m1(re)}ne=ne.sibling}e:for(ne=null,re=r;;){if(re.tag===5){if(ne===null){ne=re;try{m=re.stateNode,W?(y=m.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(P=re.stateNode,R=re.memoizedProps.style,_=R!=null&&R.hasOwnProperty("display")?R.display:null,P.style.display=Pn("display",_))}catch(me){vt(r,r.return,me)}}}else if(re.tag===6){if(ne===null)try{re.stateNode.nodeValue=W?"":re.memoizedProps}catch(me){vt(r,r.return,me)}}else if((re.tag!==22&&re.tag!==23||re.memoizedState===null||re===r)&&re.child!==null){re.child.return=re,re=re.child;continue}if(re===r)break e;for(;re.sibling===null;){if(re.return===null||re.return===r)break e;ne===re&&(ne=null),re=re.return}ne===re&&(ne=null),re.sibling.return=re.return,re=re.sibling}}break;case 19:Xn(s,r),mr(r),d&4&&d1(r);break;case 21:break;default:Xn(s,r),mr(r)}}function mr(r){var s=r.flags;if(s&2){try{e:{for(var l=r.return;l!==null;){if(l1(l)){var d=l;break e}l=l.return}throw Error(t(160))}switch(d.tag){case 5:var m=d.stateNode;d.flags&32&&(xi(m,""),d.flags&=-33);var y=c1(r);Uu(r,y,m);break;case 3:case 4:var _=d.stateNode.containerInfo,P=c1(r);Hu(r,P,_);break;default:throw Error(t(161))}}catch(R){vt(r,r.return,R)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function Pg(r,s,l){he=r,f1(r)}function f1(r,s,l){for(var d=(r.mode&1)!==0;he!==null;){var m=he,y=m.child;if(m.tag===22&&d){var _=m.memoizedState!==null||Rl;if(!_){var P=m.alternate,R=P!==null&&P.memoizedState!==null||Vt;P=Rl;var W=Vt;if(Rl=_,(Vt=R)&&!W)for(he=m;he!==null;)_=he,R=_.child,_.tag===22&&_.memoizedState!==null?g1(m):R!==null?(R.return=_,he=R):g1(m);for(;y!==null;)he=y,f1(y),y=y.sibling;he=m,Rl=P,Vt=W}p1(r)}else(m.subtreeFlags&8772)!==0&&y!==null?(y.return=m,he=y):p1(r)}}function p1(r){for(;he!==null;){var s=he;if((s.flags&8772)!==0){var l=s.alternate;try{if((s.flags&8772)!==0)switch(s.tag){case 0:case 11:case 15:Vt||Il(5,s);break;case 1:var d=s.stateNode;if(s.flags&4&&!Vt)if(l===null)d.componentDidMount();else{var m=s.elementType===s.type?l.memoizedProps:Vn(s.type,l.memoizedProps);d.componentDidUpdate(m,l.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var y=s.updateQueue;y!==null&&mf(s,y,d);break;case 3:var _=s.updateQueue;if(_!==null){if(l=null,s.child!==null)switch(s.child.tag){case 5:l=s.child.stateNode;break;case 1:l=s.child.stateNode}mf(s,_,l)}break;case 5:var P=s.stateNode;if(l===null&&s.flags&4){l=P;var R=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&l.focus();break;case"img":R.src&&(l.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var W=s.alternate;if(W!==null){var ne=W.memoizedState;if(ne!==null){var re=ne.dehydrated;re!==null&&Mi(re)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Vt||s.flags&512&&Wu(s)}catch(J){vt(s,s.return,J)}}if(s===r){he=null;break}if(l=s.sibling,l!==null){l.return=s.return,he=l;break}he=s.return}}function m1(r){for(;he!==null;){var s=he;if(s===r){he=null;break}var l=s.sibling;if(l!==null){l.return=s.return,he=l;break}he=s.return}}function g1(r){for(;he!==null;){var s=he;try{switch(s.tag){case 0:case 11:case 15:var l=s.return;try{Il(4,s)}catch(R){vt(s,l,R)}break;case 1:var d=s.stateNode;if(typeof d.componentDidMount=="function"){var m=s.return;try{d.componentDidMount()}catch(R){vt(s,m,R)}}var y=s.return;try{Wu(s)}catch(R){vt(s,y,R)}break;case 5:var _=s.return;try{Wu(s)}catch(R){vt(s,_,R)}}}catch(R){vt(s,s.return,R)}if(s===r){he=null;break}var P=s.sibling;if(P!==null){P.return=s.return,he=P;break}he=s.return}}var Eg=Math.ceil,$l=E.ReactCurrentDispatcher,Gu=E.ReactCurrentOwner,Ln=E.ReactCurrentBatchConfig,He=0,Lt=null,Ct=null,Ot=0,Sn=0,Os=Zr(0),Pt=0,ta=null,Ni=0,Ll=0,Vu=0,na=null,fn=null,Yu=0,Ns=1/0,Ir=null,zl=!1,Xu=null,ii=null,Fl=!1,si=null,jl=0,ra=0,qu=null,Bl=-1,Dl=0;function nn(){return(He&6)!==0?xt():Bl!==-1?Bl:Bl=xt()}function oi(r){return(r.mode&1)===0?1:(He&2)!==0&&Ot!==0?Ot&-Ot:fg.transition!==null?(Dl===0&&(Dl=us()),Dl):(r=Xe,r!==0||(r=window.event,r=r===void 0?16:el(r.type)),r)}function qn(r,s,l,d){if(50<ra)throw ra=0,qu=null,Error(t(185));ue(r,l,d),((He&2)===0||r!==Lt)&&(r===Lt&&((He&2)===0&&(Ll|=l),Pt===4&&ai(r,Ot)),pn(r,d),l===1&&He===0&&(s.mode&1)===0&&(Ns=xt()+500,fl&&ei()))}function pn(r,s){var l=r.callbackNode;So(r,s);var d=cs(r,r===Lt?Ot:0);if(d===0)l!==null&&Ya(l),r.callbackNode=null,r.callbackPriority=0;else if(s=d&-d,r.callbackPriority!==s){if(l!=null&&Ya(l),s===1)r.tag===0?hg(x1.bind(null,r)):nf(x1.bind(null,r)),lg(function(){(He&6)===0&&ei()}),l=null;else{switch(Ka(d)){case 1:l=bi;break;case 4:l=vo;break;case 16:l=ls;break;case 536870912:l=_o;break;default:l=ls}l=A1(l,y1.bind(null,r))}r.callbackPriority=s,r.callbackNode=l}}function y1(r,s){if(Bl=-1,Dl=0,(He&6)!==0)throw Error(t(327));var l=r.callbackNode;if(Ws()&&r.callbackNode!==l)return null;var d=cs(r,r===Lt?Ot:0);if(d===0)return null;if((d&30)!==0||(d&r.expiredLanes)!==0||s)s=Ol(r,d);else{s=d;var m=He;He|=2;var y=_1();(Lt!==r||Ot!==s)&&(Ir=null,Ns=xt()+500,Hi(r,s));do try{$g();break}catch(P){v1(r,P)}while(!0);fu(),$l.current=y,He=m,Ct!==null?s=0:(Lt=null,Ot=0,s=Pt)}if(s!==0){if(s===2&&(m=ko(r),m!==0&&(d=m,s=Ku(r,m))),s===1)throw l=ta,Hi(r,0),ai(r,d),pn(r,xt()),l;if(s===6)ai(r,d);else{if(m=r.current.alternate,(d&30)===0&&!Rg(m)&&(s=Ol(r,d),s===2&&(y=ko(r),y!==0&&(d=y,s=Ku(r,y))),s===1))throw l=ta,Hi(r,0),ai(r,d),pn(r,xt()),l;switch(r.finishedWork=m,r.finishedLanes=d,s){case 0:case 1:throw Error(t(345));case 2:Ui(r,fn,Ir);break;case 3:if(ai(r,d),(d&130023424)===d&&(s=Yu+500-xt(),10<s)){if(cs(r,0)!==0)break;if(m=r.suspendedLanes,(m&d)!==d){nn(),r.pingedLanes|=r.suspendedLanes&m;break}r.timeoutHandle=nu(Ui.bind(null,r,fn,Ir),s);break}Ui(r,fn,Ir);break;case 4:if(ai(r,d),(d&4194240)===d)break;for(s=r.eventTimes,m=-1;0<d;){var _=31-Qt(d);y=1<<_,_=s[_],_>m&&(m=_),d&=~y}if(d=m,d=xt()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*Eg(d/1960))-d,10<d){r.timeoutHandle=nu(Ui.bind(null,r,fn,Ir),d);break}Ui(r,fn,Ir);break;case 5:Ui(r,fn,Ir);break;default:throw Error(t(329))}}}return pn(r,xt()),r.callbackNode===l?y1.bind(null,r):null}function Ku(r,s){var l=na;return r.current.memoizedState.isDehydrated&&(Hi(r,s).flags|=256),r=Ol(r,s),r!==2&&(s=fn,fn=l,s!==null&&Qu(s)),r}function Qu(r){fn===null?fn=r:fn.push.apply(fn,r)}function Rg(r){for(var s=r;;){if(s.flags&16384){var l=s.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var d=0;d<l.length;d++){var m=l[d],y=m.getSnapshot;m=m.value;try{if(!Un(y(),m))return!1}catch{return!1}}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ai(r,s){for(s&=~Vu,s&=~Ll,r.suspendedLanes|=s,r.pingedLanes&=~s,r=r.expirationTimes;0<s;){var l=31-Qt(s),d=1<<l;r[l]=-1,s&=~d}}function x1(r){if((He&6)!==0)throw Error(t(327));Ws();var s=cs(r,0);if((s&1)===0)return pn(r,xt()),null;var l=Ol(r,s);if(r.tag!==0&&l===2){var d=ko(r);d!==0&&(s=d,l=Ku(r,d))}if(l===1)throw l=ta,Hi(r,0),ai(r,s),pn(r,xt()),l;if(l===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=s,Ui(r,fn,Ir),pn(r,xt()),null}function Zu(r,s){var l=He;He|=1;try{return r(s)}finally{He=l,He===0&&(Ns=xt()+500,fl&&ei())}}function Wi(r){si!==null&&si.tag===0&&(He&6)===0&&Ws();var s=He;He|=1;var l=Ln.transition,d=Xe;try{if(Ln.transition=null,Xe=1,r)return r()}finally{Xe=d,Ln.transition=l,He=s,(He&6)===0&&ei()}}function Ju(){Sn=Os.current,ot(Os)}function Hi(r,s){r.finishedWork=null,r.finishedLanes=0;var l=r.timeoutHandle;if(l!==-1&&(r.timeoutHandle=-1,ag(l)),Ct!==null)for(l=Ct.return;l!==null;){var d=l;switch(lu(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&dl();break;case 3:js(),ot(un),ot(Ht),wu();break;case 5:vu(d);break;case 4:js();break;case 13:ot(mt);break;case 19:ot(mt);break;case 10:pu(d.type._context);break;case 22:case 23:Ju()}l=l.return}if(Lt=r,Ct=r=li(r.current,null),Ot=Sn=s,Pt=0,ta=null,Vu=Ll=Ni=0,fn=na=null,Bi!==null){for(s=0;s<Bi.length;s++)if(l=Bi[s],d=l.interleaved,d!==null){l.interleaved=null;var m=d.next,y=l.pending;if(y!==null){var _=y.next;y.next=m,d.next=_}l.pending=d}Bi=null}return r}function v1(r,s){do{var l=Ct;try{if(fu(),Sl.current=Tl,kl){for(var d=gt.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}kl=!1}if(Oi=0,$t=Mt=gt=null,qo=!1,Ko=0,Gu.current=null,l===null||l.return===null){Pt=1,ta=s,Ct=null;break}e:{var y=r,_=l.return,P=l,R=s;if(s=Ot,P.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var W=R,ne=P,re=ne.tag;if((ne.mode&1)===0&&(re===0||re===11||re===15)){var J=ne.alternate;J?(ne.updateQueue=J.updateQueue,ne.memoizedState=J.memoizedState,ne.lanes=J.lanes):(ne.updateQueue=null,ne.memoizedState=null)}var ce=Uf(_);if(ce!==null){ce.flags&=-257,Gf(ce,_,P,y,s),ce.mode&1&&Hf(y,W,s),s=ce,R=W;var fe=s.updateQueue;if(fe===null){var me=new Set;me.add(R),s.updateQueue=me}else fe.add(R);break e}else{if((s&1)===0){Hf(y,W,s),ed();break e}R=Error(t(426))}}else if(ht&&P.mode&1){var bt=Uf(_);if(bt!==null){(bt.flags&65536)===0&&(bt.flags|=256),Gf(bt,_,P,y,s),du(Bs(R,P));break e}}y=R=Bs(R,P),Pt!==4&&(Pt=2),na===null?na=[y]:na.push(y),y=_;do{switch(y.tag){case 3:y.flags|=65536,s&=-s,y.lanes|=s;var j=Nf(y,R,s);pf(y,j);break e;case 1:P=R;var $=y.type,O=y.stateNode;if((y.flags&128)===0&&(typeof $.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(ii===null||!ii.has(O)))){y.flags|=65536,s&=-s,y.lanes|=s;var oe=Wf(y,P,s);pf(y,oe);break e}}y=y.return}while(y!==null)}b1(l)}catch(ge){s=ge,Ct===l&&l!==null&&(Ct=l=l.return);continue}break}while(!0)}function _1(){var r=$l.current;return $l.current=Tl,r===null?Tl:r}function ed(){(Pt===0||Pt===3||Pt===2)&&(Pt=4),Lt===null||(Ni&268435455)===0&&(Ll&268435455)===0||ai(Lt,Ot)}function Ol(r,s){var l=He;He|=2;var d=_1();(Lt!==r||Ot!==s)&&(Ir=null,Hi(r,s));do try{Ig();break}catch(m){v1(r,m)}while(!0);if(fu(),He=l,$l.current=d,Ct!==null)throw Error(t(261));return Lt=null,Ot=0,Pt}function Ig(){for(;Ct!==null;)w1(Ct)}function $g(){for(;Ct!==null&&!$c();)w1(Ct)}function w1(r){var s=C1(r.alternate,r,Sn);r.memoizedProps=r.pendingProps,s===null?b1(r):Ct=s,Gu.current=null}function b1(r){var s=r;do{var l=s.alternate;if(r=s.return,(s.flags&32768)===0){if(l=Cg(l,s,Sn),l!==null){Ct=l;return}}else{if(l=Ag(l,s),l!==null){l.flags&=32767,Ct=l;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Pt=6,Ct=null;return}}if(s=s.sibling,s!==null){Ct=s;return}Ct=s=r}while(s!==null);Pt===0&&(Pt=5)}function Ui(r,s,l){var d=Xe,m=Ln.transition;try{Ln.transition=null,Xe=1,Lg(r,s,l,d)}finally{Ln.transition=m,Xe=d}return null}function Lg(r,s,l,d){do Ws();while(si!==null);if((He&6)!==0)throw Error(t(327));l=r.finishedWork;var m=r.finishedLanes;if(l===null)return null;if(r.finishedWork=null,r.finishedLanes=0,l===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var y=l.lanes|l.childLanes;if(qa(r,y),r===Lt&&(Ct=Lt=null,Ot=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||Fl||(Fl=!0,A1(ls,function(){return Ws(),null})),y=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||y){y=Ln.transition,Ln.transition=null;var _=Xe;Xe=1;var P=He;He|=4,Gu.current=null,Mg(r,l),h1(l,r),eg(eu),ys=!!Jc,eu=Jc=null,r.current=l,Pg(l),Lc(),He=P,Xe=_,Ln.transition=y}else r.current=l;if(Fl&&(Fl=!1,si=r,jl=m),y=r.pendingLanes,y===0&&(ii=null),zc(l.stateNode),pn(r,xt()),s!==null)for(d=r.onRecoverableError,l=0;l<s.length;l++)m=s[l],d(m.value,{componentStack:m.stack,digest:m.digest});if(zl)throw zl=!1,r=Xu,Xu=null,r;return(jl&1)!==0&&r.tag!==0&&Ws(),y=r.pendingLanes,(y&1)!==0?r===qu?ra++:(ra=0,qu=r):ra=0,ei(),null}function Ws(){if(si!==null){var r=Ka(jl),s=Ln.transition,l=Xe;try{if(Ln.transition=null,Xe=16>r?16:r,si===null)var d=!1;else{if(r=si,si=null,jl=0,(He&6)!==0)throw Error(t(331));var m=He;for(He|=4,he=r.current;he!==null;){var y=he,_=y.child;if((he.flags&16)!==0){var P=y.deletions;if(P!==null){for(var R=0;R<P.length;R++){var W=P[R];for(he=W;he!==null;){var ne=he;switch(ne.tag){case 0:case 11:case 15:ea(8,ne,y)}var re=ne.child;if(re!==null)re.return=ne,he=re;else for(;he!==null;){ne=he;var J=ne.sibling,ce=ne.return;if(a1(ne),ne===W){he=null;break}if(J!==null){J.return=ce,he=J;break}he=ce}}}var fe=y.alternate;if(fe!==null){var me=fe.child;if(me!==null){fe.child=null;do{var bt=me.sibling;me.sibling=null,me=bt}while(me!==null)}}he=y}}if((y.subtreeFlags&2064)!==0&&_!==null)_.return=y,he=_;else e:for(;he!==null;){if(y=he,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:ea(9,y,y.return)}var j=y.sibling;if(j!==null){j.return=y.return,he=j;break e}he=y.return}}var $=r.current;for(he=$;he!==null;){_=he;var O=_.child;if((_.subtreeFlags&2064)!==0&&O!==null)O.return=_,he=O;else e:for(_=$;he!==null;){if(P=he,(P.flags&2048)!==0)try{switch(P.tag){case 0:case 11:case 15:Il(9,P)}}catch(ge){vt(P,P.return,ge)}if(P===_){he=null;break e}var oe=P.sibling;if(oe!==null){oe.return=P.return,he=oe;break e}he=P.return}}if(He=m,ei(),ut&&typeof ut.onPostCommitFiberRoot=="function")try{ut.onPostCommitFiberRoot(or,r)}catch{}d=!0}return d}finally{Xe=l,Ln.transition=s}}return!1}function S1(r,s,l){s=Bs(l,s),s=Nf(r,s,1),r=ni(r,s,1),s=nn(),r!==null&&(ue(r,1,s),pn(r,s))}function vt(r,s,l){if(r.tag===3)S1(r,r,l);else for(;s!==null;){if(s.tag===3){S1(s,r,l);break}else if(s.tag===1){var d=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(ii===null||!ii.has(d))){r=Bs(l,r),r=Wf(s,r,1),s=ni(s,r,1),r=nn(),s!==null&&(ue(s,1,r),pn(s,r));break}}s=s.return}}function zg(r,s,l){var d=r.pingCache;d!==null&&d.delete(s),s=nn(),r.pingedLanes|=r.suspendedLanes&l,Lt===r&&(Ot&l)===l&&(Pt===4||Pt===3&&(Ot&130023424)===Ot&&500>xt()-Yu?Hi(r,0):Vu|=l),pn(r,s)}function k1(r,s){s===0&&((r.mode&1)===0?s=1:(s=Si,Si<<=1,(Si&130023424)===0&&(Si=4194304)));var l=nn();r=Pr(r,s),r!==null&&(ue(r,s,l),pn(r,l))}function Fg(r){var s=r.memoizedState,l=0;s!==null&&(l=s.retryLane),k1(r,l)}function jg(r,s){var l=0;switch(r.tag){case 13:var d=r.stateNode,m=r.memoizedState;m!==null&&(l=m.retryLane);break;case 19:d=r.stateNode;break;default:throw Error(t(314))}d!==null&&d.delete(s),k1(r,l)}var C1;C1=function(r,s,l){if(r!==null)if(r.memoizedProps!==s.pendingProps||un.current)hn=!0;else{if((r.lanes&l)===0&&(s.flags&128)===0)return hn=!1,kg(r,s,l);hn=(r.flags&131072)!==0}else hn=!1,ht&&(s.flags&1048576)!==0&&rf(s,ml,s.index);switch(s.lanes=0,s.tag){case 2:var d=s.type;El(r,s),r=s.pendingProps;var m=Es(s,Ht.current);Fs(s,l),m=ku(null,s,d,r,m,l);var y=Cu();return s.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,dn(d)?(y=!0,hl(s)):y=!1,s.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,yu(s),m.updater=Ml,s.stateNode=m,m._reactInternals=s,Ru(s,d,r,l),s=zu(null,s,d,!0,y,l)):(s.tag=0,ht&&y&&au(s),tn(null,s,m,l),s=s.child),s;case 16:d=s.elementType;e:{switch(El(r,s),r=s.pendingProps,m=d._init,d=m(d._payload),s.type=d,m=s.tag=Dg(d),r=Vn(d,r),m){case 0:s=Lu(null,s,d,r,l);break e;case 1:s=Qf(null,s,d,r,l);break e;case 11:s=Vf(null,s,d,r,l);break e;case 14:s=Yf(null,s,d,Vn(d.type,r),l);break e}throw Error(t(306,d,""))}return s;case 0:return d=s.type,m=s.pendingProps,m=s.elementType===d?m:Vn(d,m),Lu(r,s,d,m,l);case 1:return d=s.type,m=s.pendingProps,m=s.elementType===d?m:Vn(d,m),Qf(r,s,d,m,l);case 3:e:{if(Zf(s),r===null)throw Error(t(387));d=s.pendingProps,y=s.memoizedState,m=y.element,ff(r,s),wl(s,d,null,l);var _=s.memoizedState;if(d=_.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){m=Bs(Error(t(423)),s),s=Jf(r,s,d,l,m);break e}else if(d!==m){m=Bs(Error(t(424)),s),s=Jf(r,s,d,l,m);break e}else for(bn=Qr(s.stateNode.containerInfo.firstChild),wn=s,ht=!0,Gn=null,l=df(s,null,d,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if($s(),d===m){s=Rr(r,s,l);break e}tn(r,s,d,l)}s=s.child}return s;case 5:return gf(s),r===null&&uu(s),d=s.type,m=s.pendingProps,y=r!==null?r.memoizedProps:null,_=m.children,tu(d,m)?_=null:y!==null&&tu(d,y)&&(s.flags|=32),Kf(r,s),tn(r,s,_,l),s.child;case 6:return r===null&&uu(s),null;case 13:return e1(r,s,l);case 4:return xu(s,s.stateNode.containerInfo),d=s.pendingProps,r===null?s.child=Ls(s,null,d,l):tn(r,s,d,l),s.child;case 11:return d=s.type,m=s.pendingProps,m=s.elementType===d?m:Vn(d,m),Vf(r,s,d,m,l);case 7:return tn(r,s,s.pendingProps,l),s.child;case 8:return tn(r,s,s.pendingProps.children,l),s.child;case 12:return tn(r,s,s.pendingProps.children,l),s.child;case 10:e:{if(d=s.type._context,m=s.pendingProps,y=s.memoizedProps,_=m.value,nt(xl,d._currentValue),d._currentValue=_,y!==null)if(Un(y.value,_)){if(y.children===m.children&&!un.current){s=Rr(r,s,l);break e}}else for(y=s.child,y!==null&&(y.return=s);y!==null;){var P=y.dependencies;if(P!==null){_=y.child;for(var R=P.firstContext;R!==null;){if(R.context===d){if(y.tag===1){R=Er(-1,l&-l),R.tag=2;var W=y.updateQueue;if(W!==null){W=W.shared;var ne=W.pending;ne===null?R.next=R:(R.next=ne.next,ne.next=R),W.pending=R}}y.lanes|=l,R=y.alternate,R!==null&&(R.lanes|=l),mu(y.return,l,s),P.lanes|=l;break}R=R.next}}else if(y.tag===10)_=y.type===s.type?null:y.child;else if(y.tag===18){if(_=y.return,_===null)throw Error(t(341));_.lanes|=l,P=_.alternate,P!==null&&(P.lanes|=l),mu(_,l,s),_=y.sibling}else _=y.child;if(_!==null)_.return=y;else for(_=y;_!==null;){if(_===s){_=null;break}if(y=_.sibling,y!==null){y.return=_.return,_=y;break}_=_.return}y=_}tn(r,s,m.children,l),s=s.child}return s;case 9:return m=s.type,d=s.pendingProps.children,Fs(s,l),m=In(m),d=d(m),s.flags|=1,tn(r,s,d,l),s.child;case 14:return d=s.type,m=Vn(d,s.pendingProps),m=Vn(d.type,m),Yf(r,s,d,m,l);case 15:return Xf(r,s,s.type,s.pendingProps,l);case 17:return d=s.type,m=s.pendingProps,m=s.elementType===d?m:Vn(d,m),El(r,s),s.tag=1,dn(d)?(r=!0,hl(s)):r=!1,Fs(s,l),Df(s,d,m),Ru(s,d,m,l),zu(null,s,d,!0,r,l);case 19:return n1(r,s,l);case 22:return qf(r,s,l)}throw Error(t(156,s.tag))};function A1(r,s){return xo(r,s)}function Bg(r,s,l,d){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(r,s,l,d){return new Bg(r,s,l,d)}function td(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Dg(r){if(typeof r=="function")return td(r)?1:0;if(r!=null){if(r=r.$$typeof,r===se)return 11;if(r===ae)return 14}return 2}function li(r,s){var l=r.alternate;return l===null?(l=zn(r.tag,s,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=s,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&14680064,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,s=r.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l}function Nl(r,s,l,d,m,y){var _=2;if(d=r,typeof r=="function")td(r)&&(_=1);else if(typeof r=="string")_=5;else e:switch(r){case I:return Gi(l.children,m,y,s);case N:_=8,m|=8;break;case U:return r=zn(12,l,s,m|2),r.elementType=U,r.lanes=y,r;case Z:return r=zn(13,l,s,m),r.elementType=Z,r.lanes=y,r;case Q:return r=zn(19,l,s,m),r.elementType=Q,r.lanes=y,r;case V:return Wl(l,m,y,s);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case q:_=10;break e;case H:_=9;break e;case se:_=11;break e;case ae:_=14;break e;case G:_=16,d=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return s=zn(_,l,s,m),s.elementType=r,s.type=d,s.lanes=y,s}function Gi(r,s,l,d){return r=zn(7,r,d,s),r.lanes=l,r}function Wl(r,s,l,d){return r=zn(22,r,d,s),r.elementType=V,r.lanes=l,r.stateNode={isHidden:!1},r}function nd(r,s,l){return r=zn(6,r,null,s),r.lanes=l,r}function rd(r,s,l){return s=zn(4,r.children!==null?r.children:[],r.key,s),s.lanes=l,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}function Og(r,s,l,d,m){this.tag=s,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Co(0),this.expirationTimes=Co(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Co(0),this.identifierPrefix=d,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function id(r,s,l,d,m,y,_,P,R){return r=new Og(r,s,l,P,R),s===1?(s=1,y===!0&&(s|=8)):s=0,y=zn(3,null,null,s),r.current=y,y.stateNode=r,y.memoizedState={element:d,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},yu(y),r}function Ng(r,s,l){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:d==null?null:""+d,children:r,containerInfo:s,implementation:l}}function T1(r){if(!r)return Jr;r=r._reactInternals;e:{if(Oe(r)!==r||r.tag!==1)throw Error(t(170));var s=r;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(dn(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(t(171))}if(r.tag===1){var l=r.type;if(dn(l))return ef(r,l,s)}return s}function M1(r,s,l,d,m,y,_,P,R){return r=id(l,d,!0,r,m,y,_,P,R),r.context=T1(null),l=r.current,d=nn(),m=oi(l),y=Er(d,m),y.callback=s??null,ni(l,y,m),r.current.lanes=m,ue(r,m,d),pn(r,d),r}function Hl(r,s,l,d){var m=s.current,y=nn(),_=oi(m);return l=T1(l),s.context===null?s.context=l:s.pendingContext=l,s=Er(y,_),s.payload={element:r},d=d===void 0?null:d,d!==null&&(s.callback=d),r=ni(m,s,_),r!==null&&(qn(r,m,_,y),_l(r,m,_)),_}function Ul(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function P1(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<s?l:s}}function sd(r,s){P1(r,s),(r=r.alternate)&&P1(r,s)}function Wg(){return null}var E1=typeof reportError=="function"?reportError:function(r){console.error(r)};function od(r){this._internalRoot=r}Gl.prototype.render=od.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(t(409));Hl(r,s,null,null)},Gl.prototype.unmount=od.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;Wi(function(){Hl(null,r,null,null)}),s[Cr]=null}};function Gl(r){this._internalRoot=r}Gl.prototype.unstable_scheduleHydration=function(r){if(r){var s=fs();r={blockedOn:null,target:r,priority:s};for(var l=0;l<Hn.length&&s!==0&&s<Hn[l].priority;l++);Hn.splice(l,0,r),l===0&&To(r)}};function ad(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function Vl(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function R1(){}function Hg(r,s,l,d,m){if(m){if(typeof d=="function"){var y=d;d=function(){var W=Ul(_);y.call(W)}}var _=M1(s,d,r,0,null,!1,!1,"",R1);return r._reactRootContainer=_,r[Cr]=_.current,No(r.nodeType===8?r.parentNode:r),Wi(),_}for(;m=r.lastChild;)r.removeChild(m);if(typeof d=="function"){var P=d;d=function(){var W=Ul(R);P.call(W)}}var R=id(r,0,!1,null,null,!1,!1,"",R1);return r._reactRootContainer=R,r[Cr]=R.current,No(r.nodeType===8?r.parentNode:r),Wi(function(){Hl(s,R,l,d)}),R}function Yl(r,s,l,d,m){var y=l._reactRootContainer;if(y){var _=y;if(typeof m=="function"){var P=m;m=function(){var R=Ul(_);P.call(R)}}Hl(s,_,r,m)}else _=Hg(l,s,r,m,d);return Ul(_)}ds=function(r){switch(r.tag){case 3:var s=r.stateNode;if(s.current.memoizedState.isDehydrated){var l=Vr(s.pendingLanes);l!==0&&(Yr(s,l|1),pn(s,xt()),(He&6)===0&&(Ns=xt()+500,ei()))}break;case 13:Wi(function(){var d=Pr(r,1);if(d!==null){var m=nn();qn(d,r,1,m)}}),sd(r,1)}},hs=function(r){if(r.tag===13){var s=Pr(r,134217728);if(s!==null){var l=nn();qn(s,r,134217728,l)}sd(r,134217728)}},Qa=function(r){if(r.tag===13){var s=oi(r),l=Pr(r,s);if(l!==null){var d=nn();qn(l,r,s,d)}sd(r,s)}},fs=function(){return Xe},Ao=function(r,s){var l=Xe;try{return Xe=r,s()}finally{Xe=l}},vi=function(r,s,l){switch(s){case"input":if(Nr(r,l),s=l.name,l.type==="radio"&&s!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<l.length;s++){var d=l[s];if(d!==r&&d.form===r.form){var m=ul(d);if(!m)throw Error(t(90));vn(d),Nr(d,m)}}}break;case"textarea":Oa(r,l);break;case"select":s=l.value,s!=null&&Wr(r,!!l.multiple,s,!1)}},fo=Zu,po=Wi;var Ug={usingClientEntryPoint:!1,Events:[Uo,Ms,ul,os,ho,Zu]},ia={findFiberByHostInstance:Li,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Gg={bundleType:ia.bundleType,version:ia.version,rendererPackageName:ia.rendererPackageName,rendererConfig:ia.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Va(r),r===null?null:r.stateNode},findFiberByHostInstance:ia.findFiberByHostInstance||Wg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xl.isDisabled&&Xl.supportsFiber)try{or=Xl.inject(Gg),ut=Xl}catch{}}return mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ug,mn.createPortal=function(r,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ad(s))throw Error(t(200));return Ng(r,s,null,l)},mn.createRoot=function(r,s){if(!ad(r))throw Error(t(299));var l=!1,d="",m=E1;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(d=s.identifierPrefix),s.onRecoverableError!==void 0&&(m=s.onRecoverableError)),s=id(r,1,!1,null,null,l,!1,d,m),r[Cr]=s.current,No(r.nodeType===8?r.parentNode:r),new od(s)},mn.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Va(s),r=r===null?null:r.stateNode,r},mn.flushSync=function(r){return Wi(r)},mn.hydrate=function(r,s,l){if(!Vl(s))throw Error(t(200));return Yl(null,r,s,!0,l)},mn.hydrateRoot=function(r,s,l){if(!ad(r))throw Error(t(405));var d=l!=null&&l.hydratedSources||null,m=!1,y="",_=E1;if(l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(y=l.identifierPrefix),l.onRecoverableError!==void 0&&(_=l.onRecoverableError)),s=M1(s,null,r,1,l??null,m,!1,y,_),r[Cr]=s.current,No(r),d)for(r=0;r<d.length;r++)l=d[r],m=l._getVersion,m=m(l._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[l,m]:s.mutableSourceEagerHydrationData.push(l,m);return new Gl(s)},mn.render=function(r,s,l){if(!Vl(s))throw Error(t(200));return Yl(null,r,s,!1,l)},mn.unmountComponentAtNode=function(r){if(!Vl(r))throw Error(t(40));return r._reactRootContainer?(Wi(function(){Yl(null,null,r,!1,function(){r._reactRootContainer=null,r[Cr]=null})}),!0):!1},mn.unstable_batchedUpdates=Zu,mn.unstable_renderSubtreeIntoContainer=function(r,s,l,d){if(!Vl(l))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return Yl(r,s,l,!1,d)},mn.version="18.3.1-next-f1338f8080-20240426",mn}var D1;function Jg(){if(D1)return ud.exports;D1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ud.exports=Zg(),ud.exports}var O1;function e2(){if(O1)return ql;O1=1;var n=Jg();return ql.createRoot=n.createRoot,ql.hydrateRoot=n.hydrateRoot,ql}var t2=e2();const n2=lh(t2);var ee=ch();const $r={id:"pj-1",nom:{nomcomplet:"Test Hero",prenom:"Aryn",surnom:"the Blue"},age:25,sexe:"H",taille:175,poids:70,vitesse:9,langues:"Common",alignement:"Neutral Good",raceId:"human",backgroundId:"adventurer",niveauGlobal:1,classe:{1:{classeId:"fighter",subclasseId:"champion",niveau:1}},xp:0,dv:10,maitriseBonus:2,pvActuels:12,pvMax:12,pvTmp:0,calculPvMax:{classe1:{niveauGlobal_1:"10 + modCON",par_niveau_apres_1:"1d10 + modCON"},classe2:{par_niveau_apres_1:""}},CA:16,CalculCA:{base:"10 + modDEX",bonusArmure:"+ armor proficiency + shield"},nivFatigueActuel:0,nivFatigueMax:3,initiative:"modDEX",besoin:[],caracs:{force:{FOR:16,modFOR:3},dexterite:{DEX:14,modDEX:2},constitution:{CON:14,modCON:2},intelligence:{INT:10,modINT:0},sagesse:{SAG:12,modSAG:1},charisme:{CHA:10,modCHA:0}},competences:{},percPassive:11,proficiencies:{},savingThrows:["force","constitution"],inspiration:!1,traits:["Veteran soldier","Brave"],features:[],compteur:{},ressources:{},etats:[],historique:[],notes:"",argent:{cuivre:0,argent:0,or:10,platine:0},materielSlots:{Ceinture_gauche:null,Ceinture_droite:null,Dos_gauche:null,Dos_droit:null,Armure:null,Vetement:null,paquetage:null,accessoire:null},armesDefaut:{main_droite:null,main_gauche:null,mains:null},Inventaire:{id:"",idUnique:"",quantite:0,mod:null,conteneur:null},capaMax:120,capaAvantMalus:60,capaActuel:0,StatEncombrement:"Not encumbered",descriptionPersonnage:{bio:"Test hero for the mini-game.",physique:"Athletic human in light armor.",personnalite:"Calm and determined.",objectifs:"Explore the test dungeon.",relations:"",defauts:"Too reckless."},uiClasse:{ui_template1:"fighter_base",ui_template2:null},SpellcastingSpec:{ability:null,spellSaveDc:null,spellAttackMod:null,slots:{},focusId:null,description:null,spellIds:[]}},La=12,Qs=8,at=64,d0=at,vc=at*.5,r2=1841961;function i2(n,e){return n>=0&&n<La&&e>=0&&e<Qs}function Sa(n){return Math.max(1,Math.floor(n))*at}function Od(n){return Math.max(1,Math.floor(n))*at}function za(n,e,t,i){return n>=0&&n<t&&e>=0&&e<i}function gn(n,e,t,i){const o=d0/2,a=vc/2,c=Sa(t)/2,u=vc*2,h=(n-e)*o+c,f=(n+e)*a+u;return{x:h,y:f}}function s2(n,e,t,i){const o=d0/2,a=vc/2,c=Sa(t)/2,u=vc*2,h=n-c,f=e-u,p=h/o,g=f/a,v=(p+g)/2,x=(g-p)/2,w=Math.round(v),S=Math.round(x);return{x:w,y:S}}function uh(n,e,t){const i=(t==null?void 0:t.playableCells)??null;if(i&&i.size>0)return i.has(`${n},${e}`);const o=(t==null?void 0:t.grid)??null;return o?za(n,e,o.cols,o.rows):i2(n,e)}function h0(n,e,t,i,o){const a=[];for(let c=-i;c<=i;c++)for(let u=-i;u<=i;u++){const h=e+u,f=t+c;if(!uh(h,f,o))continue;Math.sqrt(u*u+c*c)<=i+.01&&a.push({x:h,y:f})}return{id:n,type:"circle",cells:a}}function o2(n,e,t,i,o,a){const c=[],u=Math.floor(i/2),h=Math.floor(o/2);for(let f=t-h;f<=t+h;f++)for(let p=e-u;p<=e+u;p++)uh(p,f,a)&&c.push({x:p,y:f});return{id:n,type:"rectangle",cells:c}}function f0(n,e,t,i,o,a,c){const u=[],f=typeof a=="number"&&a>0&&a<180?a*Math.PI/360:null;for(let p=1;p<=i;p++){let g=p;if(f!==null){const v=Math.tan(f)*p;g=Math.floor(v),g<0&&(g=0),g>p&&(g=p)}for(let v=-g;v<=g;v++){let x=e,w=t;switch(o){case"right":x=e+p,w=t+v;break;case"left":x=e-p,w=t+v;break;case"down":x=e+v,w=t+p;break;case"up":x=e+v,w=t-p;break}uh(x,w,c)&&u.push({x,y:w})}}return{id:n,type:"cone",cells:u}}function a2(n,e){return`${n},${e}`}function l2(n,e){const t=[];let i=Math.round(n.x),o=Math.round(n.y);const a=Math.round(e.x),c=Math.round(e.y),u=Math.abs(a-i),h=Math.abs(c-o),f=i<a?1:-1,p=o<c?1:-1;let g=u-h;for(;t.push({x:i,y:o}),!(i===a&&o===c);){const v=2*g;v>-h&&(g-=h,i+=f),v<u&&(g+=u,o+=p)}return t}function ka(n,e,t){if(!t||t.size===0)return!0;const i=l2(n,e);for(let o=1;o<i.length-1;o++){const a=i[o];if(t.has(a2(a.x,a.y)))return!1}return!0}const c2=30,u2={shape:"cone",range:c2};function d2(n){return n.facing?n.facing:n.type==="player"?"right":"left"}function h2(n){return n.visionProfile?n.visionProfile:u2}function dh(n,e){const t=h2(n),i=d2(n),o=`vision-${n.id}`;return t.range<=0?{id:o,type:t.shape==="circle"?"circle":"cone",cells:[]}:t.shape==="circle"?h0(o,n.x,n.y,t.range,{playableCells:e??null}):f0(o,n.x,n.y,t.range,i,t.apertureDeg,{playableCells:e??null})}function xr(n){return`${n.x},${n.y}`}function f2(n,e,t,i){if(i&&i.size>0&&(!i.has(xr(e))||!i.has(xr({x:n.x,y:n.y}))))return!1;const o=dh(n,i??null);if(!o.cells.length)return!1;const a=xr(e);for(const c of o.cells)if(!(i&&i.size>0&&!i.has(xr(c)))&&xr(c)===a)return t&&t.size>0?ka({x:n.x,y:n.y},{x:e.x,y:e.y},t):!0;return!1}function p0(n,e,t,i){const o=dh(n,i??null);if(!o.cells.length)return[];const a=new Set;for(const h of o.cells){const f=xr(h);i&&i.size>0&&!i.has(f)||a.add(f)}const c=e.filter(h=>h.id!==n.id&&h.hp>0&&a.has(xr({x:h.x,y:h.y}))),u=i&&i.size>0?c.filter(h=>i.has(xr({x:h.x,y:h.y}))):c;return!t||t.size===0?u:u.filter(h=>ka({x:n.x,y:n.y},{x:h.x,y:h.y},t))}function _c(n,e,t,i,o){return!(e.hp<=0||o&&o.size>0&&(!o.has(xr({x:e.x,y:e.y}))||!o.has(xr({x:n.x,y:n.y})))||!p0(n,t,i,o).some(u=>u.id===e.id))}function wc(n,e,t){return Math.max(e,Math.min(t,n))}function di(n,e){return Math.abs(n.x-e.x)+Math.abs(n.y-e.y)}function Yt(n){return n.hp<=0}function N1(n,e,t,i,o){return Yt(n)||Yt(e)?!1:_c(n,e,t,i,o)}function p2(n,e){const t=e.x-n.x,i=e.y-n.y;return Math.abs(t)>=Math.abs(i)?t>=0?"right":"left":i>=0?"down":"up"}const m2=["./brute.json","./archer.json","./assassin.json","./ghost.json"],W1={types:m2},g2="brute",y2="Brute",x2="Frontliner robuste qui avance pour engager le joueur.",v2="brute",_2=["enemy-move","enemy-melee-strike"],w2={preferredRangeMin:1,preferredRangeMax:1,panicRange:0},b2={raceOrOrigin:"Brute mercenaire",register:"familier",tone:["agressif","direct","impatient"],vocabulary:["charge","ecrase","avance","finissons-en"],quirks:["phrases courtes","menaces simples"],taboos:["pas de modernisme","pas de meta-jeu"]},S2={hp:10,moveRange:3,attackDamage:2,armorClass:14,attackRange:1,maxAttacksPerTurn:2},k2={type:"ground",speed:3,canPassThroughWalls:!1,canPassThroughEntities:!1,canStopOnOccupiedTile:!1},C2={shape:"cone",range:4,apertureDeg:90,canSeeInDark:!1},A2={id:g2,label:y2,description:x2,aiRole:v2,actions:_2,behavior:w2,speechProfile:b2,baseStats:S2,movement:k2,vision:C2},T2="archer",M2="Archer",P2="Tireur qui prefere garder une distance de securite avant de frapper.",E2="archer",R2=["enemy-move","enemy-bow-shot","enemy-melee-strike"],I2={preferredRangeMin:3,preferredRangeMax:6,panicRange:2},$2={raceOrOrigin:"Archer de bande",register:"neutre",tone:["tactique","moqueur","vigilant"],vocabulary:["a couvert","recule","je l'ai en vue","distance"],quirks:["annonce ce qu'il voit","donne des consignes courtes"],taboos:["pas de modernisme","pas de meta-jeu"]},L2={hp:7,moveRange:2,attackDamage:2,armorClass:13,attackRange:6,maxAttacksPerTurn:1},z2={type:"ground",speed:2,canPassThroughWalls:!1,canPassThroughEntities:!1,canStopOnOccupiedTile:!1},F2={shape:"cone",range:15,apertureDeg:60,canSeeInDark:!1},j2={id:T2,label:M2,description:P2,aiRole:E2,actions:R2,behavior:I2,speechProfile:$2,baseStats:L2,movement:z2,vision:F2},B2="assassin",D2="Assassin",O2="Frappeur rapide qui cherche a se rapprocher pour porter un coup decisif.",N2="assassin",W2=["enemy-move","enemy-melee-strike"],H2={preferredRangeMin:1,preferredRangeMax:1,panicRange:0},U2={raceOrOrigin:"Assassin",register:"soutenu",tone:["froid","tranchant","calme"],vocabulary:["silence","cible","dans l'ombre","fin"],quirks:["parle peu","phrases courtes et precises"],taboos:["pas de modernisme","pas de meta-jeu"]},G2={hp:6,moveRange:3,attackDamage:3,armorClass:15},V2={type:"ground",speed:3,canPassThroughWalls:!1,canPassThroughEntities:!0,canStopOnOccupiedTile:!1},Y2={shape:"cone",range:6,apertureDeg:80,canSeeInDark:!1},X2={id:B2,label:D2,description:O2,aiRole:N2,actions:W2,behavior:H2,speechProfile:U2,baseStats:G2,movement:V2,vision:Y2},q2="ghost",K2="Fantome",Q2="Esprit intangible capable de traverser les autres creatures.",Z2="ghost",J2=["enemy-move","enemy-melee-strike"],ey={preferredRangeMin:1,preferredRangeMax:1,panicRange:0},ty={raceOrOrigin:"Esprit vengeur",register:"soutenu",tone:["cryptique","menaant","surnaturel"],vocabulary:["je te sens","au-dela","froideur","souffle"],quirks:["parle en images","phrases etranges mais courtes"],taboos:["pas de modernisme","pas de meta-jeu"]},ny={hp:8,moveRange:4,attackDamage:3,armorClass:12},ry={type:"ghost",speed:4,canPassThroughWalls:!0,canPassThroughEntities:!0,canStopOnOccupiedTile:!1},iy={shape:"circle",range:6,canSeeInDark:!0},sy={id:q2,label:K2,description:Q2,aiRole:Z2,actions:J2,behavior:ey,speechProfile:ty,baseStats:ny,movement:ry,vision:iy},oy=["./wall-stone.json","./low-wall-stone.json","./tree-oak.json","./barrel-wood.json","./pillar-stone.json"],H1={types:oy},ay="wall-stone",ly="Mur de pierre",cy="wall",uy=["wall","stone"],dy={movement:!0,vision:!0,attacks:!0},hy={destructible:!0,maxHp:35,ac:15},fy=[{id:"1",label:"Segment 1",footprint:[{x:0,y:0}],rotatable:!1},{id:"2",label:"Segment 2",footprint:[{x:0,y:0},{x:1,y:0}],rotatable:!0},{id:"3",label:"Segment 3",footprint:[{x:0,y:0},{x:1,y:0},{x:2,y:0}],rotatable:!0}],py={spriteKey:"obstacle:wall-stone",tint:16777215,heightClass:"tall"},my={weight:5,cluster:{min:2,max:8},shapeHint:"line",avoidNearTokens:!0},gy={id:ay,label:ly,category:cy,tags:uy,blocking:dy,durability:hy,variants:fy,appearance:py,spawnRules:my},yy="low-wall-stone",xy="Muret de pierre",vy="wall",_y=["wall","stone","low"],wy={movement:!0,vision:!1,attacks:!1},by={destructible:!0,maxHp:18,ac:13},Sy=[{id:"1",label:"Segment 1",footprint:[{x:0,y:0}],rotatable:!1},{id:"2",label:"Segment 2",footprint:[{x:0,y:0},{x:1,y:0}],rotatable:!0}],ky={cover:"half"},Cy={spriteKey:"obstacle:low-wall-stone",tint:16777215,heightClass:"low"},Ay={weight:3,cluster:{min:1,max:6},shapeHint:"line",avoidNearTokens:!0},Ty={id:yy,label:xy,category:vy,tags:_y,blocking:wy,durability:by,variants:Sy,combat:ky,appearance:Cy,spawnRules:Ay},My="tree-oak",Py="Chne",Ey="vegetation",Ry=["tree","vegetation","wood"],Iy={movement:!0,vision:!0,attacks:!0},$y={destructible:!0,maxHp:22,ac:12},Ly=[{id:"base",label:"Tronc",footprint:[{x:0,y:0}],rotatable:!1}],zy={spriteKey:"obstacle:tree-oak",tint:16777215,heightClass:"tall",variantWeights:{summer:6,autumn:3,dead:1}},Fy={weight:6,cluster:{min:1,max:5},shapeHint:"scatter",avoidNearTokens:!0},jy={id:My,label:Py,category:Ey,tags:Ry,blocking:Iy,durability:$y,variants:Ly,appearance:zy,spawnRules:Fy},By="barrel-wood",Dy="Tonneau",Oy="prop",Ny=["barrel","wood","prop"],Wy={movement:!0,vision:!1,attacks:!1},Hy={destructible:!0,maxHp:8,ac:10},Uy=[{id:"base",label:"Tonneau",footprint:[{x:0,y:0}],rotatable:!1}],Gy={spriteKey:"obstacle:barrel-wood",tint:16777215,heightClass:"medium"},Vy={weight:4,cluster:{min:1,max:3},shapeHint:"scatter",avoidNearTokens:!0},Yy={id:By,label:Dy,category:Oy,tags:Ny,blocking:Wy,durability:Hy,variants:Uy,appearance:Gy,spawnRules:Vy},Xy="pillar-stone",qy="Pilier de pierre",Ky="structure",Qy=["pillar","stone","structure"],Zy={movement:!0,vision:!0,attacks:!0},Jy={destructible:!0,maxHp:28,ac:14},ex=[{id:"base",label:"Pilier",footprint:[{x:0,y:0}],rotatable:!1}],tx={spriteKey:"obstacle:pillar-stone",tint:16777215,heightClass:"tall"},nx={weight:2,cluster:{min:1,max:2},shapeHint:"scatter",avoidNearTokens:!0},rx={id:Xy,label:qy,category:Ky,tags:Qy,blocking:Zy,durability:Jy,variants:ex,appearance:tx,spawnRules:nx},ix={"./wall-stone.json":gy,"./low-wall-stone.json":Ty,"./tree-oak.json":jy,"./barrel-wood.json":Yy,"./pillar-stone.json":rx};function sx(){const n=Array.isArray(H1.types)?H1.types:[],e=[];for(const t of n){const i=ix[t];i?e.push(i):console.warn("[obstacle-types] Type path missing in bundle:",t)}return e.length===0&&console.warn("[obstacle-types] No obstacle types loaded from index.json"),e}function ox(n){return String(n??"").toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").trim()}function Ft(n,e){return e.some(t=>t.test(n))}function fd(n,e){for(const t of e){const i=n.match(t);if(!i)continue;const o=Number(i[1]);if(Number.isFinite(o))return o}return null}function ax(n){const e=String(n.prompt??""),t=ox(e),i=[],o=Ft(t,[/\bdonjon\b/,/\bdongon\b/,/\bdungeon\b/,/\bcatacombe\b/,/\bcouloir\b/,/\bsalle\b/]),a=Ft(t,[/\bforet\b/,/\bbois\b/,/\barbres?\b/,/\bclairiere\b/]),c=Ft(t,[/\bville\b/,/\brue\b/,/\bmaisons?\b/,/\bquartier\b/]);let u="generic";o?u="dungeon":a?u="forest":c&&(u="city");const h=Ft(t,[/\bil fait jour\b/,/\bjour\b/]),f=Ft(t,[/\bnuit\b/,/\bobscur\b/,/\bsombre\b/]),p=h?"day":f?"night":"unknown",g=Ft(t,[/\bcircul\w+/]),v=Ft(t,[/\bcarre(?:e|es)?\b/,/\bsquare\b/]),x=Ft(t,[/\brectang\w+\b/,/\brectangle\b/]),w=Ft(t,[/\bclairiere\b/]),S=Ft(t,[/\brue\b/]),b=fd(t,[/\b(\d+)\s*(acces|acces|entrees|portes)\b/])??null,k=fd(t,[/\b(\d+)\s*(colonnes|piliers)\b/])??null,A=Ft(t,[/\bautel\b/,/\bhotel\b/]),M=Ft(t,[/\bfaiblement eclaire\b/,/\bpeu eclaire\b/,/\bfaible lumiere\b/]),E=Ft(t,[/\bau centre\b/,/\bcentre\b/,/\bcentral\b/]),B=Ft(t,[/\bportes? (sont )?fermees?\b/,/\bfermee\b/]),F=Ft(t,[/\bimmense\b/,/\bvaste\b/,/\bspacieu\w+\b/,/\bgrande\b/,/\bgrand\b/])?"large":Ft(t,[/\bpetit\b/,/\bpetite\b/,/\bexigu\w+\b/,/\betroit\w+\b/])?"small":"medium";let I="generic_scatter";u==="dungeon"&&(v||x)?I="dungeon_square_room":u==="dungeon"&&g?I="dungeon_circular_room":u==="forest"&&w?I="forest_clearing":u==="city"&&S?I="city_street":u==="dungeon"?I="dungeon_circular_room":u==="forest"?I="forest_clearing":u==="city"&&(I="city_street");const N={prompt:e,grid:{cols:n.cols,rows:n.rows},layoutId:I,theme:u,timeOfDay:p,sizeHint:F,dungeon:u==="dungeon"?{borderWalls:!0,entrances:{count:b??2,width:1},room:{shape:g?"circle":"rectangle"},columns:k??0,hasAltar:A,lighting:M&&!h?"low":"normal"}:void 0,forest:u==="forest"?{radius:Math.max(2,Math.floor(Math.min(n.cols,n.rows)*.28)),treesOnRing:"sparse",lighting:f?"night":"day"}:void 0,city:u==="city"?{direction:"horizontal",streetWidth:2,buildingDepth:2,doors:"closed",lighting:f?"night":"day"}:void 0};return u==="dungeon"&&g&&N.dungeon&&(N.dungeon.room.radius=Math.max(2,Math.floor(Math.min(n.cols,n.rows)*.33)),b!==null&&(N.dungeon.entrances.count=Math.max(1,b)),k!==null&&(N.dungeon.columns=Math.max(0,k)),M&&E&&(N.dungeon.lighting="low")),u==="dungeon"&&(v||x)&&N.dungeon&&(b!==null&&(N.dungeon.entrances.count=Math.max(1,b)),k!==null&&(N.dungeon.columns=Math.max(0,k)),M&&E&&(N.dungeon.lighting="low")),u==="forest"&&w&&N.forest&&(N.forest.treesOnRing=Ft(t,[/\bparseme\b/,/\bparsem\w+/])?"sparse":"dense",N.forest.radius=Math.max(2,Math.floor(Math.min(n.cols,n.rows)*.3))),u==="city"&&S&&N.city&&(N.city.direction=Ft(t,[/\bverticale?\b/])?"vertical":"horizontal",N.city.streetWidth=Math.max(1,fd(t,[/\b(\d+)\s*cases?\b/])??2)),i.push(`theme=${u} layout=${I} time=${p}`),i.push(`sizeHint=${F}`),{spec:N,notes:i}}function lx(n){let e=n>>>0;return()=>{e+=1831565813;let t=Math.imul(e^e>>>15,1|e);return t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296}}function cx(n){const e=String(n??"");let t=2166136261;for(let i=0;i<e.length;i++)t^=e.charCodeAt(i),t=Math.imul(t,16777619);return t>>>0}function pi(n,e){var o,a;const t=n.reduce((c,u)=>c+Math.max(0,u.weight),0);if(t<=0)return((o=n[0])==null?void 0:o.item)??null;let i=e()*t;for(const c of n){const u=Math.max(0,c.weight);if(i<u)return c.item;i-=u}return((a=n[n.length-1])==null?void 0:a.item)??null}function hi(n,e,t){const i=Math.min(e,t),o=Math.max(e,t);return i+Math.floor(n()*(o-i+1))}function ux(n,e){return`${n},${e}`}function dx(n,e){switch(e){case 90:return{x:-n.y,y:n.x};case 180:return{x:-n.x,y:-n.y};case 270:return{x:n.y,y:-n.x};default:return{x:n.x,y:n.y}}}function hx(n,e){var i;return n?(n.variants||[]).find(o=>o.id===e)??((i=n.variants)==null?void 0:i[0])??null:null}function hh(n,e){const t=hx(e,n.variantId),i=Array.isArray(t==null?void 0:t.footprint)&&t.footprint.length?t.footprint:[{x:0,y:0}],o=n.rotation??0;return i.map(a=>{const c=dx(a,o);return{x:n.x+c.x,y:n.y+c.y}})}function fx(n,e){var u,h,f;const t=new Map;for(const p of n)t.set(p.id,p);const i=new Set,o=new Set,a=new Set,c=new Set;for(const p of e){if(p.hp<=0)continue;const g=t.get(p.typeId),v=hh(p,g);for(const x of v){const w=ux(x.x,x.y);c.add(w),(u=g==null?void 0:g.blocking)!=null&&u.movement&&i.add(w),(h=g==null?void 0:g.blocking)!=null&&h.vision&&o.add(w),(f=g==null?void 0:g.blocking)!=null&&f.attacks&&a.add(w)}}return{movement:i,vision:o,attacks:a,occupied:c}}function tt(n,e){return`${n},${e}`}function Ye(n,e,t){return Math.max(e,Math.min(t,n))}function Ca(n,e,t){return e>=0&&t>=0&&e<n.cols&&t<n.rows}function m0(n,e,t){return t*n.cols+e}function Fa(n){const e=Math.max(1,n.cols),t=Math.max(1,n.rows),i=e*t,o={terrain:Array.from({length:i},()=>"unknown"),height:Array.from({length:i},()=>0),light:Array.from({length:i},()=>1)};let a=1;const c=n.seedPrefix??"obs",u=new Set;for(let h=0;h<t;h++)for(let f=0;f<e;f++)u.add(tt(f,h));return{cols:e,rows:t,layers:o,playable:u,obstacles:[],occupied:new Set,movementBlocked:new Set,reserved:n.reserved??new Set,log:[],nextObstacleId:()=>`${c}-${a++}`}}function ja(n,e,t,i){const o=new Set,a=Math.max(0,Math.floor(e));for(let c=-a;c<=a;c++)for(let u=-a;u<=a;u++){if(Math.abs(u)+Math.abs(c)>a)continue;const f=n.x+u,p=n.y+c;f<0||p<0||f>=t||p>=i||o.add(tt(f,p))}return o}function Zs(n,e,t,i){Ca(n,e,t)&&(n.layers.terrain[m0(n,e,t)]=i)}function Ba(n,e,t,i){Ca(n,e,t)&&(n.layers.light[m0(n,e,t)]=Ye(i,0,1))}function An(n){var g,v;const{draft:e,type:t,x:i,y:o,variantId:a,rotation:c}=n;if(!t)return!1;const u=Math.max(1,Number(((g=t.durability)==null?void 0:g.maxHp)??1)),h={id:e.nextObstacleId(),typeId:t.id,variantId:a,x:i,y:o,rotation:c,hp:u,maxHp:u},f=hh(h,t);if(!f.length)return!1;const p=e.playable.size>0;for(const x of f){if(!Ca(e,x.x,x.y))return!1;const w=tt(x.x,x.y);if(p&&!e.playable.has(w)||!n.allowOnReserved&&e.reserved.has(w)||e.occupied.has(w))return!1}e.obstacles.push(h);for(const x of f){const w=tt(x.x,x.y);e.occupied.add(w),(v=t.blocking)!=null&&v.movement&&e.movementBlocked.add(w)}return!0}function px(n,e){const t=new Set;if(!Ca(n,e.x,e.y))return t;const i=tt(e.x,e.y);if(n.movementBlocked.has(i))return t;const o=[e];t.add(i);const a=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(;o.length;){const c=o.shift();for(const u of a){const h=c.x+u.x,f=c.y+u.y;if(!Ca(n,h,f))continue;const p=tt(h,f);t.has(p)||n.movementBlocked.has(p)||(t.add(p),o.push({x:h,y:f}))}}return t}function mx(n,e){return n.length===0?null:n[Math.floor(e()*n.length)]??n[0]}function gx(n){const{draft:e,playerStart:t,enemyTypes:i,rand:o}=n,a=[],c=[],u=Ye(n.enemyCount,1,20),h=px(e,t),f=(g,v)=>Math.abs(g-t.x)+Math.abs(v-t.y)+o()*.25,p=[];for(let g=0;g<e.rows;g++)for(let v=0;v<e.cols;v++)e.occupied.has(tt(v,g))||e.playable.size>0&&!e.playable.has(tt(v,g))||v===t.x&&g===t.y||h.size>0&&!h.has(tt(v,g))||p.push({x:v,y:g});if(p.length===0){for(let g=0;g<e.rows;g++)for(let v=0;v<e.cols;v++)e.occupied.has(tt(v,g))||e.playable.size>0&&!e.playable.has(tt(v,g))||v===t.x&&g===t.y||p.push({x:v,y:g});a.push("Spawns: fallback (aucune case atteignable libre).")}p.sort((g,v)=>f(v.x,v.y)-f(g.x,g.y));for(let g=0;g<u;g++){const v=mx(i,o);if(!v)break;const x=p.find(w=>!c.some(S=>S.position.x===w.x&&S.position.y===w.y));if(!x)break;c.push({enemyType:v,position:x})}return a.push(`Spawns: ${c.length}/${u} ennemis.`),{enemySpawns:c,log:a}}function ui(n,e,t){return Math.max(e,Math.min(t,n))}function Lr(n){const e=Math.max(1,Math.floor(n));return e%2===0?e:e+1}function yx(n){const{spec:e}=n,t=Math.max(1,e.grid.cols),i=Math.max(1,e.grid.rows),o=e.sizeHint==="large"?Math.max(120,n.enemyCount*28+80):e.sizeHint==="small"?Math.max(48,n.enemyCount*16+20):Math.max(72,n.enemyCount*22+40);if(e.layoutId==="dungeon_circular_room"){const a=Math.sqrt(o/Math.PI),c=Lr(Math.ceil(a*2+4)),u=Math.max(i,c),h=Math.max(t,Lr(Math.ceil(c*1.4)));return h>t||u>i?{cols:ui(h,t,60),rows:ui(u,i,40),reason:`salle circulaire '${e.sizeHint??"medium"}' -> minDim${c}, cible${o} cases`}:null}if(e.layoutId==="dungeon_square_room"){const a=Lr(Math.ceil(Math.sqrt(o)+4)),c=Math.max(a,Math.max(t,i)),u=t/i,h=u>.75&&u<1.33,f=Math.max(t,h?c:Lr(Math.ceil(c*Math.max(1,u)))),p=Math.max(i,h?c:Lr(Math.ceil(c/Math.max(1,u))));return f>t||p>i?{cols:ui(f,t,70),rows:ui(p,i,50),reason:`salle carre '${e.sizeHint??"medium"}' -> minDim${a}, cible${o} cases`}:null}if(e.layoutId==="city_street"){const a=e.sizeHint==="large"?1.6:e.sizeHint==="small"?1:1.25,c=Math.max(t,Lr(Math.ceil(t*a))),u=Math.max(i,Lr(Math.ceil(i*(e.sizeHint==="large"?1.4:1.1))));return c>t||u>i?{cols:ui(c,t,70),rows:ui(u,i,50),reason:`rue '${e.sizeHint??"medium"}' -> agrandissement pour rduire la densit`}:null}if(e.layoutId==="forest_clearing"){const a=e.sizeHint==="large"?1.5:e.sizeHint==="small"?1:1.2,c=Math.max(t,Lr(Math.ceil(t*a))),u=Math.max(i,Lr(Math.ceil(i*a)));return c>t||u>i?{cols:ui(c,t,70),rows:ui(u,i,50),reason:`clairire '${e.sizeHint??"medium"}' -> plus d'espace autour`}:null}if(e.sizeHint==="large"){const a=Math.max(t,18),c=Math.max(i,12);if(a>t||c>i)return{cols:a,rows:c,reason:"taille 'large' (fallback gnrique)"}}return null}function jr(n,e){return n.find(t=>t.id===e)??null}function Aa(n,e){return n.filter(e).map(t=>{var i;return{item:t,weight:Math.max(0,Number(((i=t.spawnRules)==null?void 0:i.weight)??1))}}).filter(t=>t.weight>0)}function Zn(n,e,t){const i=Array.isArray(n.variants)?n.variants:[];if(i.length===0)return"base";const o=i.map(a=>{const c=Array.isArray(a.footprint)?a.footprint.length:1,u=Math.max(1,c),h=e==="line"?u*2:u;return{item:a.id,weight:h}});return pi(o,t)??i[0].id}function g0(n,e,t){const i=(n.variants??[]).find(o=>o.id===e)??null;return i!=null&&i.rotatable,0}function y0(n,e,t,i){const o=n-t,a=e-i;return Math.sqrt(o*o+a*a)}function xx(n){const e=new Set;for(let t=0;t<n.rows;t++)for(let i=0;i<n.cols;i++)y0(i,t,n.cx,n.cy)<=n.radius&&e.add(tt(i,t));return e}function vx(n,e,t){const i=tt(e,t);return n.has(i)?!n.has(tt(e+1,t))||!n.has(tt(e-1,t))||!n.has(tt(e,t+1))||!n.has(tt(e,t-1)):!1}function _x(n){const{boundary:e,count:t,rand:i}=n;if(e.length===0||t<=0)return[];const o=[],a=[...e].sort(()=>i()-.5),c=Math.max(2,Math.floor(Math.min(n.cols,n.rows)/3));for(const u of a){if(o.length>=t)break;o.every(h=>Math.abs(h.x-u.x)+Math.abs(h.y-u.y)>=c)&&o.push(u)}for(;o.length<t;)o.push(e[Math.floor(i()*e.length)]);return o.slice(0,t)}function wx(n,e){const t=jr(e.obstacleTypes,"wall-stone")??e.obstacleTypes.find(a=>a.category==="wall")??e.obstacleTypes[0]??null,i=jr(e.obstacleTypes,"pillar-stone")??e.obstacleTypes.find(a=>(a.tags??[]).includes("pillar"))??null,o=jr(e.obstacleTypes,"barrel-wood")??e.obstacleTypes.find(a=>(a.tags??[]).includes("barrel"))??null;return{wallType:t,pillarType:i,barrelType:o}}function bx(n){var H,se,Z;const{spec:e,ctx:t,rand:i}=n,o=Math.max(1,e.grid.cols),a=Math.max(1,e.grid.rows),c=Fa({cols:o,rows:a,reserved:new Set,seedPrefix:"obs"});c.log.push("Layout: donjon (salle circulaire).");const u=e.dungeon??{borderWalls:!0,entrances:{count:2},room:{},columns:0,hasAltar:!1,lighting:"normal"},{wallType:h,pillarType:f,barrelType:p}=wx(e,t),g=u.room.radius??Math.max(2,Math.floor(Math.min(o,a)*.33)),v=Ye(Math.floor(o*.62),0,o-1),x=Ye(Math.floor(a*.5),0,a-1),w=xx({cols:o,rows:a,cx:v,cy:x,radius:g});c.playable=w;let S={x:v,y:x},b=null,k=Number.POSITIVE_INFINITY;for(const Q of w){const[ae,G]=Q.split(","),V=Number(ae),te=Number(G);if(!Number.isFinite(V)||!Number.isFinite(te))continue;const Y=V*100+Math.abs(te-x);Y<k&&(k=Y,b={x:V,y:te})}b&&(S=b),c.reserved=ja(S,2,o,a);for(let Q=0;Q<a;Q++)for(let ae=0;ae<o;ae++)w.has(tt(ae,Q))&&Zs(c,ae,Q,"floor");const A=u.lighting==="low"?.25:.75;for(let Q=0;Q<a;Q++)for(let ae=0;ae<o;ae++){if(!w.has(tt(ae,Q)))continue;const G=y0(ae,Q,v,x),V=Ye(1-G/(g+.001),0,1),te=u.lighting==="low"?.55*V:.15*V;Ba(c,ae,Q,Ye(A+te,0,1))}const M=[];for(let Q=0;Q<a;Q++)for(let ae=0;ae<o;ae++)vx(w,ae,Q)&&M.push({x:ae,y:Q});const E=_x({cols:o,rows:a,boundary:M,count:Math.max(0,u.entrances.count),rand:i}),B=new Set(E.map(Q=>tt(Q.x,Q.y)));for(const Q of B)c.reserved.add(Q);if(h&&u.borderWalls){let Q=0;const ae=((H=(h.variants??[]).map(G=>({id:G.id,len:Array.isArray(G.footprint)?G.footprint.length:1})).sort((G,V)=>G.len-V.len)[0])==null?void 0:H.id)??((Z=(se=h.variants)==null?void 0:se[0])==null?void 0:Z.id)??"1";for(const G of M){if(B.has(tt(G.x,G.y)))continue;const V=ae,te=g0(h,V);An({draft:c,type:h,x:G.x,y:G.y,variantId:V,rotation:te})&&Q++}c.log.push(`Murs: ${Q} segments (avec ${E.length} accs).`)}else c.log.push("Murs: aucun type de mur disponible.");const F=Math.max(0,u.columns);if(F>0){const Q=f??h;let ae=0;const G=Math.max(1,Math.floor(g*.5)),V=[{x:v+G,y:x},{x:v-G,y:x},{x:v,y:x+G},{x:v,y:x-G}].filter(Y=>w.has(tt(Y.x,Y.y)));for(;ae<F&&V.length;){const Y=V.shift(),ie=Q?Zn(Q,"scatter",i):"base";An({draft:c,type:Q,x:Y.x,y:Y.y,variantId:ie,rotation:0})&&ae++}let te=0;for(;ae<F&&te<200;){te++;const Y=Ye(v+hi(i,-g+1,g-1),0,o-1),ie=Ye(x+hi(i,-g+1,g-1),0,a-1);if(!w.has(tt(Y,ie))||B.has(tt(Y,ie)))continue;const L=Q?Zn(Q,"scatter",i):"base";An({draft:c,type:Q,x:Y,y:ie,variantId:L,rotation:0})&&ae++}c.log.push(`Colonnes: ${ae}/${F}.`)}if(u.hasAltar){const Q=p??f??null;if(Q){const ae=Zn(Q,"room",i),G=An({draft:c,type:Q,x:v,y:x,variantId:ae,rotation:0});c.log.push(G?"Autel: plac au centre.":"Autel: placement impossible (collision).")}else c.log.push("Autel: aucun type d'obstacle appropri.")}const I=Aa(t.obstacleTypes,Q=>Q.category!=="wall"),N=Ye(Math.floor(o*a/45),1,3);let U=0,q=0;for(;U<N&&q<120;){q++;const Q=pi(I,i)??null;if(!Q)break;const ae=Ye(v+hi(i,-g+1,g-1),0,o-1),G=Ye(x+hi(i,-g+1,g-1),0,a-1);if(!w.has(tt(ae,G))||B.has(tt(ae,G)))continue;const V=Zn(Q,"scatter",i),te=(Q.variants??[]).find(L=>L.id===V)??null,Y=te!=null&&te.rotatable?pi([{item:0,weight:1},{item:90,weight:1},{item:180,weight:1},{item:270,weight:1}],i)??0:0;An({draft:c,type:Q,x:ae,y:G,variantId:V,rotation:Y})&&U++}return U>0&&c.log.push(`Props: +${U}.`),{draft:c,playerStart:S}}function Sx(n){const e=jr(n.obstacleTypes,"wall-stone")??n.obstacleTypes.find(o=>o.category==="wall")??n.obstacleTypes[0]??null,t=jr(n.obstacleTypes,"pillar-stone")??n.obstacleTypes.find(o=>(o.tags??[]).includes("pillar"))??null,i=jr(n.obstacleTypes,"barrel-wood")??n.obstacleTypes.find(o=>(o.tags??[]).includes("barrel"))??null;return{wallType:e,pillarType:t,barrelType:i}}function kx(n){const e=[];for(let t=n.x1;t<=n.x2;t++)e.push({x:t,y:n.y1}),n.y2!==n.y1&&e.push({x:t,y:n.y2});for(let t=n.y1+1;t<=n.y2-1;t++)e.push({x:n.x1,y:t}),n.x2!==n.x1&&e.push({x:n.x2,y:t});return e}function Cx(n){const{boundary:e,rand:t}=n,i=Math.max(0,Math.floor(n.count));if(!e.length||i<=0)return[];const o=[],a=[...e].sort(()=>t()-.5),c=4;for(const u of a){if(o.length>=i)break;o.every(h=>Math.abs(h.x-u.x)+Math.abs(h.y-u.y)>=c)&&o.push(u)}for(;o.length<i;)o.push(e[Math.floor(t()*e.length)]);return o.slice(0,i)}function Ax(n){var F,I,N,U,q;const{spec:e,ctx:t,rand:i}=n,o=Math.max(1,e.grid.cols),a=Math.max(1,e.grid.rows),c=Fa({cols:o,rows:a,reserved:new Set,seedPrefix:"obs"});c.log.push("Layout: donjon (salle carre/rectangulaire).");const u=((F=e.dungeon)==null?void 0:F.lighting)==="low"?.35:.8;for(let H=0;H<a;H++)for(let se=0;se<o;se++)Zs(c,se,H,"floor"),Ba(c,se,H,u);const h={x:1,y:Math.floor(a/2)};c.reserved=ja(h,2,o,a);const{wallType:f,pillarType:p,barrelType:g}=Sx(t),v=e.dungeon??{borderWalls:!0,entrances:{count:2},columns:0,hasAltar:!1},x={x1:0,y1:0,x2:o-1,y2:a-1},w=kx(x),S=Cx({boundary:w,count:((I=v.entrances)==null?void 0:I.count)??2,rand:i}),b=new Set(S.map(H=>tt(H.x,H.y)));for(const H of b)c.reserved.add(H);if(f&&v.borderWalls){const H=((N=(f.variants??[]).map(Z=>({id:Z.id,len:Array.isArray(Z.footprint)?Z.footprint.length:1})).sort((Z,Q)=>Z.len-Q.len)[0])==null?void 0:N.id)??((q=(U=f.variants)==null?void 0:U[0])==null?void 0:q.id)??"1";let se=0;for(const Z of w){if(b.has(tt(Z.x,Z.y)))continue;An({draft:c,type:f,x:Z.x,y:Z.y,variantId:H,rotation:0})&&se++}c.log.push(`Murs: ${se} segments (avec ${S.length} accs).`)}else c.log.push("Murs: aucun type de mur disponible.");const k=Math.max(0,v.columns??0);if(k>0){const H=p??f;let se=0,Z=0;for(;se<k&&Z<300;){Z++;const Q=Ye(1+Math.floor(i()*Math.max(1,o-2)),1,Math.max(1,o-2)),ae=Ye(1+Math.floor(i()*Math.max(1,a-2)),1,Math.max(1,a-2)),G=H?Zn(H,"scatter",i):"base";An({draft:c,type:H,x:Q,y:ae,variantId:G,rotation:0})&&se++}c.log.push(`Colonnes: ${se}/${k}.`)}if(v.hasAltar){const H=g??p??null;if(H){const se=Zn(H,"room",i),Z=Math.floor(o/2),Q=Math.floor(a/2),ae=An({draft:c,type:H,x:Z,y:Q,variantId:se,rotation:0});c.log.push(ae?"Autel: plac au centre.":"Autel: placement impossible (collision).")}else c.log.push("Autel: aucun type d'obstacle appropri.")}const A=Aa(t.obstacleTypes,H=>H.category!=="wall"),M=Ye(Math.floor(o*a/120),0,6);let E=0,B=0;for(;E<M&&B<300;){B++;const H=pi(A,i)??null;if(!H)break;const se=Ye(1+hi(i,0,Math.max(0,o-3)),1,Math.max(1,o-2)),Z=Ye(1+hi(i,0,Math.max(0,a-3)),1,Math.max(1,a-2)),Q=Zn(H,"scatter",i);An({draft:c,type:H,x:se,y:Z,variantId:Q,rotation:0})&&E++}return E&&c.log.push(`Props: +${E}.`),{draft:c,playerStart:h}}function U1(n,e,t,i){const o=n-t,a=e-i;return Math.sqrt(o*o+a*a)}function Tx(n){const{spec:e,ctx:t,rand:i}=n,o=Math.max(1,e.grid.cols),a=Math.max(1,e.grid.rows),c={x:1,y:Math.floor(a/2)},u=ja(c,2,o,a),h=Fa({cols:o,rows:a,reserved:u,seedPrefix:"obs"}),f=e.forest??{radius:Math.max(2,Math.floor(Math.min(o,a)*.3)),treesOnRing:"sparse",lighting:"day"},p=Ye(Math.floor(o*.6),0,o-1),g=Ye(Math.floor(a*.5),0,a-1),v=Math.max(2,f.radius);h.log.push("Layout: fort (clairire).");for(let N=0;N<a;N++)for(let U=0;U<o;U++)Zs(h,U,N,"grass");const x=f.lighting==="night"?.25:.9;for(let N=0;N<a;N++)for(let U=0;U<o;U++)Ba(h,U,N,x);const w=jr(t.obstacleTypes,"tree-oak")??t.obstacleTypes.find(N=>(N.tags??[]).includes("tree"))??t.obstacleTypes.find(N=>N.category==="vegetation")??null,S=Aa(t.obstacleTypes,N=>(N.tags??[]).includes("tree")||N.category==="vegetation"),b=f.treesOnRing==="dense"?1.8:1.2,k=f.treesOnRing==="dense"?.55:.3;let A=0,M=0;const E=Ye(Math.floor(o*a*k*.12),3,14);for(;A<E&&M<400;){M++;const N=Math.floor(i()*o),U=Math.floor(i()*a);if(Math.abs(N-c.x)+Math.abs(U-c.y)<=2)continue;const q=U1(N,U,p,g);if(!(q>=v-b&&q<=v+b))continue;const se=pi(S,i)??w;if(!se)break;const Z=Zn(se,"scatter",i),Q=(se.variants??[]).find(V=>V.id===Z)??null,ae=Q!=null&&Q.rotatable?pi([{item:0,weight:1},{item:90,weight:1},{item:180,weight:1},{item:270,weight:1}],i)??0:0;An({draft:h,type:se,x:N,y:U,variantId:Z,rotation:ae})&&A++}h.log.push(`Arbres: ${A} (anneau de clairire).`);const B=Aa(t.obstacleTypes,N=>N.category!=="wall"&&N.category!=="vegetation"),F=Ye(Math.floor(o*a/80),0,3);let I=0;for(M=0;I<F&&M<150;){M++;const N=Ye(p+hi(i,-v+1,v-1),0,o-1),U=Ye(g+hi(i,-v+1,v-1),0,a-1);if(U1(N,U,p,g)>v-1)continue;const H=pi(B,i)??null;if(!H)break;const se=Zn(H,"scatter",i);An({draft:h,type:H,x:N,y:U,variantId:se,rotation:0})&&I++}return I&&h.log.push(`Props: +${I}.`),{draft:h,playerStart:c}}function Mx(n){const{spec:e,ctx:t,rand:i}=n,o=Math.max(1,e.grid.cols),a=Math.max(1,e.grid.rows),c={x:1,y:Math.floor(a/2)},u=ja(c,2,o,a),h=Fa({cols:o,rows:a,reserved:u,seedPrefix:"obs"}),f=e.city??{streetWidth:2,buildingDepth:2,doors:"closed",lighting:"day"};h.log.push("Layout: ville (rue).");const p=f.lighting==="night"?.25:.9;for(let I=0;I<a;I++)for(let N=0;N<o;N++)Ba(h,N,I,p),Zs(h,N,I,"road");const g=jr(t.obstacleTypes,"wall-stone")??t.obstacleTypes.find(I=>I.category==="wall")??t.obstacleTypes[0]??null;if(!g)return h.log.push("Maisons: aucun type de mur disponible."),{draft:h,playerStart:c};const v=Ye(Math.floor(f.streetWidth),1,Math.max(1,a-2)),x=Ye(Math.floor(f.buildingDepth),1,Math.max(1,Math.floor(a/2)-1)),w=Ye(Math.floor(a/2),0,a-1),S=Ye(w-Math.floor(v/2),0,a-1),b=Ye(S+v-1,0,a-1);for(let I=S;I<=b;I++)for(let N=0;N<o;N++)Zs(h,N,I,"road");const k=Ye(S-1,0,a-1),A=Ye(k-x+1,0,a-1),M=Ye(b+1,0,a-1),E=Ye(M+x-1,0,a-1);let B=0;const F=(I,N,U)=>{for(let q=N;q<=U;q++){const H=Zn(g,"line",i),se=g0(g,H);An({draft:h,type:g,x:q,y:I,variantId:H,rotation:se})&&B++}};return k>=0&&k<a&&F(k,0,o-1),M>=0&&M<a&&F(M,0,o-1),A!==k&&A>=0&&A<a&&F(A,0,o-1),E!==M&&E>=0&&E<a&&F(E,0,o-1),h.log.push(`Maisons: ${B} segments de murs (portes ${f.doors==="closed"?"fermes":"ouvertes"}).`),{draft:h,playerStart:c}}function Px(n){const{spec:e,ctx:t,rand:i}=n,o=Math.max(1,e.grid.cols),a=Math.max(1,e.grid.rows),c={x:1,y:Math.floor(a/2)},u=ja(c,2,o,a),h=Fa({cols:o,rows:a,reserved:u,seedPrefix:"obs"});h.log.push("Layout: basique (scatter).");for(let x=0;x<a;x++)for(let w=0;w<o;w++)Zs(h,w,x,"floor"),Ba(h,w,x,.75);const f=jr(t.obstacleTypes,"barrel-wood")??t.obstacleTypes.find(x=>(x.tags??[]).includes("barrel"))??null,p=Aa(t.obstacleTypes,x=>x.category!=="wall"),g=Ye(Math.floor(o*a/18),1,8);let v=0;for(let x=0;x<g;x++){const w=pi(p,i)??f;if(!w)break;const S=Math.floor(i()*o),b=Math.floor(i()*a);if(S===c.x&&b===c.y)continue;const k=Zn(w,"scatter",i);An({draft:h,type:w,x:S,y:b,variantId:k,rotation:0})&&v++}return h.log.push(`Props: ${v}.`),{draft:h,playerStart:c}}function Ex(n){const{spec:e,notes:t}=ax({prompt:n.prompt,cols:n.grid.cols,rows:n.grid.rows}),i=cx(n.prompt||"default"),o=lx(i);return{spec:e,notes:t,rand:o}}function Rx(n){const{spec:e,ctx:t,rand:i}=n;switch(e.layoutId){case"dungeon_circular_room":return bx({spec:e,ctx:t,rand:i});case"dungeon_square_room":return Ax({spec:e,ctx:t,rand:i});case"forest_clearing":return Tx({spec:e,ctx:t,rand:i});case"city_street":return Mx({spec:e,ctx:t,rand:i});default:return Px({spec:e,ctx:t,rand:i})}}function Ix(n){const{spec:e,notes:t,rand:i}=Ex(n),o=yx({spec:e,enemyCount:n.ctx.enemyCount}),{draft:a,playerStart:c}=Rx({spec:e,ctx:n.ctx,rand:i}),{enemySpawns:u,log:h}=gx({draft:a,playerStart:c,enemyCount:n.ctx.enemyCount,enemyTypes:n.ctx.enemyTypes,rand:i}),f=[],p=[];return e.prompt.trim()&&f.push(`Prompt: ${e.prompt.trim()}`),f.push(e.layoutId==="dungeon_circular_room"?"Layout: donjon (salle circulaire).":e.layoutId==="dungeon_square_room"?"Layout: donjon (salle carre).":e.layoutId==="forest_clearing"?"Layout: foret (clairiere).":e.layoutId==="city_street"?"Layout: ville (rue).":"Layout: basique."),f.push(`Obstacles: ${a.obstacles.length}. Ennemis: ${u.length}.`),p.push(...t.map(g=>`[spec] ${g}`)),o&&p.push(`[spec] recommendedGrid=${o.cols}x${o.rows} (${o.reason})`),p.push(...a.log.map(g=>`[gen] ${g}`)),p.push(...h.map(g=>`[spawn] ${g}`)),{summaryParts:f,generationLog:p,playerStart:c,enemySpawns:u,playableCells:Array.from(a.playable),obstacles:a.obstacles,recommendedGrid:o??void 0}}function G1(n){const e=Math.max(1,n.grid.cols),t=Math.max(1,n.grid.rows),i=Ix({prompt:String(n.prompt??""),grid:{cols:e,rows:t},ctx:{enemyCount:n.enemyCount,enemyTypes:n.enemyTypes,obstacleTypes:n.obstacleTypes}});return{summary:i.summaryParts.join(" "),playerStart:i.playerStart,enemySpawns:i.enemySpawns,playableCells:i.playableCells,obstacles:i.obstacles,recommendedGrid:i.recommendedGrid,generationLog:i.generationLog}}const $x=["./melee-strike.json","./dash.json","./second-wind.json","./throw-dagger.json","./enemy-move.json","./enemy-melee-strike.json","./enemy-bow-shot.json"],V1={actions:$x},Lx="melee-strike",zx="Frappe basique",Fx="Attaque de melee simple contre une cible a 1 case.",jx="attack",Bx={actionType:"action",movementCost:0},Dx={target:"enemy",range:{min:0,max:1,shape:"single"},maxTargets:1,requiresLos:!0},Ox={perTurn:1,perEncounter:null,resource:null},Nx=[{type:"phase",mustBe:"player",reason:"Tour joueur requis."},{type:"distance_max",target:"primary",max:1,reason:"Portee de melee uniquement."},{type:"target_alive",target:"primary",reason:"La cible doit avoir des PV restants."}],Wx={bonus:5,critRange:20},Hx={formula:"1d6+3",critRule:"double-dice",damageType:"slashing"},Ux=[{type:"damage",target:"primary",formula:"1d6 + modFOR",damageType:"slashing"},{type:"log",message:"Frappe basique inflige 1d6+FOR a la cible."}],Gx={priority:"finish_low_hp_target",successLog:"Attaque de melee effectuee.",failureLog:"Cible hors portee ou deja a terre."},Vx=["martial","arme","starter"],Yx={id:Lx,name:zx,summary:Fx,category:jx,actionCost:Bx,targeting:Dx,usage:Ox,conditions:Nx,attack:Wx,damage:Hx,effects:Ux,aiHints:Gx,tags:Vx},Xx="dash",qx="Course",Kx="Transforme l'action en 3 cases de mouvement en plus.",Qx="movement",Zx={actionType:"action",movementCost:0},Jx={target:"self",range:{min:0,max:0,shape:"self"},maxTargets:1,requiresLos:!1},e3={perTurn:1,perEncounter:null,resource:null},t3=[{type:"phase",mustBe:"player",reason:"Tour joueur requis."}],n3=[{type:"modify_path_limit",target:"self",delta:3,duration:"this_turn"},{type:"log",message:"Course: +3 cases de mouvement pour ce tour."}],r3={priority:"close_gap",successLog:"Course utilisee pour approcher.",failureLog:"Deja a portee, course ignoree."},i3=["mobilite","deplacement"],s3={id:Xx,name:qx,summary:Kx,category:Qx,actionCost:Zx,targeting:Jx,usage:e3,conditions:t3,effects:n3,aiHints:r3,tags:i3},o3="second-wind",a3="Second souffle",l3="Restaure une partie des PV en bonus action.",c3="support",u3={actionType:"bonus",movementCost:0},d3={target:"self",range:{min:0,max:0,shape:"self"},maxTargets:1,requiresLos:!1},h3={perTurn:null,perEncounter:1,resource:null},f3=[{type:"phase",mustBe:"player",reason:"Tour joueur requis."},{type:"stat_below_percent",who:"self",stat:"hp",percentMax:.75,reason:"Economiser tant que les PV sont hauts."}],p3=[{type:"heal",target:"self",formula:"1d10 + niveau",min:1},{type:"temp_hp",target:"self",amount:2,duration:"end_of_turn"},{type:"log",message:"Second souffle: soigne 1d10 + niveau."}],m3={priority:"survive",successLog:"Second souffle declenche.",failureLog:"PV trop hauts ou tour non joueur."},g3=["soin","defense","survie"],y3={id:o3,name:a3,summary:l3,category:c3,actionCost:u3,targeting:d3,usage:h3,conditions:f3,effects:p3,aiHints:m3,tags:g3},x3="throw-dagger",v3="Lancer de dague",_3="Attaque a distance courte avec une dague a lancer.",w3="attack",b3={actionType:"action",movementCost:0},S3={target:"enemy",range:{min:1,max:4,shape:"single"},maxTargets:1,requiresLos:!0},k3={perTurn:1,perEncounter:null,resource:{name:"dagger",pool:"bandolier",min:1}},C3=[{type:"phase",mustBe:"player",reason:"Tour joueur requis."},{type:"distance_between",target:"primary",min:1,max:4,reason:"Hors de melee mais a portee de lancer."},{type:"resource_at_least",resource:"dagger",pool:"bandolier",value:1,reason:"Besoin d'une dague a lancer."}],A3={bonus:4,critRange:20},T3={formula:"1d4+2",critRule:"double-dice",damageType:"piercing"},M3=[{type:"damage",target:"primary",formula:"1d4 + modDEX",damageType:"piercing"},{type:"resource_spend",resource:"dagger",pool:"bandolier",amount:1},{type:"log",message:"Dague lancee: 1d4+DEX degats perforants."}],P3={priority:"poke_from_range",successLog:"Dague lancee.",failureLog:"Pas de dague ou cible hors portee."},E3=["distance","arme","jet"],R3={id:x3,name:v3,summary:_3,category:w3,actionCost:b3,targeting:S3,usage:k3,conditions:C3,attack:A3,damage:T3,effects:M3,aiHints:P3,tags:E3},I3="enemy-move",$3="Deplacement (ennemi)",L3="Deplacement tactique vers une case cible (portee base: moveRange).",z3="movement",F3={actionType:"action",movementCost:0},j3={target:"emptyCell",range:{min:1,max:3,shape:"single"},maxTargets:1,requiresLos:!1},B3={perTurn:1,perEncounter:null,resource:null},D3=[],O3=[{type:"move_to",target:"self",maxSteps:"moveRange"},{type:"log",message:"L'ennemi se deplace."}],N3={priority:"positioning",successLog:"Deplacement.",failureLog:"Aucun chemin valide."},W3=["enemy","movement"],H3={id:I3,name:$3,summary:L3,category:z3,actionCost:F3,targeting:j3,usage:B3,conditions:D3,effects:O3,aiHints:N3,tags:W3},U3="enemy-melee-strike",G3="Frappe (ennemi)",V3="Attaque de melee simple contre le joueur a 1 case.",Y3="attack",X3={actionType:"action",movementCost:0},q3={target:"player",range:{min:0,max:1,shape:"single"},maxTargets:1,requiresLos:!0},K3={perTurn:1,perEncounter:null,resource:null},Q3=[{type:"target_alive",target:"primary",reason:"Le joueur doit etre en vie."}],Z3={bonus:4,critRange:20},J3={formula:"attackDamage",critRule:"double-dice",damageType:"slashing"},e5=[{type:"damage",target:"primary",formula:"attackDamage",damageType:"slashing"},{type:"log",message:"L'ennemi frappe au contact."}],t5={priority:"finish_low_hp_target",successLog:"Frappe au contact.",failureLog:"Joueur hors portee ou non visible."},n5=["enemy","melee"],r5={id:U3,name:G3,summary:V3,category:Y3,actionCost:X3,targeting:q3,usage:K3,conditions:Q3,attack:Z3,damage:J3,effects:e5,aiHints:t5,tags:n5},i5="enemy-bow-shot",s5="Tir a l'arc (ennemi)",o5="Tir a distance contre le joueur, prefere eviter la melee.",a5="attack",l5={actionType:"action",movementCost:0},c5={target:"player",range:{min:2,max:6,shape:"single"},maxTargets:1,requiresLos:!0},u5={perTurn:1,perEncounter:null,resource:null},d5=[{type:"target_alive",target:"primary",reason:"Le joueur doit etre en vie."}],h5={bonus:5,critRange:20},f5={formula:"attackDamage",critRule:"double-dice",damageType:"piercing"},p5=[{type:"damage",target:"primary",formula:"attackDamage",damageType:"piercing"},{type:"log",message:"Une fleche siffle dans l'air."}],m5={priority:"poke_from_range",successLog:"Tir a l'arc.",failureLog:"Joueur hors portee/ligne de vue ou trop proche."},g5=["enemy","distance","bow"],y5={id:i5,name:s5,summary:o5,category:a5,actionCost:l5,targeting:c5,usage:u5,conditions:d5,attack:h5,damage:f5,effects:p5,aiHints:m5,tags:g5};function Gs(n,e=1){const t=[];for(let o=0;o<e;o++)t.push(1+Math.floor(Math.random()*n));const i=t.reduce((o,a)=>o+a,0);return{rolls:t,total:i}}function x0(n,e="normal",t=20){if(e==="advantage"){const o=Gs(20),a=Gs(20),c=Math.max(o.total,a.total);return{d20:{rolls:[o.total,a.total],total:c},bonus:n,total:c+n,mode:e,isCrit:c>=t}}if(e==="disadvantage"){const o=Gs(20),a=Gs(20),c=Math.min(o.total,a.total);return{d20:{rolls:[o.total,a.total],total:c},bonus:n,total:c+n,mode:e,isCrit:c>=t}}const i=Gs(20);return{d20:i,bonus:n,total:i.total+n,mode:e,isCrit:i.total>=t}}function x5(n){const e=[],i=n.replace(/\s+/g,"").split(/(?=[+-])/);for(const o of i){if(!o)continue;const a=o.startsWith("-")?-1:1,c=o.replace(/^[+-]/,""),u=c.match(/^(\d*)d(\d+)$/i);if(u){const f=u[1]?parseInt(u[1],10):1,p=parseInt(u[2],10);e.push({diceCount:a*f,diceSides:p,modifier:0});continue}const h=parseInt(c,10);Number.isNaN(h)||e.push({diceCount:0,diceSides:0,modifier:a*h})}return e}function Nd(n,e){const t=!!(e!=null&&e.isCrit),i=(e==null?void 0:e.critRule)??"double-dice",o=x5(n),a=[];let c=0;for(const f of o)if(f.diceCount!==0&&f.diceSides>0){const p=Math.abs(f.diceCount),g=t&&i==="double-dice"?p*2:p,v=Gs(f.diceSides,g);a.push(f.diceCount<0?{rolls:v.rolls,total:-v.total}:v)}else c+=f.modifier;let h=a.reduce((f,p)=>f+p.total,0)+c;return t&&i==="double-total"&&(h*=2),{dice:a,flatModifier:c,total:h,formula:n,isCrit:t}}function pc(n,e){return`${n},${e}`}function v5(n){return n.movementProfile?n.movementProfile:typeof n.moveRange=="number"?{type:"ground",speed:n.moveRange,canPassThroughWalls:!1,canPassThroughEntities:!1,canStopOnOccupiedTile:!1}:null}function _5(n,e,t,i,o,a,c,u,h,f){const p=(f==null?void 0:f.cols)??La,g=(f==null?void 0:f.rows)??Qs;if(!za(t,i,p,g))return!1;const v=pc(t,i);if(h&&h.size>0&&!h.has(v))return!1;const x=t===c.x&&i===c.y;return u!=null&&u.has(v)&&!(e!=null&&e.canPassThroughWalls)?!1:!o.some(S=>S.id!==n.id&&S.hp>0&&S.x===t&&S.y===i)||x&&a?!0:e&&e.canPassThroughEntities?!(x&&e.canStopOnOccupiedTile===!1):!1}function mc(n,e,t,i){const o=v5(n),a=o&&o.speed>0?Math.min(i.maxDistance,o.speed):i.maxDistance,c={x:n.x,y:n.y};if(c.x===e.x&&c.y===e.y)return[];const u=new Set,h=new Map,f=new Map,p=[],g=pc(c.x,c.y);u.add(g),h.set(g,null),f.set(g,0),p.push(c);let v=null;const x=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(;p.length>0;){const M=p.shift(),E=pc(M.x,M.y),B=f.get(E)??0;if(!(B>=a))for(const F of x){const I=M.x+F.x,N=M.y+F.y,U=pc(I,N);if(u.has(U)||!_5(n,o,I,N,t,i.allowTargetOccupied??!1,e,i.blockedCells??null,i.playableCells??null,i.grid??null))continue;u.add(U),h.set(U,E),f.set(U,B+1);const q={x:I,y:N};if(p.push(q),I===e.x&&N===e.y){v=U,p.length=0;break}}}let w=v;if(!w){let M=null,E=Number.POSITIVE_INFINITY;for(const B of u){const[F,I]=B.split(",").map(Number),N=Math.abs(F-e.x)+Math.abs(I-e.y),U=f.get(B)??0;U!==0&&(U>a||N<E&&(E=N,M=B))}if(!M)return[];w=M}const S=[];let b=w;for(;b;){const[M,E]=b.split(",").map(Number);if(S.push({x:M,y:E}),b===g)break;b=h.get(b)??null}const k=S.reverse(),A=a+1;return k.length>A?k.slice(0,A):k}function w5(n,e){var i,o,a,c,u,h,f,p,g,v;const t=e.actor;if(n.toLowerCase()==="attackdamage")return typeof t.attackDamage=="number"?t.attackDamage:0;if(n.toLowerCase()==="moverange")return typeof t.moveRange=="number"?t.moveRange:0;if(n.toLowerCase()==="attackrange")return typeof t.attackRange=="number"?t.attackRange:1;if(n.toLowerCase()==="niveau"){const x=Number(((i=e.sampleCharacter)==null?void 0:i.niveauGlobal)??1);return Number.isFinite(x)?x:1}if(n.toLowerCase()==="modfor"){const x=Number(((c=(a=(o=e.sampleCharacter)==null?void 0:o.caracs)==null?void 0:a.force)==null?void 0:c.modFOR)??0);return Number.isFinite(x)?x:0}if(n.toLowerCase()==="moddex"){const x=Number(((f=(h=(u=e.sampleCharacter)==null?void 0:u.caracs)==null?void 0:h.dexterite)==null?void 0:f.modDEX)??0);return Number.isFinite(x)?x:0}if(n.toLowerCase()==="modcon"){const x=Number(((v=(g=(p=e.sampleCharacter)==null?void 0:p.caracs)==null?void 0:g.constitution)==null?void 0:v.modCON)??0);return Number.isFinite(x)?x:0}return null}function Y1(n,e){const t=String(n??"");return t.trim()?t.replace(/[A-Za-z_][A-Za-z0-9_]*/g,i=>{const o=w5(i,e);return o===null?i:String(o)}):"0"}function b5(n,e,t){var i,o;return t.kind==="token"?t.token:((i=n.targeting)==null?void 0:i.target)==="player"?e.player:(((o=n.targeting)==null?void 0:o.target)==="enemy",null)}function S5(n,e,t){var c,u;const i=e.actor,o=[e.player,...e.enemies],a=n.targeting;if(!a)return{ok:!1,reason:"Action sans ciblage."};if(a.target==="self")return{ok:!0};if(a.target==="enemy"){if(t.kind!=="token"||t.token.type!=="enemy")return{ok:!1,reason:"Cible ennemi manquante."};const h=t.token;if(h.hp<=0)return{ok:!1,reason:"La cible est deja a terre."};const f=di(i,h),p=a.range;if(p){if(typeof p.min=="number"&&f<p.min)return{ok:!1,reason:`Cible trop proche pour ${n.name} (distance ${f}, min ${p.min}).`};if(typeof p.max=="number"&&f>p.max)return{ok:!1,reason:`Cible hors portee pour ${n.name} (distance ${f}, max ${p.max}).`}}for(const g of n.conditions||[]){if(g.type==="target_alive"&&h.hp<=0)return{ok:!1,reason:g.reason||"La cible doit avoir des PV restants."};if(g.type==="distance_max"&&typeof g.max=="number"&&f>g.max)return{ok:!1,reason:g.reason||`Distance cible > ${g.max}.`};if(g.type==="distance_between"){const v=typeof g.min=="number"?g.min:(p==null?void 0:p.min)??null,x=typeof g.max=="number"?g.max:(p==null?void 0:p.max)??null;if(v!==null&&f<v)return{ok:!1,reason:g.reason||`Distance cible < ${v}.`};if(x!==null&&f>x)return{ok:!1,reason:g.reason||`Distance cible > ${x}.`}}}if(a.requiresLos){if(!_c(i,h,o,e.blockedVisionCells??null,e.playableCells??null))return{ok:!1,reason:"Cible hors vision (ligne de vue requise)."};if(!ka({x:i.x,y:i.y},{x:h.x,y:h.y},e.blockedAttackCells??null))return{ok:!1,reason:"Trajectoire bloquee (obstacle entre l'attaquant et la cible)."}}return{ok:!0}}if(a.target==="player"){const h=e.player;if(h.hp<=0)return{ok:!1,reason:"Le joueur est deja a terre."};const f=di(i,h),p=a.range;if(p){if(typeof p.min=="number"&&f<p.min)return{ok:!1,reason:`Cible trop proche pour ${n.name} (distance ${f}, min ${p.min}).`};if(typeof p.max=="number"&&f>p.max)return{ok:!1,reason:`Cible hors portee pour ${n.name} (distance ${f}, max ${p.max}).`}}for(const g of n.conditions||[]){if(g.type==="target_alive"&&h.hp<=0)return{ok:!1,reason:g.reason||"La cible doit avoir des PV restants."};if(g.type==="distance_max"&&typeof g.max=="number"&&f>g.max)return{ok:!1,reason:g.reason||`Distance cible > ${g.max}.`};if(g.type==="distance_between"){const v=typeof g.min=="number"?g.min:(p==null?void 0:p.min)??null,x=typeof g.max=="number"?g.max:(p==null?void 0:p.max)??null;if(v!==null&&f<v)return{ok:!1,reason:g.reason||`Distance cible < ${v}.`};if(x!==null&&f>x)return{ok:!1,reason:g.reason||`Distance cible > ${x}.`}}}if(a.requiresLos){if(!_c(i,h,o,e.blockedVisionCells??null,e.playableCells??null))return{ok:!1,reason:"Cible hors vision (ligne de vue requise)."};if(!ka({x:i.x,y:i.y},{x:h.x,y:h.y},e.blockedAttackCells??null))return{ok:!1,reason:"Trajectoire bloquee (obstacle entre l'attaquant et la cible)."}}return{ok:!0}}if(a.target==="emptyCell"||a.target==="cell"){if(t.kind!=="cell")return{ok:!1,reason:"Cible de case manquante."};const h=((c=e.grid)==null?void 0:c.cols)??La,f=((u=e.grid)==null?void 0:u.rows)??Qs;if(!za(t.x,t.y,h,f))return{ok:!1,reason:"Case hors plateau."};if(e.playableCells&&e.playableCells.size>0){const p=`${t.x},${t.y}`;if(!e.playableCells.has(p))return{ok:!1,reason:"Case hors zone jouable."}}return{ok:!0}}return{ok:!1,reason:"Type de ciblage non supporte."}}function k5(n,e){var a;const t=[],i=[];for(const c of n.conditions||[])c.type==="phase"&&c.mustBe&&c.mustBe!==e.phase&&t.push(c.reason||"Phase incorrecte.");const o=(a=n.usage)==null?void 0:a.resource;if(e.getResourceAmount&&(o!=null&&o.name)&&typeof o.min=="number"){const c=e.getResourceAmount(o.name,o.pool??null);if(c<o.min){const u=o.pool?` (${o.pool})`:"";t.push(`Ressource insuffisante: ${o.name}${u} (${c}/${o.min}).`)}}return{enabled:t.length===0,reasons:t,details:i}}function C5(n,e,t,i){var x,w,S,b;const o=[],a=k=>{var A;o.push(k),(A=e.onLog)==null||A.call(e,k)},c=k5(n,e);if(!c.enabled)return{ok:!1,reason:c.reasons.join(" | "),logs:o};const u=S5(n,e,t);if(!u.ok)return{ok:!1,reason:u.reason,logs:o};const h={...e.actor};let f={...e.player};const p=e.enemies.map(k=>({...k})),g=k=>{var A;(A=e.emitEvent)==null||A.call(e,k)},v=()=>{if(h.type!=="enemy")return;const k=p.findIndex(A=>A.id===h.id);k>=0&&(p[k]=h)};for(const k of n.effects||[]){if(k.type==="log"&&typeof k.message=="string"){a(k.message);continue}if(k.type==="resource_spend"&&k.resource&&e.spendResource){const A=typeof k.pool=="string"?k.pool:null,M=typeof k.amount=="number"?k.amount:1;e.spendResource(String(k.resource),A,M);continue}if(k.type==="damage"&&k.target==="primary"){const A=b5(n,e,t);if(!A)continue;const M=(i==null?void 0:i.advantageMode)??"normal",E=((x=n.damage)==null?void 0:x.critRule)??"double-dice",B=Y1(k.formula??((w=n.damage)==null?void 0:w.formula)??"0",e);let F=!0,I=!1,N=null,U=null;const q=typeof A.armorClass=="number"?A.armorClass:null;if(U=q,n.attack){const ae=x0(n.attack.bonus,M,n.attack.critRange??20);I=ae.isCrit,N=ae.total,q!==null&&(F=ae.total>=q||ae.isCrit);const G=ae.mode==="normal"?`${ae.d20.total}`:`${ae.d20.rolls.join(" / ")} -> ${ae.d20.total}`;a(`Jet de touche (${n.name}) : ${G} + ${ae.bonus} = ${ae.total}`+(q!==null?` vs CA ${q}`:"")+(ae.isCrit?" (critique!)":""))}if(!F){a(`L'attaque (${n.name}) rate sa cible. Pas de degats.`);const ae=h.type==="enemy"?"enemy_attack":"player_attack";g({kind:ae,actorId:h.id,actorKind:h.type,targetId:A.id,targetKind:A.type,summary:`${h.id} rate ${A.id} avec ${n.name}.`,data:{actionId:n.id,actionName:n.name,isHit:!1,isCrit:!1,damage:0,attackRollTotal:N,targetArmorClass:U}});continue}const H=Nd(B,{isCrit:I,critRule:E}),se=A.hp,Z=Math.max(0,se-H.total);if(A.type==="player")f={...f,hp:Z},a(`${n.name} inflige ${H.total} degats au joueur (PV ${se} -> ${Z}).`);else{const ae=p.findIndex(G=>G.id===A.id);ae>=0&&(p[ae]={...p[ae],hp:Z},a(`${n.name} inflige ${H.total} degats a ${A.id} (PV ${se} -> ${Z}).`))}const Q=h.type==="enemy"?"enemy_attack":"player_attack";g({kind:Q,actorId:h.id,actorKind:h.type,targetId:A.id,targetKind:A.type,summary:H.total>0?`${h.id} touche ${A.id} avec ${n.name} et inflige ${H.total} degats (PV ${se} -> ${Z}).`:`${h.id} touche ${A.id} avec ${n.name} (pas de degats).`,data:{actionId:n.id,actionName:n.name,isHit:!0,isCrit:I,damage:H.total,damageFormula:H.formula,attackRollTotal:N,targetArmorClass:U,targetHpBefore:se,targetHpAfter:Z}}),g({kind:"damage",actorId:h.id,actorKind:h.type,targetId:A.id,targetKind:A.type,summary:`${A.id} subit ${H.total} degats (${n.name}).`,data:{sourceActionId:n.id,sourceActionName:n.name,damage:H.total,isCrit:I,targetHpBefore:se,targetHpAfter:Z}});continue}if(k.type==="move_to"&&k.target==="self"){if(t.kind!=="cell")return{ok:!1,reason:"Move: cible de case manquante.",logs:o};const A=k.maxSteps;let M=null;if(typeof A=="number")M=A;else if(typeof A=="string"){const se=Y1(A,e),Z=Number.parseInt(se,10);M=Number.isFinite(Z)?Z:null}M===null&&(M=typeof h.moveRange=="number"?h.moveRange:3);const E=((S=e.grid)==null?void 0:S.cols)??La,B=((b=e.grid)==null?void 0:b.rows)??Qs,F=wc(t.x,0,E-1),I=wc(t.y,0,B-1);if(!za(F,I,E,B))return{ok:!1,reason:"Move: case hors plateau.",logs:o};if(e.playableCells&&e.playableCells.size>0){const se=`${F},${I}`;if(!e.playableCells.has(se))return{ok:!1,reason:"Move: case hors zone jouable.",logs:o}}const N=[f,...p],U=mc(h,{x:F,y:I},N,{maxDistance:Math.max(0,M),allowTargetOccupied:!1,blockedCells:e.blockedMovementCells??null,playableCells:e.playableCells??null,grid:e.grid??null});if(h.plannedPath=U,U.length===0)return{ok:!1,reason:"Move: aucun chemin valide.",logs:o};const q={x:h.x,y:h.y},H=U[U.length-1];h.x=H.x,h.y=H.y,v(),a(`${h.id} se deplace vers (${H.x}, ${H.y}).`),g({kind:"move",actorId:h.id,actorKind:h.type,summary:`${h.id} se deplace de (${q.x}, ${q.y}) vers (${H.x}, ${H.y}).`,data:{actionId:n.id,actionName:n.name,from:q,to:H,path:U}});continue}}return v(),{ok:!0,logs:o,actorAfter:h,playerAfter:f,enemiesAfter:p}}function Kl(n,e){return e.find(t=>t.hp>0&&t.x===n.x&&t.y===n.y)??null}const Qe={active:!1,round:null,stateStart:null,events:[],enemySpeeches:[],lastSpeechByEnemyThisRound:new Map};let A5=0;const v0=new Map;function T5(n,e){Qe.active=!0,Qe.round=n,Qe.stateStart=e,Qe.events=[],Qe.enemySpeeches=[],Qe.lastSpeechByEnemyThisRound=new Map}function kn(n){if(!Qe.active||Qe.round!==null&&n.round!==Qe.round)return;const e={id:`evt-${Date.now()}-${A5++}`,round:n.round,phase:n.phase,kind:n.kind,actorId:n.actorId,actorKind:n.actorKind,targetId:n.targetId??null,targetKind:n.targetKind??null,summary:n.summary,data:n.data??{},timestamp:Date.now()};Qe.events.push(e)}function M5(n,e){if(!Qe.active)return;const t=(e??"").trim();t&&(Qe.enemySpeeches.push({enemyId:n,line:t}),Qe.lastSpeechByEnemyThisRound.set(n,t),v0.set(n,t),Qe.round!==null&&kn({round:Qe.round,phase:"enemies",kind:"speech",actorId:n,actorKind:"enemy",summary:`${n} dit: "${t}"`,data:{line:t}}))}function P5(){return Qe.enemySpeeches.slice()}function E5(n){return v0.get(n)??null}function R5(n){return!Number.isFinite(n)||n<=0?Qe.events.slice():Qe.events.slice(-Math.floor(n))}function I5(n){return!Qe.active||!Qe.stateStart||Qe.round===null?null:{language:"fr",focusSide:"player",focusActorId:n.focusActorId,stateStart:Qe.stateStart,stateEnd:n.stateEnd,events:Qe.events.slice(),enemySpeeches:Qe.enemySpeeches.slice()}}function $5(){Qe.active=!1,Qe.round=null,Qe.stateStart=null,Qe.events=[],Qe.enemySpeeches=[],Qe.lastSpeechByEnemyThisRound=new Map}async function L5(n){const e=await fetch("/api/narration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)return{summary:"",error:"IA non fonctionnel."};const t=await e.json();return!t||typeof t.summary!="string"?{summary:"",error:"IA non fonctionnel."}:t.error&&typeof t.error=="string"?{summary:"",error:t.error}:{summary:t.summary}}async function z5(n){const e=await fetch("/api/enemy-speech",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)return{line:""};const t=await e.json();return!t||typeof t.line!="string"?{line:""}:{line:t.line}}const F5="modulepreload",j5=function(n){return"/"+n},X1={},bc=function(e,t,i){let o=Promise.resolve();if(t&&t.length>0){let c=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),h=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));o=c(t.map(f=>{if(f=j5(f),f in X1)return;X1[f]=!0;const p=f.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":F5,p||(v.as="script"),v.crossOrigin="",v.href=f,h&&v.setAttribute("nonce",h),document.head.appendChild(v),p)return new Promise((x,w)=>{v.addEventListener("load",x),v.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return o.then(c=>{for(const u of c||[])u.status==="rejected"&&a(u.reason);return e().catch(a)})};var be=(n=>(n.Application="application",n.WebGLPipes="webgl-pipes",n.WebGLPipesAdaptor="webgl-pipes-adaptor",n.WebGLSystem="webgl-system",n.WebGPUPipes="webgpu-pipes",n.WebGPUPipesAdaptor="webgpu-pipes-adaptor",n.WebGPUSystem="webgpu-system",n.CanvasSystem="canvas-system",n.CanvasPipesAdaptor="canvas-pipes-adaptor",n.CanvasPipes="canvas-pipes",n.Asset="asset",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser",n.MaskEffect="mask-effect",n.BlendMode="blend-mode",n.TextureSource="texture-source",n.Environment="environment",n.ShapeBuilder="shape-builder",n.Batcher="batcher",n))(be||{});const Wd=n=>{if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");n={...typeof n.extension!="object"?{type:n.extension}:n.extension,ref:n}}if(typeof n=="object")n={...n};else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},Ql=(n,e)=>Wd(n).priority??e,Wt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...n){return n.map(Wd).forEach(e=>{e.type.forEach(t=>{var i,o;return(o=(i=this._removeHandlers)[t])==null?void 0:o.call(i,e)})}),this},add(...n){return n.map(Wd).forEach(e=>{e.type.forEach(t=>{var a,c;const i=this._addHandlers,o=this._queue;i[t]?(c=i[t])==null||c.call(i,e):(o[t]=o[t]||[],(a=o[t])==null||a.push(e))})}),this},handle(n,e,t){var c;const i=this._addHandlers,o=this._removeHandlers;if(i[n]||o[n])throw new Error(`Extension type ${n} already has a handler`);i[n]=e,o[n]=t;const a=this._queue;return a[n]&&((c=a[n])==null||c.forEach(u=>e(u)),delete a[n]),this},handleByMap(n,e){return this.handle(n,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByNamedList(n,e,t=-1){return this.handle(n,i=>{e.findIndex(a=>a.name===i.name)>=0||(e.push({name:i.name,value:i.ref}),e.sort((a,c)=>Ql(c.value,t)-Ql(a.value,t)))},i=>{const o=e.findIndex(a=>a.name===i.name);o!==-1&&e.splice(o,1)})},handleByList(n,e,t=-1){return this.handle(n,i=>{e.includes(i.ref)||(e.push(i.ref),e.sort((o,a)=>Ql(a,t)-Ql(o,t)))},i=>{const o=e.indexOf(i.ref);o!==-1&&e.splice(o,1)})},mixin(n,...e){for(const t of e)Object.defineProperties(n.prototype,Object.getOwnPropertyDescriptors(t))}},B5={extension:{type:be.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await bc(()=>import("./browserAll-D6jP1EA4.js"),__vite__mapDeps([0,1,2]))}},D5={extension:{type:be.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await bc(()=>import("./webworkerAll-DJhLh9F_.js"),__vite__mapDeps([1,2]))}};class Nt{constructor(e,t,i){this._x=t||0,this._y=i||0,this._observer=e}clone(e){return new Nt(e??this._observer,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var pd={exports:{}},q1;function O5(){return q1||(q1=1,(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function o(h,f,p){this.fn=h,this.context=f,this.once=p||!1}function a(h,f,p,g,v){if(typeof p!="function")throw new TypeError("The listener must be a function");var x=new o(p,g||h,v),w=t?t+f:f;return h._events[w]?h._events[w].fn?h._events[w]=[h._events[w],x]:h._events[w].push(x):(h._events[w]=x,h._eventsCount++),h}function c(h,f){--h._eventsCount===0?h._events=new i:delete h._events[f]}function u(){this._events=new i,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],p,g;if(this._eventsCount===0)return f;for(g in p=this._events)e.call(p,g)&&f.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(p)):f},u.prototype.listeners=function(f){var p=t?t+f:f,g=this._events[p];if(!g)return[];if(g.fn)return[g.fn];for(var v=0,x=g.length,w=new Array(x);v<x;v++)w[v]=g[v].fn;return w},u.prototype.listenerCount=function(f){var p=t?t+f:f,g=this._events[p];return g?g.fn?1:g.length:0},u.prototype.emit=function(f,p,g,v,x,w){var S=t?t+f:f;if(!this._events[S])return!1;var b=this._events[S],k=arguments.length,A,M;if(b.fn){switch(b.once&&this.removeListener(f,b.fn,void 0,!0),k){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,p),!0;case 3:return b.fn.call(b.context,p,g),!0;case 4:return b.fn.call(b.context,p,g,v),!0;case 5:return b.fn.call(b.context,p,g,v,x),!0;case 6:return b.fn.call(b.context,p,g,v,x,w),!0}for(M=1,A=new Array(k-1);M<k;M++)A[M-1]=arguments[M];b.fn.apply(b.context,A)}else{var E=b.length,B;for(M=0;M<E;M++)switch(b[M].once&&this.removeListener(f,b[M].fn,void 0,!0),k){case 1:b[M].fn.call(b[M].context);break;case 2:b[M].fn.call(b[M].context,p);break;case 3:b[M].fn.call(b[M].context,p,g);break;case 4:b[M].fn.call(b[M].context,p,g,v);break;default:if(!A)for(B=1,A=new Array(k-1);B<k;B++)A[B-1]=arguments[B];b[M].fn.apply(b[M].context,A)}}return!0},u.prototype.on=function(f,p,g){return a(this,f,p,g,!1)},u.prototype.once=function(f,p,g){return a(this,f,p,g,!0)},u.prototype.removeListener=function(f,p,g,v){var x=t?t+f:f;if(!this._events[x])return this;if(!p)return c(this,x),this;var w=this._events[x];if(w.fn)w.fn===p&&(!v||w.once)&&(!g||w.context===g)&&c(this,x);else{for(var S=0,b=[],k=w.length;S<k;S++)(w[S].fn!==p||v&&!w[S].once||g&&w[S].context!==g)&&b.push(w[S]);b.length?this._events[x]=b.length===1?b[0]:b:c(this,x)}return this},u.prototype.removeAllListeners=function(f){var p;return f?(p=t?t+f:f,this._events[p]&&c(this,p)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,n.exports=u})(pd)),pd.exports}var N5=O5();const er=lh(N5),W5=Math.PI*2,H5=180/Math.PI,U5=Math.PI/180;class Xt{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new Xt(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return md.x=0,md.y=0,md}}const md=new Xt;class Be{constructor(e=1,t=0,i=0,o=1,a=0,c=0){this.array=null,this.a=e,this.b=t,this.c=i,this.d=o,this.tx=a,this.ty=c}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,i,o,a,c){return this.a=e,this.b=t,this.c=i,this.d=o,this.tx=a,this.ty=c,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const i=t||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,t){t=t||new Xt;const i=e.x,o=e.y;return t.x=this.a*i+this.c*o+this.tx,t.y=this.b*i+this.d*o+this.ty,t}applyInverse(e,t){t=t||new Xt;const i=this.a,o=this.b,a=this.c,c=this.d,u=this.tx,h=this.ty,f=1/(i*c+a*-o),p=e.x,g=e.y;return t.x=c*f*p+-a*f*g+(h*a-u*c)*f,t.y=i*f*g+-o*f*p+(-h*i+u*o)*f,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),o=this.a,a=this.c,c=this.tx;return this.a=o*t-this.b*i,this.b=o*i+this.b*t,this.c=a*t-this.d*i,this.d=a*i+this.d*t,this.tx=c*t-this.ty*i,this.ty=c*i+this.ty*t,this}append(e){const t=this.a,i=this.b,o=this.c,a=this.d;return this.a=e.a*t+e.b*o,this.b=e.a*i+e.b*a,this.c=e.c*t+e.d*o,this.d=e.c*i+e.d*a,this.tx=e.tx*t+e.ty*o+this.tx,this.ty=e.tx*i+e.ty*a+this.ty,this}appendFrom(e,t){const i=e.a,o=e.b,a=e.c,c=e.d,u=e.tx,h=e.ty,f=t.a,p=t.b,g=t.c,v=t.d;return this.a=i*f+o*g,this.b=i*p+o*v,this.c=a*f+c*g,this.d=a*p+c*v,this.tx=u*f+h*g+t.tx,this.ty=u*p+h*v+t.ty,this}setTransform(e,t,i,o,a,c,u,h,f){return this.a=Math.cos(u+f)*a,this.b=Math.sin(u+f)*a,this.c=-Math.sin(u-h)*c,this.d=Math.cos(u-h)*c,this.tx=e-(i*this.a+o*this.c),this.ty=t-(i*this.b+o*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const i=this.a,o=this.c;this.a=i*e.a+this.b*e.c,this.b=i*e.b+this.b*e.d,this.c=o*e.a+this.d*e.c,this.d=o*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,i=this.b,o=this.c,a=this.d,c=e.pivot,u=-Math.atan2(-o,a),h=Math.atan2(i,t),f=Math.abs(u+h);return f<1e-5||Math.abs(W5-f)<1e-5?(e.rotation=h,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=u,e.skew.y=h),e.scale.x=Math.sqrt(t*t+i*i),e.scale.y=Math.sqrt(o*o+a*a),e.position.x=this.tx+(c.x*t+c.y*o),e.position.y=this.ty+(c.x*i+c.y*a),e}invert(){const e=this.a,t=this.b,i=this.c,o=this.d,a=this.tx,c=e*o-t*i;return this.a=o/c,this.b=-t/c,this.c=-i/c,this.d=e/c,this.tx=(i*this.ty-o*a)/c,this.ty=-(e*this.ty-t*a)/c,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new Be;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return V5.identity()}static get shared(){return G5.identity()}}const G5=new Be,V5=new Be,Xi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],qi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ki=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Qi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Hd=[],_0=[],Zl=Math.sign;function Y5(){for(let n=0;n<16;n++){const e=[];Hd.push(e);for(let t=0;t<16;t++){const i=Zl(Xi[n]*Xi[t]+Ki[n]*qi[t]),o=Zl(qi[n]*Xi[t]+Qi[n]*qi[t]),a=Zl(Xi[n]*Ki[t]+Ki[n]*Qi[t]),c=Zl(qi[n]*Ki[t]+Qi[n]*Qi[t]);for(let u=0;u<16;u++)if(Xi[u]===i&&qi[u]===o&&Ki[u]===a&&Qi[u]===c){e.push(u);break}}}for(let n=0;n<16;n++){const e=new Be;e.set(Xi[n],qi[n],Ki[n],Qi[n],0,0),_0.push(e)}}Y5();const et={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:n=>Xi[n],uY:n=>qi[n],vX:n=>Ki[n],vY:n=>Qi[n],inv:n=>n&8?n&15:-n&7,add:(n,e)=>Hd[n][e],sub:(n,e)=>Hd[n][et.inv(e)],rotate180:n=>n^4,isVertical:n=>(n&3)===2,byDirection:(n,e)=>Math.abs(n)*2<=Math.abs(e)?e>=0?et.S:et.N:Math.abs(e)*2<=Math.abs(n)?n>0?et.E:et.W:e>0?n>0?et.SE:et.SW:n>0?et.NE:et.NW,matrixAppendRotationInv:(n,e,t=0,i=0)=>{const o=_0[et.inv(e)];o.tx=t,o.ty=i,n.append(o)},transformRectCoords:(n,e,t,i)=>{const{x:o,y:a,width:c,height:u}=n,{x:h,y:f,width:p,height:g}=e;return t===et.E?(i.set(o+h,a+f,c,u),i):t===et.S?i.set(p-a-u+h,o+f,u,c):t===et.W?i.set(p-o-c+h,g-a-u+f,c,u):t===et.N?i.set(a+h,g-o-c+f,u,c):i.set(o+h,a+f,c,u)}},Jl=[new Xt,new Xt,new Xt,new Xt];class ft{constructor(e=0,t=0,i=0,o=0){this.type="rectangle",this.x=Number(e),this.y=Number(t),this.width=Number(i),this.height=Number(o)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new ft(0,0,0,0)}clone(){return new ft(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}strokeContains(e,t,i,o=.5){const{width:a,height:c}=this;if(a<=0||c<=0)return!1;const u=this.x,h=this.y,f=i*(1-o),p=i-f,g=u-f,v=u+a+f,x=h-f,w=h+c+f,S=u+p,b=u+a-p,k=h+p,A=h+c-p;return e>=g&&e<=v&&t>=x&&t<=w&&!(e>S&&e<b&&t>k&&t<A)}intersects(e,t){if(!t){const N=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=N)return!1;const q=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>q}const i=this.left,o=this.right,a=this.top,c=this.bottom;if(o<=i||c<=a)return!1;const u=Jl[0].set(e.left,e.top),h=Jl[1].set(e.left,e.bottom),f=Jl[2].set(e.right,e.top),p=Jl[3].set(e.right,e.bottom);if(f.x<=u.x||h.y<=u.y)return!1;const g=Math.sign(t.a*t.d-t.b*t.c);if(g===0||(t.apply(u,u),t.apply(h,h),t.apply(f,f),t.apply(p,p),Math.max(u.x,h.x,f.x,p.x)<=i||Math.min(u.x,h.x,f.x,p.x)>=o||Math.max(u.y,h.y,f.y,p.y)<=a||Math.min(u.y,h.y,f.y,p.y)>=c))return!1;const v=g*(h.y-u.y),x=g*(u.x-h.x),w=v*i+x*a,S=v*o+x*a,b=v*i+x*c,k=v*o+x*c;if(Math.max(w,S,b,k)<=v*u.x+x*u.y||Math.min(w,S,b,k)>=v*p.x+x*p.y)return!1;const A=g*(u.y-f.y),M=g*(f.x-u.x),E=A*i+M*a,B=A*o+M*a,F=A*i+M*c,I=A*o+M*c;return!(Math.max(E,B,F,I)<=A*u.x+M*u.y||Math.min(E,B,F,I)>=A*p.x+M*p.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),o=Math.max(this.y,e.y),a=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=o,this.height=Math.max(a-o,0),this}ceil(e=1,t=.001){const i=Math.ceil((this.x+this.width-t)*e)/e,o=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=o-this.y,this}scale(e,t=e){return this.x*=e,this.y*=t,this.width*=e,this.height*=t,this}enlarge(e){const t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),o=Math.min(this.y,e.y),a=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=o,this.height=a-o,this}getBounds(e){return e||(e=new ft),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const t=e.x,i=e.y,o=e.x+e.width,a=e.y+e.height;return t>=this.x&&t<this.x+this.width&&i>=this.y&&i<this.y+this.height&&o>=this.x&&o<this.x+this.width&&a>=this.y&&a<this.y+this.height}set(e,t,i,o){return this.x=e,this.y=t,this.width=i,this.height=o,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const gd={default:-1};function wt(n="default"){return gd[n]===void 0&&(gd[n]=-1),++gd[n]}const K1=new Set,Je="8.0.0",X5="8.3.4",Ys={quiet:!1,noColor:!1},Fe=(n,e,t=3)=>{if(Ys.quiet||K1.has(e))return;let i=new Error().stack;const o=`${e}
Deprecated since v${n}`,a=typeof console.groupCollapsed=="function"&&!Ys.noColor;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",o):(i=i.split(`
`).splice(t).join(`
`),a?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",o),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",o),console.warn(i))),K1.add(e)};Object.defineProperties(Fe,{quiet:{get:()=>Ys.quiet,set:n=>{Ys.quiet=n},enumerable:!0,configurable:!1},noColor:{get:()=>Ys.noColor,set:n=>{Ys.noColor=n},enumerable:!0,configurable:!1}});const w0=()=>{};function Js(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function Q1(n){return!(n&n-1)&&!!n}function b0(n){const e={};for(const t in n)n[t]!==void 0&&(e[t]=n[t]);return e}const Z1=Object.create(null);function q5(n){const e=Z1[n];return e===void 0&&(Z1[n]=wt("resource")),e}const S0=class k0 extends er{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...k0.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){Fe(Je,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=q5(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};S0.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let eo=S0;const C0=class A0 extends er{constructor(e={}){super(),this.options=e,this.uid=wt("textureSource"),this._resourceType="textureSource",this._resourceId=wt("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...A0.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new eo(b0(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){var t,i;this.style!==e&&((t=this._style)==null||t.off("change",this._onStyleChange,this),this._style=e,(i=this._style)==null||i.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(e){this._style.maxAnisotropy=e}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=wt("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,t,i){i||(i=this._resolution),e||(e=this.width),t||(t=this.height);const o=Math.round(e*i),a=Math.round(t*i);return this.width=o/i,this.height=a/i,this._resolution=i,this.pixelWidth===o&&this.pixelHeight===a?!1:(this._refreshPOT(),this.pixelWidth=o,this.pixelHeight=a,this.emit("resize",this),this._resourceId=wt("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Q1(this.pixelWidth)&&Q1(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};C0.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let tr=C0;class fh extends tr{constructor(e){const t=e.resource||new Float32Array(e.width*e.height*4);let i=e.format;i||(t instanceof Float32Array?i="rgba32float":t instanceof Int32Array||t instanceof Uint32Array?i="rgba32uint":t instanceof Int16Array||t instanceof Uint16Array?i="rgba16uint":(t instanceof Int8Array,i="bgra8unorm")),super({...e,resource:t,format:i}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}fh.extension=be.TextureSource;const J1=new Be;class K5{constructor(e,t){this.mapCoord=new Be,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof t>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=t,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){var t;this.texture!==e&&((t=this._texture)==null||t.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,t){t===void 0&&(t=e);const i=this.mapCoord;for(let o=0;o<e.length;o+=2){const a=e[o],c=e[o+1];t[o]=a*i.a+c*i.c+i.tx,t[o+1]=a*i.b+c*i.d+i.ty}return t}update(){const e=this._texture;this._updateID++;const t=e.uvs;this.mapCoord.set(t.x1-t.x0,t.y1-t.y0,t.x3-t.x0,t.y3-t.y0,t.x0,t.y0);const i=e.orig,o=e.trim;o&&(J1.set(i.width/o.width,0,0,i.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(J1));const a=e.source,c=this.uClampFrame,u=this.clampMargin/a._resolution,h=this.clampOffset/a._resolution;return c[0]=(e.frame.x+u+h)/a.width,c[1]=(e.frame.y+u+h)/a.height,c[2]=(e.frame.x+e.frame.width-u+h)/a.width,c[3]=(e.frame.y+e.frame.height-u+h)/a.height,this.uClampOffset[0]=this.clampOffset/a.pixelWidth,this.uClampOffset[1]=this.clampOffset/a.pixelHeight,this.isSimple=e.frame.width===a.width&&e.frame.height===a.height&&e.rotate===0,!0}}class Ne extends er{constructor({source:e,label:t,frame:i,orig:o,trim:a,defaultAnchor:c,defaultBorders:u,rotate:h,dynamic:f}={}){if(super(),this.uid=wt("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new ft,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=t,this.source=(e==null?void 0:e.source)??new tr,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:p,height:g}=this._source;this.frame.width=p,this.frame.height=g}this.orig=o||this.frame,this.trim=a,this.rotate=h??0,this.defaultAnchor=c,this.defaultBorders=u,this.destroyed=!1,this.dynamic=f||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new K5(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:t}=this,{width:i,height:o}=this._source,a=t.x/i,c=t.y/o,u=t.width/i,h=t.height/o;let f=this.rotate;if(f){const p=u/2,g=h/2,v=a+p,x=c+g;f=et.add(f,et.NW),e.x0=v+p*et.uX(f),e.y0=x+g*et.uY(f),f=et.add(f,2),e.x1=v+p*et.uX(f),e.y1=x+g*et.uY(f),f=et.add(f,2),e.x2=v+p*et.uX(f),e.y2=x+g*et.uY(f),f=et.add(f,2),e.x3=v+p*et.uX(f),e.y3=x+g*et.uY(f)}else e.x0=a,e.y0=c,e.x1=a+u,e.y1=c,e.x2=a+u,e.y2=c+h,e.x3=a,e.y3=c+h}destroy(e=!1){this._source&&(this._source.off("resize",this.update,this),e&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return Fe(Je,"Texture.baseTexture is now Texture.source"),this._source}}Ne.EMPTY=new Ne({label:"EMPTY",source:new tr({label:"EMPTY"})});Ne.EMPTY.destroy=w0;Ne.WHITE=new Ne({source:new fh({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});Ne.WHITE.destroy=w0;function Q5(n,e,t){const{width:i,height:o}=t.orig,a=t.trim;if(a){const c=a.width,u=a.height;n.minX=a.x-e._x*i,n.maxX=n.minX+c,n.minY=a.y-e._y*o,n.maxY=n.minY+u}else n.minX=-e._x*i,n.maxX=n.minX+i,n.minY=-e._y*o,n.maxY=n.minY+o}const ep=new Be;class Jn{constructor(e=1/0,t=1/0,i=-1/0,o=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ep,this.minX=e,this.minY=t,this.maxX=i,this.maxY=o}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new ft);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=ep,this}set(e,t,i,o){this.minX=e,this.minY=t,this.maxX=i,this.maxY=o}addFrame(e,t,i,o,a){a||(a=this.matrix);const c=a.a,u=a.b,h=a.c,f=a.d,p=a.tx,g=a.ty;let v=this.minX,x=this.minY,w=this.maxX,S=this.maxY,b=c*e+h*t+p,k=u*e+f*t+g;b<v&&(v=b),k<x&&(x=k),b>w&&(w=b),k>S&&(S=k),b=c*i+h*t+p,k=u*i+f*t+g,b<v&&(v=b),k<x&&(x=k),b>w&&(w=b),k>S&&(S=k),b=c*e+h*o+p,k=u*e+f*o+g,b<v&&(v=b),k<x&&(x=k),b>w&&(w=b),k>S&&(S=k),b=c*i+h*o+p,k=u*i+f*o+g,b<v&&(v=b),k<x&&(x=k),b>w&&(w=b),k>S&&(S=k),this.minX=v,this.minY=x,this.maxX=w,this.maxY=S}addRect(e,t){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,t)}addBounds(e,t){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,t)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const t=this.minX,i=this.minY,o=this.maxX,a=this.maxY,{a:c,b:u,c:h,d:f,tx:p,ty:g}=e;let v=c*t+h*i+p,x=u*t+f*i+g;this.minX=v,this.minY=x,this.maxX=v,this.maxY=x,v=c*o+h*i+p,x=u*o+f*i+g,this.minX=v<this.minX?v:this.minX,this.minY=x<this.minY?x:this.minY,this.maxX=v>this.maxX?v:this.maxX,this.maxY=x>this.maxY?x:this.maxY,v=c*t+h*a+p,x=u*t+f*a+g,this.minX=v<this.minX?v:this.minX,this.minY=x<this.minY?x:this.minY,this.maxX=v>this.maxX?v:this.maxX,this.maxY=x>this.maxY?x:this.maxY,v=c*o+h*a+p,x=u*o+f*a+g,this.minX=v<this.minX?v:this.minX,this.minY=x<this.minY?x:this.minY,this.maxX=v>this.maxX?v:this.maxX,this.maxY=x>this.maxY?x:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,t,i,o){return this.minX<e&&(this.minX=e),this.maxX>t&&(this.maxX=t),this.minY<i&&(this.minY=i),this.maxY>o&&(this.maxY=o),this}pad(e,t=e){return this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Jn(this.minX,this.minY,this.maxX,this.maxY)}scale(e,t=e){return this.minX*=e,this.minY*=t,this.maxX*=e,this.maxY*=t,this}get x(){return this.minX}set x(e){const t=this.maxX-this.minX;this.minX=e,this.maxX=e+t}get y(){return this.minY}set y(e){const t=this.maxY-this.minY;this.minY=e,this.maxY=e+t}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,t,i,o){let a=this.minX,c=this.minY,u=this.maxX,h=this.maxY;o||(o=this.matrix);const f=o.a,p=o.b,g=o.c,v=o.d,x=o.tx,w=o.ty;for(let S=t;S<i;S+=2){const b=e[S],k=e[S+1],A=f*b+g*k+x,M=p*b+v*k+w;a=A<a?A:a,c=M<c?M:c,u=A>u?A:u,h=M>h?M:h}this.minX=a,this.minY=c,this.maxX=u,this.maxY=h}containsPoint(e,t){return this.minX<=e&&this.minY<=t&&this.maxX>=e&&this.maxY>=t}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var Z5={grad:.9,turn:360,rad:360/(2*Math.PI)},zr=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},jt=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t+0},jn=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n>e?n:e},T0=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},tp=function(n){return{r:jn(n.r,0,255),g:jn(n.g,0,255),b:jn(n.b,0,255),a:jn(n.a)}},yd=function(n){return{r:jt(n.r),g:jt(n.g),b:jt(n.b),a:jt(n.a,3)}},J5=/^#([0-9a-f]{3,8})$/i,ec=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},M0=function(n){var e=n.r,t=n.g,i=n.b,o=n.a,a=Math.max(e,t,i),c=a-Math.min(e,t,i),u=c?a===e?(t-i)/c:a===t?2+(i-e)/c:4+(e-t)/c:0;return{h:60*(u<0?u+6:u),s:a?c/a*100:0,v:a/255*100,a:o}},P0=function(n){var e=n.h,t=n.s,i=n.v,o=n.a;e=e/360*6,t/=100,i/=100;var a=Math.floor(e),c=i*(1-t),u=i*(1-(e-a)*t),h=i*(1-(1-e+a)*t),f=a%6;return{r:255*[i,u,c,c,h,i][f],g:255*[h,i,i,u,c,c][f],b:255*[c,c,h,i,i,u][f],a:o}},np=function(n){return{h:T0(n.h),s:jn(n.s,0,100),l:jn(n.l,0,100),a:jn(n.a)}},rp=function(n){return{h:jt(n.h),s:jt(n.s),l:jt(n.l),a:jt(n.a,3)}},ip=function(n){return P0((t=(e=n).s,{h:e.h,s:(t*=((i=e.l)<50?i:100-i)/100)>0?2*t/(i+t)*100:0,v:i+t,a:e.a}));var e,t,i},ya=function(n){return{h:(e=M0(n)).h,s:(o=(200-(t=e.s))*(i=e.v)/100)>0&&o<200?t*i/100/(o<=100?o:200-o)*100:0,l:o/2,a:e.a};var e,t,i,o},e8=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,t8=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,n8=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,r8=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Ud={string:[[function(n){var e=J5.exec(n);return e?(n=e[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?jt(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?jt(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var e=n8.exec(n)||r8.exec(n);return e?e[2]!==e[4]||e[4]!==e[6]?null:tp({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(n){var e=e8.exec(n)||t8.exec(n);if(!e)return null;var t,i,o=np({h:(t=e[1],i=e[2],i===void 0&&(i="deg"),Number(t)*(Z5[i]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return ip(o)},"hsl"]],object:[[function(n){var e=n.r,t=n.g,i=n.b,o=n.a,a=o===void 0?1:o;return zr(e)&&zr(t)&&zr(i)?tp({r:Number(e),g:Number(t),b:Number(i),a:Number(a)}):null},"rgb"],[function(n){var e=n.h,t=n.s,i=n.l,o=n.a,a=o===void 0?1:o;if(!zr(e)||!zr(t)||!zr(i))return null;var c=np({h:Number(e),s:Number(t),l:Number(i),a:Number(a)});return ip(c)},"hsl"],[function(n){var e=n.h,t=n.s,i=n.v,o=n.a,a=o===void 0?1:o;if(!zr(e)||!zr(t)||!zr(i))return null;var c=(function(u){return{h:T0(u.h),s:jn(u.s,0,100),v:jn(u.v,0,100),a:jn(u.a)}})({h:Number(e),s:Number(t),v:Number(i),a:Number(a)});return P0(c)},"hsv"]]},sp=function(n,e){for(var t=0;t<e.length;t++){var i=e[t][0](n);if(i)return[i,e[t][1]]}return[null,void 0]},i8=function(n){return typeof n=="string"?sp(n.trim(),Ud.string):typeof n=="object"&&n!==null?sp(n,Ud.object):[null,void 0]},xd=function(n,e){var t=ya(n);return{h:t.h,s:jn(t.s+100*e,0,100),l:t.l,a:t.a}},vd=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},op=function(n,e){var t=ya(n);return{h:t.h,s:t.s,l:jn(t.l+100*e,0,100),a:t.a}},Gd=(function(){function n(e){this.parsed=i8(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return jt(vd(this.rgba),2)},n.prototype.isDark=function(){return vd(this.rgba)<.5},n.prototype.isLight=function(){return vd(this.rgba)>=.5},n.prototype.toHex=function(){return e=yd(this.rgba),t=e.r,i=e.g,o=e.b,c=(a=e.a)<1?ec(jt(255*a)):"","#"+ec(t)+ec(i)+ec(o)+c;var e,t,i,o,a,c},n.prototype.toRgb=function(){return yd(this.rgba)},n.prototype.toRgbString=function(){return e=yd(this.rgba),t=e.r,i=e.g,o=e.b,(a=e.a)<1?"rgba("+t+", "+i+", "+o+", "+a+")":"rgb("+t+", "+i+", "+o+")";var e,t,i,o,a},n.prototype.toHsl=function(){return rp(ya(this.rgba))},n.prototype.toHslString=function(){return e=rp(ya(this.rgba)),t=e.h,i=e.s,o=e.l,(a=e.a)<1?"hsla("+t+", "+i+"%, "+o+"%, "+a+")":"hsl("+t+", "+i+"%, "+o+"%)";var e,t,i,o,a},n.prototype.toHsv=function(){return e=M0(this.rgba),{h:jt(e.h),s:jt(e.s),v:jt(e.v),a:jt(e.a,3)};var e},n.prototype.invert=function(){return gr({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},n.prototype.saturate=function(e){return e===void 0&&(e=.1),gr(xd(this.rgba,e))},n.prototype.desaturate=function(e){return e===void 0&&(e=.1),gr(xd(this.rgba,-e))},n.prototype.grayscale=function(){return gr(xd(this.rgba,-1))},n.prototype.lighten=function(e){return e===void 0&&(e=.1),gr(op(this.rgba,e))},n.prototype.darken=function(e){return e===void 0&&(e=.1),gr(op(this.rgba,-e))},n.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},n.prototype.alpha=function(e){return typeof e=="number"?gr({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):jt(this.rgba.a,3);var t},n.prototype.hue=function(e){var t=ya(this.rgba);return typeof e=="number"?gr({h:e,s:t.s,l:t.l,a:t.a}):jt(t.h)},n.prototype.isEqual=function(e){return this.toHex()===gr(e).toHex()},n})(),gr=function(n){return n instanceof Gd?n:new Gd(n)},ap=[],s8=function(n){n.forEach(function(e){ap.indexOf(e)<0&&(e(Gd,Ud),ap.push(e))})};function o8(n,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var o in t)i[t[o]]=o;var a={};n.prototype.toName=function(c){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var u,h,f=i[this.toHex()];if(f)return f;if(c!=null&&c.closest){var p=this.toRgb(),g=1/0,v="black";if(!a.length)for(var x in t)a[x]=new n(t[x]).toRgb();for(var w in t){var S=(u=p,h=a[w],Math.pow(u.r-h.r,2)+Math.pow(u.g-h.g,2)+Math.pow(u.b-h.b,2));S<g&&(g=S,v=w)}return v}},e.string.push([function(c){var u=c.toLowerCase(),h=u==="transparent"?"#0000":t[u];return h?new n(h).toRgb():null},"name"])}s8([o8]);const to=class fa{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof fa)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,t){const i=typeof e;if(i!==typeof t)return!1;if(i==="number"||i==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((a,c)=>a===t[c]);if(e!==null&&t!==null){const a=Object.keys(e),c=Object.keys(t);return a.length!==c.length?!1:a.every(u=>e[u]===t[u])}return e===t}toRgba(){const[e,t,i,o]=this._components;return{r:e,g:t,b:i,a:o}}toRgb(){const[e,t,i]=this._components;return{r:e,g:t,b:i}}toRgbaString(){const[e,t,i]=this.toUint8RgbArray();return`rgba(${e},${t},${i},${this.alpha})`}toUint8RgbArray(e){const[t,i,o]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(t*255),e[1]=Math.round(i*255),e[2]=Math.round(o*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[t,i,o,a]=this._components;return e[0]=t,e[1]=i,e[2]=o,e[3]=a,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[t,i,o]=this._components;return e[0]=t,e[1]=i,e[2]=o,e}toNumber(){return this._int}toBgrNumber(){const[e,t,i]=this.toUint8RgbArray();return(i<<16)+(t<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,i,o,a]=fa._temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=i,this._components[2]*=o,this._components[3]*=a,this._refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let i=this._int>>16&255,o=this._int>>8&255,a=this._int&255;return t&&(i=i*e+.5|0,o=o*e+.5|0,a=a*e+.5|0),(e*255<<24)+(i<<16)+(o<<8)+a}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let t,i,o,a;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const c=e;t=(c>>16&255)/255,i=(c>>8&255)/255,o=(c&255)/255,a=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,i,o,a=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,i,o,a=255]=e,t/=255,i/=255,o/=255,a/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const u=fa.HEX_PATTERN.exec(e);u&&(e=`#${u[2]}`)}const c=gr(e);c.isValid()&&({r:t,g:i,b:o,a}=c.rgba,t/=255,i/=255,o/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=i,this._components[2]=o,this._components[3]=a,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,t,i]=this._components;this._int=(e*255<<16)+(t*255<<8)+(i*255|0)}_clamp(e,t=0,i=1){return typeof e=="number"?Math.min(Math.max(e,t),i):(e.forEach((o,a)=>{e[a]=Math.min(Math.max(o,t),i)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof fa||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};to.shared=new to;to._temp=new to;to.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let At=to;const a8={cullArea:null,cullable:!1,cullableChildren:!0};let _d=0;const lp=500;function ct(...n){_d!==lp&&(_d++,_d===lp?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...n))}const Da={_registeredResources:new Set,register(n){this._registeredResources.add(n)},unregister(n){this._registeredResources.delete(n)},release(){this._registeredResources.forEach(n=>n.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(n){return this._registeredResources.has(n)},reset(){this._registeredResources.clear()}};class l8{constructor(e,t){this._pool=[],this._count=0,this._index=0,this._classType=e,t&&this.prepopulate(t)}prepopulate(e){for(let t=0;t<e;t++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){var i;let t;return this._index>0?t=this._pool[--this._index]:(t=new this._classType,this._count++),(i=t.init)==null||i.call(t,e),t}return(e){var t;(t=e.reset)==null||t.call(e),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let e=0;e<this._index;e++)this._pool[e].destroy();this._pool.length=0,this._count=0,this._index=0}}class c8{constructor(){this._poolsByClass=new Map}prepopulate(e,t){this.getPool(e).prepopulate(t)}get(e,t){return this.getPool(e).get(t)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new l8(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(t=>{const i=e[t._classType.name]?t._classType.name+t._classType.ID:t._classType.name;e[i]={free:t.totalFree,used:t.totalUsed,size:t.totalSize}}),e}clear(){this._poolsByClass.forEach(e=>e.clear()),this._poolsByClass.clear()}}const Bn=new c8;Da.register(Bn);const u8={get isCachedAsTexture(){var n;return!!((n=this.renderGroup)!=null&&n.isCachedAsTexture)},cacheAsTexture(n){typeof n=="boolean"&&n===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(n===!0?{}:n))},updateCacheTexture(){var n;(n=this.renderGroup)==null||n.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(n){Fe("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(n)}};function d8(n,e,t){const i=n.length;let o;if(e>=i||t===0)return;t=e+t>i?i-e:t;const a=i-t;for(o=e;o<a;++o)n[o]=n[o+t];n.length=a}const h8={allowChildren:!0,removeChildren(n=0,e){var a;const t=e??this.children.length,i=t-n,o=[];if(i>0&&i<=t){for(let u=t-1;u>=n;u--){const h=this.children[u];h&&(o.push(h),h.parent=null)}d8(this.children,n,t);const c=this.renderGroup||this.parentRenderGroup;c&&c.removeChildren(o);for(let u=0;u<o.length;++u){const h=o[u];(a=h.parentRenderLayer)==null||a.detach(h),this.emit("childRemoved",h,this,u),o[u].emit("removed",this)}return o.length>0&&this._didViewChangeTick++,o}else if(i===0&&this.children.length===0)return o;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(n){const e=this.getChildAt(n);return this.removeChild(e)},getChildAt(n){if(n<0||n>=this.children.length)throw new Error(`getChildAt: Index (${n}) does not exist.`);return this.children[n]},setChildIndex(n,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(n),this.addChildAt(n,e)},getChildIndex(n){const e=this.children.indexOf(n);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(n,e){this.allowChildren||Fe(Je,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:t}=this;if(e<0||e>t.length)throw new Error(`${n}addChildAt: The index ${e} supplied is out of bounds ${t.length}`);if(n.parent){const o=n.parent.children.indexOf(n);if(n.parent===this&&o===e)return n;o!==-1&&n.parent.children.splice(o,1)}e===t.length?t.push(n):t.splice(e,0,n),n.parent=this,n.didChange=!0,n._updateFlags=15;const i=this.renderGroup||this.parentRenderGroup;return i&&i.addChild(n),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",n,this,e),n.emit("added",this),n},swapChildren(n,e){if(n===e)return;const t=this.getChildIndex(n),i=this.getChildIndex(e);this.children[t]=e,this.children[i]=n;const o=this.renderGroup||this.parentRenderGroup;o&&(o.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var n;(n=this.parent)==null||n.removeChild(this)},reparentChild(...n){return n.length===1?this.reparentChildAt(n[0],this.children.length):(n.forEach(e=>this.reparentChildAt(e,this.children.length)),n[0])},reparentChildAt(n,e){if(n.parent===this)return this.setChildIndex(n,e),n;const t=n.worldTransform.clone();n.removeFromParent(),this.addChildAt(n,e);const i=this.worldTransform.clone();return i.invert(),t.prepend(i),n.setFromMatrix(t),n},replaceChild(n,e){n.updateLocalTransform(),this.addChildAt(e,this.getChildIndex(n)),e.setFromMatrix(n.localTransform),e.updateLocalTransform(),this.removeChild(n)}},f8={collectRenderables(n,e,t){this.parentRenderLayer&&this.parentRenderLayer!==t||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(n,e,t):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,n):this.collectRenderablesWithEffects(n,e,t))},collectRenderablesSimple(n,e,t){const i=this.children,o=i.length;for(let a=0;a<o;a++)i[a].collectRenderables(n,e,t)},collectRenderablesWithEffects(n,e,t){const{renderPipes:i}=e;for(let o=0;o<this.effects.length;o++){const a=this.effects[o];i[a.pipe].push(a,this,n)}this.collectRenderablesSimple(n,e,t);for(let o=this.effects.length-1;o>=0;o--){const a=this.effects[o];i[a.pipe].pop(a,this,n)}}};class cp{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class p8{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let t=0;t<this._tests.length;t++){const i=this._tests[t];if(i.test(e))return Bn.get(i.maskClass,e)}return e}returnMaskEffect(e){Bn.return(e)}}const Vd=new p8;Wt.handleByList(be.MaskEffect,Vd._effectClasses);const m8={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0)},addEffect(n){this.effects.indexOf(n)===-1&&(this.effects.push(n),this.effects.sort((t,i)=>t.priority-i.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(n){const e=this.effects.indexOf(n);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(n){const e=this._maskEffect;(e==null?void 0:e.mask)!==n&&(e&&(this.removeEffect(e),Vd.returnMaskEffect(e),this._maskEffect=null),n!=null&&(this._maskEffect=Vd.getMaskEffect(n),this.addEffect(this._maskEffect)))},get mask(){var n;return(n=this._maskEffect)==null?void 0:n.mask},setMask(n){this._maskOptions={...this._maskOptions,...n},n.mask&&(this.mask=n.mask),this._markStructureAsChanged()},set filters(n){var a;!Array.isArray(n)&&n&&(n=[n]);const e=this._filterEffect||(this._filterEffect=new cp);n=n;const t=(n==null?void 0:n.length)>0,i=((a=e.filters)==null?void 0:a.length)>0,o=t!==i;n=Array.isArray(n)?n.slice(0):n,e.filters=Object.freeze(n),o&&(t?this.addEffect(e):(this.removeEffect(e),e.filters=n??null))},get filters(){var n;return(n=this._filterEffect)==null?void 0:n.filters},set filterArea(n){this._filterEffect||(this._filterEffect=new cp),this._filterEffect.filterArea=n},get filterArea(){var n;return(n=this._filterEffect)==null?void 0:n.filterArea}},g8={label:null,get name(){return Fe(Je,"Container.name property has been removed, use Container.label instead"),this.label},set name(n){Fe(Je,"Container.name property has been removed, use Container.label instead"),this.label=n},getChildByName(n,e=!1){return this.getChildByLabel(n,e)},getChildByLabel(n,e=!1){const t=this.children;for(let i=0;i<t.length;i++){const o=t[i];if(o.label===n||n instanceof RegExp&&n.test(o.label))return o}if(e)for(let i=0;i<t.length;i++){const a=t[i].getChildByLabel(n,!0);if(a)return a}return null},getChildrenByLabel(n,e=!1,t=[]){const i=this.children;for(let o=0;o<i.length;o++){const a=i[o];(a.label===n||n instanceof RegExp&&n.test(a.label))&&t.push(a)}if(e)for(let o=0;o<i.length;o++)i[o].getChildrenByLabel(n,!0,t);return t}},rn=Bn.getPool(Be),Br=Bn.getPool(Jn),y8=new Be,x8={getFastGlobalBounds(n,e){e||(e=new Jn),e.clear(),this._getGlobalBoundsRecursive(!!n,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const t=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(t.worldTransform),e},_getGlobalBoundsRecursive(n,e,t){let i=e;if(n&&this.parentRenderLayer&&this.parentRenderLayer!==t||this.localDisplayStatus!==7||!this.measurable)return;const o=!!this.effects.length;if((this.renderGroup||o)&&(i=Br.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const c=this.bounds;i.addFrame(c.minX,c.minY,c.maxX,c.maxY,this.groupTransform)}const a=this.children;for(let c=0;c<a.length;c++)a[c]._getGlobalBoundsRecursive(n,i,t)}if(o){let a=!1;const c=this.renderGroup||this.parentRenderGroup;for(let u=0;u<this.effects.length;u++)this.effects[u].addBounds&&(a||(a=!0,i.applyMatrix(c.worldTransform)),this.effects[u].addBounds(i,!0));a&&i.applyMatrix(c.worldTransform.copyTo(y8).invert()),e.addBounds(i),Br.return(i)}else this.renderGroup&&(e.addBounds(i,this.relativeGroupTransform),Br.return(i))}};function E0(n,e,t){t.clear();let i,o;return n.parent?e?i=n.parent.worldTransform:(o=rn.get().identity(),i=ph(n,o)):i=Be.IDENTITY,R0(n,t,i,e),o&&rn.return(o),t.isValid||t.set(0,0,0,0),t}function R0(n,e,t,i){var u,h;if(!n.visible||!n.measurable)return;let o;i?o=n.worldTransform:(n.updateLocalTransform(),o=rn.get(),o.appendFrom(n.localTransform,t));const a=e,c=!!n.effects.length;if(c&&(e=Br.get().clear()),n.boundsArea)e.addRect(n.boundsArea,o);else{const f=n.bounds;f&&!f.isEmpty()&&(e.matrix=o,e.addBounds(f));for(let p=0;p<n.children.length;p++)R0(n.children[p],e,o,i)}if(c){for(let f=0;f<n.effects.length;f++)(h=(u=n.effects[f]).addBounds)==null||h.call(u,e);a.addBounds(e,Be.IDENTITY),Br.return(e)}i||rn.return(o)}function ph(n,e){const t=n.parent;return t&&(ph(t,e),t.updateLocalTransform(),e.append(t.localTransform)),e}function I0(n,e){if(n===16777215||!e)return e;if(e===16777215||!n)return n;const t=n>>16&255,i=n>>8&255,o=n&255,a=e>>16&255,c=e>>8&255,u=e&255,h=t*a/255|0,f=i*c/255|0,p=o*u/255|0;return(h<<16)+(f<<8)+p}const up=16777215;function dp(n,e){return n===up?e:e===up?n:I0(n,e)}function gc(n){return((n&255)<<16)+(n&65280)+(n>>16&255)}const v8={getGlobalAlpha(n){if(n)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,t=this.parent;for(;t;)e*=t.alpha,t=t.parent;return e},getGlobalTransform(n=new Be,e){if(e)return n.copyFrom(this.worldTransform);this.updateLocalTransform();const t=ph(this,rn.get().identity());return n.appendFrom(this.localTransform,t),rn.return(t),n},getGlobalTint(n){if(n)return this.renderGroup?gc(this.renderGroup.worldColor):this.parentRenderGroup?gc(dp(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,t=this.parent;for(;t;)e=dp(e,t.localColor),t=t.parent;return gc(e)}};function $0(n,e,t){return e.clear(),t||(t=Be.IDENTITY),L0(n,e,t,n,!0),e.isValid||e.set(0,0,0,0),e}function L0(n,e,t,i,o){var h,f;let a;if(o)a=rn.get(),a=t.copyTo(a);else{if(!n.visible||!n.measurable)return;n.updateLocalTransform();const p=n.localTransform;a=rn.get(),a.appendFrom(p,t)}const c=e,u=!!n.effects.length;if(u&&(e=Br.get().clear()),n.boundsArea)e.addRect(n.boundsArea,a);else{n.renderPipeId&&(e.matrix=a,e.addBounds(n.bounds));const p=n.children;for(let g=0;g<p.length;g++)L0(p[g],e,a,i,!1)}if(u){for(let p=0;p<n.effects.length;p++)(f=(h=n.effects[p]).addLocalBounds)==null||f.call(h,e,i);c.addBounds(e,Be.IDENTITY),Br.return(e)}rn.return(a)}function z0(n,e){const t=n.children;for(let i=0;i<t.length;i++){const o=t[i],a=o.uid,c=(o._didViewChangeTick&65535)<<16|o._didContainerChangeTick&65535,u=e.index;(e.data[u]!==a||e.data[u+1]!==c)&&(e.data[e.index]=a,e.data[e.index+1]=c,e.didChange=!0),e.index=u+2,o.children.length&&z0(o,e)}return e.didChange}const _8=new Be,w8={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(n,e){const t=Math.sign(this.scale.x)||1;e!==0?this.scale.x=n/e*t:this.scale.x=t},_setHeight(n,e){const t=Math.sign(this.scale.y)||1;e!==0?this.scale.y=n/e*t:this.scale.y=t},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Jn});const n=this._localBoundsCacheData;return n.index=1,n.didChange=!1,n.data[0]!==this._didViewChangeTick&&(n.didChange=!0,n.data[0]=this._didViewChangeTick),z0(this,n),n.didChange&&$0(this,n.localBounds,_8),n.localBounds},getBounds(n,e){return E0(this,n,e||new Jn)}},b8={_onRender:null,set onRender(n){const e=this.renderGroup||this.parentRenderGroup;if(!n){this._onRender&&(e==null||e.removeOnRender(this)),this._onRender=null;return}this._onRender||e==null||e.addOnRender(this),this._onRender=n},get onRender(){return this._onRender}},S8={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(n){this._zIndex!==n&&(this._zIndex=n,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(k8))}};function k8(n,e){return n._zIndex-e._zIndex}const C8={getGlobalPosition(n=new Xt,e=!1){return this.parent?this.parent.toGlobal(this._position,n,e):(n.x=this._position.x,n.y=this._position.y),n},toGlobal(n,e,t=!1){const i=this.getGlobalTransform(rn.get(),t);return e=i.apply(n,e),rn.return(i),e},toLocal(n,e,t,i){e&&(n=e.toGlobal(n,t,i));const o=this.getGlobalTransform(rn.get(),i);return t=o.applyInverse(n,t),rn.return(o),t}};class F0{constructor(){this.uid=wt("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let A8=0;class T8{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this.textureStyle=new eo(this.textureOptions)}createTexture(e,t,i){const o=new tr({...this.textureOptions,width:e,height:t,resolution:1,antialias:i,autoGarbageCollect:!1});return new Ne({source:o,label:`texturePool_${A8++}`})}getOptimalTexture(e,t,i=1,o){let a=Math.ceil(e*i-1e-6),c=Math.ceil(t*i-1e-6);a=Js(a),c=Js(c);const u=(a<<17)+(c<<1)+(o?1:0);this._texturePool[u]||(this._texturePool[u]=[]);let h=this._texturePool[u].pop();return h||(h=this.createTexture(a,c,o)),h.source._resolution=i,h.source.width=a/i,h.source.height=c/i,h.source.pixelWidth=a,h.source.pixelHeight=c,h.frame.x=0,h.frame.y=0,h.frame.width=e,h.frame.height=t,h.updateUvs(),this._poolKeyHash[h.uid]=u,h}getSameSizeTexture(e,t=!1){const i=e.source;return this.getOptimalTexture(e.width,e.height,i._resolution,t)}returnTexture(e,t=!1){const i=this._poolKeyHash[e.uid];t&&(e.source.style=this.textureStyle),this._texturePool[i].push(e)}clear(e){if(e=e!==!1,e)for(const t in this._texturePool){const i=this._texturePool[t];if(i)for(let o=0;o<i.length;o++)i[o].destroy(!0)}this._texturePool={}}}const j0=new T8;Da.register(j0);class M8{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new Be,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new F0,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const t=e.children;for(let i=0;i<t.length;i++){const o=t[i];o._updateFlags=15,this.addChild(o)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(j0.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const e=this._parentCacheAsTextureRenderGroup;e&&!e.textureNeedsUpdate&&e.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const t=this.childrenToUpdate[e];t.list.fill(null),t.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const t=this.renderGroupChildren.indexOf(e);t>-1&&this.renderGroupChildren.splice(t,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const t=e.children;for(let i=0;i<t.length;i++)this.addChild(t[i])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const t=e.children;for(let i=0;i<t.length;i++)this.removeChild(t[i])}removeChildren(e){for(let t=0;t<e.length;t++)this.removeChild(e[t])}onChildUpdate(e){let t=this.childrenToUpdate[e.relativeRenderGroupDepth];t||(t=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),t.list[t.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const t=this.root.children;for(let i=0;i<t.length;i++)this._getChildren(t[i],e);return e}_getChildren(e,t=[]){if(t.push(e),e.renderGroup)return t;const i=e.children;for(let o=0;o<i.length;o++)this._getChildren(i[o],t);return t}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new Be),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new Be),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new Be),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function P8(n,e,t={}){for(const i in e)!t[i]&&e[i]!==void 0&&(n[i]=e[i])}const wd=new Nt(null),tc=new Nt(null),bd=new Nt(null,1,1),nc=new Nt(null),hp=1,E8=2,Sd=4;class xn extends er{constructor(e={}){var t,i;super(),this.uid=wt("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new Be,this.relativeGroupTransform=new Be,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new Nt(this,0,0),this._scale=bd,this._pivot=tc,this._origin=nc,this._skew=wd,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],P8(this,e,{children:!0,parent:!0,effects:!0}),(t=e.children)==null||t.forEach(o=>this.addChild(o)),(i=e.parent)==null||i.addChild(this)}static mixin(e){Fe("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Wt.mixin(xn,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||Fe(Je,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let o=0;o<e.length;o++)this.addChild(e[o]);return e[0]}const t=e[0],i=this.renderGroup||this.parentRenderGroup;return t.parent===this?(this.children.splice(this.children.indexOf(t),1),this.children.push(t),i&&(i.structureDidChange=!0),t):(t.parent&&t.parent.removeChild(t),this.children.push(t),this.sortableChildren&&(this.sortDirty=!0),t.parent=this,t.didChange=!0,t._updateFlags=15,i&&i.addChild(t),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this),this._didViewChangeTick++,t._zIndex!==0&&t.depthOfChildModified(),t)}removeChild(...e){if(e.length>1){for(let o=0;o<e.length;o++)this.removeChild(e[o]);return e[0]}const t=e[0],i=this.children.indexOf(t);return i>-1&&(this._didViewChangeTick++,this.children.splice(i,1),this.renderGroup?this.renderGroup.removeChild(t):this.parentRenderGroup&&this.parentRenderGroup.removeChild(t),t.parentRenderLayer&&t.parentRenderLayer.detach(t),t.parent=null,this.emit("childRemoved",t,this,i),t.emit("removed",this)),t}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e==null||e.removeChild(this),this.renderGroup=Bn.get(M8,this),this.groupTransform=Be.IDENTITY,e==null||e.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e==null||e.removeChild(this),Bn.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e==null||e.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new Be),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*H5}set angle(e){this.rotation=e*U5}get pivot(){return this._pivot===tc&&(this._pivot=new Nt(this,0,0)),this._pivot}set pivot(e){this._pivot===tc&&(this._pivot=new Nt(this,0,0),this._origin!==nc&&ct("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===wd&&(this._skew=new Nt(this,0,0)),this._skew}set skew(e){this._skew===wd&&(this._skew=new Nt(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===bd&&(this._scale=new Nt(this,1,1)),this._scale}set scale(e){this._scale===bd&&(this._scale=new Nt(this,0,0)),typeof e=="string"&&(e=parseFloat(e)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get origin(){return this._origin===nc&&(this._origin=new Nt(this,0,0)),this._origin}set origin(e){this._origin===nc&&(this._origin=new Nt(this,0,0),this._pivot!==tc&&ct("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._origin.set(e):this._origin.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const t=this.getLocalBounds().width;this._setWidth(e,t)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const t=this.getLocalBounds().height;this._setHeight(e,t)}getSize(e){e||(e={});const t=this.getLocalBounds();return e.width=Math.abs(this.scale.x*t.width),e.height=Math.abs(this.scale.y*t.height),e}setSize(e,t){const i=this.getLocalBounds();typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,i.width),t!==void 0&&this._setHeight(t,i.height)}_updateSkew(){const e=this._rotation,t=this._skew;this._cx=Math.cos(e+t._y),this._sx=Math.sin(e+t._y),this._cy=-Math.sin(e-t._x),this._sy=Math.cos(e-t._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this.origin.set(typeof e.originX=="number"?e.originX:this.origin.x,typeof e.originY=="number"?e.originY:this.origin.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const t=this.localTransform,i=this._scale,o=this._pivot,a=this._origin,c=this._position,u=i._x,h=i._y,f=o._x,p=o._y,g=-a._x,v=-a._y;t.a=this._cx*u,t.b=this._sx*u,t.c=this._cy*h,t.d=this._sy*h,t.tx=c._x-(f*t.a+p*t.c)+(g*t.a+v*t.c)-g,t.ty=c._y-(f*t.b+p*t.d)+(g*t.b+v*t.d)-v}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=hp,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const i=At.shared.setValue(e??16777215).toBgrNumber();i!==this.localColor&&(this.localColor=i,this._updateFlags|=hp,this._onUpdate())}get tint(){return gc(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=E8,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const t=e?2:0;(this.localDisplayStatus&2)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Sd,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const t=e?0:4;(this.localDisplayStatus&4)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Sd,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const t=e?1:0;(this.localDisplayStatus&1)!==t&&(this._updateFlags|=Sd,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){var o;if(this.destroyed)return;this.destroyed=!0;let t;if(this.children.length&&(t=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e==null?void 0:e.children)&&t)for(let a=0;a<t.length;++a)t[a].destroy(e);(o=this.renderGroup)==null||o.destroy(),this.renderGroup=null}}Wt.mixin(xn,h8,x8,C8,b8,w8,m8,g8,S8,a8,u8,v8,f8);class mh extends xn{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new Jn(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const t=this.bounds,{x:i,y:o}=e;return i>=t.minX&&i<=t.maxX&&o>=t.minY&&o<=t.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){var t,i;super.destroy(e),this._bounds=null;for(const o in this._gpuData)(i=(t=this._gpuData[o]).destroy)==null||i.call(t);this._gpuData=null}collectRenderablesSimple(e,t,i){const{renderPipes:o}=t;o.blendMode.pushBlendMode(this,this.groupBlendMode,e),o[this.renderPipeId].addRenderable(this,e),this.didViewUpdate=!1;const c=this.children,u=c.length;for(let h=0;h<u;h++)c[h].collectRenderables(e,t,i);o.blendMode.popBlendMode(e)}}class no extends mh{constructor(e=Ne.EMPTY){e instanceof Ne&&(e={texture:e});const{texture:t=Ne.EMPTY,anchor:i,roundPixels:o,width:a,height:c,...u}=e;super({label:"Sprite",...u}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new Nt({_onUpdate:()=>{this.onViewUpdate()}}),i?this.anchor=i:t.defaultAnchor&&(this.anchor=t.defaultAnchor),this.texture=t,this.allowChildren=!1,this.roundPixels=o??!1,a!==void 0&&(this.width=a),c!==void 0&&(this.height=c)}static from(e,t=!1){return e instanceof Ne?new no(e):new no(Ne.from(e,t))}set texture(e){e||(e=Ne.EMPTY);const t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return Q5(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return Fe("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,t=this._texture,i=this._bounds,{width:o,height:a}=t.orig;i.minX=-e._x*o,i.maxX=i.minX+o,i.minY=-e._y*a,i.maxY=i.minY+a}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e==null?void 0:e.texture){const i=typeof e=="boolean"?e:e==null?void 0:e.textureSource;this._texture.destroy(i)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),t!==void 0&&this._setHeight(t,this._texture.orig.height)}}const R8=new Jn;function B0(n,e,t){const i=R8;n.measurable=!0,E0(n,t,i),e.addBoundsMask(i),n.measurable=!1}function D0(n,e,t){const i=Br.get();n.measurable=!0;const o=rn.get().identity(),a=O0(n,t,o);$0(n,i,a),n.measurable=!1,e.addBoundsMask(i),rn.return(o),Br.return(i)}function O0(n,e,t){return n?(n!==e&&(O0(n.parent,e,t),n.updateLocalTransform(),t.append(n.localTransform)),t):(ct("Mask bounds, renderable is not inside the root container"),t)}class N0{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e!=null&&e.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof no),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(e,t){this.inverse||B0(this.mask,e,t)}addLocalBounds(e,t){D0(this.mask,e,t)}containsPoint(e,t){const i=this.mask;return t(i,e)}destroy(){this.reset()}static test(e){return e instanceof no}}N0.extension=be.MaskEffect;class W0{constructor(e){this.priority=0,this.pipe="colorMask",e!=null&&e.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}W0.extension=be.MaskEffect;class H0{constructor(e){this.priority=0,this.pipe="stencilMask",e!=null&&e.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(e,t){B0(this.mask,e,t)}addLocalBounds(e,t){D0(this.mask,e,t)}containsPoint(e,t){const i=this.mask;return t(i,e)}destroy(){this.reset()}static test(e){return e instanceof xn}}H0.extension=be.MaskEffect;const I8={createCanvas:(n,e)=>{const t=document.createElement("canvas");return t.width=n,t.height=e,t},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(n,e)=>fetch(n,e),parseXML:n=>new DOMParser().parseFromString(n,"text/xml")};let fp=I8;const rt={get(){return fp},set(n){fp=n}};class U0 extends tr{constructor(e){e.resource||(e.resource=rt.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,t=this.height,i=this._resolution){const o=super.resize(e,t,i);return o&&this.resizeCanvas(),o}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}U0.extension=be.TextureSource;class Ji extends tr{constructor(e){super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}Ji.extension=be.TextureSource;var Yd=(n=>(n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))(Yd||{});class kd{constructor(e,t=null,i=0,o=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=t,this.priority=i,this._once=o}match(e,t=null){return this._fn===e&&this._context===t}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const t=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const G0=class Cn{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new kd(null,null,1/0),this.deltaMS=1/Cn.targetFPMS,this.elapsedMS=1/Cn.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,i=Yd.NORMAL){return this._addListener(new kd(e,t,i))}addOnce(e,t,i=Yd.NORMAL){return this._addListener(new kd(e,t,i,!0))}_addListener(e){let t=this._head.next,i=this._head;if(!t)e.connect(i);else{for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}return this._startIfPossible(),this}remove(e,t){let i=this._head.next;for(;i;)i.match(e,t)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const a=e-this._lastFrame|0;if(a<this._minElapsedMS)return;this._lastFrame=e-a%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Cn.targetFPMS;const i=this._head;let o=i.next;for(;o;)o=o.emit(this);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,t)/1e3,Cn.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!Cn._shared){const e=Cn._shared=new Cn;e.autoStart=!0,e._protected=!0}return Cn._shared}static get system(){if(!Cn._system){const e=Cn._system=new Cn;e.autoStart=!0,e._protected=!0}return Cn._system}};G0.targetFPMS=.06;let rc=G0,Cd;async function V0(){return Cd??(Cd=(async()=>{var c;const e=rt.get().createCanvas(1,1).getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const t=await new Promise(u=>{const h=document.createElement("video");h.onloadeddata=()=>u(h),h.onerror=()=>u(null),h.autoplay=!1,h.crossOrigin="anonymous",h.preload="auto",h.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",h.load()});if(!t)return"premultiply-alpha-on-upload";const i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const a=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,a),e.deleteFramebuffer(o),e.deleteTexture(i),(c=e.getExtension("WEBGL_lose_context"))==null||c.loseContext(),a[0]<=a[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Cd}const Mc=class Y0 extends tr{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...Y0.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=rc.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,t=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(t.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await V0(),this._load=new Promise((i,o)=>{this.isValid?i(this):(this._resolve=i,this._reject=o,t.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${t.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(rc.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(rc.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(rc.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};Mc.extension=be.TextureSource;Mc.defaultOptions={...tr.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Mc.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let xa=Mc;const Qn=(n,e,t=!1)=>(Array.isArray(n)||(n=[n]),e?n.map(i=>typeof i=="string"||t?e(i):i):n);class $8{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||ct(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const i=Qn(e);let o;for(let h=0;h<this.parsers.length;h++){const f=this.parsers[h];if(f.test(t)){o=f.getCacheableAssets(i,t);break}}const a=new Map(Object.entries(o||{}));o||i.forEach(h=>{a.set(h,t)});const c=[...a.keys()],u={cacheKeys:c,keys:i};i.forEach(h=>{this._cacheMap.set(h,u)}),c.forEach(h=>{const f=o?o[h]:t;this._cache.has(h)&&this._cache.get(h)!==f&&ct("[Cache] already has key:",h),this._cache.set(h,a.get(h))})}remove(e){if(!this._cacheMap.has(e)){ct(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(o=>{this._cache.delete(o)}),t.keys.forEach(o=>{this._cacheMap.delete(o)})}get parsers(){return this._parsers}}const lt=new $8,Xd=[];Wt.handleByList(be.TextureSource,Xd);function X0(n={}){const e=n&&n.resource,t=e?n.resource:n,i=e?n:{resource:n};for(let o=0;o<Xd.length;o++){const a=Xd[o];if(a.test(t))return new a(i)}throw new Error(`Could not find a source type for resource: ${i.resource}`)}function L8(n={},e=!1){const t=n&&n.resource,i=t?n.resource:n,o=t?n:{resource:n};if(!e&&lt.has(i))return lt.get(i);const a=new Ne({source:X0(o)});return a.on("destroy",()=>{lt.has(i)&&lt.remove(i)}),e||lt.set(i,a),a}function z8(n,e=!1){return typeof n=="string"?lt.get(n):n instanceof tr?new Ne({source:n}):L8(n,e)}Ne.from=z8;tr.from=X0;Wt.add(N0,W0,H0,xa,Ji,U0,fh);var gi=(n=>(n[n.Low=0]="Low",n[n.Normal=1]="Normal",n[n.High=2]="High",n))(gi||{});function Kn(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function oa(n){return n.split("?")[0].split("#")[0]}function F8(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function j8(n,e,t){return n.replace(new RegExp(F8(e),"g"),t)}function B8(n,e){let t="",i=0,o=-1,a=0,c=-1;for(let u=0;u<=n.length;++u){if(u<n.length)c=n.charCodeAt(u);else{if(c===47)break;c=47}if(c===47){if(!(o===u-1||a===1))if(o!==u-1&&a===2){if(t.length<2||i!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const h=t.lastIndexOf("/");if(h!==t.length-1){h===-1?(t="",i=0):(t=t.slice(0,h),i=t.length-1-t.lastIndexOf("/")),o=u,a=0;continue}}else if(t.length===2||t.length===1){t="",i=0,o=u,a=0;continue}}}else t.length>0?t+=`/${n.slice(o+1,u)}`:t=n.slice(o+1,u),i=u-o-1;o=u,a=0}else c===46&&a!==-1?++a:a=-1}return t}const Tn={toPosix(n){return j8(n,"\\","/")},isUrl(n){return/^https?:/.test(this.toPosix(n))},isDataUrl(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},isBlobUrl(n){return n.startsWith("blob:")},hasProtocol(n){return/^[^/:]+:/.test(this.toPosix(n))},getProtocol(n){Kn(n),n=this.toPosix(n);const e=/^file:\/\/\//.exec(n);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(n);return t?t[0]:""},toAbsolute(n,e,t){if(Kn(n),this.isDataUrl(n)||this.isBlobUrl(n))return n;const i=oa(this.toPosix(e??rt.get().getBaseUrl())),o=oa(this.toPosix(t??this.rootname(i)));return n=this.toPosix(n),n.startsWith("/")?Tn.join(o,n.slice(1)):this.isAbsolute(n)?n:this.join(i,n)},normalize(n){if(Kn(n),n.length===0)return".";if(this.isDataUrl(n)||this.isBlobUrl(n))return n;n=this.toPosix(n);let e="";const t=n.startsWith("/");this.hasProtocol(n)&&(e=this.rootname(n),n=n.slice(e.length));const i=n.endsWith("/");return n=B8(n),n.length>0&&i&&(n+="/"),t?`/${n}`:e+n},isAbsolute(n){return Kn(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){const i=n[t];if(Kn(i),i.length>0)if(e===void 0)e=i;else{const o=n[t-1]??"";this.joinExtensions.includes(this.extname(o).toLowerCase())?e+=`/../${i}`:e+=`/${i}`}}return e===void 0?".":this.normalize(e)},dirname(n){if(Kn(n),n.length===0)return".";n=this.toPosix(n);let e=n.charCodeAt(0);const t=e===47;let i=-1,o=!0;const a=this.getProtocol(n),c=n;n=n.slice(a.length);for(let u=n.length-1;u>=1;--u)if(e=n.charCodeAt(u),e===47){if(!o){i=u;break}}else o=!1;return i===-1?t?"/":this.isUrl(c)?a+n:a:t&&i===1?"//":a+n.slice(0,i)},rootname(n){Kn(n),n=this.toPosix(n);let e="";if(n.startsWith("/")?e="/":e=this.getProtocol(n),this.isUrl(n)){const t=n.indexOf("/",e.length);t!==-1?e=n.slice(0,t):e=n,e.endsWith("/")||(e+="/")}return e},basename(n,e){Kn(n),e&&Kn(e),n=oa(this.toPosix(n));let t=0,i=-1,o=!0,a;if(e!==void 0&&e.length>0&&e.length<=n.length){if(e.length===n.length&&e===n)return"";let c=e.length-1,u=-1;for(a=n.length-1;a>=0;--a){const h=n.charCodeAt(a);if(h===47){if(!o){t=a+1;break}}else u===-1&&(o=!1,u=a+1),c>=0&&(h===e.charCodeAt(c)?--c===-1&&(i=a):(c=-1,i=u))}return t===i?i=u:i===-1&&(i=n.length),n.slice(t,i)}for(a=n.length-1;a>=0;--a)if(n.charCodeAt(a)===47){if(!o){t=a+1;break}}else i===-1&&(o=!1,i=a+1);return i===-1?"":n.slice(t,i)},extname(n){Kn(n),n=oa(this.toPosix(n));let e=-1,t=0,i=-1,o=!0,a=0;for(let c=n.length-1;c>=0;--c){const u=n.charCodeAt(c);if(u===47){if(!o){t=c+1;break}continue}i===-1&&(o=!1,i=c+1),u===46?e===-1?e=c:a!==1&&(a=1):e!==-1&&(a=-1)}return e===-1||i===-1||a===0||a===1&&e===i-1&&e===t+1?"":n.slice(e,i)},parse(n){Kn(n);const e={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return e;n=oa(this.toPosix(n));let t=n.charCodeAt(0);const i=this.isAbsolute(n);let o;e.root=this.rootname(n),i||this.hasProtocol(n)?o=1:o=0;let a=-1,c=0,u=-1,h=!0,f=n.length-1,p=0;for(;f>=o;--f){if(t=n.charCodeAt(f),t===47){if(!h){c=f+1;break}continue}u===-1&&(h=!1,u=f+1),t===46?a===-1?a=f:p!==1&&(p=1):a!==-1&&(p=-1)}return a===-1||u===-1||p===0||p===1&&a===u-1&&a===c+1?u!==-1&&(c===0&&i?e.base=e.name=n.slice(1,u):e.base=e.name=n.slice(c,u)):(c===0&&i?(e.name=n.slice(1,a),e.base=n.slice(1,u)):(e.name=n.slice(c,a),e.base=n.slice(c,u)),e.ext=n.slice(a,u)),e.dir=this.dirname(n),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function q0(n,e,t,i,o){const a=e[t];for(let c=0;c<a.length;c++){const u=a[c];t<e.length-1?q0(n.replace(i[t],u),e,t+1,i,o):o.push(n.replace(i[t],u))}}function D8(n){const e=/\{(.*?)\}/g,t=n.match(e),i=[];if(t){const o=[];t.forEach(a=>{const c=a.substring(1,a.length-1).split(",");o.push(c)}),q0(n,o,0,t,i)}else i.push(n);return i}const Sc=n=>!Array.isArray(n);class io{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`).join("&")}}getAlias(e){const{alias:t,src:i}=e;return Qn(t||i,a=>typeof a=="string"?a:Array.isArray(a)?a.map(c=>(c==null?void 0:c.src)??c):a!=null&&a.src?a.src:a,!0)}addManifest(e){this._manifest&&ct("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const i=[];let o=t;Array.isArray(t)||(o=Object.entries(t).map(([a,c])=>typeof c=="string"||Array.isArray(c)?{alias:a,src:c}:{alias:a,...c})),o.forEach(a=>{const c=a.src,u=a.alias;let h;if(typeof u=="string"){const f=this._createBundleAssetId(e,u);i.push(f),h=[u,f]}else{const f=u.map(p=>this._createBundleAssetId(e,p));i.push(...f),h=[...u,...f]}this.add({...a,alias:h,src:c})}),this._bundles[e]=i}add(e){const t=[];Array.isArray(e)?t.push(...e):t.push(e);let i;i=a=>{this.hasKey(a)&&ct(`[Resolver] already has key: ${a} overwriting`)},Qn(t).forEach(a=>{const{src:c}=a;let{data:u,format:h,loadParser:f,parser:p}=a;const g=Qn(c).map(S=>typeof S=="string"?D8(S):Array.isArray(S)?S:[S]),v=this.getAlias(a);Array.isArray(v)?v.forEach(i):i(v);const x=[],w=S=>{const b=this._parsers.find(k=>k.test(S));return{...b==null?void 0:b.parse(S),src:S}};g.forEach(S=>{S.forEach(b=>{let k={};if(typeof b!="object"?k=w(b):(u=b.data??u,h=b.format??h,(b.loadParser||b.parser)&&(f=b.loadParser??f,p=b.parser??p),k={...w(b.src),...b}),!v)throw new Error(`[Resolver] alias is undefined for this asset: ${k.src}`);k=this._buildResolvedAsset(k,{aliases:v,data:u,format:h,loadParser:f,parser:p,progressSize:a.progressSize}),x.push(k)})}),v.forEach(S=>{this._assetMap[S]=x})})}resolveBundle(e){const t=Sc(e);e=Qn(e);const i={};return e.forEach(o=>{const a=this._bundles[o];if(a){const c=this.resolve(a),u={};for(const h in c){const f=c[h];u[this._extractAssetIdFromBundle(o,h)]=f}i[o]=u}}),t?i[e[0]]:i}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const i={};for(const o in t)i[o]=t[o].src;return i}return t.src}resolve(e){const t=Sc(e);e=Qn(e);const i={};return e.forEach(o=>{if(!this._resolverHash[o])if(this._assetMap[o]){let a=this._assetMap[o];const c=this._getPreferredOrder(a);c==null||c.priority.forEach(u=>{c.params[u].forEach(h=>{const f=a.filter(p=>p[u]?p[u]===h:!1);f.length&&(a=f)})}),this._resolverHash[o]=a[0]}else this._resolverHash[o]=this._buildResolvedAsset({alias:[o],src:o},{});i[o]=this._resolverHash[o]}),t?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const i=e[t],o=this._preferredOrder.find(a=>a.params.format.includes(i.format));if(o)return o}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}_buildResolvedAsset(e,t){const{aliases:i,data:o,loadParser:a,parser:c,format:u,progressSize:h}=t;return(this._basePath||this._rootPath)&&(e.src=Tn.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=i??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...o||{},...e.data},e.loadParser=a??e.loadParser,e.parser=c??e.parser,e.format=u??e.format??O8(e.src),h!==void 0&&(e.progressSize=h),e}}io.RETINA_PREFIX=/@([0-9\.]+)x/;function O8(n){return n.split(".").pop().split("?").shift().split("#").shift()}const qd=(n,e)=>{const t=e.split("?")[1];return t&&(n+=`?${t}`),n},K0=class pa{constructor(e,t){this.linkedSheets=[];let i=e;(e==null?void 0:e.source)instanceof tr&&(i={texture:e,data:t});const{texture:o,data:a,cachePrefix:c=""}=i;this.cachePrefix=c,this._texture=o instanceof Ne?o:null,this.textureSource=o.source,this.textures={},this.animations={},this.data=a;const u=parseFloat(a.meta.scale);u?(this.resolution=u,o.source.resolution=this.resolution):this.resolution=o.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=pa.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const i=pa.BATCH_SIZE;for(;t-e<i&&t<this._frameKeys.length;){const o=this._frameKeys[t],a=this._frames[o],c=a.frame;if(c){let u=null,h=null;const f=a.trimmed!==!1&&a.sourceSize?a.sourceSize:a.frame,p=new ft(0,0,Math.floor(f.w)/this.resolution,Math.floor(f.h)/this.resolution);a.rotated?u=new ft(Math.floor(c.x)/this.resolution,Math.floor(c.y)/this.resolution,Math.floor(c.h)/this.resolution,Math.floor(c.w)/this.resolution):u=new ft(Math.floor(c.x)/this.resolution,Math.floor(c.y)/this.resolution,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution),a.trimmed!==!1&&a.spriteSourceSize&&(h=new ft(Math.floor(a.spriteSourceSize.x)/this.resolution,Math.floor(a.spriteSourceSize.y)/this.resolution,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution)),this.textures[o]=new Ne({source:this.textureSource,frame:u,orig:p,trim:h,rotate:a.rotated?2:0,defaultAnchor:a.anchor,defaultBorders:a.borders,label:o.toString()})}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let i=0;i<e[t].length;i++){const o=e[t][i];this.animations[t].push(this.textures[o])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*pa.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*pa.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};K0.BATCH_SIZE=1e3;let pp=K0;const N8=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Q0(n,e,t){const i={};if(n.forEach(o=>{i[o]=e}),Object.keys(e.textures).forEach(o=>{i[`${e.cachePrefix}${o}`]=e.textures[o]}),!t){const o=Tn.dirname(n[0]);e.linkedSheets.forEach((a,c)=>{const u=Q0([`${o}/${e.data.meta.related_multi_packs[c]}`],a,!0);Object.assign(i,u)})}return i}const W8={extension:be.Asset,cache:{test:n=>n instanceof pp,getCacheableAssets:(n,e)=>Q0(n,e,!1)},resolver:{extension:{type:be.ResolveParser,name:"resolveSpritesheet"},test:n=>{const t=n.split("?")[0].split("."),i=t.pop(),o=t.pop();return i==="json"&&N8.includes(o)},parse:n=>{var t;const e=n.split(".");return{resolution:parseFloat(((t=io.RETINA_PREFIX.exec(n))==null?void 0:t[1])??"1"),format:e[e.length-2],src:n}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:be.LoadParser,priority:gi.Normal,name:"spritesheetLoader"},async testParse(n,e){return Tn.extname(e.src).toLowerCase()===".json"&&!!n.frames},async parse(n,e,t){var g,v;const{texture:i,imageFilename:o,textureOptions:a,cachePrefix:c}=(e==null?void 0:e.data)??{};let u=Tn.dirname(e.src);u&&u.lastIndexOf("/")!==u.length-1&&(u+="/");let h;if(i instanceof Ne)h=i;else{const x=qd(u+(o??n.meta.image),e.src);h=(await t.load([{src:x,data:a}]))[x]}const f=new pp({texture:h.source,data:n,cachePrefix:c});await f.parse();const p=(g=n==null?void 0:n.meta)==null?void 0:g.related_multi_packs;if(Array.isArray(p)){const x=[];for(const S of p){if(typeof S!="string")continue;let b=u+S;(v=e.data)!=null&&v.ignoreMultiPack||(b=qd(b,e.src),x.push(t.load({src:b,data:{textureOptions:a,ignoreMultiPack:!0}})))}const w=await Promise.all(x);f.linkedSheets=w,w.forEach(S=>{S.linkedSheets=[f].concat(f.linkedSheets.filter(b=>b!==S))})}return f},async unload(n,e,t){await t.unload(n.textureSource._sourceOrigin),n.destroy(!1)}}};Wt.add(W8);const Ad=Object.create(null),mp=Object.create(null);function gh(n,e){let t=mp[n];return t===void 0&&(Ad[e]===void 0&&(Ad[e]=1),mp[n]=t=Ad[e]++),t}let Hs;function Z0(){return(!Hs||Hs!=null&&Hs.isContextLost())&&(Hs=rt.get().createCanvas().getContext("webgl",{})),Hs}let ic;function H8(){if(!ic){ic="mediump";const n=Z0();n&&n.getShaderPrecisionFormat&&(ic=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision?"highp":"mediump")}return ic}function U8(n,e,t){return e?n:t?(n=n.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${n}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${n}
        `}function G8(n,e,t){const i=t?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(n.substring(0,9)!=="precision"){let o=t?e.requestedFragmentPrecision:e.requestedVertexPrecision;return o==="highp"&&i!=="highp"&&(o="mediump"),`precision ${o} float;
${n}`}else if(i!=="highp"&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}function V8(n,e){return e?`#version 300 es
${n}`:n}const Y8={},X8={};function q8(n,{name:e="pixi-program"},t=!0){e=e.replace(/\s+/g,"-"),e+=t?"-fragment":"-vertex";const i=t?Y8:X8;return i[e]?(i[e]++,e+=`-${i[e]}`):i[e]=1,n.indexOf("#define SHADER_NAME")!==-1?n:`${`#define SHADER_NAME ${e}`}
${n}`}function K8(n,e){return e?n.replace("#version 300 es",""):n}const Td={stripVersion:K8,ensurePrecision:G8,addProgramDefines:U8,setProgramName:q8,insertVersion:V8},aa=Object.create(null),J0=class Kd{constructor(e){e={...Kd.defaultOptions,...e};const t=e.fragment.indexOf("#version 300 es")!==-1,i={stripVersion:t,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:H8()},setProgramName:{name:e.name},addProgramDefines:t,insertVersion:t};let o=e.fragment,a=e.vertex;Object.keys(Td).forEach(c=>{const u=i[c];o=Td[c](o,u,!0),a=Td[c](a,u,!1)}),this.fragment=o,this.vertex=a,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=gh(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,aa[this._cacheKey]=null}static from(e){const t=`${e.vertex}:${e.fragment}`;return aa[t]||(aa[t]=new Kd(e),aa[t]._cacheKey=t),aa[t]}};J0.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let em=J0;const gp={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function Q8(n){return gp[n]??gp.float32}const Z8={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function J8({source:n,entryPoint:e}){const t={},i=n.indexOf(`fn ${e}`);if(i!==-1){const o=n.indexOf("->",i);if(o!==-1){const a=n.substring(i,o),c=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let u;for(;(u=c.exec(a))!==null;){const h=Z8[u[3]]??"float32";t[u[2]]={location:parseInt(u[1],10),format:h,stride:Q8(h).stride,offset:0,instance:!1,start:0}}}}return t}function Md(n){var g,v;const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,t=/@group\((\d+)\)/,i=/@binding\((\d+)\)/,o=/var(<[^>]+>)? (\w+)/,a=/:\s*(\w+)/,c=/struct\s+(\w+)\s*{([^}]+)}/g,u=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,f=(g=n.match(e))==null?void 0:g.map(x=>({group:parseInt(x.match(t)[1],10),binding:parseInt(x.match(i)[1],10),name:x.match(o)[2],isUniform:x.match(o)[1]==="<uniform>",type:x.match(a)[1]}));if(!f)return{groups:[],structs:[]};const p=((v=n.match(c))==null?void 0:v.map(x=>{const w=x.match(h)[1],S=x.match(u).reduce((b,k)=>{const[A,M]=k.split(":");return b[A.trim()]=M.trim(),b},{});return S?{name:w,members:S}:null}).filter(({name:x})=>f.some(w=>w.type===x)))??[];return{groups:f,structs:p}}var ma=(n=>(n[n.VERTEX=1]="VERTEX",n[n.FRAGMENT=2]="FRAGMENT",n[n.COMPUTE=4]="COMPUTE",n))(ma||{});function e6({groups:n}){const e=[];for(let t=0;t<n.length;t++){const i=n[t];e[i.group]||(e[i.group]=[]),i.isUniform?e[i.group].push({binding:i.binding,visibility:ma.VERTEX|ma.FRAGMENT,buffer:{type:"uniform"}}):i.type==="sampler"?e[i.group].push({binding:i.binding,visibility:ma.FRAGMENT,sampler:{type:"filtering"}}):i.type==="texture_2d"&&e[i.group].push({binding:i.binding,visibility:ma.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function t6({groups:n}){const e=[];for(let t=0;t<n.length;t++){const i=n[t];e[i.group]||(e[i.group]={}),e[i.group][i.name]=i.binding}return e}function n6(n,e){const t=new Set,i=new Set,o=[...n.structs,...e.structs].filter(c=>t.has(c.name)?!1:(t.add(c.name),!0)),a=[...n.groups,...e.groups].filter(c=>{const u=`${c.name}-${c.binding}`;return i.has(u)?!1:(i.add(u),!0)});return{structs:o,groups:a}}const la=Object.create(null);class Pc{constructor(e){var u,h;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:t,vertex:i,layout:o,gpuLayout:a,name:c}=e;if(this.name=c,this.fragment=t,this.vertex=i,t.source===i.source){const f=Md(t.source);this.structsAndGroups=f}else{const f=Md(i.source),p=Md(t.source);this.structsAndGroups=n6(f,p)}this.layout=o??t6(this.structsAndGroups),this.gpuLayout=a??e6(this.structsAndGroups),this.autoAssignGlobalUniforms=((u=this.layout[0])==null?void 0:u.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((h=this.layout[1])==null?void 0:h.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:t}=this,i=e.source+t.source+e.entryPoint+t.entryPoint;this._layoutKey=gh(i,"program")}get attributeData(){return this._attributeData??(this._attributeData=J8(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,la[this._cacheKey]=null}static from(e){const t=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return la[t]||(la[t]=new Pc(e),la[t]._cacheKey=t),la[t]}}const tm=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],r6=tm.reduce((n,e)=>(n[e]=!0,n),{});function i6(n,e){switch(n){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const nm=class rm{constructor(e,t){this._touched=0,this.uid=wt("uniform"),this._resourceType="uniformGroup",this._resourceId=wt("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,t={...rm.defaultOptions,...t},this.uniformStructures=e;const i={};for(const o in e){const a=e[o];if(a.name=o,a.size=a.size??1,!r6[a.type]){const c=a.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(c){const[,u,h]=c;throw new Error(`Uniform type ${a.type} is not supported. Use type: '${u}', size: ${h} instead.`)}throw new Error(`Uniform type ${a.type} is not supported. Supported uniform types are: ${tm.join(", ")}`)}a.value??(a.value=i6(a.type,a.size)),i[o]=a.value}this.uniforms=i,this._dirtyId=1,this.ubo=t.ubo,this.isStatic=t.isStatic,this._signature=gh(Object.keys(i).map(o=>`${o}-${e[o].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};nm.defaultOptions={ubo:!1,isStatic:!1};let im=nm;class yc{constructor(e){this.resources=Object.create(null),this._dirty=!0;let t=0;for(const i in e){const o=e[i];this.setResource(o,t++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let t=0;for(const i in this.resources)e[t++]=this.resources[i]._resourceId;this._key=e.join("|")}setResource(e,t){var o,a;const i=this.resources[t];e!==i&&(i&&((o=e.off)==null||o.call(e,"change",this.onResourceChange,this)),(a=e.on)==null||a.call(e,"change",this.onResourceChange,this),this.resources[t]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const t=this.resources;for(const i in t)t[i]._touched=e}destroy(){var t;const e=this.resources;for(const i in e){const o=e[i];(t=o==null?void 0:o.off)==null||t.call(o,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const t=this.resources;for(const i in t)t[i]===e&&(t[i]=null)}else this._updateKey()}}var Qd=(n=>(n[n.WEBGL=1]="WEBGL",n[n.WEBGPU=2]="WEBGPU",n[n.BOTH=3]="BOTH",n))(Qd||{});class yh extends er{constructor(e){super(),this.uid=wt("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:t,glProgram:i,groups:o,resources:a,compatibleRenderers:c,groupMap:u}=e;this.gpuProgram=t,this.glProgram=i,c===void 0&&(c=0,t&&(c|=Qd.WEBGPU),i&&(c|=Qd.WEBGL)),this.compatibleRenderers=c;const h={};if(!a&&!o&&(a={}),a&&o)throw new Error("[Shader] Cannot have both resources and groups");if(!t&&o&&!u)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!t&&o&&u)for(const f in u)for(const p in u[f]){const g=u[f][p];h[g]={group:f,binding:p,name:g}}else if(t&&o&&!u){const f=t.structsAndGroups.groups;u={},f.forEach(p=>{u[p.group]=u[p.group]||{},u[p.group][p.binding]=p.name,h[p.name]=p})}else if(a){o={},u={},t&&t.structsAndGroups.groups.forEach(g=>{u[g.group]=u[g.group]||{},u[g.group][g.binding]=g.name,h[g.name]=g});let f=0;for(const p in a)h[p]||(o[99]||(o[99]=new yc,this._ownedBindGroups.push(o[99])),h[p]={group:99,binding:f,name:p},u[99]=u[99]||{},u[99][f]=p,f++);for(const p in a){const g=p;let v=a[p];!v.source&&!v._resourceType&&(v=new im(v));const x=h[g];x&&(o[x.group]||(o[x.group]=new yc,this._ownedBindGroups.push(o[x.group])),o[x.group].setResource(v,x.binding))}}this.groups=o,this._uniformBindMap=u,this.resources=this._buildResourceAccessor(o,h)}addResource(e,t,i){var o,a;(o=this._uniformBindMap)[t]||(o[t]={}),(a=this._uniformBindMap[t])[i]||(a[i]=e),this.groups[t]||(this.groups[t]=new yc,this._ownedBindGroups.push(this.groups[t]))}_buildResourceAccessor(e,t){const i={};for(const o in t){const a=t[o];Object.defineProperty(i,a.name,{get(){return e[a.group].getResource(a.binding)},set(c){e[a.group].setResource(c,a.binding)}})}return i}destroy(e=!1){var t,i;this._destroyed||(this._destroyed=!0,this.emit("destroy",this),e&&((t=this.gpuProgram)==null||t.destroy(),(i=this.glProgram)==null||i.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(o=>{o.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(e){const{gpu:t,gl:i,...o}=e;let a,c;return t&&(a=Pc.from(t)),i&&(c=em.from(i)),new yh({gpuProgram:a,glProgram:c,...o})}}const Zd=[];Wt.handleByNamedList(be.Environment,Zd);async function s6(n){if(!n)for(let e=0;e<Zd.length;e++){const t=Zd[e];if(t.value.test()){await t.value.load();return}}}let ca;function o6(){if(typeof ca=="boolean")return ca;try{ca=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ca=!1}return ca}function yp(n,e,t=2){const i=e&&e.length,o=i?e[0]*t:n.length;let a=sm(n,0,o,t,!0);const c=[];if(!a||a.next===a.prev)return c;let u,h,f;if(i&&(a=d6(n,e,a,t)),n.length>80*t){u=n[0],h=n[1];let p=u,g=h;for(let v=t;v<o;v+=t){const x=n[v],w=n[v+1];x<u&&(u=x),w<h&&(h=w),x>p&&(p=x),w>g&&(g=w)}f=Math.max(p-u,g-h),f=f!==0?32767/f:0}return Ta(a,c,t,u,h,f,0),c}function sm(n,e,t,i,o){let a;if(o===b6(n,e,t,i)>0)for(let c=e;c<t;c+=i)a=xp(c/i|0,n[c],n[c+1],a);else for(let c=t-i;c>=e;c-=i)a=xp(c/i|0,n[c],n[c+1],a);return a&&ro(a,a.next)&&(Pa(a),a=a.next),a}function es(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(ro(t,t.next)||yt(t.prev,t,t.next)===0)){if(Pa(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Ta(n,e,t,i,o,a,c){if(!n)return;!c&&a&&g6(n,i,o,a);let u=n;for(;n.prev!==n.next;){const h=n.prev,f=n.next;if(a?l6(n,i,o,a):a6(n)){e.push(h.i,n.i,f.i),Pa(n),n=f.next,u=f.next;continue}if(n=f,n===u){c?c===1?(n=c6(es(n),e),Ta(n,e,t,i,o,a,2)):c===2&&u6(n,e,t,i,o,a):Ta(es(n),e,t,i,o,a,1);break}}}function a6(n){const e=n.prev,t=n,i=n.next;if(yt(e,t,i)>=0)return!1;const o=e.x,a=t.x,c=i.x,u=e.y,h=t.y,f=i.y,p=Math.min(o,a,c),g=Math.min(u,h,f),v=Math.max(o,a,c),x=Math.max(u,h,f);let w=i.next;for(;w!==e;){if(w.x>=p&&w.x<=v&&w.y>=g&&w.y<=x&&ga(o,u,a,h,c,f,w.x,w.y)&&yt(w.prev,w,w.next)>=0)return!1;w=w.next}return!0}function l6(n,e,t,i){const o=n.prev,a=n,c=n.next;if(yt(o,a,c)>=0)return!1;const u=o.x,h=a.x,f=c.x,p=o.y,g=a.y,v=c.y,x=Math.min(u,h,f),w=Math.min(p,g,v),S=Math.max(u,h,f),b=Math.max(p,g,v),k=Jd(x,w,e,t,i),A=Jd(S,b,e,t,i);let M=n.prevZ,E=n.nextZ;for(;M&&M.z>=k&&E&&E.z<=A;){if(M.x>=x&&M.x<=S&&M.y>=w&&M.y<=b&&M!==o&&M!==c&&ga(u,p,h,g,f,v,M.x,M.y)&&yt(M.prev,M,M.next)>=0||(M=M.prevZ,E.x>=x&&E.x<=S&&E.y>=w&&E.y<=b&&E!==o&&E!==c&&ga(u,p,h,g,f,v,E.x,E.y)&&yt(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;M&&M.z>=k;){if(M.x>=x&&M.x<=S&&M.y>=w&&M.y<=b&&M!==o&&M!==c&&ga(u,p,h,g,f,v,M.x,M.y)&&yt(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;E&&E.z<=A;){if(E.x>=x&&E.x<=S&&E.y>=w&&E.y<=b&&E!==o&&E!==c&&ga(u,p,h,g,f,v,E.x,E.y)&&yt(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function c6(n,e){let t=n;do{const i=t.prev,o=t.next.next;!ro(i,o)&&am(i,t,t.next,o)&&Ma(i,o)&&Ma(o,i)&&(e.push(i.i,t.i,o.i),Pa(t),Pa(t.next),t=n=o),t=t.next}while(t!==n);return es(t)}function u6(n,e,t,i,o,a){let c=n;do{let u=c.next.next;for(;u!==c.prev;){if(c.i!==u.i&&v6(c,u)){let h=lm(c,u);c=es(c,c.next),h=es(h,h.next),Ta(c,e,t,i,o,a,0),Ta(h,e,t,i,o,a,0);return}u=u.next}c=c.next}while(c!==n)}function d6(n,e,t,i){const o=[];for(let a=0,c=e.length;a<c;a++){const u=e[a]*i,h=a<c-1?e[a+1]*i:n.length,f=sm(n,u,h,i,!1);f===f.next&&(f.steiner=!0),o.push(x6(f))}o.sort(h6);for(let a=0;a<o.length;a++)t=f6(o[a],t);return t}function h6(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const i=(n.next.y-n.y)/(n.next.x-n.x),o=(e.next.y-e.y)/(e.next.x-e.x);t=i-o}return t}function f6(n,e){const t=p6(n,e);if(!t)return e;const i=lm(t,n);return es(i,i.next),es(t,t.next)}function p6(n,e){let t=e;const i=n.x,o=n.y;let a=-1/0,c;if(ro(n,t))return t;do{if(ro(n,t.next))return t.next;if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const g=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(g<=i&&g>a&&(a=g,c=t.x<t.next.x?t:t.next,g===i))return c}t=t.next}while(t!==e);if(!c)return null;const u=c,h=c.x,f=c.y;let p=1/0;t=c;do{if(i>=t.x&&t.x>=h&&i!==t.x&&om(o<f?i:a,o,h,f,o<f?a:i,o,t.x,t.y)){const g=Math.abs(o-t.y)/(i-t.x);Ma(t,n)&&(g<p||g===p&&(t.x>c.x||t.x===c.x&&m6(c,t)))&&(c=t,p=g)}t=t.next}while(t!==u);return c}function m6(n,e){return yt(n.prev,n,e.prev)<0&&yt(e.next,n,n.next)<0}function g6(n,e,t,i){let o=n;do o.z===0&&(o.z=Jd(o.x,o.y,e,t,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==n);o.prevZ.nextZ=null,o.prevZ=null,y6(o)}function y6(n){let e,t=1;do{let i=n,o;n=null;let a=null;for(e=0;i;){e++;let c=i,u=0;for(let f=0;f<t&&(u++,c=c.nextZ,!!c);f++);let h=t;for(;u>0||h>0&&c;)u!==0&&(h===0||!c||i.z<=c.z)?(o=i,i=i.nextZ,u--):(o=c,c=c.nextZ,h--),a?a.nextZ=o:n=o,o.prevZ=a,a=o;i=c}a.nextZ=null,t*=2}while(e>1);return n}function Jd(n,e,t,i,o){return n=(n-t)*o|0,e=(e-i)*o|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function x6(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function om(n,e,t,i,o,a,c,u){return(o-c)*(e-u)>=(n-c)*(a-u)&&(n-c)*(i-u)>=(t-c)*(e-u)&&(t-c)*(a-u)>=(o-c)*(i-u)}function ga(n,e,t,i,o,a,c,u){return!(n===c&&e===u)&&om(n,e,t,i,o,a,c,u)}function v6(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!_6(n,e)&&(Ma(n,e)&&Ma(e,n)&&w6(n,e)&&(yt(n.prev,n,e.prev)||yt(n,e.prev,e))||ro(n,e)&&yt(n.prev,n,n.next)>0&&yt(e.prev,e,e.next)>0)}function yt(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function ro(n,e){return n.x===e.x&&n.y===e.y}function am(n,e,t,i){const o=oc(yt(n,e,t)),a=oc(yt(n,e,i)),c=oc(yt(t,i,n)),u=oc(yt(t,i,e));return!!(o!==a&&c!==u||o===0&&sc(n,t,e)||a===0&&sc(n,i,e)||c===0&&sc(t,n,i)||u===0&&sc(t,e,i))}function sc(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function oc(n){return n>0?1:n<0?-1:0}function _6(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&am(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Ma(n,e){return yt(n.prev,n,n.next)<0?yt(n,e,n.next)>=0&&yt(n,n.prev,e)>=0:yt(n,e,n.prev)<0||yt(n,n.next,e)<0}function w6(n,e){let t=n,i=!1;const o=(n.x+e.x)/2,a=(n.y+e.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&o<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function lm(n,e){const t=eh(n.i,n.x,n.y),i=eh(e.i,e.x,e.y),o=n.next,a=e.prev;return n.next=e,e.prev=n,t.next=o,o.prev=t,i.next=t,t.prev=i,a.next=i,i.prev=a,i}function xp(n,e,t,i){const o=eh(n,e,t);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function Pa(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function eh(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function b6(n,e,t,i){let o=0;for(let a=e,c=t-i;a<t;a+=i)o+=(n[c]-n[a])*(n[a+1]+n[c+1]),c=a;return o}const S6=yp.default||yp;var cm=(n=>(n[n.NONE=0]="NONE",n[n.COLOR=16384]="COLOR",n[n.STENCIL=1024]="STENCIL",n[n.DEPTH=256]="DEPTH",n[n.COLOR_DEPTH=16640]="COLOR_DEPTH",n[n.COLOR_STENCIL=17408]="COLOR_STENCIL",n[n.DEPTH_STENCIL=1280]="DEPTH_STENCIL",n[n.ALL=17664]="ALL",n))(cm||{});class k6{constructor(e){this.items=[],this._name=e}emit(e,t,i,o,a,c,u,h){const{name:f,items:p}=this;for(let g=0,v=p.length;g<v;g++)p[g][f](e,t,i,o,a,c,u,h);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&this.items.splice(t,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const C6=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],um=class dm extends er{constructor(e){super(),this.uid=wt("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const t=[...C6,...this.config.runners??[]];this._addRunners(...t),this._unsafeEvalCheck()}async init(e={}){const t=e.skipExtensionImports===!0?!0:e.manageImports===!1;await s6(t),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const i in this._systemsHash)e={...this._systemsHash[i].constructor.defaultOptions,...e};e={...dm.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let i=0;i<this.runners.init.items.length;i++)await this.runners.init.items[i].init(e);this._initOptions=e}render(e,t){let i=e;if(i instanceof xn&&(i={container:i},t&&(Fe(Je,"passing a second argument is deprecated, please use render options instead"),i.target=t.renderTexture)),i.target||(i.target=this.view.renderTarget),i.target===this.view.renderTarget&&(this._lastObjectRendered=i.container,i.clearColor??(i.clearColor=this.background.colorRgba),i.clear??(i.clear=this.background.clearBeforeRender)),i.clearColor){const o=Array.isArray(i.clearColor)&&i.clearColor.length===4;i.clearColor=o?i.clearColor:At.shared.setValue(i.clearColor).toArray()}i.transform||(i.container.updateLocalTransform(),i.transform=i.container.localTransform),i.container.visible&&(i.container.enableRenderGroup(),this.runners.prerender.emit(i),this.runners.renderStart.emit(i),this.runners.render.emit(i),this.runners.renderEnd.emit(i),this.runners.postrender.emit(i))}resize(e,t,i){const o=this.view.resolution;this.view.resize(e,t,i),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),i!==void 0&&i!==o&&this.runners.resolutionChange.emit(i)}clear(e={}){const t=this;e.target||(e.target=t.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=cm.ALL);const{clear:i,clearColor:o,target:a}=e;At.shared.setValue(o??this.background.colorRgba),t.renderTarget.clear(a,i,At.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(t=>{this.runners[t]=new k6(t)})}_addSystems(e){let t;for(t in e){const i=e[t];this._addSystem(i.value,i.name)}}_addSystem(e,t){const i=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=i,this._systemsHash[t]=i;for(const o in this.runners)this.runners[o].add(i);return this}_addPipes(e,t){const i=t.reduce((o,a)=>(o[a.name]=a.value,o),{});e.forEach(o=>{const a=o.value,c=o.name,u=i[c];this.renderPipes[c]=new a(this,u?new u:null),this.runners.destroy.add(this.renderPipes[c])})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),(e===!0||typeof e=="object"&&e.releaseGlobalResources)&&Da.release(),Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!o6())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};um.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let hm=um,ac;function A6(n){return ac!==void 0||(ac=(()=>{var t;const e={stencil:!0,failIfMajorPerformanceCaveat:n??hm.defaultOptions.failIfMajorPerformanceCaveat};try{if(!rt.get().getWebGLRenderingContext())return!1;let o=rt.get().createCanvas().getContext("webgl",e);const a=!!((t=o==null?void 0:o.getContextAttributes())!=null&&t.stencil);if(o){const c=o.getExtension("WEBGL_lose_context");c&&c.loseContext()}return o=null,a}catch{return!1}})()),ac}let lc;async function T6(n={}){return lc!==void 0||(lc=await(async()=>{const e=rt.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(n)).requestDevice(),!0}catch{return!1}})()),lc}const vp=["webgl","webgpu","canvas"];async function M6(n){let e=[];n.preference?(e.push(n.preference),vp.forEach(a=>{a!==n.preference&&e.push(a)})):e=vp.slice();let t,i={};for(let a=0;a<e.length;a++){const c=e[a];if(c==="webgpu"&&await T6()){const{WebGPURenderer:u}=await bc(async()=>{const{WebGPURenderer:h}=await import("./WebGPURenderer-ChVKvC3p.js");return{WebGPURenderer:h}},__vite__mapDeps([3,2,4]));t=u,i={...n,...n.webgpu};break}else if(c==="webgl"&&A6(n.failIfMajorPerformanceCaveat??hm.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:u}=await bc(async()=>{const{WebGLRenderer:h}=await import("./WebGLRenderer-D8udQsyz.js");return{WebGLRenderer:h}},__vite__mapDeps([5,2,4]));t=u,i={...n,...n.webgl};break}else if(c==="canvas")throw i={...n},new Error("CanvasRenderer is not yet implemented")}if(delete i.webgpu,delete i.webgl,!t)throw new Error("No available renderer for the current environment");const o=new t;return await o.init(i),o}const fm="8.14.3";class pm{static init(){var e;(e=globalThis.__PIXI_APP_INIT__)==null||e.call(globalThis,this,fm)}static destroy(){}}pm.extension=be.Application;class P6{constructor(e){this._renderer=e}init(){var e;(e=globalThis.__PIXI_RENDERER_INIT__)==null||e.call(globalThis,this._renderer,fm)}destroy(){this._renderer=null}}P6.extension={type:[be.WebGLSystem,be.WebGPUSystem],name:"initHook",priority:-10};const mm=class th{constructor(...e){this.stage=new xn,e[0]!==void 0&&Fe(Je,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.stage||(this.stage=new xn),this.renderer=await M6(e),th._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return Fe(Je,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,t=!1){const i=th._plugins.slice(0);i.reverse(),i.forEach(o=>{o.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};mm._plugins=[];let gm=mm;Wt.handleByList(be.Application,gm._plugins);Wt.add(pm);class ym extends er{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return Fe(Je,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return Fe(Je,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return Fe(Je,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return Fe(Je,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return Fe(Je,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){var t;this.emit("destroy",this),this.removeAllListeners();for(const i in this.chars)(t=this.chars[i].texture)==null||t.destroy();this.chars=null,e&&(this.pages.forEach(i=>i.texture.destroy(!0)),this.pages=null)}}/**
 * tiny-lru
 *
 * @copyright 2025 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 11.4.5
 */class E6{constructor(e=0,t=0,i=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=i,this.size=0,this.ttl=t}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){const t=this.items[e];delete this.items[e],this.size--,t.prev!==null&&(t.prev.next=t.next),t.next!==null&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}return this}entries(e=this.keys()){return e.map(t=>[t,this.get(t)])}evict(e=!1){if(e||this.size>0){const t=this.first;delete this.items[t.key],--this.size===0?(this.first=null,this.last=null):(this.first=t.next,this.first.prev=null)}return this}expiresAt(e){let t;return this.has(e)&&(t=this.items[e].expiry),t}get(e){const t=this.items[e];if(t!==void 0){if(this.ttl>0&&t.expiry<=Date.now()){this.delete(e);return}return this.moveToEnd(t),t.value}}has(e){return e in this.items}moveToEnd(e){this.last!==e&&(e.prev!==null&&(e.prev.next=e.next),e.next!==null&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),e.prev=this.last,e.next=null,this.last!==null&&(this.last.next=e),this.last=e,this.first===null&&(this.first=e))}keys(){const e=[];let t=this.first;for(;t!==null;)e.push(t.key),t=t.next;return e}setWithEvicted(e,t,i=this.resetTtl){let o=null;if(this.has(e))this.set(e,t,!0,i);else{this.max>0&&this.size===this.max&&(o={...this.first},this.evict(!0));let a=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t};++this.size===1?this.first=a:this.last.next=a,this.last=a}return o}set(e,t,i=!1,o=this.resetTtl){let a=this.items[e];return i||a!==void 0?(a.value=t,i===!1&&o&&(a.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(a)):(this.max>0&&this.size===this.max&&this.evict(!0),a=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t},++this.size===1?this.first=a:this.last.next=a,this.last=a),this}values(e=this.keys()){return e.map(t=>this.get(t))}}function xm(n=1e3,e=0,t=!1){if(isNaN(n)||n<0)throw new TypeError("Invalid max value");if(isNaN(e)||e<0)throw new TypeError("Invalid ttl value");if(typeof t!="boolean")throw new TypeError("Invalid resetTtl value");return new E6(n,e,t)}const R6=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function kc(n){const e=typeof n.fontSize=="number"?`${n.fontSize}px`:n.fontSize;let t=n.fontFamily;Array.isArray(n.fontFamily)||(t=n.fontFamily.split(","));for(let i=t.length-1;i>=0;i--){let o=t[i].trim();!/([\"\'])[^\'\"]+\1/.test(o)&&!R6.includes(o)&&(o=`"${o}"`),t[i]=o}return`${n.fontStyle} ${n.fontVariant} ${n.fontWeight} ${e} ${t.join(",")}`}const Pd={willReadFrequently:!0},nr=class xe{static get experimentalLetterSpacingSupported(){let e=xe._experimentalLetterSpacingSupported;if(e===void 0){const t=rt.get().getCanvasRenderingContext2D().prototype;e=xe._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,i,o,a,c,u,h,f){this.text=e,this.style=t,this.width=i,this.height=o,this.lines=a,this.lineWidths=c,this.lineHeight=u,this.maxLineWidth=h,this.fontProperties=f}static measureText(e=" ",t,i=xe._canvas,o=t.wordWrap){var A;const a=`${e}-${t.styleKey}-wordWrap-${o}`;if(xe._measurementCache.has(a))return xe._measurementCache.get(a);const c=kc(t),u=xe.measureFont(c);u.fontSize===0&&(u.fontSize=t.fontSize,u.ascent=t.fontSize);const h=xe.__context;h.font=c;const p=(o?xe._wordWrap(e,t,i):e).split(/(?:\r\n|\r|\n)/),g=new Array(p.length);let v=0;for(let M=0;M<p.length;M++){const E=xe._measureText(p[M],t.letterSpacing,h);g[M]=E,v=Math.max(v,E)}const x=((A=t._stroke)==null?void 0:A.width)||0;let w=v+x;t.dropShadow&&(w+=t.dropShadow.distance);const S=t.lineHeight||u.fontSize;let b=Math.max(S,u.fontSize+x)+(p.length-1)*(S+t.leading);t.dropShadow&&(b+=t.dropShadow.distance);const k=new xe(e,t,w,b,p,g,S+t.leading,v,u);return xe._measurementCache.set(a,k),k}static _measureText(e,t,i){let o=!1;xe.experimentalLetterSpacingSupported&&(xe.experimentalLetterSpacing?(i.letterSpacing=`${t}px`,i.textLetterSpacing=`${t}px`,o=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));const a=i.measureText(e);let c=a.width;const u=-a.actualBoundingBoxLeft;let f=a.actualBoundingBoxRight-u;if(c>0)if(o)c-=t,f-=t;else{const p=(xe.graphemeSegmenter(e).length-1)*t;c+=p,f+=p}return Math.max(c,f)}static _wordWrap(e,t,i=xe._canvas){const o=i.getContext("2d",Pd);let a=0,c="",u="";const h=Object.create(null),{letterSpacing:f,whiteSpace:p}=t,g=xe._collapseSpaces(p),v=xe._collapseNewlines(p);let x=!g;const w=t.wordWrapWidth+f,S=xe._tokenize(e);for(let b=0;b<S.length;b++){let k=S[b];if(xe._isNewline(k)){if(!v){u+=xe._addLine(c),x=!g,c="",a=0;continue}k=" "}if(g){const M=xe.isBreakingSpace(k),E=xe.isBreakingSpace(c[c.length-1]);if(M&&E)continue}const A=xe._getFromCache(k,f,h,o);if(A>w)if(c!==""&&(u+=xe._addLine(c),c="",a=0),xe.canBreakWords(k,t.breakWords)){const M=xe.wordWrapSplit(k);for(let E=0;E<M.length;E++){let B=M[E],F=B,I=1;for(;M[E+I];){const U=M[E+I];if(!xe.canBreakChars(F,U,k,E,t.breakWords))B+=U;else break;F=U,I++}E+=I-1;const N=xe._getFromCache(B,f,h,o);N+a>w&&(u+=xe._addLine(c),x=!1,c="",a=0),c+=B,a+=N}}else{c.length>0&&(u+=xe._addLine(c),c="",a=0);const M=b===S.length-1;u+=xe._addLine(k,!M),x=!1,c="",a=0}else A+a>w&&(x=!1,u+=xe._addLine(c),c="",a=0),(c.length>0||!xe.isBreakingSpace(k)||x)&&(c+=k,a+=A)}return u+=xe._addLine(c,!1),u}static _addLine(e,t=!0){return e=xe._trimRight(e),e=t?`${e}
`:e,e}static _getFromCache(e,t,i,o){let a=i[e];return typeof a!="number"&&(a=xe._measureText(e,t,o)+t,i[e]=a),a}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const i=e[t];if(!xe.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:xe._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:xe._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const t=[];let i="";if(typeof e!="string")return t;for(let o=0;o<e.length;o++){const a=e[o],c=e[o+1];if(xe.isBreakingSpace(a,c)||xe._isNewline(a)){i!==""&&(t.push(i),i=""),a==="\r"&&c===`
`?(t.push(`\r
`),o++):t.push(a);continue}i+=a}return i!==""&&t.push(i),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,i,o,a){return!0}static wordWrapSplit(e){return xe.graphemeSegmenter(e)}static measureFont(e){if(xe._fonts[e])return xe._fonts[e];const t=xe._context;t.font=e;const i=t.measureText(xe.METRICS_STRING+xe.BASELINE_SYMBOL),o={ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,fontSize:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return xe._fonts[e]=o,o}static clearMetrics(e=""){e?delete xe._fonts[e]:xe._fonts={}}static get _canvas(){if(!xe.__canvas){let e;try{const t=new OffscreenCanvas(0,0),i=t.getContext("2d",Pd);if(i!=null&&i.measureText)return xe.__canvas=t,t;e=rt.get().createCanvas()}catch{e=rt.get().createCanvas()}e.width=e.height=10,xe.__canvas=e}return xe.__canvas}static get _context(){return xe.__context||(xe.__context=xe._canvas.getContext("2d",Pd)),xe.__context}};nr.METRICS_STRING="|q";nr.BASELINE_SYMBOL="M";nr.BASELINE_MULTIPLIER=1.4;nr.HEIGHT_MULTIPLIER=2;nr.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const n=new Intl.Segmenter;return e=>{const t=n.segment(e),i=[];let o=0;for(const a of t)i[o++]=a.segment;return i}}return n=>[...n]})();nr.experimentalLetterSpacing=!1;nr._fonts={};nr._newlines=[10,13];nr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];nr._measurementCache=xm(1e3);let vr=nr;const _p=[{offset:0,color:"white"},{offset:1,color:"black"}],xh=class nh{constructor(...e){this.uid=wt("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let t=I6(e);t={...t.type==="radial"?nh.defaultRadialOptions:nh.defaultLinearOptions,...b0(t)},this._textureSize=t.textureSize,this._wrapMode=t.wrapMode,t.type==="radial"?(this.center=t.center,this.outerCenter=t.outerCenter??this.center,this.innerRadius=t.innerRadius,this.outerRadius=t.outerRadius,this.scale=t.scale,this.rotation=t.rotation):(this.start=t.start,this.end=t.end),this.textureSpace=t.textureSpace,this.type=t.type,t.colorStops.forEach(o=>{this.addColorStop(o.offset,o.color)})}addColorStop(e,t){return this.colorStops.push({offset:e,color:At.shared.setValue(t).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:e,y:t}=this.start,{x:i,y:o}=this.end,a=i-e,c=o-t;const u=a<0||c<0;if(this._wrapMode==="clamp-to-edge"){if(a<0){const b=e;e=i,i=b,a*=-1}if(c<0){const b=t;t=o,o=b,c*=-1}}const h=this.colorStops.length?this.colorStops:_p,f=this._textureSize,{canvas:p,context:g}=bp(f,1),v=u?g.createLinearGradient(this._textureSize,0,0,0):g.createLinearGradient(0,0,this._textureSize,0);wp(v,h),g.fillStyle=v,g.fillRect(0,0,f,1),this.texture=new Ne({source:new Ji({resource:p,addressMode:this._wrapMode})});const x=Math.sqrt(a*a+c*c),w=Math.atan2(c,a),S=new Be;S.scale(x/f,1),S.rotate(w),S.translate(e,t),this.textureSpace==="local"&&S.scale(f,f),this.transform=S}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:_p,t=this._textureSize,{canvas:i,context:o}=bp(t,t),{x:a,y:c}=this.center,{x:u,y:h}=this.outerCenter,f=this.innerRadius,p=this.outerRadius,g=u-p,v=h-p,x=t/(p*2),w=(a-g)*x,S=(c-v)*x,b=o.createRadialGradient(w,S,f*x,(u-g)*x,(h-v)*x,p*x);wp(b,e),o.fillStyle=e[e.length-1].color,o.fillRect(0,0,t,t),o.fillStyle=b,o.translate(w,S),o.rotate(this.rotation),o.scale(1,this.scale),o.translate(-w,-S),o.fillRect(0,0,t,t),this.texture=new Ne({source:new Ji({resource:i,addressMode:this._wrapMode})});const k=new Be;k.scale(1/x,1/x),k.translate(g,v),this.textureSpace==="local"&&k.scale(t,t),this.transform=k}destroy(){var e;(e=this.texture)==null||e.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};xh.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};xh.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let Or=xh;function wp(n,e){for(let t=0;t<e.length;t++){const i=e[t];n.addColorStop(i.offset,i.color)}}function bp(n,e){const t=rt.get().createCanvas(n,e),i=t.getContext("2d");return{canvas:t,context:i}}function I6(n){let e=n[0]??{};return(typeof e=="number"||n[1])&&(Fe("8.5.2","use options object instead"),e={type:"linear",start:{x:n[0],y:n[1]},end:{x:n[2],y:n[3]},textureSpace:n[4],textureSize:n[5]??Or.defaultLinearOptions.textureSize}),e}const Sp={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Ec{constructor(e,t){this.uid=wt("fillPattern"),this._tick=0,this.transform=new Be,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),t&&(e.source.style.addressModeU=Sp[t].addressModeU,e.source.style.addressModeV=Sp[t].addressModeV)}setTransform(e){const t=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/t.frame.width,1/t.frame.height),this._tick++}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture=e,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}var Ed,kp;function $6(){if(kp)return Ed;kp=1,Ed=t;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function t(a){var c=[];return a.replace(e,function(u,h,f){var p=h.toLowerCase();for(f=o(f),p=="m"&&f.length>2&&(c.push([h].concat(f.splice(0,2))),p="l",h=h=="m"?"l":"L");;){if(f.length==n[p])return f.unshift(h),c.push(f);if(f.length<n[p])throw new Error("malformed path data");c.push([h].concat(f.splice(0,n[p])))}}),c}var i=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function o(a){var c=a.match(i);return c?c.map(Number):[]}return Ed}var L6=$6();const z6=lh(L6);function F6(n,e){const t=z6(n),i=[];let o=null,a=0,c=0;for(let u=0;u<t.length;u++){const h=t[u],f=h[0],p=h;switch(f){case"M":a=p[1],c=p[2],e.moveTo(a,c);break;case"m":a+=p[1],c+=p[2],e.moveTo(a,c);break;case"H":a=p[1],e.lineTo(a,c);break;case"h":a+=p[1],e.lineTo(a,c);break;case"V":c=p[1],e.lineTo(a,c);break;case"v":c+=p[1],e.lineTo(a,c);break;case"L":a=p[1],c=p[2],e.lineTo(a,c);break;case"l":a+=p[1],c+=p[2],e.lineTo(a,c);break;case"C":a=p[5],c=p[6],e.bezierCurveTo(p[1],p[2],p[3],p[4],a,c);break;case"c":e.bezierCurveTo(a+p[1],c+p[2],a+p[3],c+p[4],a+p[5],c+p[6]),a+=p[5],c+=p[6];break;case"S":a=p[3],c=p[4],e.bezierCurveToShort(p[1],p[2],a,c);break;case"s":e.bezierCurveToShort(a+p[1],c+p[2],a+p[3],c+p[4]),a+=p[3],c+=p[4];break;case"Q":a=p[3],c=p[4],e.quadraticCurveTo(p[1],p[2],a,c);break;case"q":e.quadraticCurveTo(a+p[1],c+p[2],a+p[3],c+p[4]),a+=p[3],c+=p[4];break;case"T":a=p[1],c=p[2],e.quadraticCurveToShort(a,c);break;case"t":a+=p[1],c+=p[2],e.quadraticCurveToShort(a,c);break;case"A":a=p[6],c=p[7],e.arcToSvg(p[1],p[2],p[3],p[4],p[5],a,c);break;case"a":a+=p[6],c+=p[7],e.arcToSvg(p[1],p[2],p[3],p[4],p[5],a,c);break;case"Z":case"z":e.closePath(),i.length>0&&(o=i.pop(),o?(a=o.startX,c=o.startY):(a=0,c=0)),o=null;break;default:ct(`Unknown SVG path command: ${f}`)}f!=="Z"&&f!=="z"&&o===null&&(o={startX:a,startY:c},i.push(o))}return e}class vh{constructor(e=0,t=0,i=0){this.type="circle",this.x=e,this.y=t,this.radius=i}clone(){return new vh(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const i=this.radius*this.radius;let o=this.x-e,a=this.y-t;return o*=o,a*=a,o+a<=i}strokeContains(e,t,i,o=.5){if(this.radius===0)return!1;const a=this.x-e,c=this.y-t,u=this.radius,h=(1-o)*i,f=Math.sqrt(a*a+c*c);return f<=u+h&&f>u-(i-h)}getBounds(e){return e||(e=new ft),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class _h{constructor(e=0,t=0,i=0,o=0){this.type="ellipse",this.x=e,this.y=t,this.halfWidth=i,this.halfHeight=o}clone(){return new _h(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,t){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(e-this.x)/this.halfWidth,o=(t-this.y)/this.halfHeight;return i*=i,o*=o,i+o<=1}strokeContains(e,t,i,o=.5){const{halfWidth:a,halfHeight:c}=this;if(a<=0||c<=0)return!1;const u=i*(1-o),h=i-u,f=a-h,p=c-h,g=a+u,v=c+u,x=e-this.x,w=t-this.y,S=x*x/(f*f)+w*w/(p*p),b=x*x/(g*g)+w*w/(v*v);return S>1&&b<=1}getBounds(e){return e||(e=new ft),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function j6(n,e,t,i,o,a){const c=n-t,u=e-i,h=o-t,f=a-i,p=c*h+u*f,g=h*h+f*f;let v=-1;g!==0&&(v=p/g);let x,w;v<0?(x=t,w=i):v>1?(x=o,w=a):(x=t+v*h,w=i+v*f);const S=n-x,b=e-w;return S*S+b*b}let B6,D6;class va{constructor(...e){this.type="polygon";let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const i=[];for(let o=0,a=t.length;o<a;o++)i.push(t[o].x,t[o].y);t=i}this.points=t,this.closePath=!0}isClockwise(){let e=0;const t=this.points,i=t.length;for(let o=0;o<i;o+=2){const a=t[o],c=t[o+1],u=t[(o+2)%i],h=t[(o+3)%i];e+=(u-a)*(h+c)}return e<0}containsPolygon(e){const t=this.getBounds(B6),i=e.getBounds(D6);if(!t.containsRect(i))return!1;const o=e.points;for(let a=0;a<o.length;a+=2){const c=o[a],u=o[a+1];if(!this.contains(c,u))return!1}return!0}clone(){const e=this.points.slice(),t=new va(e);return t.closePath=this.closePath,t}contains(e,t){let i=!1;const o=this.points.length/2;for(let a=0,c=o-1;a<o;c=a++){const u=this.points[a*2],h=this.points[a*2+1],f=this.points[c*2],p=this.points[c*2+1];h>t!=p>t&&e<(f-u)*((t-h)/(p-h))+u&&(i=!i)}return i}strokeContains(e,t,i,o=.5){const a=i*i,c=a*(1-o),u=a-c,{points:h}=this,f=h.length-(this.closePath?0:2);for(let p=0;p<f;p+=2){const g=h[p],v=h[p+1],x=h[(p+2)%h.length],w=h[(p+3)%h.length],S=j6(e,t,g,v,x,w),b=Math.sign((x-g)*(t-v)-(w-v)*(e-g));if(S<=(b<0?u:c))return!0}return!1}getBounds(e){e||(e=new ft);const t=this.points;let i=1/0,o=-1/0,a=1/0,c=-1/0;for(let u=0,h=t.length;u<h;u+=2){const f=t[u],p=t[u+1];i=f<i?f:i,o=f>o?f:o,a=p<a?p:a,c=p>c?p:c}return e.x=i,e.width=o-i,e.y=a,e.height=c-a,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,t)=>`${e}, ${t}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return Fe("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return Fe("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const cc=(n,e,t,i,o,a,c)=>{const u=n-t,h=e-i,f=Math.sqrt(u*u+h*h);return f>=o-a&&f<=o+c};class wh{constructor(e=0,t=0,i=0,o=0,a=20){this.type="roundedRectangle",this.x=e,this.y=t,this.width=i,this.height=o,this.radius=a}getBounds(e){return e||(e=new ft),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new wh(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+i&&t<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let o=e-(this.x+i),a=t-(this.y+i);const c=i*i;if(o*o+a*a<=c||(o=e-(this.x+this.width-i),o*o+a*a<=c)||(a=t-(this.y+this.height-i),o*o+a*a<=c)||(o=e-(this.x+i),o*o+a*a<=c))return!0}return!1}strokeContains(e,t,i,o=.5){const{x:a,y:c,width:u,height:h,radius:f}=this,p=i*(1-o),g=i-p,v=a+f,x=c+f,w=u-f*2,S=h-f*2,b=a+u,k=c+h;return(e>=a-p&&e<=a+g||e>=b-g&&e<=b+p)&&t>=x&&t<=x+S||(t>=c-p&&t<=c+g||t>=k-g&&t<=k+p)&&e>=v&&e<=v+w?!0:e<v&&t<x&&cc(e,t,v,x,f,g,p)||e>b-f&&t<x&&cc(e,t,b-f,x,f,g,p)||e>b-f&&t>k-f&&cc(e,t,b-f,k-f,f,g,p)||e<v&&t>k-f&&cc(e,t,v,k-f,f,g,p)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const vm={};function O6(n,e,t){let i=2166136261;for(let o=0;o<e;o++)i^=n[o].uid,i=Math.imul(i,16777619),i>>>=0;return vm[i]||N6(n,e,i,t)}function N6(n,e,t,i){const o={};let a=0;for(let u=0;u<i;u++){const h=u<e?n[u]:Ne.EMPTY.source;o[a++]=h.source,o[a++]=h.style}const c=new yc(o);return vm[t]=c,c}class Cp{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function Ap(n,e){const t=n.byteLength/8|0,i=new Float64Array(n,0,t);new Float64Array(e,0,t).set(i);const a=n.byteLength-t*8;if(a>0){const c=new Uint8Array(n,t*8,a);new Uint8Array(e,t*8,a).set(c)}}const W6={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var H6=(n=>(n[n.DISABLED=0]="DISABLED",n[n.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",n[n.MASK_ACTIVE=2]="MASK_ACTIVE",n[n.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",n[n.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",n[n.NONE=5]="NONE",n))(H6||{});function Tp(n,e){return e.alphaMode==="no-premultiply-alpha"&&W6[n]||n}const U6=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function G6(n){let e="";for(let t=0;t<n;++t)t>0&&(e+=`
else `),t<n-1&&(e+=`if(test == ${t}.0){}`);return e}function V6(n,e){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const i=U6.replace(/%forloop%/gi,G6(n));if(e.shaderSource(t,i),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))n=n/2|0;else break}}finally{e.deleteShader(t)}return n}let Us=null;function Y6(){var e;if(Us)return Us;const n=Z0();return Us=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),Us=V6(Us,n),(e=n.getExtension("WEBGL_lose_context"))==null||e.loseContext(),Us}class X6{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const t=this.textures[e];this.textures[e]=null,this.ids[t.uid]=null}this.count=0}}class q6{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new X6,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const _a=[];let Cc=0;Da.register({clear:()=>{if(_a.length>0)for(const n of _a)n&&n.destroy();_a.length=0,Cc=0}});function Mp(){return Cc>0?_a[--Cc]:new q6}function Pp(n){_a[Cc++]=n}let ua=0;const _m=class wm{constructor(e){this.uid=wt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],e={...wm.defaultOptions,...e},e.maxTextures||(Fe("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),e.maxTextures=Y6());const{maxTextures:t,attributesInitialSize:i,indicesInitialSize:o}=e;this.attributeBuffer=new Cp(i*4),this.indexBuffer=new Uint16Array(o),this.maxTextures=t}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)Pp(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,t){const i=e._batch.textures.ids[t._source.uid];return!i&&i!==0?!1:(e._textureId=i,e.texture=t,!0)}updateElement(e){this.dirty=!0;const t=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId)}break(e){const t=this._elements;if(!t[this.elementStart])return;let i=Mp(),o=i.textures;o.clear();const a=t[this.elementStart];let c=Tp(a.blendMode,a.texture._source),u=a.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const h=this.attributeBuffer.float32View,f=this.attributeBuffer.uint32View,p=this.indexBuffer;let g=this._batchIndexSize,v=this._batchIndexStart,x="startBatch";const w=this.maxTextures;for(let S=this.elementStart;S<this.elementSize;++S){const b=t[S];t[S]=null;const A=b.texture._source,M=Tp(b.blendMode,A),E=c!==M||u!==b.topology;if(A._batchTick===ua&&!E){b._textureId=A._textureBindLocation,g+=b.indexSize,b.packAsQuad?(this.packQuadAttributes(b,h,f,b._attributeStart,b._textureId),this.packQuadIndex(p,b._indexStart,b._attributeStart/this.vertexSize)):(this.packAttributes(b,h,f,b._attributeStart,b._textureId),this.packIndex(b,p,b._indexStart,b._attributeStart/this.vertexSize)),b._batch=i;continue}A._batchTick=ua,(o.count>=w||E)&&(this._finishBatch(i,v,g-v,o,c,u,e,x),x="renderBatch",v=g,c=M,u=b.topology,i=Mp(),o=i.textures,o.clear(),++ua),b._textureId=A._textureBindLocation=o.count,o.ids[A.uid]=o.count,o.textures[o.count++]=A,b._batch=i,g+=b.indexSize,b.packAsQuad?(this.packQuadAttributes(b,h,f,b._attributeStart,b._textureId),this.packQuadIndex(p,b._indexStart,b._attributeStart/this.vertexSize)):(this.packAttributes(b,h,f,b._attributeStart,b._textureId),this.packIndex(b,p,b._indexStart,b._attributeStart/this.vertexSize))}o.count>0&&(this._finishBatch(i,v,g-v,o,c,u,e,x),v=g,++ua),this.elementStart=this.elementSize,this._batchIndexStart=v,this._batchIndexSize=g}_finishBatch(e,t,i,o,a,c,u,h){e.gpuBindGroup=null,e.bindGroup=null,e.action=h,e.batcher=this,e.textures=o,e.blendMode=a,e.topology=c,e.start=t,e.size=i,++ua,this.batches[this.batchIndex++]=e,u.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const t=Math.max(e,this.attributeBuffer.size*2),i=new Cp(t);Ap(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}_resizeIndexBuffer(e){const t=this.indexBuffer;let i=Math.max(e,t.length*1.5);i+=i%2;const o=i>65535?new Uint32Array(i):new Uint16Array(i);if(o.BYTES_PER_ELEMENT!==t.BYTES_PER_ELEMENT)for(let a=0;a<t.length;a++)o[a]=t[a];else Ap(t.buffer,o.buffer);this.indexBuffer=o}packQuadIndex(e,t,i){e[t]=i+0,e[t+1]=i+1,e[t+2]=i+2,e[t+3]=i+0,e[t+4]=i+2,e[t+5]=i+3}packIndex(e,t,i,o){const a=e.indices,c=e.indexSize,u=e.indexOffset,h=e.attributeOffset;for(let f=0;f<c;f++)t[i++]=o+a[f+u]-h}destroy(e={}){var t;if(this.batches!==null){for(let i=0;i<this.batches.length;i++)Pp(this.batches[i]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,e.shader&&((t=this.shader)==null||t.destroy(),this.shader=null);for(let i=0;i<this._elements.length;i++)this._elements[i]&&(this._elements[i]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};_m.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let K6=_m;var yn=(n=>(n[n.MAP_READ=1]="MAP_READ",n[n.MAP_WRITE=2]="MAP_WRITE",n[n.COPY_SRC=4]="COPY_SRC",n[n.COPY_DST=8]="COPY_DST",n[n.INDEX=16]="INDEX",n[n.VERTEX=32]="VERTEX",n[n.UNIFORM=64]="UNIFORM",n[n.STORAGE=128]="STORAGE",n[n.INDIRECT=256]="INDIRECT",n[n.QUERY_RESOLVE=512]="QUERY_RESOLVE",n[n.STATIC=1024]="STATIC",n))(yn||{});class Ea extends er{constructor(e){let{data:t,size:i}=e;const{usage:o,label:a,shrinkToFit:c}=e;super(),this.uid=wt("buffer"),this._resourceType="buffer",this._resourceId=wt("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,i??(i=t==null?void 0:t.byteLength);const u=!!t;this.descriptor={size:i,usage:o,mappedAtCreation:u,label:a},this.shrinkToFit=c??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&yn.STATIC)}set static(e){e?this.descriptor.usage|=yn.STATIC:this.descriptor.usage&=~yn.STATIC}setDataWithSize(e,t,i){if(this._updateID++,this._updateSize=t*e.BYTES_PER_ELEMENT,this._data===e){i&&this.emit("update",this);return}const o=this._data;if(this._data=e,this._dataInt32=null,!o||o.length!==e.length){!this.shrinkToFit&&o&&e.byteLength<o.byteLength?i&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=wt("resource"),this.emit("change",this));return}i&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function bm(n,e){if(!(n instanceof Ea)){let t=e?yn.INDEX:yn.VERTEX;n instanceof Array&&(e?(n=new Uint32Array(n),t=yn.INDEX|yn.COPY_DST):(n=new Float32Array(n),t=yn.VERTEX|yn.COPY_DST)),n=new Ea({data:n,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:t})}return n}function Q6(n,e,t){const i=n.getAttribute(e);if(!i)return t.minX=0,t.minY=0,t.maxX=0,t.maxY=0,t;const o=i.buffer.data;let a=1/0,c=1/0,u=-1/0,h=-1/0;const f=o.BYTES_PER_ELEMENT,p=(i.offset||0)/f,g=(i.stride||8)/f;for(let v=p;v<o.length;v+=g){const x=o[v],w=o[v+1];x>u&&(u=x),w>h&&(h=w),x<a&&(a=x),w<c&&(c=w)}return t.minX=a,t.minY=c,t.maxX=u,t.maxY=h,t}function Z6(n){return(n instanceof Ea||Array.isArray(n)||n.BYTES_PER_ELEMENT)&&(n={buffer:n}),n.buffer=bm(n.buffer,!1),n}class J6 extends er{constructor(e={}){super(),this.uid=wt("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Jn,this._boundsDirty=!0;const{attributes:t,indexBuffer:i,topology:o}=e;if(this.buffers=[],this.attributes={},t)for(const a in t)this.addAttribute(a,t[a]);this.instanceCount=e.instanceCount??1,i&&this.addIndex(i),this.topology=o||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}addAttribute(e,t){const i=Z6(t);this.buffers.indexOf(i.buffer)===-1&&(this.buffers.push(i.buffer),i.buffer.on("update",this.onBufferUpdate,this),i.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=i}addIndex(e){this.indexBuffer=bm(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,Q6(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){var t;this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(i=>i.destroy()),(t=this.indexBuffer)==null||t.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const e4=new Float32Array(1),t4=new Uint32Array(1);class n4 extends J6{constructor(){const t=new Ea({data:e4,label:"attribute-batch-buffer",usage:yn.VERTEX|yn.COPY_DST,shrinkToFit:!1}),i=new Ea({data:t4,label:"index-batch-buffer",usage:yn.INDEX|yn.COPY_DST,shrinkToFit:!1}),o=24;super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:o,offset:0},aUV:{buffer:t,format:"float32x2",stride:o,offset:8},aColor:{buffer:t,format:"unorm8x4",stride:o,offset:16},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:o,offset:20}},indexBuffer:i})}}function Ep(n,e,t){if(n)for(const i in n){const o=i.toLocaleLowerCase(),a=e[o];if(a){let c=n[i];i==="header"&&(c=c.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),t&&a.push(`//----${t}----//`),a.push(c)}else ct(`${i} placement hook does not exist in shader`)}}const r4=/\{\{(.*?)\}\}/g;function Rp(n){var i;const e={};return(((i=n.match(r4))==null?void 0:i.map(o=>o.replace(/[{()}]/g,"")))??[]).forEach(o=>{e[o]=[]}),e}function Ip(n,e){let t;const i=/@in\s+([^;]+);/g;for(;(t=i.exec(n))!==null;)e.push(t[1])}function $p(n,e,t=!1){const i=[];Ip(e,i),n.forEach(u=>{u.header&&Ip(u.header,i)});const o=i;t&&o.sort();const a=o.map((u,h)=>`       @location(${h}) ${u},`).join(`
`);let c=e.replace(/@in\s+[^;]+;\s*/g,"");return c=c.replace("{{in}}",`
${a}
`),c}function Lp(n,e){let t;const i=/@out\s+([^;]+);/g;for(;(t=i.exec(n))!==null;)e.push(t[1])}function i4(n){const t=/\b(\w+)\s*:/g.exec(n);return t?t[1]:""}function s4(n){const e=/@.*?\s+/g;return n.replace(e,"")}function o4(n,e){const t=[];Lp(e,t),n.forEach(h=>{h.header&&Lp(h.header,t)});let i=0;const o=t.sort().map(h=>h.indexOf("builtin")>-1?h:`@location(${i++}) ${h}`).join(`,
`),a=t.sort().map(h=>`       var ${s4(h)};`).join(`
`),c=`return VSOutput(
            ${t.sort().map(h=>` ${i4(h)}`).join(`,
`)});`;let u=e.replace(/@out\s+[^;]+;\s*/g,"");return u=u.replace("{{struct}}",`
${o}
`),u=u.replace("{{start}}",`
${a}
`),u=u.replace("{{return}}",`
${c}
`),u}function zp(n,e){let t=n;for(const i in e){const o=e[i];o.join(`
`).length?t=t.replace(`{{${i}}}`,`//-----${i} START-----//
${o.join(`
`)}
//----${i} FINISH----//`):t=t.replace(`{{${i}}}`,"")}return t}const fi=Object.create(null),Rd=new Map;let a4=0;function l4({template:n,bits:e}){const t=Sm(n,e);if(fi[t])return fi[t];const{vertex:i,fragment:o}=u4(n,e);return fi[t]=km(i,o,e),fi[t]}function c4({template:n,bits:e}){const t=Sm(n,e);return fi[t]||(fi[t]=km(n.vertex,n.fragment,e)),fi[t]}function u4(n,e){const t=e.map(c=>c.vertex).filter(c=>!!c),i=e.map(c=>c.fragment).filter(c=>!!c);let o=$p(t,n.vertex,!0);o=o4(t,o);const a=$p(i,n.fragment,!0);return{vertex:o,fragment:a}}function Sm(n,e){return e.map(t=>(Rd.has(t)||Rd.set(t,a4++),Rd.get(t))).sort((t,i)=>t-i).join("-")+n.vertex+n.fragment}function km(n,e,t){const i=Rp(n),o=Rp(e);return t.forEach(a=>{Ep(a.vertex,i,a.name),Ep(a.fragment,o,a.name)}),{vertex:zp(n,i),fragment:zp(e,o)}}const d4=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,h4=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,f4=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,p4=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,m4={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},g4={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function y4({bits:n,name:e}){const t=l4({template:{fragment:h4,vertex:d4},bits:[m4,...n]});return Pc.from({name:e,vertex:{source:t.vertex,entryPoint:"main"},fragment:{source:t.fragment,entryPoint:"main"}})}function x4({bits:n,name:e}){return new em({name:e,...c4({template:{vertex:f4,fragment:p4},bits:[g4,...n]})})}const v4={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},_4={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Id={};function w4(n){const e=[];if(n===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let t=0;for(let i=0;i<n;i++)e.push(`@group(1) @binding(${t++}) var textureSource${i+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${t++}) var textureSampler${i+1}: sampler;`)}return e.join(`
`)}function b4(n){const e=[];if(n===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let t=0;t<n;t++)t===n-1?e.push("  default:{"):e.push(`  case ${t}:{`),e.push(`      outColor = textureSampleGrad(textureSource${t+1}, textureSampler${t+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function S4(n){return Id[n]||(Id[n]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${w4(n)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${b4(n)}
            `}}),Id[n]}const $d={};function k4(n){const e=[];for(let t=0;t<n;t++)t>0&&e.push("else"),t<n-1&&e.push(`if(vTextureId < ${t}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${t}], vUV);`),e.push("}");return e.join(`
`)}function C4(n){return $d[n]||($d[n]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${n}];

            `,main:`

                ${k4(n)}
            `}}),$d[n]}const A4={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},T4={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Fp={};function M4(n){let e=Fp[n];if(e)return e;const t=new Int32Array(n);for(let i=0;i<n;i++)t[i]=i;return e=Fp[n]=new im({uTextures:{value:t,type:"i32",size:n}},{isStatic:!0}),e}class jp extends yh{constructor(e){const t=x4({name:"batch",bits:[_4,C4(e),T4]}),i=y4({name:"batch",bits:[v4,S4(e),A4]});super({glProgram:t,gpuProgram:i,resources:{batchSamplers:M4(e)}}),this.maxTextures=e}}let da=null;const Cm=class Am extends K6{constructor(e){super(e),this.geometry=new n4,this.name=Am.extension.name,this.vertexSize=6,da??(da=new jp(e.maxTextures)),this.shader=da}packAttributes(e,t,i,o,a){const c=a<<16|e.roundPixels&65535,u=e.transform,h=u.a,f=u.b,p=u.c,g=u.d,v=u.tx,x=u.ty,{positions:w,uvs:S}=e,b=e.color,k=e.attributeOffset,A=k+e.attributeSize;for(let M=k;M<A;M++){const E=M*2,B=w[E],F=w[E+1];t[o++]=h*B+p*F+v,t[o++]=g*F+f*B+x,t[o++]=S[E],t[o++]=S[E+1],i[o++]=b,i[o++]=c}}packQuadAttributes(e,t,i,o,a){const c=e.texture,u=e.transform,h=u.a,f=u.b,p=u.c,g=u.d,v=u.tx,x=u.ty,w=e.bounds,S=w.maxX,b=w.minX,k=w.maxY,A=w.minY,M=c.uvs,E=e.color,B=a<<16|e.roundPixels&65535;t[o+0]=h*b+p*A+v,t[o+1]=g*A+f*b+x,t[o+2]=M.x0,t[o+3]=M.y0,i[o+4]=E,i[o+5]=B,t[o+6]=h*S+p*A+v,t[o+7]=g*A+f*S+x,t[o+8]=M.x1,t[o+9]=M.y1,i[o+10]=E,i[o+11]=B,t[o+12]=h*S+p*k+v,t[o+13]=g*k+f*S+x,t[o+14]=M.x2,t[o+15]=M.y2,i[o+16]=E,i[o+17]=B,t[o+18]=h*b+p*k+v,t[o+19]=g*k+f*b+x,t[o+20]=M.x3,t[o+21]=M.y3,i[o+22]=E,i[o+23]=B}_updateMaxTextures(e){this.shader.maxTextures!==e&&(da=new jp(e),this.shader=da)}destroy(){this.shader=null,super.destroy()}};Cm.extension={type:[be.Batcher],name:"default"};let P4=Cm;function E4(n,e,t,i,o,a,c,u=null){let h=0;t*=e,o*=a;const f=u.a,p=u.b,g=u.c,v=u.d,x=u.tx,w=u.ty;for(;h<c;){const S=n[t],b=n[t+1];i[o]=f*S+g*b+x,i[o+1]=p*S+v*b+w,o+=a,t+=e,h++}}function R4(n,e,t,i){let o=0;for(e*=t;o<i;)n[e]=0,n[e+1]=0,e+=t,o++}function Tm(n,e,t,i,o){const a=e.a,c=e.b,u=e.c,h=e.d,f=e.tx,p=e.ty;t||(t=0),i||(i=2),o||(o=n.length/i-t);let g=t*i;for(let v=0;v<o;v++){const x=n[g],w=n[g+1];n[g]=a*x+u*w+f,n[g+1]=c*x+h*w+p,g+=i}}const I4=new Be;class Mm{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,t=e>>16|e&65280|(e&255)<<16,i=this.renderable;return i?I0(t,i.groupColor)+(this.alpha*i.groupAlpha*255<<24):t+(this.alpha*255<<24)}get transform(){var e;return((e=this.renderable)==null?void 0:e.groupTransform)||I4}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const Ra={extension:{type:be.ShapeBuilder,name:"circle"},build(n,e){let t,i,o,a,c,u;if(n.type==="circle"){const E=n;if(c=u=E.radius,c<=0)return!1;t=E.x,i=E.y,o=a=0}else if(n.type==="ellipse"){const E=n;if(c=E.halfWidth,u=E.halfHeight,c<=0||u<=0)return!1;t=E.x,i=E.y,o=a=0}else{const E=n,B=E.width/2,F=E.height/2;t=E.x+B,i=E.y+F,c=u=Math.max(0,Math.min(E.radius,Math.min(B,F))),o=B-c,a=F-u}if(o<0||a<0)return!1;const h=Math.ceil(2.3*Math.sqrt(c+u)),f=h*8+(o?4:0)+(a?4:0);if(f===0)return!1;if(h===0)return e[0]=e[6]=t+o,e[1]=e[3]=i+a,e[2]=e[4]=t-o,e[5]=e[7]=i-a,!0;let p=0,g=h*4+(o?2:0)+2,v=g,x=f,w=o+c,S=a,b=t+w,k=t-w,A=i+S;if(e[p++]=b,e[p++]=A,e[--g]=A,e[--g]=k,a){const E=i-S;e[v++]=k,e[v++]=E,e[--x]=E,e[--x]=b}for(let E=1;E<h;E++){const B=Math.PI/2*(E/h),F=o+Math.cos(B)*c,I=a+Math.sin(B)*u,N=t+F,U=t-F,q=i+I,H=i-I;e[p++]=N,e[p++]=q,e[--g]=q,e[--g]=U,e[v++]=U,e[v++]=H,e[--x]=H,e[--x]=N}w=o,S=a+u,b=t+w,k=t-w,A=i+S;const M=i-S;return e[p++]=b,e[p++]=A,e[--x]=M,e[--x]=b,o&&(e[p++]=k,e[p++]=A,e[--x]=M,e[--x]=k),!0},triangulate(n,e,t,i,o,a){if(n.length===0)return;let c=0,u=0;for(let p=0;p<n.length;p+=2)c+=n[p],u+=n[p+1];c/=n.length/2,u/=n.length/2;let h=i;e[h*t]=c,e[h*t+1]=u;const f=h++;for(let p=0;p<n.length;p+=2)e[h*t]=n[p],e[h*t+1]=n[p+1],p>0&&(o[a++]=h,o[a++]=f,o[a++]=h-1),h++;o[a++]=f+1,o[a++]=f,o[a++]=h-1}},$4={...Ra,extension:{...Ra.extension,name:"ellipse"}},L4={...Ra,extension:{...Ra.extension,name:"roundedRectangle"}},Pm=1e-4,Bp=1e-4;function z4(n){const e=n.length;if(e<6)return 1;let t=0;for(let i=0,o=n[e-2],a=n[e-1];i<e;i+=2){const c=n[i],u=n[i+1];t+=(c-o)*(u+a),o=c,a=u}return t<0?-1:1}function Dp(n,e,t,i,o,a,c,u){const h=n-t*o,f=e-i*o,p=n+t*a,g=e+i*a;let v,x;c?(v=i,x=-t):(v=-i,x=t);const w=h+v,S=f+x,b=p+v,k=g+x;return u.push(w,S),u.push(b,k),2}function Vi(n,e,t,i,o,a,c,u){const h=t-n,f=i-e;let p=Math.atan2(h,f),g=Math.atan2(o-n,a-e);u&&p<g?p+=Math.PI*2:!u&&p>g&&(g+=Math.PI*2);let v=p;const x=g-p,w=Math.abs(x),S=Math.sqrt(h*h+f*f),b=(15*w*Math.sqrt(S)/Math.PI>>0)+1,k=x/b;if(v+=k,u){c.push(n,e),c.push(t,i);for(let A=1,M=v;A<b;A++,M+=k)c.push(n,e),c.push(n+Math.sin(M)*S,e+Math.cos(M)*S);c.push(n,e),c.push(o,a)}else{c.push(t,i),c.push(n,e);for(let A=1,M=v;A<b;A++,M+=k)c.push(n+Math.sin(M)*S,e+Math.cos(M)*S),c.push(n,e);c.push(o,a),c.push(n,e)}return b*2}function F4(n,e,t,i,o,a){const c=Pm;if(n.length===0)return;const u=e;let h=u.alignment;if(e.alignment!==.5){let Y=z4(n);h=(h-.5)*Y+.5}const f=new Xt(n[0],n[1]),p=new Xt(n[n.length-2],n[n.length-1]),g=i,v=Math.abs(f.x-p.x)<c&&Math.abs(f.y-p.y)<c;if(g){n=n.slice(),v&&(n.pop(),n.pop(),p.set(n[n.length-2],n[n.length-1]));const Y=(f.x+p.x)*.5,ie=(p.y+f.y)*.5;n.unshift(Y,ie),n.push(Y,ie)}const x=o,w=n.length/2;let S=n.length;const b=x.length/2,k=u.width/2,A=k*k,M=u.miterLimit*u.miterLimit;let E=n[0],B=n[1],F=n[2],I=n[3],N=0,U=0,q=-(B-I),H=E-F,se=0,Z=0,Q=Math.sqrt(q*q+H*H);q/=Q,H/=Q,q*=k,H*=k;const ae=h,G=(1-ae)*2,V=ae*2;g||(u.cap==="round"?S+=Vi(E-q*(G-V)*.5,B-H*(G-V)*.5,E-q*G,B-H*G,E+q*V,B+H*V,x,!0)+2:u.cap==="square"&&(S+=Dp(E,B,q,H,G,V,!0,x))),x.push(E-q*G,B-H*G),x.push(E+q*V,B+H*V);for(let Y=1;Y<w-1;++Y){E=n[(Y-1)*2],B=n[(Y-1)*2+1],F=n[Y*2],I=n[Y*2+1],N=n[(Y+1)*2],U=n[(Y+1)*2+1],q=-(B-I),H=E-F,Q=Math.sqrt(q*q+H*H),q/=Q,H/=Q,q*=k,H*=k,se=-(I-U),Z=F-N,Q=Math.sqrt(se*se+Z*Z),se/=Q,Z/=Q,se*=k,Z*=k;const ie=F-E,L=B-I,K=F-N,ve=U-I,Pe=ie*K+L*ve,Ee=L*K-ve*ie,Re=Ee<0;if(Math.abs(Ee)<.001*Math.abs(Pe)){x.push(F-q*G,I-H*G),x.push(F+q*V,I+H*V),Pe>=0&&(u.join==="round"?S+=Vi(F,I,F-q*G,I-H*G,F-se*G,I-Z*G,x,!1)+4:S+=2,x.push(F-se*V,I-Z*V),x.push(F+se*G,I+Z*G));continue}const De=(-q+E)*(-H+I)-(-q+F)*(-H+B),Le=(-se+N)*(-Z+I)-(-se+F)*(-Z+U),Ue=(ie*Le-K*De)/Ee,Ke=(ve*De-L*Le)/Ee,Mn=(Ue-F)*(Ue-F)+(Ke-I)*(Ke-I),vn=F+(Ue-F)*G,sn=I+(Ke-I)*G,on=F-(Ue-F)*V,an=I-(Ke-I)*V,rr=Math.min(ie*ie+L*L,K*K+ve*ve),Nr=Re?G:V,ts=rr+Nr*Nr*A;Mn<=ts?u.join==="bevel"||Mn/A>M?(Re?(x.push(vn,sn),x.push(F+q*V,I+H*V),x.push(vn,sn),x.push(F+se*V,I+Z*V)):(x.push(F-q*G,I-H*G),x.push(on,an),x.push(F-se*G,I-Z*G),x.push(on,an)),S+=2):u.join==="round"?Re?(x.push(vn,sn),x.push(F+q*V,I+H*V),S+=Vi(F,I,F+q*V,I+H*V,F+se*V,I+Z*V,x,!0)+4,x.push(vn,sn),x.push(F+se*V,I+Z*V)):(x.push(F-q*G,I-H*G),x.push(on,an),S+=Vi(F,I,F-q*G,I-H*G,F-se*G,I-Z*G,x,!1)+4,x.push(F-se*G,I-Z*G),x.push(on,an)):(x.push(vn,sn),x.push(on,an)):(x.push(F-q*G,I-H*G),x.push(F+q*V,I+H*V),u.join==="round"?Re?S+=Vi(F,I,F+q*V,I+H*V,F+se*V,I+Z*V,x,!0)+2:S+=Vi(F,I,F-q*G,I-H*G,F-se*G,I-Z*G,x,!1)+2:u.join==="miter"&&Mn/A<=M&&(Re?(x.push(on,an),x.push(on,an)):(x.push(vn,sn),x.push(vn,sn)),S+=2),x.push(F-se*G,I-Z*G),x.push(F+se*V,I+Z*V),S+=2)}E=n[(w-2)*2],B=n[(w-2)*2+1],F=n[(w-1)*2],I=n[(w-1)*2+1],q=-(B-I),H=E-F,Q=Math.sqrt(q*q+H*H),q/=Q,H/=Q,q*=k,H*=k,x.push(F-q*G,I-H*G),x.push(F+q*V,I+H*V),g||(u.cap==="round"?S+=Vi(F-q*(G-V)*.5,I-H*(G-V)*.5,F-q*G,I-H*G,F+q*V,I+H*V,x,!1)+2:u.cap==="square"&&(S+=Dp(F,I,q,H,G,V,!1,x)));const te=Bp*Bp;for(let Y=b;Y<S+b-2;++Y)E=x[Y*2],B=x[Y*2+1],F=x[(Y+1)*2],I=x[(Y+1)*2+1],N=x[(Y+2)*2],U=x[(Y+2)*2+1],!(Math.abs(E*(I-U)+F*(U-B)+N*(B-I))<te)&&a.push(Y,Y+1,Y+2)}function j4(n,e,t,i){const o=Pm;if(n.length===0)return;const a=n[0],c=n[1],u=n[n.length-2],h=n[n.length-1],f=e||Math.abs(a-u)<o&&Math.abs(c-h)<o,p=t,g=n.length/2,v=p.length/2;for(let x=0;x<g;x++)p.push(n[x*2]),p.push(n[x*2+1]);for(let x=0;x<g-1;x++)i.push(v+x,v+x+1);f&&i.push(v+g-1,v)}function Em(n,e,t,i,o,a,c){const u=S6(n,e,2);if(!u)return;for(let f=0;f<u.length;f+=3)a[c++]=u[f]+o,a[c++]=u[f+1]+o,a[c++]=u[f+2]+o;let h=o*i;for(let f=0;f<n.length;f+=2)t[h]=n[f],t[h+1]=n[f+1],h+=i}const B4=[],D4={extension:{type:be.ShapeBuilder,name:"polygon"},build(n,e){for(let t=0;t<n.points.length;t++)e[t]=n.points[t];return!0},triangulate(n,e,t,i,o,a){Em(n,B4,e,t,i,o,a)}},O4={extension:{type:be.ShapeBuilder,name:"rectangle"},build(n,e){const t=n,i=t.x,o=t.y,a=t.width,c=t.height;return a>0&&c>0?(e[0]=i,e[1]=o,e[2]=i+a,e[3]=o,e[4]=i+a,e[5]=o+c,e[6]=i,e[7]=o+c,!0):!1},triangulate(n,e,t,i,o,a){let c=0;i*=t,e[i+c]=n[0],e[i+c+1]=n[1],c+=t,e[i+c]=n[2],e[i+c+1]=n[3],c+=t,e[i+c]=n[6],e[i+c+1]=n[7],c+=t,e[i+c]=n[4],e[i+c+1]=n[5],c+=t;const u=i/t;o[a++]=u,o[a++]=u+1,o[a++]=u+2,o[a++]=u+1,o[a++]=u+3,o[a++]=u+2}},N4={extension:{type:be.ShapeBuilder,name:"triangle"},build(n,e){return e[0]=n.x,e[1]=n.y,e[2]=n.x2,e[3]=n.y2,e[4]=n.x3,e[5]=n.y3,!0},triangulate(n,e,t,i,o,a){let c=0;i*=t,e[i+c]=n[0],e[i+c+1]=n[1],c+=t,e[i+c]=n[2],e[i+c+1]=n[3],c+=t,e[i+c]=n[4],e[i+c+1]=n[5];const u=i/t;o[a++]=u,o[a++]=u+1,o[a++]=u+2}},W4=new Be,H4=new ft;function U4(n,e,t,i){const o=e.matrix?n.copyFrom(e.matrix).invert():n.identity();if(e.textureSpace==="local"){const c=t.getBounds(H4);e.width&&c.pad(e.width);const{x:u,y:h}=c,f=1/c.width,p=1/c.height,g=-u*f,v=-h*p,x=o.a,w=o.b,S=o.c,b=o.d;o.a*=f,o.b*=f,o.c*=p,o.d*=p,o.tx=g*x+v*S+o.tx,o.ty=g*w+v*b+o.ty}else o.translate(e.texture.frame.x,e.texture.frame.y),o.scale(1/e.texture.source.width,1/e.texture.source.height);const a=e.texture.source.style;return!(e.fill instanceof Or)&&a.addressMode==="clamp-to-edge"&&(a.addressMode="repeat",a.update()),i&&o.append(W4.copyFrom(i).invert()),o}const Rc={};Wt.handleByMap(be.ShapeBuilder,Rc);Wt.add(O4,D4,N4,Ra,$4,L4);const G4=new ft,V4=new Be;function Y4(n,e){const{geometryData:t,batches:i}=e;i.length=0,t.indices.length=0,t.vertices.length=0,t.uvs.length=0;for(let o=0;o<n.instructions.length;o++){const a=n.instructions[o];if(a.action==="texture")X4(a.data,i,t);else if(a.action==="fill"||a.action==="stroke"){const c=a.action==="stroke",u=a.data.path.shapePath,h=a.data.style,f=a.data.hole;c&&f&&Op(f.shapePath,h,!0,i,t),f&&(u.shapePrimitives[u.shapePrimitives.length-1].holes=f.shapePath.shapePrimitives),Op(u,h,c,i,t)}}}function X4(n,e,t){const i=[],o=Rc.rectangle,a=G4;a.x=n.dx,a.y=n.dy,a.width=n.dw,a.height=n.dh;const c=n.transform;if(!o.build(a,i))return;const{vertices:u,uvs:h,indices:f}=t,p=f.length,g=u.length/2;c&&Tm(i,c),o.triangulate(i,u,2,g,f,p);const v=n.image,x=v.uvs;h.push(x.x0,x.y0,x.x1,x.y1,x.x3,x.y3,x.x2,x.y2);const w=Bn.get(Mm);w.indexOffset=p,w.indexSize=f.length-p,w.attributeOffset=g,w.attributeSize=u.length/2-g,w.baseColor=n.style,w.alpha=n.alpha,w.texture=v,w.geometryData=t,e.push(w)}function Op(n,e,t,i,o){const{vertices:a,uvs:c,indices:u}=o;n.shapePrimitives.forEach(({shape:h,transform:f,holes:p})=>{const g=[],v=Rc[h.type];if(!v.build(h,g))return;const x=u.length,w=a.length/2;let S="triangle-list";if(f&&Tm(g,f),t){const M=h.closePath??!0,E=e;E.pixelLine?(j4(g,M,a,u),S="line-list"):F4(g,E,!1,M,a,u)}else if(p){const M=[],E=g.slice();q4(p).forEach(F=>{M.push(E.length/2),E.push(...F)}),Em(E,M,a,2,w,u,x)}else v.triangulate(g,a,2,w,u,x);const b=c.length/2,k=e.texture;if(k!==Ne.WHITE){const M=U4(V4,e,h,f);E4(a,2,w,c,b,2,a.length/2-w,M)}else R4(c,b,2,a.length/2-w);const A=Bn.get(Mm);A.indexOffset=x,A.indexSize=u.length-x,A.attributeOffset=w,A.attributeSize=a.length/2-w,A.baseColor=e.color,A.alpha=e.alpha,A.texture=k,A.geometryData=o,A.topology=S,i.push(A)})}function q4(n){const e=[];for(let t=0;t<n.length;t++){const i=n[t].shape,o=[];Rc[i.type].build(i,o)&&e.push(o)}return e}class K4{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Q4{constructor(){this.instructions=new F0}init(e){const t=e.maxTextures;this.batcher?this.batcher._updateMaxTextures(t):this.batcher=new P4({maxTextures:t}),this.instructions.reset()}get geometry(){return Fe(X5,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const bh=class rh{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){rh.defaultOptions.bezierSmoothness=(e==null?void 0:e.bezierSmoothness)??rh.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let t=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){t?this._cleanGraphicsContextData(e):t=this._initContext(e),Y4(e,t);const i=e.batchMode;e.customShader||i==="no-batch"?t.isBatchable=!1:i==="auto"?t.isBatchable=t.geometryData.vertices.length<400:t.isBatchable=!0,e.dirty=!1}return t}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const t=Bn.get(Q4,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:i,geometryData:o}=this._gpuContextHash[e.uid],a=o.vertices.length,c=o.indices.length;for(let p=0;p<i.length;p++)i[p].applyTransform=!1;const u=t.batcher;u.ensureAttributeBuffer(a),u.ensureIndexBuffer(c),u.begin();for(let p=0;p<i.length;p++){const g=i[p];u.add(g)}u.finish(t.instructions);const h=u.geometry;h.indexBuffer.setDataWithSize(u.indexBuffer,u.indexSize,!0),h.buffers[0].setDataWithSize(u.attributeBuffer.float32View,u.attributeSize,!0);const f=u.batches;for(let p=0;p<f.length;p++){const g=f[p];g.bindGroup=O6(g.textures.textures,g.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[e.uid]=t,t}_initContext(e){const t=new K4;return t.context=e,this._gpuContextHash[e.uid]=t,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const t=this._gpuContextHash[e.uid];t.isBatchable||this._graphicsDataContextHash[e.uid]&&(Bn.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),t.batches&&t.batches.forEach(i=>{Bn.return(i)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context);this._gpuContextHash={},this._graphicsDataContextHash={},this._renderer=null}};bh.extension={type:[be.WebGLSystem,be.WebGPUSystem,be.CanvasSystem],name:"graphicsContext"};bh.defaultOptions={bezierSmoothness:.5};let Rm=bh;const Z4=8,uc=11920929e-14,J4=1;function Im(n,e,t,i,o,a,c,u,h,f){const g=Math.min(.99,Math.max(0,f??Rm.defaultOptions.bezierSmoothness));let v=(J4-g)/1;return v*=v,e9(e,t,i,o,a,c,u,h,n,v),n}function e9(n,e,t,i,o,a,c,u,h,f){ih(n,e,t,i,o,a,c,u,h,f,0),h.push(c,u)}function ih(n,e,t,i,o,a,c,u,h,f,p){if(p>Z4)return;const g=(n+t)/2,v=(e+i)/2,x=(t+o)/2,w=(i+a)/2,S=(o+c)/2,b=(a+u)/2,k=(g+x)/2,A=(v+w)/2,M=(x+S)/2,E=(w+b)/2,B=(k+M)/2,F=(A+E)/2;if(p>0){let I=c-n,N=u-e;const U=Math.abs((t-c)*N-(i-u)*I),q=Math.abs((o-c)*N-(a-u)*I);if(U>uc&&q>uc){if((U+q)*(U+q)<=f*(I*I+N*N)){h.push(B,F);return}}else if(U>uc){if(U*U<=f*(I*I+N*N)){h.push(B,F);return}}else if(q>uc){if(q*q<=f*(I*I+N*N)){h.push(B,F);return}}else if(I=B-(n+c)/2,N=F-(e+u)/2,I*I+N*N<=f){h.push(B,F);return}}ih(n,e,g,v,k,A,B,F,h,f,p+1),ih(B,F,M,E,S,b,c,u,h,f,p+1)}const t9=8,n9=11920929e-14,r9=1;function i9(n,e,t,i,o,a,c,u){const f=Math.min(.99,Math.max(0,u??Rm.defaultOptions.bezierSmoothness));let p=(r9-f)/1;return p*=p,s9(e,t,i,o,a,c,n,p),n}function s9(n,e,t,i,o,a,c,u){sh(c,n,e,t,i,o,a,u,0),c.push(o,a)}function sh(n,e,t,i,o,a,c,u,h){if(h>t9)return;const f=(e+i)/2,p=(t+o)/2,g=(i+a)/2,v=(o+c)/2,x=(f+g)/2,w=(p+v)/2;let S=a-e,b=c-t;const k=Math.abs((i-a)*b-(o-c)*S);if(k>n9){if(k*k<=u*(S*S+b*b)){n.push(x,w);return}}else if(S=x-(e+a)/2,b=w-(t+c)/2,S*S+b*b<=u){n.push(x,w);return}sh(n,e,t,f,p,x,w,u,h+1),sh(n,x,w,g,v,a,c,u,h+1)}function $m(n,e,t,i,o,a,c,u){let h=Math.abs(o-a);(!c&&o>a||c&&a>o)&&(h=2*Math.PI-h),u||(u=Math.max(6,Math.floor(6*Math.pow(i,1/3)*(h/Math.PI)))),u=Math.max(u,3);let f=h/u,p=o;f*=c?-1:1;for(let g=0;g<u+1;g++){const v=Math.cos(p),x=Math.sin(p),w=e+v*i,S=t+x*i;n.push(w,S),p+=f}}function o9(n,e,t,i,o,a){const c=n[n.length-2],h=n[n.length-1]-t,f=c-e,p=o-t,g=i-e,v=Math.abs(h*g-f*p);if(v<1e-8||a===0){(n[n.length-2]!==e||n[n.length-1]!==t)&&n.push(e,t);return}const x=h*h+f*f,w=p*p+g*g,S=h*p+f*g,b=a*Math.sqrt(x)/v,k=a*Math.sqrt(w)/v,A=b*S/x,M=k*S/w,E=b*g+k*f,B=b*p+k*h,F=f*(k+A),I=h*(k+A),N=g*(b+M),U=p*(b+M),q=Math.atan2(I-B,F-E),H=Math.atan2(U-B,N-E);$m(n,E+e,B+t,a,q,H,f*p>g*h)}const wa=Math.PI*2,Ld={centerX:0,centerY:0,ang1:0,ang2:0},zd=({x:n,y:e},t,i,o,a,c,u,h)=>{n*=t,e*=i;const f=o*n-a*e,p=a*n+o*e;return h.x=f+c,h.y=p+u,h};function a9(n,e){const t=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),i=e===1.5707963267948966?.551915024494:t,o=Math.cos(n),a=Math.sin(n),c=Math.cos(n+e),u=Math.sin(n+e);return[{x:o-a*i,y:a+o*i},{x:c+u*i,y:u-c*i},{x:c,y:u}]}const Np=(n,e,t,i)=>{const o=n*i-e*t<0?-1:1;let a=n*t+e*i;return a>1&&(a=1),a<-1&&(a=-1),o*Math.acos(a)},l9=(n,e,t,i,o,a,c,u,h,f,p,g,v)=>{const x=Math.pow(o,2),w=Math.pow(a,2),S=Math.pow(p,2),b=Math.pow(g,2);let k=x*w-x*b-w*S;k<0&&(k=0),k/=x*b+w*S,k=Math.sqrt(k)*(c===u?-1:1);const A=k*o/a*g,M=k*-a/o*p,E=f*A-h*M+(n+t)/2,B=h*A+f*M+(e+i)/2,F=(p-A)/o,I=(g-M)/a,N=(-p-A)/o,U=(-g-M)/a,q=Np(1,0,F,I);let H=Np(F,I,N,U);u===0&&H>0&&(H-=wa),u===1&&H<0&&(H+=wa),v.centerX=E,v.centerY=B,v.ang1=q,v.ang2=H};function c9(n,e,t,i,o,a,c,u=0,h=0,f=0){if(a===0||c===0)return;const p=Math.sin(u*wa/360),g=Math.cos(u*wa/360),v=g*(e-i)/2+p*(t-o)/2,x=-p*(e-i)/2+g*(t-o)/2;if(v===0&&x===0)return;a=Math.abs(a),c=Math.abs(c);const w=Math.pow(v,2)/Math.pow(a,2)+Math.pow(x,2)/Math.pow(c,2);w>1&&(a*=Math.sqrt(w),c*=Math.sqrt(w)),l9(e,t,i,o,a,c,h,f,p,g,v,x,Ld);let{ang1:S,ang2:b}=Ld;const{centerX:k,centerY:A}=Ld;let M=Math.abs(b)/(wa/4);Math.abs(1-M)<1e-7&&(M=1);const E=Math.max(Math.ceil(M),1);b/=E;let B=n[n.length-2],F=n[n.length-1];const I={x:0,y:0};for(let N=0;N<E;N++){const U=a9(S,b),{x:q,y:H}=zd(U[0],a,c,g,p,k,A,I),{x:se,y:Z}=zd(U[1],a,c,g,p,k,A,I),{x:Q,y:ae}=zd(U[2],a,c,g,p,k,A,I);Im(n,B,F,q,H,se,Z,Q,ae),B=Q,F=ae,S+=b}}function u9(n,e,t){const i=(c,u)=>{const h=u.x-c.x,f=u.y-c.y,p=Math.sqrt(h*h+f*f),g=h/p,v=f/p;return{len:p,nx:g,ny:v}},o=(c,u)=>{c===0?n.moveTo(u.x,u.y):n.lineTo(u.x,u.y)};let a=e[e.length-1];for(let c=0;c<e.length;c++){const u=e[c%e.length],h=u.radius??t;if(h<=0){o(c,u),a=u;continue}const f=e[(c+1)%e.length],p=i(u,a),g=i(u,f);if(p.len<1e-4||g.len<1e-4){o(c,u),a=u;continue}let v=Math.asin(p.nx*g.ny-p.ny*g.nx),x=1,w=!1;p.nx*g.nx-p.ny*-g.ny<0?v<0?v=Math.PI+v:(v=Math.PI-v,x=-1,w=!0):v>0&&(x=-1,w=!0);const S=v/2;let b,k=Math.abs(Math.cos(S)*h/Math.sin(S));k>Math.min(p.len/2,g.len/2)?(k=Math.min(p.len/2,g.len/2),b=Math.abs(k*Math.sin(S)/Math.cos(S))):b=h;const A=u.x+g.nx*k+-g.ny*b*x,M=u.y+g.ny*k+g.nx*b*x,E=Math.atan2(p.ny,p.nx)+Math.PI/2*x,B=Math.atan2(g.ny,g.nx)-Math.PI/2*x;c===0&&n.moveTo(A+Math.cos(E)*b,M+Math.sin(E)*b),n.arc(A,M,b,E,B,w),a=u}}function d9(n,e,t,i){const o=(u,h)=>Math.sqrt((u.x-h.x)**2+(u.y-h.y)**2),a=(u,h,f)=>({x:u.x+(h.x-u.x)*f,y:u.y+(h.y-u.y)*f}),c=e.length;for(let u=0;u<c;u++){const h=e[(u+1)%c],f=h.radius??t;if(f<=0){u===0?n.moveTo(h.x,h.y):n.lineTo(h.x,h.y);continue}const p=e[u],g=e[(u+2)%c],v=o(p,h);let x;if(v<1e-4)x=h;else{const b=Math.min(v/2,f);x=a(h,p,b/v)}const w=o(g,h);let S;if(w<1e-4)S=h;else{const b=Math.min(w/2,f);S=a(h,g,b/w)}u===0?n.moveTo(x.x,x.y):n.lineTo(x.x,x.y),n.quadraticCurveTo(h.x,h.y,S.x,S.y,i)}}const h9=new ft;class f9{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Jn,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,t){return this.startPoly(e,t),this}lineTo(e,t){this._ensurePoly();const i=this._currentPoly.points,o=i[i.length-2],a=i[i.length-1];return(o!==e||a!==t)&&i.push(e,t),this}arc(e,t,i,o,a,c){this._ensurePoly(!1);const u=this._currentPoly.points;return $m(u,e,t,i,o,a,c),this}arcTo(e,t,i,o,a){this._ensurePoly();const c=this._currentPoly.points;return o9(c,e,t,i,o,a),this}arcToSvg(e,t,i,o,a,c,u){const h=this._currentPoly.points;return c9(h,this._currentPoly.lastX,this._currentPoly.lastY,c,u,e,t,i,o,a),this}bezierCurveTo(e,t,i,o,a,c,u){this._ensurePoly();const h=this._currentPoly;return Im(this._currentPoly.points,h.lastX,h.lastY,e,t,i,o,a,c,u),this}quadraticCurveTo(e,t,i,o,a){this._ensurePoly();const c=this._currentPoly;return i9(this._currentPoly.points,c.lastX,c.lastY,e,t,i,o,a),this}closePath(){return this.endPoly(!0),this}addPath(e,t){this.endPoly(),t&&!t.isIdentity()&&(e=e.clone(!0),e.transform(t));const i=this.shapePrimitives,o=i.length;for(let a=0;a<e.instructions.length;a++){const c=e.instructions[a];this[c.action](...c.data)}if(e.checkForHoles&&i.length-o>1){let a=null;for(let c=o;c<i.length;c++){const u=i[c];if(u.shape.type==="polygon"){const h=u.shape,f=a==null?void 0:a.shape;f&&f.containsPolygon(h)?(a.holes||(a.holes=[]),a.holes.push(u),i.copyWithin(c,c+1),i.length--,c--):a=u}}}return this}finish(e=!1){this.endPoly(e)}rect(e,t,i,o,a){return this.drawShape(new ft(e,t,i,o),a),this}circle(e,t,i,o){return this.drawShape(new vh(e,t,i),o),this}poly(e,t,i){const o=new va(e);return o.closePath=t,this.drawShape(o,i),this}regularPoly(e,t,i,o,a=0,c){o=Math.max(o|0,3);const u=-1*Math.PI/2+a,h=Math.PI*2/o,f=[];for(let p=0;p<o;p++){const g=u-p*h;f.push(e+i*Math.cos(g),t+i*Math.sin(g))}return this.poly(f,!0,c),this}roundPoly(e,t,i,o,a,c=0,u){if(o=Math.max(o|0,3),a<=0)return this.regularPoly(e,t,i,o,c);const h=i*Math.sin(Math.PI/o)-.001;a=Math.min(a,h);const f=-1*Math.PI/2+c,p=Math.PI*2/o,g=(o-2)*Math.PI/o/2;for(let v=0;v<o;v++){const x=v*p+f,w=e+i*Math.cos(x),S=t+i*Math.sin(x),b=x+Math.PI+g,k=x-Math.PI-g,A=w+a*Math.cos(b),M=S+a*Math.sin(b),E=w+a*Math.cos(k),B=S+a*Math.sin(k);v===0?this.moveTo(A,M):this.lineTo(A,M),this.quadraticCurveTo(w,S,E,B,u)}return this.closePath()}roundShape(e,t,i=!1,o){return e.length<3?this:(i?d9(this,e,t,o):u9(this,e,t),this.closePath())}filletRect(e,t,i,o,a){if(a===0)return this.rect(e,t,i,o);const c=Math.min(i,o)/2,u=Math.min(c,Math.max(-c,a)),h=e+i,f=t+o,p=u<0?-u:0,g=Math.abs(u);return this.moveTo(e,t+g).arcTo(e+p,t+p,e+g,t,g).lineTo(h-g,t).arcTo(h-p,t+p,h,t+g,g).lineTo(h,f-g).arcTo(h-p,f-p,e+i-g,f,g).lineTo(e+g,f).arcTo(e+p,f-p,e,f-g,g).closePath()}chamferRect(e,t,i,o,a,c){if(a<=0)return this.rect(e,t,i,o);const u=Math.min(a,Math.min(i,o)/2),h=e+i,f=t+o,p=[e+u,t,h-u,t,h,t+u,h,f-u,h-u,f,e+u,f,e,f-u,e,t+u];for(let g=p.length-1;g>=2;g-=2)p[g]===p[g-2]&&p[g-1]===p[g-3]&&p.splice(g-1,2);return this.poly(p,!0,c)}ellipse(e,t,i,o,a){return this.drawShape(new _h(e,t,i,o),a),this}roundRect(e,t,i,o,a,c){return this.drawShape(new wh(e,t,i,o,a),c),this}drawShape(e,t){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:t}),this}startPoly(e,t){let i=this._currentPoly;return i&&this.endPoly(),i=new va,i.points.push(e,t),this._currentPoly=i,this}endPoly(e=!1){const t=this._currentPoly;return t&&t.points.length>2&&(t.closePath=e,this.shapePrimitives.push({shape:t})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new va,e)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let i=t.shape.x,o=t.shape.y;if(t.transform&&!t.transform.isIdentity()){const a=t.transform,c=i;i=a.a*i+a.c*o+a.tx,o=a.b*c+a.d*o+a.ty}this._currentPoly.points.push(i,o)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let t=0;t<e.instructions.length;t++){const i=e.instructions[t];this[i.action](...i.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const t=this.shapePrimitives;for(let i=0;i<t.length;i++){const o=t[i],a=o.shape.getBounds(h9);o.transform?e.addRect(a,o.transform):e.addRect(a)}return e}}class Dr{constructor(e,t=!1){this.instructions=[],this.uid=wt("graphicsPath"),this._dirty=!0,this.checkForHoles=t,typeof e=="string"?F6(e,this):this.instructions=(e==null?void 0:e.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new f9(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,t){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,t]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,t,i,o,a){const c=this.instructions[this.instructions.length-1],u=this.getLastPoint(Xt.shared);let h=0,f=0;if(!c||c.action!=="bezierCurveTo")h=u.x,f=u.y;else{h=c.data[2],f=c.data[3];const p=u.x,g=u.y;h=p+(p-h),f=g+(g-f)}return this.instructions.push({action:"bezierCurveTo",data:[h,f,e,t,i,o,a]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,t,i){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(Xt.shared);let c=0,u=0;if(!o||o.action!=="quadraticCurveTo")c=a.x,u=a.y;else{c=o.data[0],u=o.data[1];const h=a.x,f=a.y;c=h+(h-c),u=f+(f-u)}return this.instructions.push({action:"quadraticCurveTo",data:[c,u,e,t,i]}),this._dirty=!0,this}rect(e,t,i,o,a){return this.instructions.push({action:"rect",data:[e,t,i,o,a]}),this._dirty=!0,this}circle(e,t,i,o){return this.instructions.push({action:"circle",data:[e,t,i,o]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,t,i,o,a,c,u){a||(a=o/2);const h=-1*Math.PI/2+c,f=i*2,p=Math.PI*2/f,g=[];for(let v=0;v<f;v++){const x=v%2?a:o,w=v*p+h;g.push(e+x*Math.cos(w),t+x*Math.sin(w))}return this.poly(g,!0,u),this}clone(e=!1){const t=new Dr;if(t.checkForHoles=this.checkForHoles,!e)t.instructions=this.instructions.slice();else for(let i=0;i<this.instructions.length;i++){const o=this.instructions[i];t.instructions.push({action:o.action,data:o.data.slice()})}return t}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const t=e.a,i=e.b,o=e.c,a=e.d,c=e.tx,u=e.ty;let h=0,f=0,p=0,g=0,v=0,x=0,w=0,S=0;for(let b=0;b<this.instructions.length;b++){const k=this.instructions[b],A=k.data;switch(k.action){case"moveTo":case"lineTo":h=A[0],f=A[1],A[0]=t*h+o*f+c,A[1]=i*h+a*f+u;break;case"bezierCurveTo":p=A[0],g=A[1],v=A[2],x=A[3],h=A[4],f=A[5],A[0]=t*p+o*g+c,A[1]=i*p+a*g+u,A[2]=t*v+o*x+c,A[3]=i*v+a*x+u,A[4]=t*h+o*f+c,A[5]=i*h+a*f+u;break;case"quadraticCurveTo":p=A[0],g=A[1],h=A[2],f=A[3],A[0]=t*p+o*g+c,A[1]=i*p+a*g+u,A[2]=t*h+o*f+c,A[3]=i*h+a*f+u;break;case"arcToSvg":h=A[5],f=A[6],w=A[0],S=A[1],A[0]=t*w+o*S,A[1]=i*w+a*S,A[5]=t*h+o*f+c,A[6]=i*h+a*f+u;break;case"circle":A[4]=ha(A[3],e);break;case"rect":A[4]=ha(A[4],e);break;case"ellipse":A[8]=ha(A[8],e);break;case"roundRect":A[5]=ha(A[5],e);break;case"addPath":A[0].transform(e);break;case"poly":A[2]=ha(A[2],e);break;default:ct("unknown transform action",k.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let t=this.instructions.length-1,i=this.instructions[t];if(!i)return e.x=0,e.y=0,e;for(;i.action==="closePath";){if(t--,t<0)return e.x=0,e.y=0,e;i=this.instructions[t]}switch(i.action){case"moveTo":case"lineTo":e.x=i.data[0],e.y=i.data[1];break;case"quadraticCurveTo":e.x=i.data[2],e.y=i.data[3];break;case"bezierCurveTo":e.x=i.data[4],e.y=i.data[5];break;case"arc":case"arcToSvg":e.x=i.data[5],e.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(e);break}return e}}function ha(n,e){return n?n.prepend(e):e.clone()}function _t(n,e,t){const i=n.getAttribute(e);return i?Number(i):t}function p9(n,e){const t=n.querySelectorAll("defs");for(let i=0;i<t.length;i++){const o=t[i];for(let a=0;a<o.children.length;a++){const c=o.children[a];switch(c.nodeName.toLowerCase()){case"lineargradient":e.defs[c.id]=m9(c);break;case"radialgradient":e.defs[c.id]=g9();break}}}}function m9(n){const e=_t(n,"x1",0),t=_t(n,"y1",0),i=_t(n,"x2",1),o=_t(n,"y2",0),a=n.getAttribute("gradientUnits")||"objectBoundingBox",c=new Or(e,t,i,o,a==="objectBoundingBox"?"local":"global");for(let u=0;u<n.children.length;u++){const h=n.children[u],f=_t(h,"offset",0),p=At.shared.setValue(h.getAttribute("stop-color")).toNumber();c.addColorStop(f,p)}return c}function g9(n){return ct("[SVG Parser] Radial gradients are not yet supported"),new Or(0,0,1,0)}function Wp(n){const e=n.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const Hp={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Lm(n,e){const t=n.getAttribute("style"),i={},o={},a={strokeStyle:i,fillStyle:o,useFill:!1,useStroke:!1};for(const c in Hp){const u=n.getAttribute(c);u&&Up(e,a,c,u.trim())}if(t){const c=t.split(";");for(let u=0;u<c.length;u++){const h=c[u].trim(),[f,p]=h.split(":");Hp[f]&&Up(e,a,f,p.trim())}}return{strokeStyle:a.useStroke?i:null,fillStyle:a.useFill?o:null,useFill:a.useFill,useStroke:a.useStroke}}function Up(n,e,t,i){switch(t){case"stroke":if(i!=="none"){if(i.startsWith("url(")){const o=Wp(i);e.strokeStyle.fill=n.defs[o]}else e.strokeStyle.color=At.shared.setValue(i).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(i);break;case"fill":if(i!=="none"){if(i.startsWith("url(")){const o=Wp(i);e.fillStyle.fill=n.defs[o]}else e.fillStyle.color=At.shared.setValue(i).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(i);break;case"stroke-opacity":e.strokeStyle.alpha=Number(i);break;case"opacity":e.fillStyle.alpha=Number(i),e.strokeStyle.alpha=Number(i);break}}function y9(n){if(n.length<=2)return!0;const e=n.map(u=>u.area).sort((u,h)=>h-u),[t,i]=e,o=e[e.length-1],a=t/i,c=i/o;return!(a>3&&c<2)}function x9(n){return n.split(/(?=[Mm])/).filter(i=>i.trim().length>0)}function v9(n){const e=n.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!e||e.length<4)return 0;const t=e.map(Number),i=[],o=[];for(let p=0;p<t.length;p+=2)p+1<t.length&&(i.push(t[p]),o.push(t[p+1]));if(i.length===0||o.length===0)return 0;const a=Math.min(...i),c=Math.max(...i),u=Math.min(...o),h=Math.max(...o);return(c-a)*(h-u)}function Gp(n,e){const t=new Dr(n,!1);for(const i of t.instructions)e.instructions.push(i)}function _9(n,e){if(typeof n=="string"){const c=document.createElement("div");c.innerHTML=n.trim(),n=c.querySelector("svg")}const t={context:e,defs:{},path:new Dr};p9(n,t);const i=n.children,{fillStyle:o,strokeStyle:a}=Lm(n,t);for(let c=0;c<i.length;c++){const u=i[c];u.nodeName.toLowerCase()!=="defs"&&zm(u,t,o,a)}return e}function zm(n,e,t,i){const o=n.children,{fillStyle:a,strokeStyle:c}=Lm(n,e);a&&t?t={...t,...a}:a&&(t=a),c&&i?i={...i,...c}:c&&(i=c);const u=!t&&!i;u&&(t={color:0});let h,f,p,g,v,x,w,S,b,k,A,M,E,B,F,I,N;switch(n.nodeName.toLowerCase()){case"path":{B=n.getAttribute("d");const U=n.getAttribute("fill-rule"),q=x9(B),H=U==="evenodd",se=q.length>1;if(H&&se){const Q=q.map(G=>({path:G,area:v9(G)}));if(Q.sort((G,V)=>V.area-G.area),q.length>3||!y9(Q))for(let G=0;G<Q.length;G++){const V=Q[G],te=G===0;e.context.beginPath();const Y=new Dr(void 0,!0);Gp(V.path,Y),e.context.path(Y),te?(t&&e.context.fill(t),i&&e.context.stroke(i)):e.context.cut()}else for(let G=0;G<Q.length;G++){const V=Q[G],te=G%2===1;e.context.beginPath();const Y=new Dr(void 0,!0);Gp(V.path,Y),e.context.path(Y),te?e.context.cut():(t&&e.context.fill(t),i&&e.context.stroke(i))}}else{const Q=U?U==="evenodd":!0;F=new Dr(B,Q),e.context.path(F),t&&e.context.fill(t),i&&e.context.stroke(i)}break}case"circle":w=_t(n,"cx",0),S=_t(n,"cy",0),b=_t(n,"r",0),e.context.ellipse(w,S,b,b),t&&e.context.fill(t),i&&e.context.stroke(i);break;case"rect":h=_t(n,"x",0),f=_t(n,"y",0),I=_t(n,"width",0),N=_t(n,"height",0),k=_t(n,"rx",0),A=_t(n,"ry",0),k||A?e.context.roundRect(h,f,I,N,k||A):e.context.rect(h,f,I,N),t&&e.context.fill(t),i&&e.context.stroke(i);break;case"ellipse":w=_t(n,"cx",0),S=_t(n,"cy",0),k=_t(n,"rx",0),A=_t(n,"ry",0),e.context.beginPath(),e.context.ellipse(w,S,k,A),t&&e.context.fill(t),i&&e.context.stroke(i);break;case"line":p=_t(n,"x1",0),g=_t(n,"y1",0),v=_t(n,"x2",0),x=_t(n,"y2",0),e.context.beginPath(),e.context.moveTo(p,g),e.context.lineTo(v,x),i&&e.context.stroke(i);break;case"polygon":E=n.getAttribute("points"),M=E.match(/\d+/g).map(U=>parseInt(U,10)),e.context.poly(M,!0),t&&e.context.fill(t),i&&e.context.stroke(i);break;case"polyline":E=n.getAttribute("points"),M=E.match(/\d+/g).map(U=>parseInt(U,10)),e.context.poly(M,!1),i&&e.context.stroke(i);break;case"g":case"svg":break;default:{ct(`[SVG parser] <${n.nodeName}> elements unsupported`);break}}u&&(t=null);for(let U=0;U<o.length;U++)zm(o[U],e,t,i)}function w9(n){return At.isColorLike(n)}function Vp(n){return n instanceof Ec}function Yp(n){return n instanceof Or}function b9(n){return n instanceof Ne}function S9(n,e,t){const i=At.shared.setValue(e??0);return n.color=i.toNumber(),n.alpha=i.alpha===1?t.alpha:i.alpha,n.texture=Ne.WHITE,{...t,...n}}function k9(n,e,t){return n.texture=e,{...t,...n}}function Xp(n,e,t){return n.fill=e,n.color=16777215,n.texture=e.texture,n.matrix=e.transform,{...t,...n}}function qp(n,e,t){return e.buildGradient(),n.fill=e,n.color=16777215,n.texture=e.texture,n.matrix=e.transform,n.textureSpace=e.textureSpace,{...t,...n}}function C9(n,e){const t={...e,...n},i=At.shared.setValue(t.color);return t.alpha*=i.alpha,t.color=i.toNumber(),t}function Zi(n,e){if(n==null)return null;const t={},i=n;return w9(n)?S9(t,n,e):b9(n)?k9(t,n,e):Vp(n)?Xp(t,n,e):Yp(n)?qp(t,n,e):i.fill&&Vp(i.fill)?Xp(i,i.fill,e):i.fill&&Yp(i.fill)?qp(i,i.fill,e):C9(i,e)}function Ac(n,e){const{width:t,alignment:i,miterLimit:o,cap:a,join:c,pixelLine:u,...h}=e,f=Zi(n,h);return f?{width:t,alignment:i,miterLimit:o,cap:a,join:c,pixelLine:u,...f}:null}const A9=new Xt,Kp=new Be,Sh=class yr extends er{constructor(){super(...arguments),this.uid=wt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Dr,this._transform=new Be,this._fillStyle={...yr.defaultFillStyle},this._strokeStyle={...yr.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Jn,this._boundsDirty=!0}clone(){const e=new yr;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Zi(e,yr.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Ac(e,yr.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Zi(e,yr.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Zi(e,yr.defaultStrokeStyle),this}texture(e,t,i,o,a,c){return this.instructions.push({action:"texture",data:{image:e,dx:i||0,dy:o||0,dw:a||e.frame.width,dh:c||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t?At.shared.setValue(t).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Dr,this}fill(e,t){let i;const o=this.instructions[this.instructions.length-1];return this._tick===0&&(o==null?void 0:o.action)==="stroke"?i=o.data.path:i=this._activePath.clone(),i?(e!=null&&(t!==void 0&&typeof e=="number"&&(Fe(Je,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:t}),this._fillStyle=Zi(e,yr.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:t}=this._activePath.getLastPoint(Xt.shared);this._activePath.clear(),this._activePath.moveTo(e,t)}stroke(e){let t;const i=this.instructions[this.instructions.length-1];return this._tick===0&&(i==null?void 0:i.action)==="fill"?t=i.data.path:t=this._activePath.clone(),t?(e!=null&&(this._strokeStyle=Ac(e,yr.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:t}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const t=this.instructions[this.instructions.length-1-e],i=this._activePath.clone();if(t&&(t.action==="stroke"||t.action==="fill"))if(t.data.hole)t.data.hole.addPath(i);else{t.data.hole=i;break}}return this._initNextPathLocation(),this}arc(e,t,i,o,a,c){this._tick++;const u=this._transform;return this._activePath.arc(u.a*e+u.c*t+u.tx,u.b*e+u.d*t+u.ty,i,o,a,c),this}arcTo(e,t,i,o,a){this._tick++;const c=this._transform;return this._activePath.arcTo(c.a*e+c.c*t+c.tx,c.b*e+c.d*t+c.ty,c.a*i+c.c*o+c.tx,c.b*i+c.d*o+c.ty,a),this}arcToSvg(e,t,i,o,a,c,u){this._tick++;const h=this._transform;return this._activePath.arcToSvg(e,t,i,o,a,h.a*c+h.c*u+h.tx,h.b*c+h.d*u+h.ty),this}bezierCurveTo(e,t,i,o,a,c,u){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*e+h.c*t+h.tx,h.b*e+h.d*t+h.ty,h.a*i+h.c*o+h.tx,h.b*i+h.d*o+h.ty,h.a*a+h.c*c+h.tx,h.b*a+h.d*c+h.ty,u),this}closePath(){var e;return this._tick++,(e=this._activePath)==null||e.closePath(),this}ellipse(e,t,i,o){return this._tick++,this._activePath.ellipse(e,t,i,o,this._transform.clone()),this}circle(e,t,i){return this._tick++,this._activePath.circle(e,t,i,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,t){this._tick++;const i=this._transform;return this._activePath.lineTo(i.a*e+i.c*t+i.tx,i.b*e+i.d*t+i.ty),this}moveTo(e,t){this._tick++;const i=this._transform,o=this._activePath.instructions,a=i.a*e+i.c*t+i.tx,c=i.b*e+i.d*t+i.ty;return o.length===1&&o[0].action==="moveTo"?(o[0].data[0]=a,o[0].data[1]=c,this):(this._activePath.moveTo(a,c),this)}quadraticCurveTo(e,t,i,o,a){this._tick++;const c=this._transform;return this._activePath.quadraticCurveTo(c.a*e+c.c*t+c.tx,c.b*e+c.d*t+c.ty,c.a*i+c.c*o+c.tx,c.b*i+c.d*o+c.ty,a),this}rect(e,t,i,o){return this._tick++,this._activePath.rect(e,t,i,o,this._transform.clone()),this}roundRect(e,t,i,o,a){return this._tick++,this._activePath.roundRect(e,t,i,o,a,this._transform.clone()),this}poly(e,t){return this._tick++,this._activePath.poly(e,t,this._transform.clone()),this}regularPoly(e,t,i,o,a=0,c){return this._tick++,this._activePath.regularPoly(e,t,i,o,a,c),this}roundPoly(e,t,i,o,a,c){return this._tick++,this._activePath.roundPoly(e,t,i,o,a,c),this}roundShape(e,t,i,o){return this._tick++,this._activePath.roundShape(e,t,i,o),this}filletRect(e,t,i,o,a){return this._tick++,this._activePath.filletRect(e,t,i,o,a),this}chamferRect(e,t,i,o,a,c){return this._tick++,this._activePath.chamferRect(e,t,i,o,a,c),this}star(e,t,i,o,a=0,c=0){return this._tick++,this._activePath.star(e,t,i,o,a,c,this._transform.clone()),this}svg(e){return this._tick++,_9(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,t=e){return this._transform.scale(e,t),this}setTransform(e,t,i,o,a,c){return e instanceof Be?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,t,i,o,a,c),this)}transform(e,t,i,o,a,c){return e instanceof Be?(this._transform.append(e),this):(Kp.set(e,t,i,o,a,c),this._transform.append(Kp),this)}translate(e,t=e){return this._transform.translate(e,t),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const e=this._bounds;e.clear();for(let t=0;t<this.instructions.length;t++){const i=this.instructions[t],o=i.action;if(o==="fill"){const a=i.data;e.addBounds(a.path.bounds)}else if(o==="texture"){const a=i.data;e.addFrame(a.dx,a.dy,a.dx+a.dw,a.dy+a.dh,a.transform)}if(o==="stroke"){const a=i.data,c=a.style.alignment,u=a.style.width*(1-c),h=a.path.bounds;e.addFrame(h.minX-u,h.minY-u,h.maxX+u,h.maxY+u)}}return e}containsPoint(e){var o;if(!this.bounds.containsPoint(e.x,e.y))return!1;const t=this.instructions;let i=!1;for(let a=0;a<t.length;a++){const c=t[a],u=c.data,h=u.path;if(!c.action||!h)continue;const f=u.style,p=h.shapePath.shapePrimitives;for(let g=0;g<p.length;g++){const v=p[g].shape;if(!f||!v)continue;const x=p[g].transform,w=x?x.applyInverse(e,A9):e;if(c.action==="fill")i=v.contains(w.x,w.y);else{const b=f;i=v.strokeContains(w.x,w.y,b.width,b.alignment)}const S=u.hole;if(S){const b=(o=S.shapePath)==null?void 0:o.shapePrimitives;if(b)for(let k=0;k<b.length;k++)b[k].shape.contains(w.x,w.y)&&(i=!1)}if(i)return!0}}return i}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e==null?void 0:e.texture){const i=typeof e=="boolean"?e:e==null?void 0:e.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(i)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(i))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Sh.defaultFillStyle={color:16777215,alpha:1,texture:Ne.WHITE,matrix:null,fill:null,textureSpace:"local"};Sh.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:Ne.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Fn=Sh;const kh=class Vs extends er{constructor(e={}){super(),this.uid=wt("textStyle"),this._tick=0,T9(e);const t={...Vs.defaultTextStyle,...e};for(const i in t){const o=i;this[o]=t[i]}this.update(),this._tick=0}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.update())}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...Vs.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...Vs.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.update())}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.update())}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.update())}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.update())}get filters(){return this._filters}set filters(e){this._filters!==e&&(this._filters=Object.freeze(e),this.update())}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.update())}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...Fn.defaultFillStyle,...e},()=>{this._fill=Zi({...this._originalFill},Fn.defaultFillStyle)})),this._fill=Zi(e===0?"black":e,Fn.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...Fn.defaultStrokeStyle,...e},()=>{this._stroke=Ac({...this._originalStroke},Fn.defaultStrokeStyle)})),this._stroke=Ac(e,Fn.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){const e=Vs.defaultTextStyle;for(const t in e)this[t]=e[t]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new Vs({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let e=0;if(this._filters)for(let t=0;t<this._filters.length;t++)e+=this._filters[t].padding;return Math.max(this._padding,e)}destroy(e=!1){var i,o,a,c;if(this.removeAllListeners(),typeof e=="boolean"?e:e==null?void 0:e.texture){const u=typeof e=="boolean"?e:e==null?void 0:e.textureSource;(i=this._fill)!=null&&i.texture&&this._fill.texture.destroy(u),(o=this._originalFill)!=null&&o.texture&&this._originalFill.texture.destroy(u),(a=this._stroke)!=null&&a.texture&&this._stroke.texture.destroy(u),(c=this._originalStroke)!=null&&c.texture&&this._originalStroke.texture.destroy(u)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,t){return new Proxy(e,{set:(i,o,a)=>(i[o]===a||(i[o]=a,t==null||t(o,a),this.update()),!0)})}_isFillStyle(e){return(e??null)!==null&&!(At.isColorLike(e)||e instanceof Or||e instanceof Ec)}};kh.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};kh.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ia=kh;function T9(n){const e=n;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const t=Ia.defaultDropShadow;n.dropShadow={alpha:e.dropShadowAlpha??t.alpha,angle:e.dropShadowAngle??t.angle,blur:e.dropShadowBlur??t.blur,color:e.dropShadowColor??t.color,distance:e.dropShadowDistance??t.distance}}if(e.strokeThickness!==void 0){Fe(Je,"strokeThickness is now a part of stroke");const t=e.stroke;let i={};if(At.isColorLike(t))i.color=t;else if(t instanceof Or||t instanceof Ec)i.fill=t;else if(Object.hasOwnProperty.call(t,"color")||Object.hasOwnProperty.call(t,"fill"))i=t;else throw new Error("Invalid stroke value.");n.stroke={...i,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){if(Fe(Je,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(e.fill)||e.fill.length===0)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");e.fill.length!==e.fillGradientStops.length&&ct("The number of fill colors must match the number of fill gradient stops.");const t=new Or({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),i=e.fillGradientStops.slice(),o=e.fill.map(a=>At.shared.setValue(a).toNumber());i.forEach((a,c)=>{t.addColorStop(a,o[c])}),n.fill={fill:t}}}class M9{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){const i=rt.get().createCanvas();i.width=e,i.height=t;const o=i.getContext("2d");return{canvas:i,context:o}}getOptimalCanvasAndContext(e,t,i=1){e=Math.ceil(e*i-1e-6),t=Math.ceil(t*i-1e-6),e=Js(e),t=Js(t);const o=(e<<17)+(t<<1);this._canvasPool[o]||(this._canvasPool[o]=[]);let a=this._canvasPool[o].pop();return a||(a=this._createCanvasAndContext(e,t)),a}returnCanvasAndContext(e){const t=e.canvas,{width:i,height:o}=t,a=(i<<17)+(o<<1);e.context.resetTransform(),e.context.clearRect(0,0,i,o),this._canvasPool[a].push(e)}clear(){this._canvasPool={}}}const $a=new M9;Da.register($a);const Qp=1e5;function Tc(n,e,t,i=0){if(n.texture===Ne.WHITE&&!n.fill)return At.shared.setValue(n.color).setAlpha(n.alpha??1).toHexa();if(n.fill){if(n.fill instanceof Ec){const o=n.fill,a=e.createPattern(o.texture.source.resource,"repeat"),c=o.transform.copyTo(Be.shared);return c.scale(o.texture.frame.width,o.texture.frame.height),a.setTransform(c),a}else if(n.fill instanceof Or){const o=n.fill,a=o.type==="linear",c=o.textureSpace==="local";let u=1,h=1;c&&t&&(u=t.width+i,h=t.height+i);let f,p=!1;if(a){const{start:g,end:v}=o;f=e.createLinearGradient(g.x*u,g.y*h,v.x*u,v.y*h),p=Math.abs(v.x-g.x)<Math.abs((v.y-g.y)*.1)}else{const{center:g,innerRadius:v,outerCenter:x,outerRadius:w}=o;f=e.createRadialGradient(g.x*u,g.y*h,v*u,x.x*u,x.y*h,w*u)}if(p&&c&&t){const g=t.lineHeight/h;for(let v=0;v<t.lines.length;v++){const x=(v*t.lineHeight+i/2)/h;o.colorStops.forEach(w=>{const S=x+w.offset*g;f.addColorStop(Math.floor(S*Qp)/Qp,At.shared.setValue(w.color).toHex())})}}else o.colorStops.forEach(g=>{f.addColorStop(g.offset,At.shared.setValue(g.color).toHex())});return f}}else{const o=e.createPattern(n.texture.source.resource,"repeat"),a=n.matrix.copyTo(Be.shared);return a.scale(n.texture.frame.width,n.texture.frame.height),o.setTransform(a),o}return ct("FillStyle not recognised",n),"red"}const Fm=class jm extends ym{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const t={...jm.defaultOptions,...e};this._textureSize=t.textureSize,this._mipmap=t.mipmap;const i=t.style.clone();t.overrideFill&&(i._fill.color=16777215,i._fill.alpha=1,i._fill.texture=Ne.WHITE,i._fill.fill=null),this.applyFillAsTint=t.overrideFill;const o=i.fontSize;i.fontSize=this.baseMeasurementFontSize;const a=kc(i);t.overrideSize?i._stroke&&(i._stroke.width*=this.baseRenderedFontSize/o):i.fontSize=this.baseRenderedFontSize=o,this._style=i,this._skipKerning=t.skipKerning??!1,this.resolution=t.resolution??1,this._padding=t.padding??4,t.textureStyle&&(this._textureStyle=t.textureStyle instanceof eo?t.textureStyle:new eo(t.textureStyle)),this.fontMetrics=vr.measureFont(a),this.lineHeight=i.lineHeight||this.fontMetrics.fontSize||i.fontSize}ensureCharacters(e){var b,k;const t=vr.graphemeSegmenter(e).filter(A=>!this._currentChars.includes(A)).filter((A,M,E)=>E.indexOf(A)===M);if(!t.length)return;this._currentChars=[...this._currentChars,...t];let i;this._currentPageIndex===-1?i=this._nextPage():i=this.pages[this._currentPageIndex];let{canvas:o,context:a}=i.canvasAndContext,c=i.texture.source;const u=this._style;let h=this._currentX,f=this._currentY,p=this._currentMaxCharHeight;const g=this.baseRenderedFontSize/this.baseMeasurementFontSize,v=this._padding*g;let x=!1;const w=o.width/this.resolution,S=o.height/this.resolution;for(let A=0;A<t.length;A++){const M=t[A],E=vr.measureText(M,u,o,!1);E.lineHeight=E.height;const B=E.width*g,F=Math.ceil((u.fontStyle==="italic"?2:1)*B),I=E.height*g,N=F+v*2,U=I+v*2;if(x=!1,M!==`
`&&M!=="\r"&&M!=="	"&&M!==" "&&(x=!0,p=Math.ceil(Math.max(U,p))),h+N>w&&(f+=p,p=U,h=0,f+p>S)){c.update();const H=this._nextPage();o=H.canvasAndContext.canvas,a=H.canvasAndContext.context,c=H.texture.source,h=0,f=0,p=0}const q=B/g-(((b=u.dropShadow)==null?void 0:b.distance)??0)-(((k=u._stroke)==null?void 0:k.width)??0);if(this.chars[M]={id:M.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:q,kerning:{}},x){this._drawGlyph(a,E,h+v,f+v,g,u);const H=c.width*g,se=c.height*g,Z=new ft(h/H*c.width,f/se*c.height,N/H*c.width,U/se*c.height);this.chars[M].texture=new Ne({source:c,frame:Z}),h+=Math.ceil(N)}}c.update(),this._currentX=h,this._currentY=f,this._currentMaxCharHeight=p,this._skipKerning&&this._applyKerning(t,a)}get pageTextures(){return Fe(Je,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,t){const i=this._measureCache;for(let o=0;o<e.length;o++){const a=e[o];for(let c=0;c<this._currentChars.length;c++){const u=this._currentChars[c];let h=i[a];h||(h=i[a]=t.measureText(a).width);let f=i[u];f||(f=i[u]=t.measureText(u).width);let p=t.measureText(a+u).width,g=p-(h+f);g&&(this.chars[a].kerning[u]=g),p=t.measureText(a+u).width,g=p-(h+f),g&&(this.chars[u].kerning[a]=g)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,t=$a.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(t.context,this._style,e);const i=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),o=new Ne({source:new Ji({resource:t.canvas,resolution:i,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(o.source.style=this._textureStyle);const a={canvasAndContext:t,texture:o};return this.pages[this._currentPageIndex]=a,a}_setupContext(e,t,i){t.fontSize=this.baseRenderedFontSize,e.scale(i,i),e.font=kc(t),t.fontSize=this.baseMeasurementFontSize,e.textBaseline=t.textBaseline;const o=t._stroke,a=(o==null?void 0:o.width)??0;if(o&&(e.lineWidth=a,e.lineJoin=o.join,e.miterLimit=o.miterLimit,e.strokeStyle=Tc(o,e)),t._fill&&(e.fillStyle=Tc(t._fill,e)),t.dropShadow){const c=t.dropShadow,u=At.shared.setValue(c.color).toArray(),h=c.blur*i,f=c.distance*i;e.shadowColor=`rgba(${u[0]*255},${u[1]*255},${u[2]*255},${c.alpha})`,e.shadowBlur=h,e.shadowOffsetX=Math.cos(c.angle)*f,e.shadowOffsetY=Math.sin(c.angle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,t,i,o,a,c){const u=t.text,h=t.fontProperties,f=c._stroke,p=((f==null?void 0:f.width)??0)*a,g=i+p/2,v=o-p/2,x=h.descent*a,w=t.lineHeight*a;let S=!1;c.stroke&&p&&(S=!0,e.strokeText(u,g,v+w-x));const{shadowBlur:b,shadowOffsetX:k,shadowOffsetY:A}=e;c._fill&&(S&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.fillText(u,g,v+w-x)),S&&(e.shadowBlur=b,e.shadowOffsetX=k,e.shadowOffsetY=A)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:t,texture:i}=this.pages[e];$a.returnCanvasAndContext(t),i.destroy(!0)}this.pages=null}};Fm.defaultOptions={textureSize:512,style:new Ia,mipmap:!0};let Zp=Fm;function P9(n,e,t,i){const o={width:0,height:0,offsetY:0,scale:e.fontSize/t.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};o.offsetY=t.baseLineOffset;let a=o.lines[0],c=null,u=!0;const h={width:0,start:0,index:0,positions:[],chars:[]},f=t.baseMeasurementFontSize/e.fontSize,p=e.letterSpacing*f,g=e.wordWrapWidth*f,v=e.lineHeight?e.lineHeight*f:t.lineHeight,x=e.wordWrap&&e.breakWords,w=k=>{const A=a.width;for(let M=0;M<h.index;M++){const E=k.positions[M];a.chars.push(k.chars[M]),a.charPositions.push(E+A)}a.width+=k.width,u=!1,h.width=0,h.index=0,h.chars.length=0},S=()=>{let k=a.chars.length-1;if(i){let A=a.chars[k];for(;A===" ";)a.width-=t.chars[A].xAdvance,A=a.chars[--k]}o.width=Math.max(o.width,a.width),a={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},u=!0,o.lines.push(a),o.height+=v},b=k=>k-p>g;for(let k=0;k<n.length+1;k++){let A;const M=k===n.length;M||(A=n[k]);const E=t.chars[A]||t.chars[" "];if(/(?:\s)/.test(A)||A==="\r"||A===`
`||M){if(!u&&e.wordWrap&&b(a.width+h.width)?(S(),w(h),M||a.charPositions.push(0)):(h.start=a.width,w(h),M||a.charPositions.push(0)),A==="\r"||A===`
`)S();else if(!M){const N=E.xAdvance+(E.kerning[c]||0)+p;a.width+=N,a.spaceWidth=N,a.spacesIndex.push(a.charPositions.length),a.chars.push(A)}}else{const I=E.kerning[c]||0,N=E.xAdvance+I+p;x&&b(a.width+h.width+N)&&(w(h),S()),h.positions[h.index++]=h.width+I,h.chars.push(A),h.width+=N}c=A}return S(),e.align==="center"?E9(o):e.align==="right"?R9(o):e.align==="justify"&&I9(o),o}function E9(n){for(let e=0;e<n.lines.length;e++){const t=n.lines[e],i=n.width/2-t.width/2;for(let o=0;o<t.charPositions.length;o++)t.charPositions[o]+=i}}function R9(n){for(let e=0;e<n.lines.length;e++){const t=n.lines[e],i=n.width-t.width;for(let o=0;o<t.charPositions.length;o++)t.charPositions[o]+=i}}function I9(n){const e=n.width;for(let t=0;t<n.lines.length;t++){const i=n.lines[t];let o=0,a=i.spacesIndex[o++],c=0;const u=i.spacesIndex.length,f=(e-i.width)/u;for(let p=0;p<i.charPositions.length;p++)p===a&&(a=i.spacesIndex[o++],c+=f),i.charPositions[p]+=c}}function $9(n){if(n==="")return[];typeof n=="string"&&(n=[n]);const e=[];for(let t=0,i=n.length;t<i;t++){const o=n[t];if(Array.isArray(o)){if(o.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${o.length}.`);if(o[0].length===0||o[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const a=o[0].charCodeAt(0),c=o[1].charCodeAt(0);if(c<a)throw new Error("[BitmapFont]: Invalid character range.");for(let u=a,h=c;u<=h;u++)e.push(String.fromCharCode(u))}else e.push(...Array.from(o))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}let dc=0;class L9{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=xm(1e3)}getFont(e,t){var c;let i=`${t.fontFamily}-bitmap`,o=!0;if(t._fill.fill&&!t._stroke?(i+=t._fill.fill.styleKey,o=!1):(t._stroke||t.dropShadow)&&(i=`${t.styleKey}-bitmap`,o=!1),!lt.has(i)){const u=Object.create(t);u.lineHeight=0;const h=new Zp({style:u,overrideFill:o,overrideSize:!0,...this.defaultOptions});dc++,dc>50&&ct("BitmapText",`You have dynamically created ${dc} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),h.once("destroy",()=>{dc--,lt.remove(i)}),lt.set(i,h)}const a=lt.get(i);return(c=a.ensureCharacters)==null||c.call(a,e),a}getLayout(e,t,i=!0){const o=this.getFont(e,t),a=`${e}-${t.styleKey}-${i}`;if(this.measureCache.has(a))return this.measureCache.get(a);const c=vr.graphemeSegmenter(e),u=P9(c,t,o,i);return this.measureCache.set(a,u),u}measureText(e,t,i=!0){return this.getLayout(e,t,i)}install(...e){var f,p,g,v;let t=e[0];typeof t=="string"&&(t={name:t,style:e[1],chars:(f=e[2])==null?void 0:f.chars,resolution:(p=e[2])==null?void 0:p.resolution,padding:(g=e[2])==null?void 0:g.padding,skipKerning:(v=e[2])==null?void 0:v.skipKerning},Fe(Je,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const i=t==null?void 0:t.name;if(!i)throw new Error("[BitmapFontManager] Property `name` is required.");t={...this.defaultOptions,...t};const o=t.style,a=o instanceof Ia?o:new Ia(o),c=t.dynamicFill??this._canUseTintForStyle(a),u=new Zp({style:a,overrideFill:c,skipKerning:t.skipKerning,padding:t.padding,resolution:t.resolution,overrideSize:!1,textureStyle:t.textureStyle}),h=$9(t.chars);return u.ensureCharacters(h.join("")),lt.set(`${i}-bitmap`,u),u.once("destroy",()=>lt.remove(`${i}-bitmap`)),u}uninstall(e){const t=`${e}-bitmap`,i=lt.get(t);i&&i.destroy()}_canUseTintForStyle(e){return!e._stroke&&(!e.dropShadow||e.dropShadow.color===0)&&!e._fill.fill&&e._fill.color===16777215}}const Jp=new L9;class Bm extends ym{constructor(e,t){super();const{textures:i,data:o}=e;Object.keys(o.pages).forEach(a=>{const c=o.pages[parseInt(a,10)],u=i[c.id];this.pages.push({texture:u})}),Object.keys(o.chars).forEach(a=>{const c=o.chars[a],{frame:u,source:h,rotate:f}=i[c.page],p=et.transformRectCoords(c,u,f,new ft),g=new Ne({frame:p,orig:new ft(0,0,c.width,c.height),source:h,rotate:f});this.chars[a]={id:a.codePointAt(0),xOffset:c.xOffset,yOffset:c.yOffset,xAdvance:c.xAdvance,kerning:c.kerning??{},texture:g}}),this.baseRenderedFontSize=o.fontSize,this.baseMeasurementFontSize=o.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:o.fontSize},this.baseLineOffset=o.baseLineOffset,this.lineHeight=o.lineHeight,this.fontFamily=o.fontFamily,this.distanceField=o.distanceField??{type:"none",range:0},this.url=t}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:t}=this.pages[e];t.destroy(!0)}this.pages=null}static install(e){Jp.install(e)}static uninstall(e){Jp.uninstall(e)}}const Fd={test(n){return typeof n=="string"&&n.startsWith("info face=")},parse(n){const e=n.match(/^[a-z]+\s+.+$/gm),t={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const g in e){const v=e[g].match(/^[a-z]+/gm)[0],x=e[g].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),w={};for(const S in x){const b=x[S].split("="),k=b[0],A=b[1].replace(/"/gm,""),M=parseFloat(A),E=isNaN(M)?A:M;w[k]=E}t[v].push(w)}const i={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[o]=t.info,[a]=t.common,[c]=t.distanceField??[];c&&(i.distanceField={range:parseInt(c.distanceRange,10),type:c.fieldType}),i.fontSize=parseInt(o.size,10),i.fontFamily=o.face,i.lineHeight=parseInt(a.lineHeight,10);const u=t.page;for(let g=0;g<u.length;g++)i.pages.push({id:parseInt(u[g].id,10)||0,file:u[g].file});const h={};i.baseLineOffset=i.lineHeight-parseInt(a.base,10);const f=t.char;for(let g=0;g<f.length;g++){const v=f[g],x=parseInt(v.id,10);let w=v.letter??v.char??String.fromCharCode(x);w==="space"&&(w=" "),h[x]=w,i.chars[w]={id:x,page:parseInt(v.page,10)||0,x:parseInt(v.x,10),y:parseInt(v.y,10),width:parseInt(v.width,10),height:parseInt(v.height,10),xOffset:parseInt(v.xoffset,10),yOffset:parseInt(v.yoffset,10),xAdvance:parseInt(v.xadvance,10),kerning:{}}}const p=t.kerning||[];for(let g=0;g<p.length;g++){const v=parseInt(p[g].first,10),x=parseInt(p[g].second,10),w=parseInt(p[g].amount,10);i.chars[h[x]].kerning[h[v]]=w}return i}},e0={test(n){const e=n;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(n){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},t=n.getElementsByTagName("info")[0],i=n.getElementsByTagName("common")[0],o=n.getElementsByTagName("distanceField")[0];o&&(e.distanceField={type:o.getAttribute("fieldType"),range:parseInt(o.getAttribute("distanceRange"),10)});const a=n.getElementsByTagName("page"),c=n.getElementsByTagName("char"),u=n.getElementsByTagName("kerning");e.fontSize=parseInt(t.getAttribute("size"),10),e.fontFamily=t.getAttribute("face"),e.lineHeight=parseInt(i.getAttribute("lineHeight"),10);for(let f=0;f<a.length;f++)e.pages.push({id:parseInt(a[f].getAttribute("id"),10)||0,file:a[f].getAttribute("file")});const h={};e.baseLineOffset=e.lineHeight-parseInt(i.getAttribute("base"),10);for(let f=0;f<c.length;f++){const p=c[f],g=parseInt(p.getAttribute("id"),10);let v=p.getAttribute("letter")??p.getAttribute("char")??String.fromCharCode(g);v==="space"&&(v=" "),h[g]=v,e.chars[v]={id:g,page:parseInt(p.getAttribute("page"),10)||0,x:parseInt(p.getAttribute("x"),10),y:parseInt(p.getAttribute("y"),10),width:parseInt(p.getAttribute("width"),10),height:parseInt(p.getAttribute("height"),10),xOffset:parseInt(p.getAttribute("xoffset"),10),yOffset:parseInt(p.getAttribute("yoffset"),10),xAdvance:parseInt(p.getAttribute("xadvance"),10),kerning:{}}}for(let f=0;f<u.length;f++){const p=parseInt(u[f].getAttribute("first"),10),g=parseInt(u[f].getAttribute("second"),10),v=parseInt(u[f].getAttribute("amount"),10);e.chars[h[g]].kerning[h[p]]=v}return e}},t0={test(n){return typeof n=="string"&&n.match(/<font(\s|>)/)?e0.test(rt.get().parseXML(n)):!1},parse(n){return e0.parse(rt.get().parseXML(n))}},z9=[".xml",".fnt"],F9={extension:{type:be.CacheParser,name:"cacheBitmapFont"},test:n=>n instanceof Bm,getCacheableAssets(n,e){const t={};return n.forEach(i=>{t[i]=e,t[`${i}-bitmap`]=e}),t[`${e.fontFamily}-bitmap`]=e,t}},j9={extension:{type:be.LoadParser,priority:gi.Normal},name:"loadBitmapFont",id:"bitmap-font",test(n){return z9.includes(Tn.extname(n).toLowerCase())},async testParse(n){return Fd.test(n)||t0.test(n)},async parse(n,e,t){const i=Fd.test(n)?Fd.parse(n):t0.parse(n),{src:o}=e,{pages:a}=i,c=[],u=i.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let g=0;g<a.length;++g){const v=a[g].file;let x=Tn.join(Tn.dirname(o),v);x=qd(x,o),c.push({src:x,data:u})}const h=await t.load(c),f=c.map(g=>h[g.src]);return new Bm({data:i,textures:f},o)},async load(n,e){return await(await rt.get().fetch(n)).text()},async unload(n,e,t){await Promise.all(n.pages.map(i=>t.unload(i.texture.source._sourceOrigin))),n.destroy()}};class B9{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<t;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const D9={extension:{type:be.CacheParser,name:"cacheTextureArray"},test:n=>Array.isArray(n)&&n.every(e=>e instanceof Ne),getCacheableAssets:(n,e)=>{const t={};return n.forEach(i=>{e.forEach((o,a)=>{t[i+(a===0?"":a+1)]=o})}),t}};async function Dm(n){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=n});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(n)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const O9={extension:{type:be.DetectionParser,priority:1},test:async()=>Dm("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async n=>[...n,"avif"],remove:async n=>n.filter(e=>e!=="avif")},n0=["png","jpg","jpeg"],N9={extension:{type:be.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async n=>[...n,...n0],remove:async n=>n.filter(e=>!n0.includes(e))},W9="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Ic(n){return W9?!1:document.createElement("video").canPlayType(n)!==""}const H9={extension:{type:be.DetectionParser,priority:0},test:async()=>Ic("video/mp4"),add:async n=>[...n,"mp4","m4v"],remove:async n=>n.filter(e=>e!=="mp4"&&e!=="m4v")},U9={extension:{type:be.DetectionParser,priority:0},test:async()=>Ic("video/ogg"),add:async n=>[...n,"ogv"],remove:async n=>n.filter(e=>e!=="ogv")},G9={extension:{type:be.DetectionParser,priority:0},test:async()=>Ic("video/webm"),add:async n=>[...n,"webm"],remove:async n=>n.filter(e=>e!=="webm")},V9={extension:{type:be.DetectionParser,priority:0},test:async()=>Dm("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async n=>[...n,"webp"],remove:async n=>n.filter(e=>e!=="webp")},Om=class xc{constructor(){this.loadOptions={...xc.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,i)=>(this._parsersValidated=!1,e[t]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const i={promise:null,parser:null};return i.promise=(async()=>{var c,u;let o=null,a=null;if((t.parser||t.loadParser)&&(a=this._parserHash[t.parser||t.loadParser],t.loadParser&&ct(`[Assets] "loadParser" is deprecated, use "parser" instead for ${e}`),a||ct(`[Assets] specified load parser "${t.parser||t.loadParser}" not found while loading ${e}`)),!a){for(let h=0;h<this.parsers.length;h++){const f=this.parsers[h];if(f.load&&((c=f.test)!=null&&c.call(f,e,t,this))){a=f;break}}if(!a)return ct(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}o=await a.load(e,t,this),i.parser=a;for(let h=0;h<this.parsers.length;h++){const f=this.parsers[h];f.parse&&f.parse&&await((u=f.testParse)==null?void 0:u.call(f,o,t,this))&&(o=await f.parse(o,t,this)||o,i.parser=f)}return o})(),i}async load(e,t){this._parsersValidated||this._validateParsers();const i=typeof t=="function"?{...xc.defaultOptions,...this.loadOptions,onProgress:t}:{...xc.defaultOptions,...this.loadOptions,...t||{}},{onProgress:o,onError:a,strategy:c,retryCount:u,retryDelay:h}=i;let f=0;const p={},g=Sc(e),v=Qn(e,S=>({alias:[S],src:S,data:{}})),x=v.reduce((S,b)=>S+(b.progressSize||1),0),w=v.map(async S=>{const b=Tn.toAbsolute(S.src);p[S.src]||(await this._loadAssetWithRetry(b,S,{onProgress:o,onError:a,strategy:c,retryCount:u,retryDelay:h},p),f+=S.progressSize||1,o&&o(f/x))});return await Promise.all(w),g?p[v[0].src]:p}async unload(e){const i=Qn(e,o=>({alias:[o],src:o})).map(async o=>{var u,h;const a=Tn.toAbsolute(o.src),c=this.promiseCache[a];if(c){const f=await c.promise;delete this.promiseCache[a],await((h=(u=c.parser)==null?void 0:u.unload)==null?void 0:h.call(u,f,o,this))}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name||e.id).reduce((e,t)=>(!t.name&&!t.id?ct("[Assets] parser should have an id"):(e[t.name]||e[t.id])&&ct(`[Assets] parser id conflict "${t.id}"`),e[t.name]=t,t.id&&(e[t.id]=t),e),{})}async _loadAssetWithRetry(e,t,i,o){let a=0;const{onError:c,strategy:u,retryCount:h,retryDelay:f}=i,p=g=>new Promise(v=>setTimeout(v,g));for(;;)try{this.promiseCache[e]||(this.promiseCache[e]=this._getLoadPromiseAndParser(e,t)),o[t.src]=await this.promiseCache[e].promise;return}catch(g){delete this.promiseCache[e],delete o[t.src],a++;const v=u!=="retry"||a>h;if(u==="retry"&&!v){c&&c(g,t),await p(f);continue}if(u==="skip"){c&&c(g,t);return}throw c&&c(g,t),new Error(`[Loader.load] Failed to load ${e}.
${g}`)}}};Om.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let Y9=Om;function so(n,e){if(Array.isArray(e)){for(const t of e)if(n.startsWith(`data:${t}`))return!0;return!1}return n.startsWith(`data:${e}`)}function oo(n,e){const t=n.split("?")[0],i=Tn.extname(t).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}const X9=".json",q9="application/json",K9={extension:{type:be.LoadParser,priority:gi.Low},name:"loadJson",id:"json",test(n){return so(n,q9)||oo(n,X9)},async load(n){return await(await rt.get().fetch(n)).json()}},Q9=".txt",Z9="text/plain",J9={name:"loadTxt",id:"text",extension:{type:be.LoadParser,priority:gi.Low,name:"loadTxt"},test(n){return so(n,Z9)||oo(n,Q9)},async load(n){return await(await rt.get().fetch(n)).text()}},ev=["normal","bold","100","200","300","400","500","600","700","800","900"],tv=[".ttf",".otf",".woff",".woff2"],nv=["font/ttf","font/otf","font/woff","font/woff2"],rv=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function iv(n){const e=Tn.extname(n),o=Tn.basename(n,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1));let a=o.length>0;for(const u of o)if(!u.match(rv)){a=!1;break}let c=o.join(" ");return a||(c=`"${c.replace(/[\\"]/g,"\\$&")}"`),c}const sv=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function ov(n){return sv.test(n)?n:encodeURI(n)}const av={extension:{type:be.LoadParser,priority:gi.Low},name:"loadWebFont",id:"web-font",test(n){return so(n,nv)||oo(n,tv)},async load(n,e){var i,o,a;const t=rt.get().getFontFaceSet();if(t){const c=[],u=((i=e.data)==null?void 0:i.family)??iv(n),h=((a=(o=e.data)==null?void 0:o.weights)==null?void 0:a.filter(p=>ev.includes(p)))??["normal"],f=e.data??{};for(let p=0;p<h.length;p++){const g=h[p],v=new FontFace(u,`url(${ov(n)})`,{...f,weight:g});await v.load(),t.add(v),c.push(v)}return lt.has(`${u}-and-url`)?lt.get(`${u}-and-url`).entries.push({url:n,faces:c}):lt.set(`${u}-and-url`,{entries:[{url:n,faces:c}]}),c.length===1?c[0]:c}return ct("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(n){const e=Array.isArray(n)?n:[n],t=e[0].family,i=lt.get(`${t}-and-url`),o=i.entries.find(a=>a.faces.some(c=>e.indexOf(c)!==-1));o.faces=o.faces.filter(a=>e.indexOf(a)===-1),o.faces.length===0&&(i.entries=i.entries.filter(a=>a!==o)),e.forEach(a=>{rt.get().getFontFaceSet().delete(a)}),i.entries.length===0&&lt.remove(`${t}-and-url`)}};function Ch(n,e=1){var i;const t=(i=io.RETINA_PREFIX)==null?void 0:i.exec(n);return t?parseFloat(t[1]):e}function Ah(n,e,t){n.label=t,n._sourceOrigin=t;const i=new Ne({source:n,label:t}),o=()=>{delete e.promiseCache[t],lt.has(t)&&lt.remove(t)};return i.source.once("destroy",()=>{e.promiseCache[t]&&(ct("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),o())}),i.once("destroy",()=>{n.destroyed||(ct("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),o())}),i}const lv=".svg",cv="image/svg+xml",uv={extension:{type:be.LoadParser,priority:gi.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(n){return so(n,cv)||oo(n,lv)},async load(n,e,t){var i;return((i=e.data)==null?void 0:i.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?hv(n):dv(n,e,t,this.config.crossOrigin)},unload(n){n.destroy(!0)}};async function dv(n,e,t,i){var b,k,A;const o=await rt.get().fetch(n),a=rt.get().createImage();a.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await o.text())}`,a.crossOrigin=i,await a.decode();const c=((b=e.data)==null?void 0:b.width)??a.width,u=((k=e.data)==null?void 0:k.height)??a.height,h=((A=e.data)==null?void 0:A.resolution)||Ch(n),f=Math.ceil(c*h),p=Math.ceil(u*h),g=rt.get().createCanvas(f,p),v=g.getContext("2d");v.imageSmoothingEnabled=!0,v.imageSmoothingQuality="high",v.drawImage(a,0,0,c*h,u*h);const{parseAsGraphicsContext:x,...w}=e.data??{},S=new Ji({resource:g,alphaMode:"premultiply-alpha-on-upload",resolution:h,...w});return Ah(S,t,n)}async function hv(n){const t=await(await rt.get().fetch(n)).text(),i=new Fn;return i.svg(t),i}const fv=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let qs=null,oh=class{constructor(){qs||(qs=URL.createObjectURL(new Blob([fv],{type:"application/javascript"}))),this.worker=new Worker(qs)}};oh.revokeObjectURL=function(){qs&&(URL.revokeObjectURL(qs),qs=null)};const pv=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Ks=null;class Nm{constructor(){Ks||(Ks=URL.createObjectURL(new Blob([pv],{type:"application/javascript"}))),this.worker=new Worker(Ks)}}Nm.revokeObjectURL=function(){Ks&&(URL.revokeObjectURL(Ks),Ks=null)};let r0=0,jd;class mv{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:t}=new oh;t.addEventListener("message",i=>{t.terminate(),oh.revokeObjectURL(),e(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,t){var i;return this._run("loadImageBitmap",[e,(i=t==null?void 0:t.data)==null?void 0:i.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){jd===void 0&&(jd=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<jd&&(this._createdWorkers++,e=new Nm().worker,e.addEventListener("message",t=>{this._complete(t.data),this._returnWorker(t.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){this._resolveHash[e.uuid]&&(e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),delete this._resolveHash[e.uuid])}async _run(e,t){await this._initWorkers();const i=new Promise((o,a)=>{this._queue.push({id:e,arguments:t,resolve:o,reject:a})});return this._next(),i}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const t=this._queue.pop(),i=t.id;this._resolveHash[r0]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:r0++,id:i})}reset(){this._workerPool.forEach(e=>e.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:e})=>{e==null||e(new Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}}const i0=new mv,gv=[".jpeg",".jpg",".png",".webp",".avif"],yv=["image/jpeg","image/png","image/webp","image/avif"];async function xv(n,e){var o;const t=await rt.get().fetch(n);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${n}: ${t.status} ${t.statusText}`);const i=await t.blob();return((o=e==null?void 0:e.data)==null?void 0:o.alphaMode)==="premultiplied-alpha"?createImageBitmap(i,{premultiplyAlpha:"none"}):createImageBitmap(i)}const Wm={name:"loadTextures",id:"texture",extension:{type:be.LoadParser,priority:gi.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(n){return so(n,yv)||oo(n,gv)},async load(n,e,t){var a;let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await i0.isImageBitmapSupported()?i=await i0.loadImageBitmap(n,e):i=await xv(n,e):i=await new Promise((c,u)=>{i=rt.get().createImage(),i.crossOrigin=this.config.crossOrigin,i.src=n,i.complete?c(i):(i.onload=()=>{c(i)},i.onerror=u)});const o=new Ji({resource:i,alphaMode:"premultiply-alpha-on-upload",resolution:((a=e.data)==null?void 0:a.resolution)||Ch(n),...e.data});return Ah(o,t,n)},unload(n){n.destroy(!0)}},vv=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let Bd,Dd;function _v(n,e,t){t===void 0&&!e.startsWith("data:")?n.crossOrigin=bv(e):t!==!1&&(n.crossOrigin=typeof t=="string"?t:"anonymous")}function wv(n){return new Promise((e,t)=>{n.addEventListener("canplaythrough",i),n.addEventListener("error",o),n.load();function i(){a(),e()}function o(c){a(),t(c)}function a(){n.removeEventListener("canplaythrough",i),n.removeEventListener("error",o)}})}function bv(n,e=globalThis.location){if(n.startsWith("data:"))return"";e||(e=globalThis.location);const t=new URL(n,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}function Sv(){const n=[],e=[];for(const t of vv){const i=xa.MIME_TYPES[t.substring(1)]||`video/${t.substring(1)}`;Ic(i)&&(n.push(t),e.includes(i)||e.push(i))}return{validVideoExtensions:n,validVideoMime:e}}const kv={name:"loadVideo",id:"video",extension:{type:be.LoadParser,name:"loadVideo"},test(n){if(!Bd||!Dd){const{validVideoExtensions:i,validVideoMime:o}=Sv();Bd=i,Dd=o}const e=so(n,Dd),t=oo(n,Bd);return e||t},async load(n,e,t){var h,f;const i={...xa.defaultOptions,resolution:((h=e.data)==null?void 0:h.resolution)||Ch(n),alphaMode:((f=e.data)==null?void 0:f.alphaMode)||await V0(),...e.data},o=document.createElement("video"),a={preload:i.autoLoad!==!1?"auto":void 0,"webkit-playsinline":i.playsinline!==!1?"":void 0,playsinline:i.playsinline!==!1?"":void 0,muted:i.muted===!0?"":void 0,loop:i.loop===!0?"":void 0,autoplay:i.autoPlay!==!1?"":void 0};Object.keys(a).forEach(p=>{const g=a[p];g!==void 0&&o.setAttribute(p,g)}),i.muted===!0&&(o.muted=!0),_v(o,n,i.crossorigin);const c=document.createElement("source");let u;if(i.mime)u=i.mime;else if(n.startsWith("data:"))u=n.slice(5,n.indexOf(";"));else if(!n.startsWith("blob:")){const p=n.split("?")[0].slice(n.lastIndexOf(".")+1).toLowerCase();u=xa.MIME_TYPES[p]||`video/${p}`}return c.src=n,u&&(c.type=u),new Promise(p=>{const g=async()=>{const v=new xa({...i,resource:o});o.removeEventListener("canplay",g),e.data.preload&&await wv(o),p(Ah(v,t,n))};i.preload&&!i.autoPlay&&o.load(),o.addEventListener("canplay",g),o.appendChild(c)})},unload(n){n.destroy(!0)}},Hm={extension:{type:be.ResolveParser,name:"resolveTexture"},test:Wm.test,parse:n=>{var e;return{resolution:parseFloat(((e=io.RETINA_PREFIX.exec(n))==null?void 0:e[1])??"1"),format:n.split(".").pop(),src:n}}},Cv={extension:{type:be.ResolveParser,priority:-2,name:"resolveJson"},test:n=>io.RETINA_PREFIX.test(n)&&n.endsWith(".json"),parse:Hm.parse};class Av{constructor(){this._detections=[],this._initialized=!1,this.resolver=new io,this.loader=new Y9,this.cache=lt,this._backgroundLoader=new B9(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var a,c;if(this._initialized){ct("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let u=e.manifest;typeof u=="string"&&(u=await this.load(u)),this.resolver.addManifest(u)}const t=((a=e.texturePreference)==null?void 0:a.resolution)??1,i=typeof t=="number"?[t]:t,o=await this._detectFormats({preferredFormats:(c=e.texturePreference)==null?void 0:c.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:o,resolution:i}}),e.preferences&&this.setPreferences(e.preferences),e.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...e.loadOptions})}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();const i=Sc(e),o=Qn(e).map(u=>{if(typeof u!="string"){const h=this.resolver.getAlias(u);return h.some(f=>!this.resolver.hasKey(f))&&this.add(u),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(u)||this.add({alias:u,src:u}),u}),a=this.resolver.resolve(o),c=await this._mapLoadToResolve(a,t);return i?c[o[0]]:c}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let i=!1;typeof e=="string"&&(i=!0,e=[e]);const o=this.resolver.resolveBundle(e),a={},c=Object.keys(o);let u=0;const h=[],f=()=>{t==null||t(h.reduce((g,v)=>g+v,0)/u)},p=c.map((g,v)=>{const x=o[g],w=Object.values(x),b=[...new Set(w.flat())].reduce((k,A)=>k+(A.progressSize||1),0);return h.push(0),u+=b,this._mapLoadToResolve(x,k=>{h[v]=k*b,f()}).then(k=>{a[g]=k})});return await Promise.all(p),i?a[e[0]]:a}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return lt.get(e);const t={};for(let i=0;i<e.length;i++)t[i]=lt.get(e[i]);return t}async _mapLoadToResolve(e,t){const i=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const o=await this.loader.load(i,t);this._backgroundLoader.active=!0;const a={};return i.forEach(c=>{const u=o[c.src],h=[c.src];c.alias&&h.push(...c.alias),h.forEach(f=>{a[f]=u}),lt.set(h,u)}),a}async unload(e){this._initialized||await this.init();const t=Qn(e).map(o=>typeof o!="string"?o.src:o),i=this.resolver.resolve(t);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=Qn(e);const t=this.resolver.resolveBundle(e),i=Object.keys(t).map(o=>this._unloadFromResolved(t[o]));await Promise.all(i)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(i=>{lt.remove(i.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const i of e.detections)e.skipDetections||await i.test()?t=await i.add(t):e.skipDetections||(t=await i.remove(t));return t=t.filter((i,o)=>t.indexOf(i)===o),t}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(i=>i in e).forEach(i=>{t.config[i]=e[i]})})}}const Xs=new Av;Wt.handleByList(be.LoadParser,Xs.loader.parsers).handleByList(be.ResolveParser,Xs.resolver.parsers).handleByList(be.CacheParser,Xs.cache.parsers).handleByList(be.DetectionParser,Xs.detections);Wt.add(D9,N9,O9,V9,H9,U9,G9,K9,J9,av,uv,Wm,kv,j9,F9,Hm,Cv);const s0={loader:be.LoadParser,resolver:be.ResolveParser,cache:be.CacheParser,detection:be.DetectionParser};Wt.handle(be.Asset,n=>{const e=n.ref;Object.entries(s0).filter(([t])=>!!e[t]).forEach(([t,i])=>Wt.add(Object.assign(e[t],{extension:e[t].extension??i})))},n=>{const e=n.ref;Object.keys(s0).filter(t=>!!e[t]).forEach(t=>Wt.remove(e[t]))});class mi extends mh{constructor(e){e instanceof Fn&&(e={context:e});const{context:t,roundPixels:i,...o}=e||{};super({label:"Graphics",...o}),this.renderPipeId="graphics",t?this._context=t:this._context=this._ownedContext=new Fn,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=i??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(e){return this._context.containsPoint(e)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||(e==null?void 0:e.context)===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,t){return this.context[e](...t),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new mi(this._context.clone()):(this._ownedContext=null,new mi(this._context))}lineStyle(e,t,i){Fe(Je,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const o={};return e&&(o.width=e),t&&(o.color=t),i&&(o.alpha=i),this.context.strokeStyle=o,this}beginFill(e,t){Fe(Je,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const i={};return e!==void 0&&(i.color=e),t!==void 0&&(i.alpha=t),this.context.fillStyle=i,this}endFill(){Fe(Je,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==Fn.defaultStrokeStyle.width||e.color!==Fn.defaultStrokeStyle.color||e.alpha!==Fn.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return Fe(Je,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return Fe(Je,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return Fe(Je,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return Fe(Je,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return Fe(Je,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return Fe(Je,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}class Tv extends mh{constructor(e,t){const{text:i,resolution:o,style:a,anchor:c,width:u,height:h,roundPixels:f,...p}=e;super({...p}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=t,this.text=i??"",this.style=a,this.resolution=o??null,this.allowChildren=!1,this._anchor=new Nt({_onUpdate:()=>{this.onViewUpdate()}}),c&&(this.anchor=c),this.roundPixels=f??!1,u!==void 0&&(this.width=u),h!==void 0&&(this.height=h)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){var t;e||(e={}),(t=this._style)==null||t.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this.bounds.width),t!==void 0&&this._setHeight(t,this.bounds.height)}containsPoint(e){const t=this.bounds.width,i=this.bounds.height,o=-t*this.anchor.x;let a=0;return e.x>=o&&e.x<=o+t&&(a=-i*this.anchor.y,e.y>=a&&e.y<=a+i)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e!=null&&e.style)&&this._style.destroy(e),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}}function Mv(n,e){let t=n[0]??{};return(typeof t=="string"||n[1])&&(Fe(Je,`use new ${e}({ text: "hi!", style }) instead`),t={text:t,style:n[1]}),t}let Yi=null,Fr=null;function Pv(n,e){Yi||(Yi=rt.get().createCanvas(256,128),Fr=Yi.getContext("2d",{willReadFrequently:!0}),Fr.globalCompositeOperation="copy",Fr.globalAlpha=1),(Yi.width<n||Yi.height<e)&&(Yi.width=Js(n),Yi.height=Js(e))}function o0(n,e,t){for(let i=0,o=4*t*e;i<e;++i,o+=4)if(n[o+3]!==0)return!1;return!0}function a0(n,e,t,i,o){const a=4*e;for(let c=i,u=i*a+4*t;c<=o;++c,u+=a)if(n[u+3]!==0)return!1;return!0}function Ev(...n){let e=n[0];e.canvas||(e={canvas:n[0],resolution:n[1]});const{canvas:t}=e,i=Math.min(e.resolution??1,1),o=e.width??t.width,a=e.height??t.height;let c=e.output;if(Pv(o,a),!Fr)throw new TypeError("Failed to get canvas 2D context");Fr.drawImage(t,0,0,o,a,0,0,o*i,a*i);const h=Fr.getImageData(0,0,o,a).data;let f=0,p=0,g=o-1,v=a-1;for(;p<a&&o0(h,o,p);)++p;if(p===a)return ft.EMPTY;for(;o0(h,o,v);)--v;for(;a0(h,o,f,p,v);)++f;for(;a0(h,o,g,p,v);)--g;return++g,++v,Fr.globalCompositeOperation="source-over",Fr.strokeRect(f,p,g-f,v-p),Fr.globalCompositeOperation="copy",c??(c=new ft),c.set(f/i,p/i,(g-f)/i,(v-p)/i),c}const l0=new ft;class Rv{getCanvasAndContext(e){const{text:t,style:i,resolution:o=1}=e,a=i._getFinalPadding(),c=vr.measureText(t||" ",i),u=Math.ceil(Math.ceil(Math.max(1,c.width)+a*2)*o),h=Math.ceil(Math.ceil(Math.max(1,c.height)+a*2)*o),f=$a.getOptimalCanvasAndContext(u,h);this._renderTextToCanvas(t,i,a,o,f);const p=i.trim?Ev({canvas:f.canvas,width:u,height:h,resolution:1,output:l0}):l0.set(0,0,u,h);return{canvasAndContext:f,frame:p}}returnCanvasAndContext(e){$a.returnCanvasAndContext(e)}_renderTextToCanvas(e,t,i,o,a){var M,E,B,F;const{canvas:c,context:u}=a,h=kc(t),f=vr.measureText(e||" ",t),p=f.lines,g=f.lineHeight,v=f.lineWidths,x=f.maxLineWidth,w=f.fontProperties,S=c.height;if(u.resetTransform(),u.scale(o,o),u.textBaseline=t.textBaseline,(M=t._stroke)!=null&&M.width){const I=t._stroke;u.lineWidth=I.width,u.miterLimit=I.miterLimit,u.lineJoin=I.join,u.lineCap=I.cap}u.font=h;let b,k;const A=t.dropShadow?2:1;for(let I=0;I<A;++I){const N=t.dropShadow&&I===0,U=N?Math.ceil(Math.max(1,S)+i*2):0,q=U*o;if(N){u.fillStyle="black",u.strokeStyle="black";const Z=t.dropShadow,Q=Z.color,ae=Z.alpha;u.shadowColor=At.shared.setValue(Q).setAlpha(ae).toRgbaString();const G=Z.blur*o,V=Z.distance*o;u.shadowBlur=G,u.shadowOffsetX=Math.cos(Z.angle)*V,u.shadowOffsetY=Math.sin(Z.angle)*V+q}else{if(u.fillStyle=t._fill?Tc(t._fill,u,f,i*2):null,(E=t._stroke)!=null&&E.width){const Z=t._stroke.width*.5+i*2;u.strokeStyle=Tc(t._stroke,u,f,Z)}u.shadowColor="black"}let H=(g-w.fontSize)/2;g-w.fontSize<0&&(H=0);const se=((B=t._stroke)==null?void 0:B.width)??0;for(let Z=0;Z<p.length;Z++)b=se/2,k=se/2+Z*g+w.ascent+H,t.align==="right"?b+=x-v[Z]:t.align==="center"&&(b+=(x-v[Z])/2),(F=t._stroke)!=null&&F.width&&this._drawLetterSpacing(p[Z],t,a,b+i,k+i-U,!0),t._fill!==void 0&&this._drawLetterSpacing(p[Z],t,a,b+i,k+i-U)}}_drawLetterSpacing(e,t,i,o,a,c=!1){const{context:u}=i,h=t.letterSpacing;let f=!1;if(vr.experimentalLetterSpacingSupported&&(vr.experimentalLetterSpacing?(u.letterSpacing=`${h}px`,u.textLetterSpacing=`${h}px`,f=!0):(u.letterSpacing="0px",u.textLetterSpacing="0px")),h===0||f){c?u.strokeText(e,o,a):u.fillText(e,o,a);return}let p=o;const g=vr.graphemeSegmenter(e);let v=u.measureText(e).width,x=0;for(let w=0;w<g.length;++w){const S=g[w];c?u.strokeText(S,p,a):u.fillText(S,p,a);let b="";for(let k=w+1;k<g.length;++k)b+=g[k];x=u.measureText(b).width,p+=v-x+h,v=x}}}const c0=new Rv;class Iv extends Tv{constructor(...e){const t=Mv(e,"Text");super(t,Ia),this.renderPipeId="text",t.textureStyle&&(this.textureStyle=t.textureStyle instanceof eo?t.textureStyle:new eo(t.textureStyle))}updateBounds(){const e=this._bounds,t=this._anchor;let i=0,o=0;if(this._style.trim){const{frame:a,canvasAndContext:c}=c0.getCanvasAndContext({text:this.text,style:this._style,resolution:1});c0.returnCanvasAndContext(c),i=a.width,o=a.height}else{const a=vr.measureText(this._text,this._style);i=a.width,o=a.height}e.minX=-t._x*i,e.maxX=e.minX+i,e.minY=-t._y*o,e.maxY=e.minY+o}}Wt.add(B5,D5);const $v=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   width="174.61385mm"
   height="234.6797mm"
   viewBox="0 0 174.61385 234.6797"
   version="1.1"
   id="svg1"
   inkscape:version="1.4.2 (f4327f4, 2025-05-13)"
   sodipodi:docname="gentil.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1"
     pagecolor="#191919"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#bd2727ff"
     inkscape:document-units="mm"
     inkscape:zoom="0.72604517"
     inkscape:cx="331.24661"
     inkscape:cy="485.50698"
     inkscape:window-width="1920"
     inkscape:window-height="1017"
     inkscape:window-x="1912"
     inkscape:window-y="-8"
     inkscape:window-maximized="1"
     inkscape:current-layer="layer1"
     showgrid="true">
    <inkscape:grid
       id="grid1"
       units="mm"
       originx="-17.307133"
       originy="-20.032634"
       spacingx="0.99999998"
       spacingy="1"
       empcolor="#0099e5"
       empopacity="0.30196078"
       color="#0099e5"
       opacity="0.14901961"
       empspacing="5"
       enabled="true"
       visible="true" />
  </sodipodi:namedview>
  <defs
     id="defs1" />
  <g
     inkscape:label="Calque 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-17.307132,-20.032634)">
    <path
       d="m 69.048457,20.142976 c -0.141111,0.105834 -1.234722,0.282223 -2.434166,0.352778 -2.504723,0.176389 -3.633611,0.740834 -4.445,2.293056 -0.352778,0.599722 -0.9525,1.622778 -1.411111,2.328333 -0.881945,1.340556 -2.046111,4.233334 -2.328334,5.891389 -0.105833,0.564445 -0.599722,2.2225 -1.093611,3.633611 -0.458611,1.446389 -1.093611,4.021667 -1.375833,5.785556 -0.282222,1.763888 -0.740833,3.421944 -1.023056,3.774721 -0.282222,0.3175 -0.599722,0.811389 -0.740833,1.093611 -0.141111,0.282223 0.07056,0.141112 0.458611,-0.352777 0.846667,-1.023056 0.9525,-0.740834 0.211667,0.670277 -0.282222,0.564445 -0.423333,1.093612 -0.282222,1.199445 0.105833,0.105833 -0.176389,0.811389 -0.635,1.516944 -0.740834,1.234722 -0.811389,1.27 -1.128889,0.564445 -0.176389,-0.388056 -0.881945,-0.987778 -1.516945,-1.305278 -1.093611,-0.529167 -1.305277,-0.529167 -2.434166,0.03528 -1.940278,0.917222 -4.233333,3.139722 -5.115278,4.974167 -0.670278,1.411111 -1.27,1.975555 -3.598333,3.457222 -3.033889,1.905 -5.750277,4.797777 -7.161388,7.584722 -0.458612,0.917222 -1.305278,2.116666 -1.869723,2.681111 -1.305277,1.340555 -3.139722,6.0325 -2.575277,6.596944 0.246944,0.246945 1.411111,0.423334 2.892777,0.388056 l 2.434167,-0.03528 -0.176389,1.093611 c -0.105833,0.599722 -0.352778,2.187222 -0.564444,3.563056 -0.176389,1.340555 -0.599723,2.751666 -0.917223,3.069166 -0.423333,0.458611 -0.493888,1.023056 -0.3175,2.257778 0.211667,1.763889 0.705556,2.610555 1.481667,2.610555 0.352778,0 0.423333,0.3175 0.246945,1.093611 -0.105834,0.635 -0.03528,1.199445 0.176388,1.340556 0.246945,0.141111 0.282223,0.987778 0.07056,2.681111 -0.176388,1.375833 -0.211666,2.822222 -0.105833,3.280833 0.246945,1.093611 -0.529167,3.774722 -1.340555,4.515556 -0.388056,0.3175 -0.670278,0.846666 -0.670278,1.199444 0,0.317504 -0.493889,0.740834 -1.234722,1.023054 -1.693334,0.59972 -2.081389,1.44639 -1.799167,4.1275 0.352778,3.35139 -0.282222,6.70278 -1.446389,7.69056 -1.128889,0.98778 -1.234722,2.61055 -0.282222,4.40972 0.3175,0.635 0.635,1.79917 0.705555,2.61056 0.529167,5.53861 0.529167,5.82083 -0.03528,6.0325 -0.3175,0.10583 -0.599722,0.21166 -0.670277,0.21166 -0.03528,0 -0.176389,-0.635 -0.3175,-1.44639 -0.176388,-1.02305 -0.423333,-1.51694 -0.917222,-1.62277 -0.529166,-0.14112 -0.705555,-0.49389 -0.705555,-1.30528 -0.03528,-2.11667 -2.575278,-6.17361 -3.633611,-5.75028 -1.023056,0.38806 -1.093611,2.54 -0.246945,4.86833 0.705556,1.79917 0.740834,2.2225 0.352778,2.96334 -0.246944,0.49389 -0.352778,1.30527 -0.246944,1.905 0.141111,0.70555 0,1.5875 -0.458612,2.57527 -0.388055,0.84667 -0.705555,2.2225 -0.705555,3.06917 0,1.51694 0,1.51694 -0.776111,0.9525 -2.081389,-1.44639 -2.187222,-1.44639 -1.940278,-0.0706 0.105833,0.70556 0.529167,1.72862 0.881945,2.25778 0.846666,1.16417 3.563055,7.51417 4.656666,10.83028 1.305278,3.98639 3.386667,7.83167 5.432778,9.91305 2.786944,2.89278 3.986389,2.46945 5.185833,-1.86972 1.058333,-3.81 0.917222,-5.57389 -0.635,-7.83166 -0.705556,-1.02306 -1.340556,-1.76389 -1.375833,-1.5875 -0.03528,0.17639 -0.176389,0.74083 -0.282223,1.27 -0.3175,1.37583 -0.670277,1.23472 -1.340555,-0.56445 l -0.564444,-1.55222 2.151944,0.17639 c 1.199444,0.0705 3.175,0.28222 4.374444,0.49389 2.434166,0.35278 3.739444,0.0705 4.303889,-1.05834 0.599722,-1.05833 0.458611,-2.08138 -0.3175,-2.8575 -0.881945,-0.88194 -1.305278,-1.94027 -2.010834,-4.7625 -0.246944,-1.16416 -0.846666,-2.75167 -1.305277,-3.52778 -0.705556,-1.16416 -0.811389,-1.69333 -0.564445,-2.99861 0.141111,-0.88194 0.529167,-2.15194 0.881945,-2.82222 1.164166,-2.18722 1.234722,-2.43417 1.234722,-3.52778 0,-1.23472 1.093611,-3.56305 2.116666,-4.58611 0.388056,-0.38805 0.705556,-0.98778 0.705556,-1.34055 0,-0.35278 0.246944,-0.9525 0.529167,-1.37584 0.3175,-0.45861 0.529166,-1.37583 0.458611,-2.11666 -0.03528,-0.74084 0.282222,-2.99862 0.705555,-5.04473 0.423334,-2.04611 0.9525,-4.58611 1.128889,-5.67972 0.246945,-1.19944 0.987778,-2.99861 1.905,-4.550832 0.846667,-1.375834 1.834444,-3.386667 2.187222,-4.445 0.352778,-1.058333 0.776111,-1.905 0.917222,-1.905 0.141112,0 0.529167,0.529167 0.846667,1.128889 0.3175,0.635 1.411111,2.434166 2.363611,3.951111 1.340556,2.046111 1.869722,3.280833 2.046111,4.691942 0.141111,1.05834 0.564445,2.32834 0.917222,2.82222 2.293056,3.24556 2.328334,4.37445 0.352778,7.09084 -0.670278,0.91722 -1.905,2.92805 -2.716389,4.445 -1.552222,2.96333 -1.552222,3.10444 -1.058333,9.03111 0.03528,0.28222 -0.105833,2.64583 -0.3175,5.22111 -0.352778,4.23334 -0.529167,4.97417 -1.658055,7.40834 -1.869723,3.95111 -1.940278,4.19805 -2.293056,7.65527 -0.211667,2.08139 -0.211667,4.09223 0.03528,5.89139 0.352778,2.61056 0.3175,2.92806 -0.917222,7.69056 -1.481667,5.57389 -1.516945,5.32694 1.199444,6.0325 0.881944,0.24694 1.658056,0.70555 1.905,1.12889 0.9525,1.79916 -0.599722,8.5725 -3.457222,14.99305 -1.058334,2.43417 -4.621389,7.16139 -5.185833,6.94972 -0.564445,-0.21166 -1.023056,0.14112 -1.693334,1.37584 -0.529166,0.9525 -1.058333,1.23472 -2.328333,1.34055 -0.246944,0.0353 -0.458611,0.21167 -0.458611,0.38806 0,0.17639 -0.3175,0.74083 -0.670278,1.27 -0.634999,0.88194 -0.634999,1.05833 -0.211666,1.905 0.458611,0.88194 0.352777,1.19944 -1.305278,4.72722 l -1.799166,3.81 -0.07055,5.46806 c -0.07056,7.76111 -0.458612,12.94694 -1.305278,17.85055 l -0.740834,4.30389 -1.552222,0.77611 c -0.846666,0.42333 -1.481666,0.84667 -1.375833,0.9525 0.07056,0.10583 -0.07056,0.81139 -0.352778,1.62278 -0.458611,1.30528 -0.458611,1.51694 0,1.86972 1.093611,0.77611 1.27,2.15195 0.917222,6.42056 -0.211666,2.25777 -0.493888,4.97416 -0.635,5.96194 -0.176388,1.02306 -0.211666,2.01083 -0.105833,2.15195 0.493889,0.74083 9.524999,4.7625 11.429999,5.07999 2.645833,0.45862 9.489722,-0.21166 11.006666,-1.09361 0.917222,-0.49388 1.058334,-0.84666 1.164167,-2.25777 0.07055,-1.19945 -0.105833,-2.01084 -0.599722,-2.82223 -0.776111,-1.27 -6.632222,-7.05555 -8.466667,-8.32555 -1.09361,-0.77611 -1.164165,-0.9525 -0.9525,-2.29306 0.141111,-0.81139 0.529167,-1.69333 0.9525,-1.97555 0.493889,-0.42334 0.776111,-1.19945 1.023056,-2.99861 0.388055,-3.21028 4.7625,-14.78139 8.290277,-21.94278 1.481667,-2.92806 2.822223,-6.17361 2.998611,-7.19667 0.635001,-3.38666 3.598334,-7.3025 6.138334,-8.07861 0.811388,-0.28222 1.552222,-0.81139 1.905,-1.41111 0.493888,-0.88194 0.740833,-0.98778 2.187222,-0.91722 2.081389,0.10583 3.139722,0.70555 6.35,3.56305 1.446388,1.30528 3.069166,2.43417 3.598333,2.54 0.529167,0.10584 1.199444,0.56445 1.516944,1.02306 0.846667,1.30528 3.245556,8.29028 3.527778,10.23055 0.282222,2.04612 1.516944,6.52639 1.940278,6.985 0.141111,0.14112 0.141111,0.74084 0,1.27 -0.176389,0.56445 -0.211667,1.09362 -0.105834,1.19945 0.105834,0.10583 0.03528,0.38805 -0.141111,0.635 -0.529166,0.635 -0.881944,2.99861 -0.529166,3.24555 0.176388,0.10584 0.246944,0.9525 0.176388,1.86973 -0.246944,2.50472 0.493889,7.86694 1.164167,8.60777 0.811389,0.91723 3.280833,1.16417 6.244177,0.67028 4.833056,-0.81139 6.596945,-0.81139 10.583333,-0.0353 2.610561,0.49389 5.185841,0.74084 8.219731,0.74084 3.98639,0 4.445,-0.0706 5.11528,-0.74084 0.56444,-0.56444 0.70555,-0.98777 0.52916,-1.83444 -0.10583,-0.56444 -0.38805,-1.23472 -0.56444,-1.48167 -0.17639,-0.24694 -2.04611,-0.88194 -4.1275,-1.41111 -2.11667,-0.52916 -4.02167,-1.16416 -4.30389,-1.37583 -0.52917,-0.42333 -2.50472,-1.48167 -4.974173,-2.71639 -3.421944,-1.65806 -5.679722,-4.19806 -4.974167,-5.53861 0.246945,-0.42333 0.105834,-1.27 -0.388055,-2.71639 -0.635,-1.905 -0.705556,-2.61056 -0.493889,-7.05556 0.141111,-2.71638 0.3175,-5.43277 0.423333,-5.99722 0.105834,-0.59972 0.3175,-3.38666 0.423334,-6.24416 0.141111,-3.13973 0.423333,-5.36223 0.635,-5.60917 0.599722,-0.56444 1.516944,-0.17639 3.280833,1.44639 1.552222,1.41111 2.504722,1.62278 2.504722,0.52917 0,-0.77612 -1.234722,-3.10445 -1.940278,-3.70417 -1.023055,-0.84667 -1.234722,-1.5875 -0.846666,-2.99861 0.211666,-0.74084 0.599722,-1.5875 0.881944,-1.83445 0.282222,-0.28222 0.493889,-0.81139 0.493889,-1.19944 0,-1.48167 3.139733,-0.59972 8.255003,2.39889 0.84667,0.49389 2.89278,0.59972 3.175,0.17639 0.10584,-0.17639 -1.05833,-1.37584 -2.54,-2.68111 -2.54,-2.29306 -6.84389,-4.79778 -8.255003,-4.79778 -0.3175,0 -0.705556,-0.17639 -0.811389,-0.35278 -0.105834,-0.21167 -0.670278,-0.35278 -1.234723,-0.35278 -0.811389,0 -1.058333,-0.21166 -1.375833,-1.12889 -0.317499,-0.84666 -0.493889,-1.02305 -0.811389,-0.70555 -1.128889,1.12889 -1.199445,0.0353 -0.352778,-4.62139 0.352778,-1.86972 1.128889,-3.06917 1.128889,-1.69333 0,1.5875 0.635,0.35277 0.776111,-1.55223 0.105833,-1.30527 0.423333,-2.29305 0.917222,-2.92805 2.751673,-3.42195 3.245563,-4.72722 3.245563,-8.71361 0,-1.72861 0.17639,-3.03389 0.42333,-3.28084 0.45861,-0.45861 0.49389,-3.56305 0.10584,-10.58333 -0.24695,-4.1275 -0.21167,-4.65667 0.3175,-4.65667 0.59972,0 0.77611,0.56445 1.05833,3.42195 0.24694,2.46944 1.16417,4.1275 3.66889,6.56167 2.18722,2.18722 3.03389,2.2225 1.94028,0.14111 -0.35278,-0.635 -1.02306,-1.905 -1.48167,-2.78695 -0.77611,-1.48166 -0.81139,-1.69333 -0.35278,-2.71639 0.3175,-0.67027 0.74083,-1.09361 1.16417,-1.09361 0.38805,0 1.19944,-0.17639 1.79916,-0.38805 2.01084,-0.74084 10.05417,1.65805 13.22917,3.91583 0.91722,0.635 1.23472,0.70556 2.36361,0.38806 0.74083,-0.21167 1.83444,-0.38806 2.46944,-0.38806 1.5875,0 4.97417,1.12889 6.70278,2.2225 1.34055,0.84667 1.94028,0.98778 5.29167,1.09361 5.78555,0.24695 15.98083,2.25778 19.685,3.91583 0.98777,0.42334 2.8575,0.88195 4.19805,0.98778 1.34056,0.14111 3.10444,0.56445 3.95111,0.9525 1.09361,0.56445 3.73945,1.02306 9.91306,1.76389 9.17222,1.16417 14.9225,1.62278 14.9225,1.30528 0,-0.49389 -3.66889,-2.01084 -10.58334,-4.445 -3.98639,-1.41111 -8.07861,-2.8575 -9.10166,-3.21028 -1.05834,-0.38805 -2.68111,-0.70555 -3.66889,-0.70555 -0.98778,0 -2.68111,-0.35278 -3.91584,-0.84667 -1.23472,-0.45861 -3.35138,-0.91722 -4.83305,-1.05833 -4.55083,-0.35278 -16.05139,-3.59834 -19.93194,-5.60917 -1.12889,-0.59972 -2.08139,-0.74083 -4.93889,-0.77611 -3.73945,0 -6.10306,-0.74084 -7.83167,-2.36361 -0.70556,-0.635 -1.16417,-0.70556 -4.445,-0.67028 -4.65666,0.10583 -11.21833,-1.27 -12.24138,-2.50472 -1.44639,-1.72861 -0.38806,-3.31611 3.31611,-5.00945 1.76389,-0.81139 2.96333,-1.79917 2.61055,-2.18722 -0.10583,-0.0706 -1.55222,0.17639 -3.24555,0.59972 -3.4925,0.88194 -6.49111,2.54 -8.21972,4.51556 -1.37584,1.65805 -2.32834,1.97555 -3.13973,1.05833 -0.49389,-0.56444 -0.52916,-0.84667 -0.21166,-1.5875 0.84666,-1.76389 0.21166,-6.6675 -1.12889,-8.78417 -0.705564,-1.12889 -1.340564,-6.87917 -1.09362,-9.63083 0.246945,-2.2225 0.176389,-2.54 -0.493888,-3.21028 -0.670278,-0.67028 -0.740834,-1.16417 -0.776112,-4.30389 0,-2.46944 -0.246944,-4.23333 -0.705555,-5.67972 C 96.988477,101.5993 96.600422,99.835411 96.45931,98.812356 96.318199,97.7893 95.965422,96.484022 95.683199,95.919578 95.400977,95.319856 94.836533,93.450133 94.483755,91.7568 c -0.599722,-3.033889 -0.599722,-3.139722 0.03528,-3.704166 0.811389,-0.740834 1.622778,-3.316111 1.340555,-4.339167 -0.105833,-0.423333 0.03528,-1.869722 0.282223,-3.210278 0.282222,-1.340555 0.529166,-3.245555 0.529166,-4.233333 0,-1.763889 0,-1.799167 0.705556,-1.164167 0.599722,0.529167 0.811389,0.564445 1.763889,0.176389 1.763896,-0.740833 2.116676,-1.516944 1.587506,-3.4925 -0.49389,-1.905 -1.05834,-3.069166 -1.69334,-3.457222 -1.093611,-0.705555 -1.305278,-2.116666 -0.776111,-4.974166 0.917222,-4.7625 0.599722,-8.149167 -0.846667,-8.748889 -0.3175,-0.105833 -1.904999,-0.3175 -3.563055,-0.458611 l -2.963333,-0.211667 -0.105834,-3.175 c -0.141123,-3.845214 -0.4939,-5.150492 -1.834456,-7.302436 -1.375833,-2.151944 -2.575288,-2.928055 -4.480288,-2.822222 l -1.552222,0.07056 0.07055,-1.340555 c 0.07056,-1.975556 -0.246939,-3.598334 -1.305273,-6.173612 -0.493889,-1.27 -0.987777,-2.610555 -1.058333,-2.963333 -0.282222,-1.375833 -1.058333,-3.175 -1.834444,-4.233333 -0.458611,-0.599722 -0.811389,-1.27 -0.811389,-1.446389 0,-0.388056 -3.139722,-3.351389 -4.092222,-3.845278 -0.811389,-0.458611 -4.550834,-0.881945 -4.833056,-0.564445 z m 26.35251,79.798332 c -0.282222,0.317502 -0.776111,-0.423333 -0.599722,-0.917222 0.211667,-0.529166 0.246944,-0.493889 0.458611,0.105834 0.141111,0.352777 0.211667,0.740833 0.141111,0.811388 z m -20.249454,68.615272 1.5875,0.74084 0.599722,2.99861 c 1.375833,6.73805 1.164166,11.04194 -0.635,12.73528 -0.458611,0.42333 -0.846667,1.02305 -0.846667,1.30527 0,0.28223 -0.3175,0.91723 -0.705555,1.48167 -0.811389,1.16417 -1.023056,4.02167 -0.388056,5.57389 0.246945,0.56444 0.388056,1.79917 0.3175,2.75167 l -0.105833,1.72861 -2.116667,-3.13972 c -1.834444,-2.75167 -5.609166,-6.56167 -6.491111,-6.56167 -0.141111,0 -0.458611,-0.38806 -0.670278,-0.88195 -0.246944,-0.49388 -0.811388,-1.05833 -1.305277,-1.23472 -0.493889,-0.17639 -0.917223,-0.56444 -0.917223,-0.88194 -0.211666,-2.64584 -0.176388,-2.82222 1.128889,-4.23334 2.116667,-2.29305 7.373056,-11.71222 7.373056,-13.22916 0,-0.45861 0.881944,-0.24695 3.175,0.84666 z"
       id="path3"
       style="fill:currentColor;fill-opacity:1;stroke:none;stroke-width:0.0352778" />
  </g>
</svg>
`,Lv=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>\r
<svg\r
   width="2342"\r
   height="3750"\r
   viewBox="0 0 2342 3750"\r
   version="1.1"\r
   id="svg1"\r
   sodipodi:docname="mechant.svg"\r
   inkscape:version="1.4.2 (f4327f4, 2025-05-13)"\r
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\r
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\r
   xmlns="http://www.w3.org/2000/svg"\r
   xmlns:svg="http://www.w3.org/2000/svg">\r
  <defs\r
     id="defs1" />\r
  <sodipodi:namedview\r
     id="namedview1"\r
     pagecolor="#ffffff"\r
     bordercolor="#000000"\r
     borderopacity="0.25"\r
     inkscape:showpageshadow="2"\r
     inkscape:pageopacity="0.0"\r
     inkscape:pagecheckerboard="0"\r
     inkscape:deskcolor="#d1d1d1"\r
     inkscape:zoom="0.21733333"\r
     inkscape:cx="1171.0123"\r
     inkscape:cy="1875"\r
     inkscape:window-width="1920"\r
     inkscape:window-height="1017"\r
     inkscape:window-x="-"\r
     inkscape:window-y="-8"\r
     inkscape:window-maximized="1"\r
     inkscape:current-layer="svg1" />\r
  <path\r
     fill-rule="nonzero"\r
     fill="#000000"\r
     fill-opacity="1"\r
     d="m 1179.4102,3716.9922 c -17.3907,-74.8555 -35.9414,-120.9844 -69.0313,-171.7774 -30.6094,-46.9726 -82.0898,-92.3789 -115.62499,-102 -9.15235,-2.625 -10.1875,-2.039 -14.46875,8.211 -2.53907,6.0703 -9.29688,27.6328 -15.01954,47.9101 -11.40625,40.4102 -25.3125,77.6563 -29,77.6563 -1.29296,0 -4.19531,-12.1133 -6.44921,-26.918 -6.85938,-45.0625 -25.47266,-111.832 -39.1875,-140.5703 -15.55469,-32.5898 -37.56641,-58.125 -60.26954,-69.918 -13.26171,-6.8906 -21.32421,-8.6875 -39.5039,-8.7929 -26.72266,-0.1563 -41.25781,5.8086 -60.45703,24.8164 -14.30469,14.164 -16.1836,14.9531 -16.28516,6.8594 -0.14062,-11.0079 -12.54687,-33.0313 -25.9375,-46.0235 -52.17578,-50.6328 -129.63672,-52.4961 -178.97266,-4.3008 -10.42578,10.1836 -21.48828,22.1836 -24.58203,26.6719 -5.5625,8.0625 -5.60937,7.9258 -4.17187,-11.4219 0.92187,-12.4336 11.65625,-51.1172 29.42578,-106.0351 62.49609,-193.1406 112.14844,-389.7969 155.69141,-616.6485 18.38671,-95.7812 35.44921,-222.3007 35.53125,-263.4609 l 0.0391,-17.1289 h -13.9961 c -32.30859,0 -86.14843,-21.6016 -135.19531,-54.2305 C 451.2891,2202.9102 384.21879,2073.8789 376.1602,1931.6914 l -2.07813,-36.6133 -92.28125,-185.9687 C 231.04687,1606.8203 167.20703,1474.6797 139.93359,1415.4609 76.816406,1278.4102 44.253906,1214.0586 17.546875,1173.6094 1.621094,1149.4805 -2.457031,1141.1289 1.300781,1140.3281 c 9.125,-1.9375 67.613281,12.9532 128.253909,32.6524 63.97656,20.789 114.91015,41.039 149.80859,59.5781 11.91406,6.3203 22.19141,10.9727 22.83203,10.332 0.64453,-0.6406 -6.85156,-34.75 -16.65625,-75.8008 -39.96484,-167.3398 -42.8164,-188.92964 -42.79297,-324.23043 0.0117,-82.66015 1.15625,-109.98046 5.83985,-139.60937 5.70703,-36.10156 23.48047,-112.28125 28.19531,-120.85156 2.13672,-3.87891 46.05469,69.26172 73.13281,121.80078 4.625,8.97265 11.3086,19.98047 14.85938,24.46094 l 6.44922,8.14843 7.98046,-17.9375 C 383.59375,709.01172 394.86328,683.32031 404.25,661.78125 442.76172,573.42969 496.08984,474 550.375,389.35156 c 9.78125,-15.26172 42.82031,-62.97265 73.42187,-106.04297 92.47657,-130.14843 130.32813,-180.25 132.13282,-174.89843 0.52734,1.57031 -3.46485,20.37109 -8.8711,41.78906 C 721.60937,251 718.21094,332 737.92187,367.83984 c 6.26954,11.39844 9.09766,13.5 19.33985,14.35157 15.53515,1.29687 20.58203,-1.5 82.62109,-45.72266 88.19531,-62.85938 122.33594,-82.6875 262.98829,-152.70703 50.1602,-24.97266 103.6289,-53.5 118.8008,-63.40234 40.8789,-26.64063 78.0976,-63.898442 97.6562,-97.757818 18.8321,-32.570312 19.3516,-32.203124 22.7032,16.007813 4.6406,66.839845 14.1093,105.718745 36.3984,149.460935 39.6289,77.75781 131.8516,149.3711 209.5,162.69141 26.8906,4.60937 41.2109,1.53906 61.5508,-13.20313 14.6797,-10.6289 35.6992,-47.6875 45.5781,-80.34765 10.5898,-35.05078 6.3516,-154.75 -7.5391,-212.890628 -0.9687,-4.039062 -0.3476,-7.339843 1.3711,-7.339843 5.0391,0 37.711,72.480471 57.3477,127.238281 9.9805,27.82031 29.4219,85.8125 43.2031,128.88281 29.3477,91.63672 46.9688,137.10938 72.8789,188.08985 19.2891,37.9375 83.0508,148.6289 89,154.48828 2.2188,2.1914 5.0313,0.57031 8.5195,-4.89844 19.4883,-30.47266 67.8711,-61.78125 106.2383,-68.76172 30.1407,-5.46875 31.6211,-2.66016 10.6211,20.03125 -22.9492,24.77734 -41.9375,63.57813 -49.4179,100.9375 -6.1602,30.76172 -5.543,104.87109 1.8984,228.39063 6.1016,101.17189 1.6406,283.24219 -8.4883,346.44139 l -1.9297,12.0078 35.5469,-20.2773 c 63.1797,-36.0625 178.2109,-81.5899 255.332,-101.082 17.0508,-4.3086 31.5782,-7.3204 32.3008,-6.6875 0.7188,0.6289 -6.7226,11.8085 -16.5312,24.8476 -42.1719,56.0508 -67.0704,92.3399 -95.8086,139.6328 -20.2422,33.3086 -84.3907,159.8594 -122.0118,240.6875 -34.7109,74.5703 -100.9687,208.5625 -127.4492,257.7422 l -23.3711,43.3789 8.5899,35.9297 c 16.332,68.2813 18.1992,120.6406 6.5,181.9883 -25.9492,136.0625 -111.0977,238.8125 -220.3477,265.8828 -25.1523,6.2305 -61.0625,6.8594 -84.3633,1.4805 -9.0976,-2.1016 -17.3789,-2.9805 -18.3984,-1.961 -4.8398,4.8282 8.7109,166.6875 23.0195,275.0703 17.5508,132.9375 27.0586,180.9141 70.461,355.5157 28.9687,116.5781 29.8789,119.8476 68.6992,247.1328 18.5117,60.7148 32.0703,110.7187 31.4101,115.8242 l -1.1796,8.9883 -4.2696,-8.5586 c -7.6523,-15.3281 -27.9804,-24.0664 -55.9804,-24.0664 -21.9102,0 -27.3789,1.3554 -49.5,12.2851 -29.7813,14.7227 -53.0586,38.4688 -58.8204,60.0157 -2.0898,7.7851 -4.5898,14.0351 -5.5585,13.8867 -0.9727,-0.1485 -9.1524,-9.2617 -18.1797,-20.2461 -20.6914,-25.1797 -39.4102,-35.2813 -69.2227,-37.336 -60.5976,-4.1835 -103.5703,40.6055 -123.25,128.4571 -9.0703,40.4883 -17.8281,95.0742 -17.8594,111.2929 -0.01,5.8321 -1.3086,10.6016 -2.8906,10.6016 -4.5898,0 -24.7695,-44.2031 -37.9805,-83.1992 -6.6875,-19.7383 -14.9375,-41.3984 -18.3476,-48.1367 l -6.1992,-12.2461 -11.3125,4.7226 c -43.5196,18.1836 -98.4805,81.2813 -124.461,142.8907 -14.9687,35.4882 -28.9883,82.4218 -37.3086,124.8437 -3.8711,19.7422 -8.1406,37.9609 -9.5,40.4883 -1.4882,2.8008 -5.8398,-9.9649 -11.1093,-32.625 z m 252.4492,-526.6289 c 3.8906,-143.336 6.4297,-182.332 19.8515,-305.0625 18.1993,-166.4805 34.3594,-261.8906 58.8282,-347.4727 14.3515,-50.1875 37.332,-110.7578 52.6015,-138.6679 5.3985,-9.8711 7.5391,-15.7383 4.7696,-13.0508 -6.1797,6.0117 -51.3204,90.9023 -63.0313,118.5195 -56.9883,134.5508 -90.5781,340.2422 -97.3281,596.0117 -3.1602,119.4805 5.8008,284.1328 17.1094,314.8203 1.3281,3.6055 2.7382,-17.6718 3.1289,-47.2812 0.3906,-29.6094 2.2304,-109.625 4.0703,-177.8164 z m -476.23831,206.4961 c 0,-2.168 2.36719,-23.0938 5.25782,-46.4922 4.29687,-34.7774 4.93359,-63.4024 3.49218,-156.7422 -1.72656,-111.3477 -5.07812,-159.8398 -20.32031,-293.6406 -22.0625,-193.7344 -77.27344,-378.336 -148.32812,-495.9727 -9.19532,-15.2304 -17.26172,-27.6914 -17.92188,-27.6914 -0.66016,0 3.71484,10.6485 9.72266,23.6602 36.0039,77.9804 83.30859,259.0898 109.29297,418.4375 28.6875,175.9179 46.22265,350.1601 50.98046,506.5312 1.26563,41.7227 3.54688,75.8594 5.06641,75.8594 1.51563,0 2.75781,-1.7773 2.75781,-3.9492 z m 707.76951,-177.1328 c -3.2617,-23.3282 -9.0117,-67.375 -12.789,-97.8789 -12.5821,-101.6602 -23.0625,-175.3789 -37.543,-264.2774 -7.8984,-48.4531 -16.0703,-100.207 -18.168,-115.0117 -9.4101,-66.6992 -7.3203,-3.0469 3.7891,115.0117 8.3789,88.9766 17.1406,155.0156 30.7617,231.7617 16.3399,92.086 35.4883,177.8164 38.8594,173.9766 0.5586,-0.6406 -1.6406,-20.2539 -4.9102,-43.582 z m -949.50779,-83.1953 c 16.32422,-93.6016 27.94922,-209.0079 31.05078,-308.3243 1.99219,-63.6757 -0.17187,-59.7031 -12.4375,22.836 -11.72656,78.9179 -28.77734,273.2695 -27.84375,317.375 0.34766,16.3008 1.54688,12.1523 9.23047,-31.8867 z m 514.98829,-8.211 c 22.2187,-19.0234 25.4883,-43.332 8.8008,-65.5586 -16.1133,-21.4648 -45.2617,-26.3398 -66.6133,-11.1367 -38.3867,27.3398 -18.0898,88.168 29.4414,88.168 12.3984,0 17.2617,-1.9649 28.3711,-11.4727 z m -13.7617,-365.2578 c 18.5625,-10.875 33.1406,-28.2422 45.1797,-53.793 8.6718,-18.3906 10.0625,-24.9882 9.9922,-47.4609 -0.1016,-30.0078 -6.9805,-48.8867 -26.5196,-72.7383 -42.4531,-51.8008 -123.2617,-33.3008 -142.8711,32.6914 -6.3203,21.2891 -6.3906,61.8086 -0.1523,82.8281 16.9101,56.9336 70.3711,84.2618 114.3711,58.4727 z m 110.8203,-103.7031 c 13.6289,-29.9688 22.25,-69.7578 22.4609,-103.5899 0.1602,-26.8281 -0.9687,-33.4804 -8.3906,-49.5078 -18.2109,-39.3125 -52.2109,-64.4336 -90.9414,-67.2031 -21.3672,-1.5273 -22.9492,-1.0977 -49.7695,13.5195 -34.418,18.7617 -47.1289,19.6836 -67.5703,4.8711 -45.0391,-32.6289 -88.5391,-30.6875 -124.0782,5.5196 -7.82419,7.9726 -15.46873,14.5 -16.98826,14.5 -3.83984,0 -17.79687,-31.668 -20.48047,-46.4688 -2.41796,-13.3203 0.16016,-28.5703 4.82422,-28.5703 1.61328,0 6.10938,9.5391 9.99219,21.1992 3.87891,11.6719 7.77344,21.2109 8.65234,21.2109 0.87891,0 8.46878,-5.789 16.85938,-12.8789 21.6719,-18.2617 43.0195,-26.9296 66.3906,-26.9296 16.3203,0 24.3086,2.3906 51.0313,15.1992 l 31.6875,15.1992 24.4297,-10.4688 c 55.5898,-23.8007 110.25,-13.0898 153.3711,30.0274 16.539,16.543 32.2812,44.8125 35.9101,64.4726 1.8594,10.0704 2.5899,10.8594 4.8516,5.3204 30.8398,-75.6719 66.789,-146.0704 97.039,-190.0313 23.0274,-33.4492 56.0079,-63.6211 79.6172,-72.8398 17.2735,-6.7383 24.9414,-7.4883 81.0625,-7.9297 66.7188,-0.5196 81.5196,-2.8907 114.4492,-18.2696 44.629,-20.8515 80.8985,-57.6914 105.6993,-107.3515 26.0507,-52.1797 34.0898,-90.3711 34,-161.5 -0.078,-57.7891 -3.25,-84.5899 -19.6993,-166.3985 -21.1679,-105.3515 -21.4609,-171.0312 -1.289,-290.3593 19.039,-112.6211 19.1992,-140.1211 1.2578,-213.6133 -25.0586,-102.6367 -62.8984,-173.5195 -126.4375,-236.8399 -57.4922,-57.289 -123.7109,-96.88668 -205.8594,-123.07809 C 1489.1992,921 1462.5703,916.85156 1422.0781,918.5 c -38.1992,1.57031 -54.3086,7.64062 -80.7578,30.46094 -25.0586,21.61718 -48.6406,78.78906 -76.5586,185.61716 l -7.6015,29.0703 -13.4297,-22.5898 c -30.0899,-50.6602 -95.6211,-94.6602 -190.2305,-127.7383 -85.77734,-29.99999 -150.83984,-40.78905 -244.69922,-40.62108 -76.19531,0.15234 -114.875,5.90234 -168.39062,25.01953 C 568,1023.6016 519.32422,1062.7109 494.09375,1115.3008 c -26.625,55.4805 -32.33984,108.2773 -29.84375,275.6875 1.03125,69.0898 1.22656,124.1523 0.43359,122.3515 -1.96875,-4.4609 -23.82422,-162.3203 -27.78125,-200.6484 -4.76953,-46.2617 -4.02734,-122.2812 1.50782,-154.0117 5.64453,-32.3594 24.76562,-89.2305 37.05468,-110.1992 11.125,-18.9805 42.41407,-56.30081 60.10157,-71.67191 56.8164,-49.38672 122.34375,-72.59765 223.70312,-79.23828 48.76953,-3.19922 56.28906,-4.39844 54.91016,-8.80859 -0.87891,-2.82031 -8.45703,-21.89063 -16.84375,-42.39063 -16.83985,-41.16015 -28.78516,-89.58984 -34.03516,-137.97265 -4.05859,-37.38672 -4.15625,-96.07813 -0.17578,-105.33985 2.27344,-5.29687 2.84766,-4.29687 3.03516,5.26172 0.32812,16.98828 18.11718,113.19141 27.84375,150.60938 13.96875,53.71093 46.52343,139.12109 53.20312,139.55078 1.30859,0.0898 17.79688,2.10937 36.63672,4.5 18.84375,2.3789 34.63672,4.00781 35.10156,3.62109 0.46485,-0.39062 -3.46875,-11.17187 -8.73828,-23.96094 -19.42969,-47.10937 -42.05859,-133.53906 -50.56641,-193.12109 -9.62109,-67.39062 -15.23828,-183.39844 -9.0664,-187.21094 1.4375,-0.88672 6.70312,25.8125 11.69922,59.35157 23.42968,157.30859 33.05078,203.39843 59.07422,283.01171 22.79296,69.73829 15.39062,61.48829 71.80859,80.06641 68.50395,22.57031 126.62505,52.65234 179.18355,92.76172 15.2188,11.6211 29,21.1211 30.6094,21.1211 1.6602,0 1.8711,-6.7109 0.4805,-15.5 -1.3399,-8.5195 -4.1289,-42.66016 -6.1992,-75.85157 -4.211,-67.67969 -13.3907,-162.50781 -23.0196,-237.94922 -3.5312,-27.6914 -5.8125,-50.96094 -5.0625,-51.71094 2.6329,-2.6289 21.5235,63.10157 27.9414,97.16016 10.8399,57.55078 13.3516,89.08203 15.2188,190.87109 1.582,86.71098 2.4922,99.51958 8.0195,112.32028 3.5235,8.1485 7.4102,13.1289 8.9102,11.418 1.4726,-1.6601 6.0625,-16.2383 10.1914,-32.3906 8.3789,-32.7578 21.4922,-68.63674 43.7187,-119.67971 23.7618,-54.58984 26.293,-68.78906 26.3008,-147.85937 0,-72.57813 -3.4883,-115.6875 -16.6289,-205.55078 -8.9492,-61.12891 -38.0312,-207.4375 -51.8906,-261.00782 -0.9414,-3.62109 0.7617,-2.21093 3.8008,3.16797 27.3593,48.26172 59,171.13282 77.75,301.89063 16.039,111.92969 17.7187,172.16015 6.4609,231.65234 -2.5508,13.45703 -4.6328,24.53906 -4.6328,24.62891 0,0.0781 10.9297,-5.17969 24.293,-11.69922 28.3984,-13.85156 65.2773,-22.72266 94.457,-22.72266 48,0 110.8711,16.92188 167.3633,45.05078 107.2695,53.40235 184.0195,129.41013 239.457,237.17193 23.1524,45 22.8399,41.4101 -4.0781,-47.3125 -30.4492,-100.32818 -36.75,-134.62896 -36.5625,-199.01958 0.1133,-39.21094 1.5117,-57.82031 5.1211,-68.50781 l 4.9609,-14.67188 2.2305,26.08984 c 6.1992,72.40235 17.6484,138.17969 34.539,198.40233 19.6016,69.8867 42.5704,175.5899 48.879,224.8672 3.621,28.2422 6.9531,74.7422 7.4101,103.3399 0.4609,28.6093 1.8399,50.2304 3.0703,48.0507 3.5391,-6.3007 21.5899,-120.7187 25.5508,-161.9414 5.9102,-61.6679 7.8984,-226.61716 3.4492,-287.11716 -7.3398,-99.88282 -29.6797,-190.25 -63.3789,-256.3711 l -14.832,-29.10937 -0.2188,22.83984 c -0.3007,31.21094 -5.9492,82.60938 -9.8007,89.21094 -2.2774,3.89062 -3.1875,-0.53125 -3.2696,-15.80078 -0.2773,-54.83985 -15.8906,-108.83985 -55.6484,-192.5 -28.582,-60.14063 -49.2813,-109.46875 -60.2617,-143.55078 -3.1797,-9.8711 -6.2383,-18.48828 -6.8086,-19.14844 -0.5703,-0.67188 -7.3516,4.20703 -15.0586,10.83984 -17.2422,14.8086 -53.8321,32.5586 -76.9922,37.34766 -24.9688,5.17187 -69.1797,4.40234 -95.8594,-1.66797 -44.8008,-10.19141 -83.2305,-29.62109 -128.289,-64.87109 -62.4219,-48.83985 -93.2305,-93.89063 -108.1211,-158.08985 -2.7305,-11.73828 -5.4883,-21.89062 -6.1485,-22.55078 -0.6523,-0.64844 -13.3906,5.44141 -28.2929,13.53906 -14.8985,8.10157 -59.3985,28.65235 -98.879,45.66016 -174.10152,75.03125 -254.00386,120.72266 -363.22261,207.74219 -27.48047,21.89844 -55.1836,41.98828 -61.56641,44.66015 -29.54687,12.33985 -66.04687,-8.82031 -87.19531,-50.55078 -8.75391,-17.26953 -18.125,-57.89062 -18.33985,-79.48047 l -0.13671,-14.00781 -7.89063,22.83985 c -17.38281,50.32031 -21.99219,78.25 -21.80859,132.13671 0.35937,104.04297 24.70312,220.21094 67.28906,321.10157 18.46875,43.76172 18.64453,44.32031 13.90625,44.32031 -4.48047,0 -25.25391,-32.60938 -41.46875,-65.08984 -23.32422,-46.73047 -51.96094,-131.92969 -66.39844,-197.55079 -7.16797,-32.58984 -12.86328,-95 -10.41406,-114.17968 l 2.08203,-16.32813 -13.63281,22.83985 c -31.75391,53.17968 -63.24219,126.92968 -97.83594,229.16015 -26.28906,77.66797 -34.85547,96.83985 -50.46484,112.91797 -14.48438,14.91016 -27.87891,15.98047 -41.14063,3.26953 l -9.02344,-8.64844 1.48047,11.09766 c 0.81641,6.10156 3.76953,34.58203 6.5625,63.29297 2.79297,28.71875 9.60938,82.30855 15.14844,119.08985 9.47266,62.8789 10.16406,73.918 11.5625,184.3398 0.82031,64.6094 0.75781,116.7305 -0.13281,115.8282 -1.8711,-1.8789 -9.66016,-66.4805 -17.10938,-141.9297 C 367.98047,1046.4102 353.51953,961.58984 326.375,865.69922 317.48437,834.30078 308.64844,802 306.74219,793.92187 c -5.32813,-22.52343 -1.75,137.27735 4.45703,199.01954 6.73047,66.99999 18.66406,146.99999 30.90625,207.17969 11.53125,56.6875 11.94922,58.207 46.29687,167.8281 58.89063,187.9727 70.33594,263.5508 66.24219,437.4102 -1.89844,80.4492 -1.42969,94.2695 4.52344,133.7617 17.55078,116.418 61.64453,200.2383 134.25781,255.2187 45.15234,34.1915 91.67969,50.8711 151.75391,54.4219 49.69922,2.9297 58.85156,6.5196 89.80078,35.168 21.3789,19.8008 68.35547,80.6797 107.24609,138.9805 35.01563,52.5 72.19534,128.8711 92.39454,189.7812 l 17.25,52.0391 1.9375,-28.1211 c 1.4531,-21.0391 4.1211,-32.5899 10.6406,-45.9102 22.8399,-46.6679 83.3594,-77.1679 134.5508,-67.8086 54.8984,10.0313 93.3086,47.8985 105.3203,103.8399 8.9883,41.8789 10.9414,49.7578 12.3399,49.7578 0.8086,0 4.9804,-7.707 9.2695,-17.1289 z m -159.8594,-285.9375 c -29,-7.5508 -63.1211,-34.8516 -80.9414,-64.7617 -8.3594,-14.0196 -11.707,-17.1016 -16.9375,-15.6094 -3.5898,1.0195 -23.7812,3.5195 -44.8711,5.539 -21.082,2.0313 -38.33202,4.9297 -38.33202,6.4493 0,7.6406 -7.60937,1.1523 -13.01953,-11.0977 -23.05078,-52.1719 2.92187,-130.7226 50.54295,-152.8516 18.8594,-8.7617 33.6602,-7.8398 51.0469,3.1915 24.3633,15.4375 35.1211,39.8789 41.832,95.0078 1.8594,15.25 5.6211,34.3398 8.3477,42.4218 6.3515,18.75 24.8828,44.0586 38.3711,52.3907 17.582,10.8593 24.1211,11.1484 38.332,1.75 25.8477,-17.1016 42.2969,-49.3321 48.6172,-95.2032 4.793,-34.75 11.6328,-54.1992 25.4297,-72.2773 l 11.5508,-15.1211 -8.3985,-7.2187 c -16.9101,-14.543 -1.1601,-14.9415 32.7305,-0.8399 41.1484,17.1367 59.3906,41.7969 68.1992,92.2383 5.211,29.7891 1.8594,69.6601 -7.3594,87.4609 -5.0312,9.7383 -5.6992,10.0782 -8.1914,4.0977 -1.5,-3.5664 -5.6211,-13.4492 -9.1601,-21.9375 l -6.4297,-15.4414 -15.6406,6.9219 c -15.9883,7.0781 -45.8203,9.75 -58.1602,5.1992 -5.75,-2.1094 -7.2187,-0.4492 -11.0703,12.5898 -6.1602,20.8711 -22.0469,40.7305 -39.418,49.2578 -16.5,8.1016 -42.4023,11.6602 -57.0703,7.8438 z m 158.2383,-113.9922 c 23.1133,-16.668 24.582,-48.5195 3.2227,-69.8906 -16.211,-16.1993 -26.4297,-16.2188 -41.6524,-0.09 -19.6992,20.8906 -26.3789,49.5 -15.2578,65.3711 9.8594,14.0899 37.2891,16.4414 53.6875,4.6094 z m -255.8789,1.1797 c 8.5508,-3.5781 13.1406,-8.6094 18.1406,-19.9102 7.4688,-16.8789 6.4805,-30.4375 -3.6601,-50.1992 -17.2813,-33.6992 -45.5586,-37.0781 -64.9688,-7.7812 -17.1211,25.8515 -16.2812,46.3203 2.6484,64.4531 7.1993,6.8984 26.3399,16.6562 35.4688,18.0781 0.5,0.078 6.0703,-2.0117 12.3711,-4.6406 z m -385.56251,-65.1289 c -22.03125,-5 -47.78907,-17.0391 -69.1836,-32.3399 -17.65234,-12.6211 -45.46875,-49.0195 -60.24609,-78.832 -17.97656,-36.2695 -17.69922,-41.1367 0.93359,-16.3086 48.14453,64.1406 95.76953,97.1406 167.28125,115.8906 18.02735,4.7188 27.52735,8.6602 25.58594,10.5977 -5.19141,5.1914 -43.3125,5.7812 -64.37109,0.9922 z m 926.86331,-3.4024 c -37.211,-8.0976 -88.6914,-33.207 -105.9492,-51.6797 -5.2305,-5.5976 -8.9727,-10.707 -8.3204,-11.3593 0.6485,-0.6485 14.1602,3.2226 30.0196,8.6015 66.8593,22.6602 132.289,27.9805 175.6679,14.3086 41.6016,-13.1094 92.711,-47.6289 120.6914,-81.5078 13.4493,-16.2812 15.8204,-12.6211 5.3204,8.1797 -44.0704,87.3086 -130.4805,132.3984 -217.4297,113.457 z m -395.0196,-32.7187 c 5.2696,-20.5313 8.2383,-114.668 4.8399,-153.7305 -3.6719,-42.0898 -2.0195,-105.2695 2.9805,-114.1992 1.8085,-3.2383 6.1484,5.9609 13.5703,28.8086 6,18.4609 13.3398,39.3203 16.3203,46.3633 l 5.4062,12.789 7.3711,-11.9218 c 18.8906,-30.5586 127.1602,-124.4883 232.0313,-201.2969 167.7578,-122.8633 214.2695,-150.0508 256.6797,-150.0508 22.6914,0 33.6992,9.3789 33.6992,28.7187 0,17.2813 -12.3008,33.4102 -44.0508,57.7383 -14.0469,10.7735 -30.8086,24.4922 -37.2383,30.5117 -11.1289,10.3907 -11.1914,10.6016 -1.5,4.1407 24.6914,-16.4297 93.0586,-49.3321 102.5078,-49.3321 15.8516,0 10.9922,9.3829 -11.5781,22.3516 -124.8906,71.7813 -165.8711,100.8984 -235.0508,167.0313 -24.0976,23.039 -53.5586,48.8398 -65.4687,57.3398 l -21.6524,15.4492 14.25,4.1992 c 26.711,7.8907 61.711,11.8789 88.2305,10.0586 67.9727,-4.6562 113.3828,-51.289 135.0117,-138.6562 4.1602,-16.7813 9.3086,-32.6133 11.4414,-35.1914 3.9492,-4.7617 35.1172,-15.5117 56.7188,-19.5586 l 11.8984,-2.2305 -1.9375,35.457 c -4.4805,82.4414 -14.3398,131.7618 -34.8125,174.1329 -45.7305,94.6601 -168.3984,138.3593 -277.6992,98.9296 -42.5,-15.332 -90.9688,-54.0898 -113.1797,-90.5312 -6.9883,-11.4688 -8.1602,-12.1914 -11.2617,-6.8984 -26.3164,44.8281 -66.0664,65.5468 -101.8985,53.1093 l -13.5898,-4.7304 0.4883,42.7617 c 0.5312,46.457 -4.6875,72.5078 -17.4883,87.2265 -6,6.9024 -6.5391,7.0313 -5.0391,1.211 z M 1629.5,2047.7383 c 14.4297,-5.1289 33.1094,-13.3399 41.5,-18.2578 19.5117,-11.4414 51.1602,-40.8086 59.2109,-54.9492 5.2696,-9.2696 4.0977,-8.5625 -7.6992,4.6484 -16.4023,18.3789 -46.2109,40.1406 -73.5703,53.7305 -26.3828,13.1093 -37.6016,16.4609 -73.6719,22.0312 l -30.7304,4.7383 29.3593,-1.3086 c 21.461,-0.9609 36.4297,-3.8203 55.6016,-10.6328 z m -896.38281,28.293 c -45.44141,-11.1719 -85.6875,-31.5196 -118.67969,-60 -33.39453,-28.8399 -64.13672,-85.75 -77.66016,-143.793 -6.39843,-27.457 -18.75781,-103.457 -17.09375,-105.1172 2.60938,-2.6094 49.9961,10 59.69532,15.8789 10.66015,6.4688 11.28515,7.7695 28.79296,59.8711 11.84766,35.2695 24.22657,56.1289 44.92188,75.6992 45.03516,42.5899 113.66797,55.7695 180.57031,34.6797 l 17.51953,-5.5195 -16.6914,-9.1289 c -21.45313,-11.7305 -38.53125,-25.7618 -82.77735,-68.0118 -59.21875,-56.5585 -87.95703,-76.1406 -191.6914,-130.6289 -31.85157,-16.7421 -57.91407,-31.6601 -57.91407,-33.1718 0,-1.5078 3.64454,-4.1289 8.10157,-5.8203 11.37109,-4.3282 33.42968,3.3007 85.69922,29.621 23.77734,11.9688 43.23046,21.25 43.23046,20.6094 0,-0.6406 -20.92187,-14.9297 -46.49218,-31.75 -48.83594,-32.1406 -58.57422,-40.5195 -64.14063,-55.2109 -4.17578,-11.0195 -0.77344,-20.8164 11.04688,-31.8086 7.96093,-7.3984 11.40625,-8.1602 37.05078,-8.1602 27.66797,0 29.08984,0.4024 65.80078,18.211 41.65234,20.2109 87.77734,48.4101 182.71094,111.7109 117.4414,78.3203 193.72261,143.1367 237.75391,202.0391 6.3594,8.5078 12.6484,14.3789 13.9687,13.0508 1.3204,-1.3399 7.4805,-17.5821 13.6915,-36.0899 6.1992,-18.5195 12,-34.3906 12.8789,-35.2695 3.8593,-3.8633 5.5898,45.0976 2.3711,67.2969 -5.6602,39.121 -25.5508,61.9609 -53.961,61.9804 -18.6719,0.02 -33.9609,-9.3906 -48.2305,-29.6679 -6.81636,-9.6915 -13.42183,-17.8516 -14.67964,-18.1329 -1.26172,-0.2773 -9.63282,8.0899 -18.60547,18.6016 -29.4961,34.5313 -90.2461,70.5 -135.14844,80.0195 -29.51172,6.2618 -71.875,5.4297 -102.03906,-1.9882 z m 101.98047,-32.9024 c 23.76562,-5.9805 58.53515,-20.0781 58.53515,-23.75 0,-0.6484 -8.82031,2.3711 -19.60156,6.7305 -10.78125,4.3515 -30.85156,10.789 -44.59766,14.3008 -23.10937,5.9101 -32.80468,9.6406 -25.05859,9.6406 1.75,0 15.57812,-3.1094 30.72266,-6.9219 z M 1060.0313,1744.5508 C 999.94531,1685.6406 863.01172,1611.5586 626.08984,1509.7891 l -17.9414,-7.711 13.50781,-0.078 c 43.24219,-0.25 165.47266,47.5 279.54297,109.1914 76.83984,41.5586 139.81248,86.8477 164.99218,118.668 9.5899,12.1211 21.4492,36.6914 17.3281,35.9101 -1.2578,-0.2382 -11.8281,-9.789 -23.4882,-21.2187 z m 159.9375,-3.2813 c 0.2109,-35.8906 25.6015,-61.6797 92.8007,-94.2382 138.8203,-67.25 229.6524,-108.0704 272.2188,-122.3321 34.3125,-11.5 46.6328,-12.7187 28.0117,-2.789 -7.1406,3.8203 -33.5508,18.7695 -58.6797,33.2187 -65.8789,37.9024 -101.832,57.1094 -182.6992,97.6406 -84.543,42.3516 -116.9023,62.3594 -136.9922,84.6993 l -14.7305,16.3906 z m -37.5899,-133.4297 -9.7891,-4.4804 14.9102,-0.1485 c 32.9805,-0.3203 66.8398,-17.4101 106.6289,-53.8125 23.25,-21.2773 27.6211,-17.4101 9,7.9532 -31.1601,42.4375 -87.168,65.8672 -120.75,50.4882 z M 1124.4219,1479 c -18.8633,-4.75 -60.6602,-27.5703 -57.0821,-31.1484 0.6407,-0.6407 10.629,2.707 22.211,7.4375 29.9609,12.2304 72.0078,12.0625 109.1406,-0.461 14.3594,-4.8281 29.5391,-11.0195 33.7305,-13.7383 10.957,-7.1015 12.9375,-2.5507 4.9297,11.3086 -11.1602,19.293 -30.8399,27.4922 -68.961,28.6914 -17.4297,0.5508 -37.2187,-0.3906 -43.9687,-2.0898 z M 432.74609,1028.1016 c 1.48047,-42.71098 8.55469,-119.91019 14.42578,-157.51176 l 4.07813,-26.10156 2.34766,14.69141 c 4.03906,25.23047 3.04296,77.64843 -2.16407,113.76953 -6.52734,45.28128 -14.57812,86.23048 -17.57812,89.41018 -1.3125,1.3906 -1.8125,-14.0196 -1.11328,-34.2578 z m 22.1211,8.8867 c 19.54687,-57.41018 40.63672,-145.94924 56.73437,-238.16799 7.20703,-41.28125 14.07813,-79.85156 15.27735,-85.71875 4.67578,-22.9414 7.85937,-12.38281 7.85937,26.07813 0,91 -20.74219,193.60937 -52.28906,258.66015 -12.03516,24.80856 -32.67578,54.10936 -27.58203,39.14846 z m 685.09371,-71.77736 c -16.6601,-35.24219 -45.4726,-111.69922 -60.8515,-161.5 -19.3594,-62.65235 -88.47659,-329.74219 -85.9844,-332.23047 2.48828,-2.49219 23.8164,47.35937 39.3047,91.84765 21.5703,61.96094 46.4805,146.8125 74.8789,255.0625 13.6523,52.03907 30.7227,111.9375 37.9297,133.09766 7.2109,21.17188 12.4531,40.26172 11.6406,42.42188 -0.8203,2.16015 -8.4297,-10.75 -16.918,-28.69922 z M 593.96875,876.30859 c -8.24609,-15.77734 -17.69922,-78.3789 -10.6875,-70.80859 2.85156,3.07812 19.97266,65.41016 19.97266,72.69922 0,5.76953 -5.90235,4.57031 -9.28516,-1.89063 z m 394.95312,-11.4375 c -9.93359,-11.96093 -25.72656,-69.1914 -20.0664,-72.6914 2.60937,-1.6211 10.59375,17.80078 20.83594,50.67968 3.07421,9.8711 6.16406,19.78125 6.86718,22.01954 1.64844,5.28125 -3.26172,5.26953 -7.63672,0 z M 701.69922,804.51953 C 687.97656,768.75 684.83203,755.64062 685.04687,735.19141 c 0.14844,-14.28125 0.79688,-16.42188 3.1875,-10.46094 2.51954,6.26953 19.28907,73.1289 24.51563,97.73828 3.04687,14.35156 -1.49219,6.98047 -11.05078,-17.94922 z m 833.41018,10.10156 c -1.0781,-6.90234 -4.9805,-47.05078 -8.668,-89.21093 -7.0117,-80.14063 -14.6914,-136.42969 -27.0312,-198.21875 -4.0391,-20.17969 -6.4805,-36.70313 -5.4297,-36.70313 3.8281,0 26.2812,57.90234 34.1601,88.08984 20.3477,77.92188 28.1992,172.8711 18.4883,223.35157 -4.7187,24.4414 -8.9687,29.1289 -11.5195,12.6914 z m -74.8906,-54.14062 c -1.0274,-7.62891 -2.6485,-25.60938 -3.6094,-39.96875 l -1.75,-26.10156 5.3906,11.41796 c 6.2188,13.19141 10.3594,68.51172 5.1211,68.51172 -1.8125,0 -4.1328,-6.23047 -5.1523,-13.85937 z m 254.5195,-97.87891 c -1.8594,-35.38281 -7.5195,-76.32031 -18.3594,-132.58203 -4.6875,-24.34766 -4.2891,-26.26953 3.1406,-15.05859 7.6211,11.5 20.8516,50.78906 26.1524,77.64843 7.039,35.64063 2.707,109.96094 -6.4024,109.96094 -1.3398,0 -3.3789,-17.99219 -4.5312,-39.96875 z m -38.0586,-36.71094 c 0,-33.67187 0.8086,-41.26953 4.0703,-38.01171 2.75,2.74218 4.0781,15.21093 4.0781,38.01171 0,22.78907 -1.3281,35.26954 -4.0781,38.00782 -3.2617,3.26172 -4.0703,-4.32813 -4.0703,-38.00782 z M 417.36719,1744.5586 c -14.4336,-199.7891 -75.11328,-338.3398 -190.38672,-434.668 -39.04688,-32.6406 -130.617189,-91.7304 -135.132814,-87.2187 -1.113281,1.1172 2.4375,6.7695 7.886719,12.5781 28.312495,30.1602 113.593745,153.4102 160.898435,232.5 49.9375,83.5195 125.22656,236.8789 148.55078,302.6211 4.95313,13.9492 9.60938,24.7695 10.34375,24.0273 0.73828,-0.7265 -0.23437,-23.1601 -2.16015,-49.8398 z m 1481.08201,10.2227 c 24.5899,-73 102.6211,-221.3321 167.3594,-318.1094 46.8203,-69.9922 93.2305,-129.211 136.9805,-174.7735 26.1914,-27.2773 31.7812,-35.8086 16.3125,-24.8984 -4.9414,3.4883 -16.6016,10.1797 -25.9219,14.8711 -29.8399,15.0391 -102.8594,66.0195 -132.3008,92.3789 -77.0976,69.0391 -139.5898,174.3906 -166.0898,280.0195 -5.0703,20.1719 -6.9493,41.3203 -8.2891,92.9922 -1.0586,40.6797 -0.5586,65.6094 1.2617,63.6172 1.6485,-1.7891 6.4571,-13.5391 10.6875,-26.0976 z m 0,0"\r
     id="path1"\r
     inkscape:highlight-color="#aaaaaa"\r
     style="fill:#ffffff;fill-opacity:1" />\r
</svg>\r
`,zv="#87CEFA",Fv="#FF0000";function Um(n){const e=n.match(/viewBox\s*=\s*"([^"]+)"/i),t=n.match(/<path[^>]*\sd="([^"]+)"[^>]*>/i);if(!e||!t)throw new Error("Cannot parse SVG path/viewBox from source.");const i=t[0].match(/transform="([^"]+)"/i);return{d:t[1],transform:i?i[1]:void 0,viewBox:e[1]}}const jv=Um($v),Bv=Um(Lv);function Dv(n){return n==="player"?zv:Fv}function Ov(n){const e=n==="player"?jv:Bv,t=Dv(n),i=e.transform?` transform="${e.transform}"`:"";return[`<svg viewBox="${e.viewBox}" xmlns="http://www.w3.org/2000/svg" style="background:none">`,"<g>",`<path d="${e.d}"${i} fill="${t}" />`,"</g>","</svg>"].join("")}function ah(n){const e=Ov(n);return`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(e)))}`}const Gm="token-player-svg",Vm="token-enemy-svg";let hc=null;async function Nv(){if(hc)return hc;const n=[{alias:Gm,src:ah("player")},{alias:Vm,src:ah("enemy")}];return hc=(async()=>{for(const e of n)Xs.add(e);await Xs.load(n.map(e=>e.alias))})(),hc}function Wv(n){const e=ee.useRef(null),t=ee.useRef(null),i=ee.useRef(null),o=ee.useRef(null),a=ee.useRef(null),c=ee.useRef(null),[u,h]=ee.useState(0),f=ee.useRef(null),p=ee.useRef(null),g=ee.useRef(null),v=ee.useRef({cols:n.grid.cols,rows:n.grid.rows}),x=ee.useRef(typeof n.zoom=="number"?n.zoom:1),w=ee.useRef({x:typeof n.panX=="number"?n.panX:0,y:typeof n.panY=="number"?n.panY:0});return x.current=typeof n.zoom=="number"?n.zoom:1,w.current={x:typeof n.panX=="number"?n.panX:0,y:typeof n.panY=="number"?n.panY:0},g.current=n.playableCells??null,v.current={cols:Math.max(1,Math.floor(n.grid.cols)),rows:Math.max(1,Math.floor(n.grid.rows))},ee.useEffect(()=>{var S;(S=f.current)==null||S.call(f)},[n.zoom,n.panX,n.panY]),ee.useEffect(()=>{var S,b;(S=p.current)==null||S.call(p),(b=f.current)==null||b.call(f)},[n.playableCells,n.grid.cols,n.grid.rows,u]),ee.useEffect(()=>{if(!n.enabled||!n.containerRef.current||e.current)return;const S=new gm;e.current=S;let b=!1,k=null,A=null,M=!1;return(async()=>{if(await S.init({width:Sa(v.current.cols),height:Od(v.current.rows),background:r2,antialias:!0}),M=!0,await Nv(),b)return;const B=n.containerRef.current;if(!B)return;B.prepend(S.canvas);const F=new xn;S.stage.addChild(F);const I=new mi;F.addChild(I);const N=()=>{I.clear();const{cols:Q,rows:ae}=v.current;for(let G=0;G<ae;G++)for(let V=0;V<Q;V++){const te=g.current;if(te&&te.size>0&&!te.has(`${V},${G}`))continue;const Y=gn(V,G,Q),ie=at,L=at*.5,K=[Y.x,Y.y-L/2,Y.x+ie/2,Y.y,Y.x,Y.y+L/2,Y.x-ie/2,Y.y],ve=(V+G)%2===0;I.poly(K).fill({color:ve?1381666:1908016,alpha:1})}};p.current=N,N();const U=new xn;F.addChild(U),t.current=U;const q=new mi;F.addChild(q),o.current=q;const H=new xn;F.addChild(H),i.current=H;const se=new xn;F.addChild(se),a.current=se,h(Q=>Q+1);const Z=()=>{const Q=n.containerRef.current;if(!Q)return;const ae=Math.max(1,Q.clientWidth),G=Math.max(1,Q.clientHeight);S.renderer.resize(ae,G);const{cols:V,rows:te}=v.current,Y=Sa(V),ie=Od(te),L=Math.min(ae/Y,G/ie),K=x.current,ve=L*K,Pe=(ae-Y*ve)/2+w.current.x,Ee=(G-ie*ve)/2+w.current.y;F.scale.set(ve),F.position.set(Pe,Ee),c.current={scale:ve,offsetX:Pe,offsetY:Ee};const Re=S.canvas;Re.style.width="100%",Re.style.height="100%",Re.style.display="block"};k=Z,f.current=Z,Z(),A=new ResizeObserver(()=>Z()),A.observe(B),window.addEventListener("resize",Z)})(),()=>{b=!0,A&&A.disconnect(),k&&window.removeEventListener("resize",k),M&&e.current&&e.current.destroy(!0),e.current=null,t.current=null,i.current=null,o.current=null,a.current=null,c.current=null,f.current=null,p.current=null}},[n.enabled,n.containerRef]),{appRef:e,obstacleLayerRef:t,tokenLayerRef:i,pathLayerRef:o,speechLayerRef:a,viewportRef:c,pixiReadyTick:u}}function Hv(n){const e=String((n==null?void 0:n.category)??"").toLowerCase();return e==="wall"?9807270:e==="vegetation"?3066993:e==="structure"?12436423:15105570}function Uv(n){ee.useEffect(()=>{const e=n.obstacleLayerRef.current;if(!e)return;e.removeChildren();const t=new Map;for(const i of n.obstacleTypes)t.set(i.id,i);for(const i of n.obstacles){const o=t.get(i.typeId)??null,a=new mi,c=o?hh(i,o):[{x:i.x,y:i.y}],u=at,h=at*.5,f=Hv(o);for(const b of c){const k=gn(b.x,b.y,n.grid.cols,n.grid.rows),A=[k.x,k.y-h/2,k.x+u/2,k.y,k.x,k.y+h/2,k.x-u/2,k.y];a.poly(A).fill({color:f,alpha:.9}),a.poly(A).stroke({color:723730,width:2,alpha:.8})}const p=i.maxHp>0?Math.max(0,Math.min(1,i.hp/i.maxHp)):1,g=Math.max(10,u*.42),v=4,x=gn(i.x,i.y,n.grid.cols,n.grid.rows),w=x.x-g/2,S=x.y-h*.9;a.rect(w,S,g,v).fill({color:0,alpha:.55}),a.rect(w,S,g*p,v).fill({color:p>.5?3066993:p>.25?15844367:15158332,alpha:.85}),e.addChild(a)}},[n.obstacleLayerRef,n.obstacleTypes,n.obstacles,n.pixiReadyTick,n.grid])}function Gv(n){ee.useEffect(()=>{const e=n.pathLayerRef.current;if(!e)return;e.clear();const t=n.effectSpecs.map(a=>{switch(a.kind){case"circle":return h0(a.id,n.player.x,n.player.y,a.radius??1,{playableCells:n.playableCells??null});case"rectangle":return o2(a.id,n.player.x,n.player.y,a.width??1,a.height??1,{playableCells:n.playableCells??null});case"cone":return f0(a.id,n.player.x,n.player.y,a.range??1,a.direction??"right",void 0,{playableCells:n.playableCells??null});default:return{id:a.id,type:"circle",cells:[]}}});for(const a of t)for(const c of a.cells){if(n.playableCells&&n.playableCells.size>0&&!n.playableCells.has(`${c.x},${c.y}`))continue;const u=gn(c.x,c.y,n.grid.cols,n.grid.rows),h=at,f=at*.5,p=[u.x,u.y-f/2,u.x+h/2,u.y,u.x,u.y+f/2,u.x-h/2,u.y],g=a.type==="circle"?3447003:a.type==="rectangle"?3066993:15158332;e.poly(p).fill({color:g,alpha:.45})}if(n.showVisionDebug){const a=[n.player,...n.enemies];for(const c of a){const u=dh(c,n.playableCells??null);for(const h of u.cells){if(n.playableCells&&n.playableCells.size>0&&!n.playableCells.has(`${h.x},${h.y}`))continue;const f=gn(h.x,h.y,n.grid.cols,n.grid.rows),p=at,g=at*.5,v=[f.x,f.y-g/2,f.x+p/2,f.y,f.x,f.y+g/2,f.x-p/2,f.y],x=c.type==="player"?2719929:12597547;e.poly(v).fill({color:x,alpha:c.type==="player"?.25:.2})}}}const i=[n.player,...n.enemies];for(const a of i){const c=gn(a.x,a.y,n.grid.cols,n.grid.rows),u=at,h=at*.5,f=[c.x,c.y-h/2,c.x+u/2,c.y,c.x,c.y+h/2,c.x-u/2,c.y],p=a.type==="player"?3066993:15158332;e.poly(f).fill({color:p,alpha:.2})}if(n.selectedTargetId){const a=n.enemies.find(c=>c.id===n.selectedTargetId);if(a){const c=gn(a.x,a.y,n.grid.cols,n.grid.rows),u=at,h=at*.5,f=[c.x,c.y-h/2,c.x+u/2,c.y,c.x,c.y+h/2,c.x-u/2,c.y];e.poly(f).fill({color:3447003,alpha:.6})}}if(n.selectedPath.length>0){const a=n.selectedPath[n.selectedPath.length-1],c=gn(a.x,a.y,n.grid.cols,n.grid.rows),u=at,h=at*.5,f=[c.x,c.y-h/2,c.x+u/2,c.y,c.x,c.y+h/2,c.x-u/2,c.y];e.poly(f).fill({color:15844367,alpha:.2})}for(const a of n.enemies){if(!a.plannedPath||a.plannedPath.length===0)continue;const c=a.plannedPath,u=c[0],h=gn(u.x,u.y,n.grid.cols,n.grid.rows);e.setStrokeStyle({width:3,color:15158332,alpha:.9}),e.moveTo(h.x,h.y);for(const f of c.slice(1)){const p=gn(f.x,f.y,n.grid.cols,n.grid.rows);e.lineTo(p.x,p.y)}e.stroke()}if(n.selectedPath.length===0)return;e.setStrokeStyle({width:6,color:15844367,alpha:1});const o=gn(n.player.x,n.player.y,n.grid.cols,n.grid.rows);e.moveTo(o.x,o.y);for(const a of n.selectedPath){const c=gn(a.x,a.y,n.grid.cols,n.grid.rows);e.lineTo(c.x,c.y)}e.stroke()},[n.pathLayerRef,n.player,n.enemies,n.selectedPath,n.effectSpecs,n.selectedTargetId,n.showVisionDebug,n.pixiReadyTick,n.playableCells,n.grid])}function Vv(n){ee.useEffect(()=>{const e=n.speechLayerRef.current;if(!e)return;e.removeChildren();const t=[n.player,...n.enemies],i=new Map(n.speechBubbles.map(f=>[f.tokenId,f])),o=6,a=140,c=at*1,u=[];for(const f of t){if(Yt(f))continue;const p=i.get(f.id);if(!p||!p.text.trim())continue;const g=gn(f.x,f.y,n.grid.cols,n.grid.rows),v=new xn,x=new mi;x.beginFill(16777215,.92);const w=new Iv(p.text,{fontFamily:"Arial",fontSize:11,fill:0,align:"center",wordWrap:!0,wordWrapWidth:a-10}),S=Math.min(a,w.width+10),b=w.height+8;x.drawRoundedRect(-S/2,-b,S,b,7),x.endFill(),w.x=-w.width/2,w.y=-b+4,v.addChild(x),v.addChild(w);const k=g.x+at*.05,A=g.y-c;v.x=k,v.y=A,e.addChild(v),u.push({x:k-S/2,y:A-b,width:S,height:b,view:v})}u.sort((f,p)=>f.y-p.y);const h=[];for(const f of u){let p=f.y,g=0;const v=(w,S,b)=>{const k=w.x,A=w.y,M=w.x+w.width,E=w.y+w.height,B=S,F=b,I=S+f.width,N=b+f.height;return k<I&&M>B&&A<N&&E>F};for(;g<20;){const w=h.find(S=>v(S,f.x,p));if(!w)break;p=w.y-f.height-o,g+=1}const x=p-f.y;x!==0&&(f.view.y+=x,f.y=p),h.push(f)}},[n.speechLayerRef,n.player,n.enemies,n.speechBubbles,n.pixiReadyTick,n.grid])}function Yv(n){ee.useEffect(()=>{const e=n.tokenLayerRef.current;if(!e)return;e.removeChildren();const t=[n.player,...n.enemies];for(const i of t){const o=new xn;if(!Yt(i)){const h=new mi;h.beginFill(0,.4),h.drawEllipse(0,0,at*.4,at*.15),h.endFill(),o.addChild(h)}const a=i.type==="player"?Gm:Vm,c=no.from(a);c.anchor.set(.5,1),c.width=at*.9,c.height=at*.9,Yt(i)?(c.rotation=Math.PI/2,c.alpha=.7):(c.rotation=0,c.alpha=1),o.addChild(c);const u=gn(i.x,i.y,n.grid.cols,n.grid.rows);o.x=u.x+at*.05,o.y=u.y,e.addChild(o)}},[n.tokenLayerRef,n.player,n.enemies,n.pixiReadyTick,n.grid])}function Xv(n){return T.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",background:"#0b0b12",color:"#f5f5f5",fontFamily:"system-ui, sans-serif",padding:16,boxSizing:"border-box"},children:[T.jsx("h1",{style:{marginBottom:8},children:"Prparation du combat"}),T.jsx("p",{style:{marginBottom:16,fontSize:13,maxWidth:480,textAlign:"center"},children:"Configurez le combat avant de lancer la grille : nombre d'ennemis, puis dmarrez pour effectuer les jets d'initiative et entrer en mode tour par tour."}),T.jsxs("div",{style:{padding:16,borderRadius:8,background:"#141421",border:"1px solid #333",minWidth:260,display:"flex",flexDirection:"column",gap:12},children:[T.jsxs("label",{style:{fontSize:13,display:"flex",flexDirection:"column",gap:6},children:["Contexte de la battle map :",T.jsx("textarea",{value:n.mapPrompt,onChange:e=>n.onChangeMapPrompt(e.target.value),placeholder:"Ex: Un donjon humide: une salle, un couloir, une porte verrouille, des piliers. Ennemis en embuscade au fond.",rows:4,style:{resize:"vertical",minHeight:84,background:"#0f0f19",color:"#f5f5f5",border:"1px solid #333",borderRadius:6,padding:"8px 10px",fontSize:12,lineHeight:1.35}})]}),T.jsxs("label",{style:{fontSize:13},children:["Nombre d'ennemis :",T.jsx("input",{type:"number",min:1,max:8,value:n.configEnemyCount,onChange:e=>n.onChangeEnemyCount(Math.max(1,Math.min(8,Number(e.target.value)||1))),style:{marginLeft:8,width:60,background:"#0f0f19",color:"#f5f5f5",border:"1px solid #333",borderRadius:4,padding:"2px 4px"}})]}),T.jsxs("p",{style:{fontSize:11,color:"#b0b8c4",margin:0},children:["Taille de la carte : actuellement fixe (",n.gridCols," x ",n.gridRows,"). Un redimensionnement dynamique demandera une refonte de boardConfig.ts."]}),T.jsx("button",{type:"button",onClick:()=>{if(n.enemyTypeCount===0){n.onNoEnemyTypes();return}n.onStartCombat()},style:{marginTop:8,padding:"6px 12px",background:"#2ecc71",color:"#0b0b12",border:"none",borderRadius:4,cursor:"pointer",fontWeight:600,fontSize:13},children:"Lancer le combat"})]})]})}function qv(n){return T.jsxs("section",{style:{padding:"8px 12px",background:"#141421",borderRadius:8,border:"1px solid #333"},children:[T.jsx("h2",{style:{margin:"0 0 8px"},children:"tat du combat"}),T.jsxs("div",{children:[T.jsx("strong",{children:"Round :"})," ",n.round," | ",T.jsx("strong",{children:"Phase :"})," ",n.phase==="player"?"Joueur":"Ennemis"]}),T.jsxs("div",{style:{fontSize:12,marginTop:4},children:[T.jsx("strong",{children:"Initiative PJ :"})," ",n.playerInitiative??"en cours..."]}),T.jsxs("div",{children:[T.jsx("strong",{children:"Nom :"})," ",n.sampleCharacter.nom.nomcomplet]}),T.jsxs("div",{children:[T.jsx("strong",{children:"Niveau :"})," ",n.sampleCharacter.niveauGlobal," |"," ",T.jsx("strong",{children:"Classe :"})," ",n.sampleCharacter.classe[1].classeId]}),T.jsxs("div",{children:[T.jsx("strong",{children:"PV :"})," ",n.player.hp," / ",n.player.maxHp]}),T.jsxs("div",{children:[T.jsx("strong",{children:"CA :"})," ",n.sampleCharacter.CA]}),T.jsxs("div",{style:{marginTop:8},children:[T.jsx("strong",{children:"Caracs :"})," FOR ",n.sampleCharacter.caracs.force.FOR," | DEX"," ",n.sampleCharacter.caracs.dexterite.DEX," | CON"," ",n.sampleCharacter.caracs.constitution.CON]}),T.jsxs("div",{style:{marginTop:8,fontSize:12},children:[T.jsx("strong",{children:"Trajectoire :"})," ",n.selectedPath.length===0?"aucune":`(${n.player.x}, ${n.player.y}) -> `+n.selectedPath.map(e=>`(${e.x}, ${e.y})`).join(" -> ")]}),T.jsxs("div",{style:{marginTop:8,fontSize:11,opacity:.85},children:[T.jsx("strong",{children:"IA ennemis (debug) :"}),T.jsxs("div",{children:["Dernier appel :"," ",n.aiLastState?`round ${n.aiLastState.round}, phase ${n.aiLastState.phase}`:"aucun"]}),T.jsxs("div",{children:["Dcisions reues :"," ",n.aiLastIntents===null?"n/a":`${n.aiLastIntents.length} (fallback: ${n.aiUsedFallback?"oui":"non"})`]}),n.aiLastError&&T.jsxs("div",{children:["Erreur : ",n.aiLastError]})]})]})}function Kv(n){const{enemies:e,player:t,validatedAction:i}=n;return T.jsxs("section",{style:{padding:"8px 12px",background:"#151524",borderRadius:8,border:"1px solid #333",display:"flex",flexDirection:"column",gap:8},children:[T.jsx("h2",{style:{margin:"0 0 4px"},children:"Ennemis"}),T.jsx("p",{style:{margin:0,fontSize:12,opacity:.85},children:"Chaque ennemi est une entit propre. Capacits IA : dplacement, attaque au contact, attente si aucune option."}),T.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,maxHeight:"180px",overflowY:"auto",paddingRight:4},children:e.map(o=>{var u;const a=n.revealedEnemyIds.has(o.id),c=o.enemyTypeLabel??o.enemyTypeId??"inconnu";return T.jsxs("div",{style:{background:"#0f0f19",border:"1px solid #2a2a3a",borderRadius:8,padding:"8px 10px",display:"flex",flexDirection:"column",gap:6},children:[T.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[T.jsx("strong",{style:{color:"#f5f5f5"},children:o.id}),T.jsxs("span",{style:{fontSize:12,color:"#b0b8c4"},children:["(",o.x,",",o.y,") |"," ",a?T.jsxs(T.Fragment,{children:["PV ",o.hp," / ",o.maxHp," ",o.aiRole?`(role: ${o.aiRole})`:""]}):"etat inconnu"]})]}),T.jsxs("div",{style:{fontSize:12,color:"rgba(255,255,255,0.78)"},children:["Nature : ",a?c:"inconnu"]}),T.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:n.capabilities.map(h=>T.jsx("span",{style:{background:h.color,color:"#0b0b12",borderRadius:4,padding:"2px 6px",fontSize:11,fontWeight:700},children:h.action.toUpperCase()},`${o.id}-${h.action}`))}),T.jsxs("div",{style:{fontSize:12,color:"#d0d6e0"},children:["Ce qu'il peut faire : ",n.capabilities.map(h=>h.label).join(" | ")]}),i&&((u=i.targeting)==null?void 0:u.target)==="enemy"&&(()=>{const h=n.validateEnemyTargetForAction(i,o,t,[t,...e]),f=h.ok,p=n.selectedTargetId===o.id;return T.jsx("button",{type:"button",onClick:()=>{if(!f){n.onLog(h.reason||`Cible ${o.id} invalide pour ${i.name}.`);return}n.onSelectTargetId(o.id),n.onSetTargetMode("none"),n.onLog(`Cible selectionnee: ${o.id}.`)},disabled:!f,style:{marginTop:6,alignSelf:"flex-start",padding:"4px 8px",fontSize:11,borderRadius:4,border:"none",cursor:f?"pointer":"default",background:f?"#3498db":"#555",color:"#fff",opacity:p?1:.9},children:p?"Cible actuelle":"Cibler avec l'action valide"})})(),T.jsxs("div",{style:{fontSize:12,color:"#9cb2ff"},children:["Dernire dcision IA : ",n.describeEnemyLastDecision(o.id)]})]},o.id)})})]})}function Qv(n){return T.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.75)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:T.jsxs("div",{style:{background:"#141421",borderRadius:12,border:"1px solid #f1c40f",padding:"24px 32px",maxWidth:360,textAlign:"center",boxShadow:"0 0 24px rgba(0,0,0,0.6)"},children:[T.jsx("h2",{style:{margin:"0 0 8px"},children:"Game Over"}),T.jsx("p",{style:{fontSize:13,margin:"0 0 16px"},children:"Le hros est tomb et aucun alli n'est en mesure de continuer."}),T.jsx("button",{type:"button",onClick:n.onRestart,style:{padding:"6px 12px",background:"#e67e22",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:13,fontWeight:600},children:"Recommencer le combat"})]})})}function Zv(n){return T.jsxs("div",{style:{marginBottom:8,padding:"6px 10px",background:"#111322",borderRadius:8,border:"1px solid #333",display:"flex",flexDirection:"column",gap:4,maxWidth:"100%"},children:[T.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[T.jsxs("span",{style:{fontSize:12,color:"#b0b8c4"},children:["Ordre d'initiative (round ",n.round,")"]}),n.activeEntry&&T.jsxs("span",{style:{fontSize:11,color:"#f1c40f"},children:["Tour actuel :"," ",n.activeEntry.kind==="player"?"Joueur":n.activeEntry.id]})]}),T.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",overflowX:"auto",paddingBottom:2},children:n.timelineEntries.map(e=>{const t=n.activeEntry&&e.id===n.activeEntry.id&&e.kind===n.activeEntry.kind,i=e.kind==="player",o=ah(i?"player":"enemy"),a=e.kind==="player"?n.player:n.enemies.find(h=>h.id===e.id)||null,c=a?Yt(a):!1,u=i?{svg:o,label:"PJ"}:{svg:o,label:e.id};return T.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:4,borderRadius:6,border:t?"2px solid #f1c40f":"1px solid #333",background:c?"#111118":t?"#1b1b30":"#101020",minWidth:48},children:[T.jsx("img",{src:u.svg,alt:u.label,style:{width:32,height:32,objectFit:"contain",filter:c?"grayscale(1)":i?"none":"grayscale(0.2)"}}),T.jsx("span",{style:{fontSize:10,marginTop:2,color:c?"#777a8a":"#d0d6e0",whiteSpace:"nowrap",textDecoration:c?"line-through":"none"},children:u.label}),T.jsxs("span",{style:{fontSize:9,color:"#9aa0b5"},children:["Init ",e.initiative]})]},`${e.kind}-${e.id}`)})})]})}function Jv(n){return T.jsxs("div",{style:{padding:"10px 12px",background:"linear-gradient(180deg, rgba(38, 28, 16, 0.92), rgba(16, 12, 8, 0.92))",borderRadius:14,border:"1px solid rgba(255,255,255,0.10)",boxShadow:"0 16px 50px rgba(0,0,0,0.45)",display:"flex",flexDirection:"column",gap:4,maxWidth:"100%",height:170,fontFamily:'"Iowan Old Style", "Palatino Linotype", Palatino, Garamond, "Times New Roman", serif'},children:[T.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[T.jsx("span",{style:{fontSize:13,color:"rgba(255,255,255,0.82)",fontWeight:700},children:"Chronique du tour"}),T.jsxs("span",{style:{fontSize:12,color:"rgba(255,255,255,0.65)"},children:["Round ",n.round]})]}),T.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2,flex:"1 1 auto",minHeight:0,overflowY:"auto",paddingRight:4},children:[n.narrativeLog.length===0&&T.jsx("span",{style:{fontSize:12,color:"rgba(255,255,255,0.65)"},children:"En attente d'actions pour raconter le tour..."}),n.narrativeLog.slice(0,20).map((e,t)=>T.jsxs("span",{style:{fontSize:13,color:"rgba(255,255,255,0.88)"},children:[" ",e]},t))]})]})}function e7(n){var i,o,a,c;const e=n.selectedAction,t=n.selectedAvailability;return T.jsxs("section",{style:{padding:"8px 12px",background:"#141421",borderRadius:8,border:"1px solid #333",display:"flex",flexDirection:"column",gap:8},children:[T.jsx("h2",{style:{margin:"0 0 4px"},children:"Actions dtailles"}),T.jsxs("p",{style:{margin:0,fontSize:12,opacity:.85},children:["Source: ",T.jsx("code",{children:"action-game/actions/index.json"}),". Liste charge et vrifie localement (phase, distance)."]}),T.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[T.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,maxHeight:"180px",overflowY:"auto",paddingRight:4},children:[n.actions.map(u=>{const h=n.computeActionAvailability(u),f=(e==null?void 0:e.id)===u.id,p=u.actionCost.actionType==="action"?"#8e44ad":u.actionCost.actionType==="bonus"?"#27ae60":u.actionCost.actionType==="reaction"?"#e67e22":"#2980b9",g=f?"#6c5ce7":"#2a2a3a";return T.jsxs("button",{type:"button",onClick:()=>n.onSelectActionId(u.id),style:{textAlign:"left",background:f?"#1e1e2f":"#0f0f19",color:"#f5f5f5",border:`1px solid ${g}`,borderRadius:6,padding:"8px 10px",cursor:"pointer"},children:[T.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginBottom:4,alignItems:"center"},children:[T.jsx("span",{style:{fontWeight:600},children:u.name}),T.jsx("span",{style:{fontSize:11,padding:"2px 6px",borderRadius:4,background:p,color:"#fff"},children:u.actionCost.actionType})]}),T.jsx("div",{style:{fontSize:12,opacity:.9},children:u.summary||u.category}),T.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginTop:4,fontSize:11,alignItems:"center"},children:[T.jsx("span",{style:{color:h.enabled?"#2ecc71":"#e74c3c"},children:h.enabled?"Disponible":h.reasons[0]||"Bloque"}),T.jsx("span",{style:{color:"#9aa0b5"},children:n.describeRange(u.targeting)}),T.jsx("span",{style:{color:"#9aa0b5"},children:n.describeUsage(u.usage)})]})]},u.id)}),n.actions.length===0&&T.jsx("div",{style:{fontSize:12,opacity:.8},children:"Aucune action charge pour le moment."})]}),e&&T.jsxs("div",{style:{borderTop:"1px solid #2a2a3a",paddingTop:8,display:"flex",flexDirection:"column",gap:6},children:[T.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap",fontSize:11},children:[T.jsx("span",{style:{background:"#2d2d40",color:"#d0d4f7",padding:"2px 6px",borderRadius:4},children:e.category}),(i=e.tags)==null?void 0:i.slice(0,4).map(u=>T.jsx("span",{style:{background:"#1f2a38",color:"#9bb0d6",padding:"2px 6px",borderRadius:4},children:u},u))]}),T.jsx("div",{style:{fontSize:12},children:e.summary||"Pas de rsum."}),T.jsxs("div",{style:{fontSize:12},children:[T.jsx("strong",{children:"Cot:"})," ",e.actionCost.actionType," | Mouvement"," ",e.actionCost.movementCost]}),T.jsxs("div",{style:{fontSize:12},children:[T.jsx("strong",{children:"Porte:"})," ",n.describeRange(e.targeting)]}),T.jsxs("div",{style:{fontSize:12},children:[T.jsx("strong",{children:"Usage:"})," ",n.describeUsage(e.usage)]}),T.jsxs("div",{style:{fontSize:12},children:[T.jsx("strong",{children:"Conditions:"}),T.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:4},children:[e.conditions.length===0&&T.jsx("span",{style:{color:"#9aa0b5"},children:"Aucune condition."}),e.conditions.map((u,h)=>T.jsxs("div",{style:{color:"#cfd3ec"},children:[n.conditionLabel(u),u.reason?` - ${u.reason}`:""]},`${u.type}-${h}`)),t&&T.jsxs("div",{style:{color:t.enabled?"#2ecc71":"#e74c3c"},children:["tat:"," ",t.enabled?"OK pour ce tour":t.reasons.join(" | ")||"Bloqu",t.details.length>0&&T.jsx("div",{style:{color:"#9aa0b5",marginTop:2},children:t.details.join(" / ")})]})]})]}),T.jsxs("div",{style:{fontSize:12},children:[T.jsx("strong",{children:"Effets:"}),T.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:4},children:e.effects.map((u,h)=>T.jsx("div",{style:{color:"#cfd3ec"},children:n.effectLabel(u)},`${u.type}-${h}`))})]}),T.jsxs("div",{style:{fontSize:12},children:[T.jsx("strong",{children:"Hints IA:"})," ",((o=e.aiHints)==null?void 0:o.priority)||"n/a",T.jsxs("div",{style:{color:"#9aa0b5"},children:["Success: ",((a=e.aiHints)==null?void 0:a.successLog)||"n/a"]}),T.jsxs("div",{style:{color:"#9aa0b5"},children:["Failure: ",((c=e.aiHints)==null?void 0:c.failureLog)||"n/a"]})]}),T.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[T.jsx("button",{type:"button",onClick:()=>n.onPreviewActionArea(e),style:{padding:"4px 8px",background:"#2980b9",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Prvisualiser"}),T.jsx("button",{type:"button",onClick:()=>n.onValidateAction(e),disabled:!(t!=null&&t.enabled),style:{padding:"4px 8px",background:t!=null&&t.enabled?"#2ecc71":"#555",color:"#fff",border:"none",borderRadius:4,cursor:t!=null&&t.enabled?"pointer":"default",fontSize:12},children:"Valider l'action"})]})]})]})]})}function t7(n){var e,t,i,o,a,c;return T.jsxs("section",{style:{padding:"8px 12px",background:"#141421",borderRadius:8,border:"1px solid #333",display:"flex",flexDirection:"column",gap:8},children:[T.jsx("h2",{style:{margin:"0 0 4px"},children:"Jets de ds"}),T.jsx("p",{style:{margin:0,fontSize:12,opacity:.85},children:"Choisir une action, la valider, puis lancer le jet de touche et/ou de dgts. Mode auto: enchane touche + dgts."}),T.jsxs("div",{style:{fontSize:12},children:["Action valide :"," ",n.validatedAction?`${n.validatedAction.name} (${n.validatedAction.id})`:"aucune (valider une action d'abord)"]}),T.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:["normal","advantage","disadvantage"].map(u=>T.jsx("button",{type:"button",onClick:()=>n.onSetAdvantageMode(u),style:{padding:"4px 8px",background:n.advantageMode===u?"#8e44ad":"#2c2c3a",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:u},u))}),T.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[T.jsx("button",{type:"button",onClick:n.onRollAttack,disabled:!((e=n.validatedAction)!=null&&e.attack),style:{padding:"4px 8px",background:(t=n.validatedAction)!=null&&t.attack?"#2980b9":"#555",color:"#fff",border:"none",borderRadius:4,cursor:(i=n.validatedAction)!=null&&i.attack?"pointer":"default",fontSize:12},children:"Lancer jet de touche"}),T.jsx("button",{type:"button",onClick:n.onRollDamage,disabled:!((o=n.validatedAction)!=null&&o.damage),style:{padding:"4px 8px",background:(a=n.validatedAction)!=null&&a.damage?"#27ae60":"#555",color:"#fff",border:"none",borderRadius:4,cursor:(c=n.validatedAction)!=null&&c.damage?"pointer":"default",fontSize:12},children:"Lancer dgts"}),T.jsx("button",{type:"button",onClick:n.onAutoResolve,style:{padding:"4px 8px",background:"#9b59b6",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Mode auto (touche + dgts)"})]}),T.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[T.jsxs("div",{style:{background:"#101020",borderRadius:6,padding:8,border:"1px solid #26263a"},children:[T.jsx("div",{style:{fontWeight:600,marginBottom:4,fontSize:12},children:"Jet de touche"}),n.attackRoll?T.jsxs("div",{style:{fontSize:12,lineHeight:1.4},children:["d20: ",n.attackRoll.d20.rolls.join(" / "),"  ",n.attackRoll.d20.total," | bonus"," ",n.attackRoll.bonus," | total ",n.attackRoll.total," ",n.attackRoll.isCrit?"(critique)":""]}):T.jsx("div",{style:{fontSize:12,opacity:.7},children:"Pas encore lanc."})]}),T.jsxs("div",{style:{background:"#101020",borderRadius:6,padding:8,border:"1px solid #26263a"},children:[T.jsx("div",{style:{fontWeight:600,marginBottom:4,fontSize:12},children:"Jet de dgts"}),n.damageRoll?T.jsxs("div",{style:{fontSize:12,lineHeight:1.4},children:["Ds:"," ",n.damageRoll.dice.length?n.damageRoll.dice.map(u=>u.rolls.join("+")).join(" | "):"-"," ","| mod ",n.damageRoll.flatModifier," | total ",n.damageRoll.total," ",n.damageRoll.isCrit?"(critique)":""]}):T.jsx("div",{style:{fontSize:12,opacity:.7},children:"Pas encore lanc."})]})]}),T.jsxs("div",{style:{fontSize:12},children:[T.jsx("strong",{children:"Logs des jets:"}),T.jsxs("div",{style:{marginTop:4,display:"flex",flexDirection:"column",gap:2},children:[n.diceLogs.map((u,h)=>T.jsxs("div",{style:{color:"#dfe6ff"},children:["- ",u]},h)),n.diceLogs.length===0&&T.jsx("div",{style:{color:"#9aa0b5"},children:"Aucun jet enregistr."})]})]})]})}function n7(n){return T.jsxs("section",{style:{padding:"8px 12px",background:"#141421",borderRadius:8,border:"1px solid #333",display:"flex",flexDirection:"column",gap:8},children:[T.jsx("h2",{style:{margin:"0 0 4px"},children:"Zones d'effet (demo)"}),T.jsxs("p",{style:{margin:0,fontSize:12},children:["Ces boutons utilisent les helpers de ",T.jsx("code",{children:"boardEffects.ts"})," pour dessiner des zones en coordonnes de grille autour du joueur."]}),T.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginTop:8},children:[T.jsx("button",{type:"button",onClick:n.onShowCircle,style:{padding:"4px 8px",background:"#2980b9",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Cercle R=2"}),T.jsx("button",{type:"button",onClick:n.onShowRectangle,style:{padding:"4px 8px",background:"#27ae60",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Rectangle 3x3"}),T.jsx("button",{type:"button",onClick:n.onShowCone,style:{padding:"4px 8px",background:"#c0392b",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Cne porte 4"}),T.jsx("button",{type:"button",onClick:n.onToggleVisionDebug,style:{padding:"4px 8px",background:n.showVisionDebug?"#f1c40f":"#555",color:"#0b0b12",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:n.showVisionDebug?"Masquer vision":"Afficher vision"}),T.jsx("button",{type:"button",onClick:n.onClear,style:{padding:"4px 8px",background:"#7f8c8d",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Effacer zones"})]})]})}function r7(n){return T.jsxs("section",{style:{padding:"8px 12px",background:"#141421",borderRadius:8,border:"1px solid #333",flex:"1 1 auto",display:"flex",flexDirection:"column"},children:[T.jsx("h2",{style:{margin:"0 0 8px"},children:"Log"}),T.jsx("div",{style:{flex:"1 1 auto",overflowY:"auto",fontSize:12,lineHeight:1.4},children:n.log.map((e,t)=>T.jsxs("div",{children:["- ",e]},t))})]})}function ba(n,e){return{x:Math.cos(e)*n,y:Math.sin(e)*n}}function u0(n,e,t,i,o){const a=ba(n,t);return`A ${n} ${n} 0 ${i} ${o} ${a.x} ${a.y}`}function i7(n,e,t,i){const o=Math.abs(i-t)>=Math.PI*2-1e-6,a=i-t,c=o||Math.abs(a)>Math.PI?1:0,u=a>=0?1:0,h=u===1?0:1,f=ba(e,t),p=ba(n,i),g=ba(n,t);return[`M ${f.x} ${f.y}`,u0(e,t,i,c,u),`L ${p.x} ${p.y}`,u0(n,i,t,c,h),`L ${g.x} ${g.y}`,"Z"].join(" ")}function s7(n){if(!n.open)return null;const e=n.size??240,t=e/2,i=t,o=Math.max(44,Math.floor(i*.42)),a=o-6,c=Math.max(1,n.items.length),u=Math.PI*2/c,h=-Math.PI/2,f=n.centerLabel??"Annuler",p=n.onCenterClick??n.onClose,g=typeof n.sliceOpacity=="number"?n.sliceOpacity:1,v=typeof n.centerOpacity=="number"?n.centerOpacity:1;return T.jsx("div",{style:{position:"absolute",left:n.anchorX,top:n.anchorY,width:e,height:e,transform:"translate(-50%, -50%)",zIndex:50,pointerEvents:"auto",userSelect:"none"},onMouseDown:x=>{x.preventDefault(),x.stopPropagation()},onClick:x=>{x.preventDefault(),x.stopPropagation()},children:T.jsxs("svg",{width:e,height:e,viewBox:`${-t} ${-t} ${e} ${e}`,children:[T.jsx("defs",{children:T.jsx("filter",{id:"wheelShadow",x:"-30%",y:"-30%",width:"160%",height:"160%",children:T.jsx("feDropShadow",{dx:"0",dy:"10",stdDeviation:"14",floodOpacity:"0.35"})})}),T.jsxs("g",{filter:"url(#wheelShadow)",children:[n.items.map((x,w)=>{const S=h+w*u,b=h+(w+1)*u,k=(S+b)/2,A=ba((o+i)/2,k),M=i7(o,i,S,b),E=!!x.disabled,B=E&&x.disabledReason?x.disabledReason:E?"Indisponible":void 0;return T.jsxs("g",{children:[T.jsx("path",{d:M,fill:E?"rgba(90, 90, 100, 0.75)":x.color,stroke:"rgba(255,255,255,0.22)",strokeWidth:1,style:{cursor:E?"not-allowed":"pointer",transition:"filter 120ms ease, opacity 120ms ease"},opacity:(E?.55:.95)*Math.max(0,Math.min(1,g)),onClick:F=>{var I;F.preventDefault(),F.stopPropagation(),!E&&((I=x.onSelect)==null||I.call(x))},children:B?T.jsx("title",{children:B}):null}),T.jsx("text",{x:A.x,y:A.y,textAnchor:"middle",dominantBaseline:"middle",style:{fill:E?"rgba(255,255,255,0.6)":"rgba(255,255,255,0.92)",fontSize:12,fontWeight:700,letterSpacing:.2,pointerEvents:"none"},children:x.label})]},x.id)}),T.jsx("circle",{cx:0,cy:0,r:a,fill:"rgba(10,10,16,0.92)",stroke:"rgba(255,255,255,0.18)",strokeWidth:1,opacity:Math.max(0,Math.min(1,v)),style:{cursor:"pointer"},onClick:x=>{x.preventDefault(),x.stopPropagation(),p()}}),T.jsx("text",{x:0,y:0,textAnchor:"middle",dominantBaseline:"middle",style:{fill:"rgba(255,255,255,0.9)",fontSize:12,fontWeight:800,pointerEvents:"none"},children:f})]})]})})}function o7(n){const e=n.toLowerCase();return e==="attack"?"Attaque":e==="movement"?"Mouvement":e==="support"?"Support":e==="defense"?"Defense":e==="item"?"Objet":e==="reaction"?"Reaction":n}function a7(n){const e=n.toLowerCase();return e==="attack"?"#e74c3c":e==="movement"?"#2ecc71":e==="support"?"#3498db":e==="defense"?"#9b59b6":e==="item"?"#f1c40f":e==="reaction"?"#e67e22":"#7f8c8d"}function l7(n){const[e,t]=ee.useState("root"),[i,o]=ee.useState(null),a=n.actions.length>7,c=ee.useMemo(()=>{const p=new Set;for(const g of n.actions)p.add(g.category);return Array.from(p).sort((g,v)=>g.localeCompare(v))},[n.actions]);ee.useEffect(()=>{n.open||(t("root"),o(null))},[n.open]);const u=ee.useMemo(()=>{if(e==="categories")return[{id:"all",label:"Toutes",color:"#34495e",onSelect:()=>{o(null),t("actions")}},...c.map(x=>({id:`cat-${x}`,label:o7(x),color:a7(x),onSelect:()=>{o(x),t("actions")}}))];if(e==="actions")return(i?n.actions.filter(x=>x.category===i):n.actions).map(x=>{const S=n.computeActionAvailability(x).enabled;return{id:`action-${x.id}`,label:x.name,color:S?"#2ecc71":"#e74c3c",onSelect:()=>{n.onPickAction(x),t("root"),o(null)}}});if(e==="inspect"){const v=n.canInteractWithBoard&&n.hasCell,x=n.canInteractWithBoard?n.hasCell?"Indisponible":"Aucune case":"Tour joueur requis";return[{id:"inspect-cell",label:"Inspecter (10)",color:"#3498db",disabled:!v,disabledReason:x,onSelect:()=>{n.onInspectCell(),t("root")}},{id:"look",label:"Tourner regard",color:"#1abc9c",disabled:!v,disabledReason:x,onSelect:()=>{n.onLook(),t("root")}}]}const p=n.canInteractWithBoard,g=n.selectedPathLength>0;return[{id:"move",label:"Deplacer",color:"#2ecc71",disabled:!p,disabledReason:"Tour joueur requis",onSelect:n.onEnterMoveMode},{id:"action",label:"Action",color:"#e74c3c",disabled:!n.canInteractWithBoard,disabledReason:"Tour joueur requis",onSelect:()=>{if(a){t("categories");return}t("actions")}},{id:"validate-move",label:"Valider",color:"#f1c40f",disabled:!n.canInteractWithBoard||!g,disabledReason:g?"Tour joueur requis":"Aucun trajet",onSelect:n.onValidateMove},{id:"reset-move",label:"Annuler trajet",color:"#e67e22",disabled:!n.canInteractWithBoard||!g,disabledReason:g?"Tour joueur requis":"Aucun trajet",onSelect:n.onResetMove},{id:"inspect",label:"Inspecter",color:"#3498db",disabled:!n.hasCell||!n.canInteractWithBoard,disabledReason:n.canInteractWithBoard?"Aucune case":"Tour joueur requis",onSelect:()=>t("inspect")},{id:"interact",label:"Interagir",color:"#9b59b6",disabled:!n.canInteractWithBoard,disabledReason:"Tour joueur requis",onSelect:n.onInteract},{id:"hide",label:"Se cacher",color:"#34495e",disabled:!n.canInteractWithBoard,disabledReason:"Tour joueur requis",onSelect:n.onHide},{id:"end-turn",label:"Fin tour",color:"#ff7f50",disabled:!n.canInteractWithBoard||n.isResolvingEnemies,disabledReason:n.isResolvingEnemies?"Tour des ennemis en cours":"Tour joueur requis",onSelect:n.onEndTurn}]},[c,n,i,a,e]),{centerLabel:h,onCenterClick:f}=ee.useMemo(()=>e==="root"?{centerLabel:"Annuler",onCenterClick:n.onClose}:e==="categories"?{centerLabel:"Retour",onCenterClick:()=>t("root")}:e==="inspect"?{centerLabel:"Retour",onCenterClick:()=>t("root")}:e==="actions"&&a?{centerLabel:"Retour",onCenterClick:()=>t("categories")}:{centerLabel:"Retour",onCenterClick:()=>t("root")},[n.onClose,a,e]);return T.jsx(s7,{open:n.open,anchorX:n.anchorX,anchorY:n.anchorY,items:u,onClose:n.onClose,size:n.size,centerLabel:h,onCenterClick:f,sliceOpacity:.65,centerOpacity:.6})}function fc(n,e,t){return Math.max(e,Math.min(t,n))}function c7(n){return n==="action"?"#8e44ad":n==="bonus"?"#27ae60":n==="reaction"?"#e67e22":"#2980b9"}function u7(n){var x,w,S,b,k,A,M;const e=ee.useRef(null),[t,i]=ee.useState({left:16,top:16}),o=ee.useRef(null),a=ee.useRef(!1),[c,u]=ee.useState(!1),h=n.action,f=n.availability,p=f?!f.enabled:!1;ee.useLayoutEffect(()=>{if(!n.open||a.current)return;const E=e.current;if(!E)return;const B=E.parentElement;if(!B)return;const F=B.getBoundingClientRect(),I=E.getBoundingClientRect(),N=n.anchorX+18,U=n.anchorY+18,q=fc(N,8,Math.max(8,F.width-I.width-8)),H=fc(U,8,Math.max(8,F.height-I.height-8));i({left:q,top:H})},[n.anchorX,n.anchorY,n.open,h==null?void 0:h.id]),ee.useEffect(()=>{n.open&&(a.current=!1)},[n.open,h==null?void 0:h.id]),ee.useEffect(()=>{if(!c)return;const E=F=>{const I=e.current,N=o.current;if(!I||!N)return;const U=I.parentElement;if(!U)return;const q=U.getBoundingClientRect(),H=I.getBoundingClientRect(),se=F.clientX-N.startClientX,Z=F.clientY-N.startClientY,Q=N.startLeft+se,ae=N.startTop+Z,G=fc(Q,8,Math.max(8,q.width-H.width-8)),V=fc(ae,8,Math.max(8,q.height-H.height-8));a.current=!0,i({left:G,top:V})},B=()=>{u(!1),o.current=null};return window.addEventListener("pointermove",E),window.addEventListener("pointerup",B,{once:!0}),()=>{window.removeEventListener("pointermove",E)}},[c]);const v=!!(((x=h==null?void 0:h.targeting)==null?void 0:x.target)==="enemy");return!n.open||!h?null:T.jsxs("div",{ref:e,onMouseDown:E=>E.stopPropagation(),style:{position:"absolute",left:t.left,top:t.top,zIndex:60,width:360,maxWidth:"min(92vw, 420px)",background:"rgba(10, 10, 16, 0.92)",border:"1px solid rgba(255,255,255,0.14)",borderRadius:12,padding:12,boxShadow:"0 18px 60px rgba(0,0,0,0.55)",backdropFilter:"blur(8px)"},children:[T.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10,alignItems:"flex-start"},children:[T.jsxs("div",{onPointerDown:E=>{E.button!==0||!e.current||(E.preventDefault(),E.stopPropagation(),o.current={startClientX:E.clientX,startClientY:E.clientY,startLeft:t.left,startTop:t.top},u(!0))},style:{minWidth:0,flex:"1 1 auto",cursor:c?"grabbing":"grab",userSelect:"none"},title:"Glisser pour deplacer",children:[T.jsx("div",{style:{fontSize:13,fontWeight:900,color:"#fff"},children:h.name}),T.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:6},children:[T.jsx("span",{style:{fontSize:11,padding:"2px 6px",borderRadius:6,background:c7(h.actionCost.actionType),color:"#fff",fontWeight:800},children:h.actionCost.actionType}),T.jsx("span",{style:{fontSize:11,padding:"2px 6px",borderRadius:6,background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.12)",color:"rgba(255,255,255,0.85)",fontWeight:700},children:h.category}),T.jsx("span",{style:{fontSize:11,padding:"2px 6px",borderRadius:6,background:p?"rgba(231,76,60,0.25)":"rgba(46,204,113,0.18)",border:`1px solid ${p?"rgba(231,76,60,0.55)":"rgba(46,204,113,0.45)"}`,color:p?"#ffb2aa":"#bdf6d2",fontWeight:800},children:f?f.enabled?"Disponible":"Bloquee":"Etat inconnu"})]})]}),T.jsx("button",{type:"button",onClick:()=>{n.onClose()},style:{width:32,height:32,borderRadius:10,border:"1px solid rgba(255,255,255,0.14)",background:"rgba(255,255,255,0.06)",color:"rgba(255,255,255,0.85)",cursor:"pointer",fontWeight:900,flex:"0 0 auto"},title:"Fermer",children:""})]}),T.jsx("div",{style:{marginTop:10,fontSize:12,color:"rgba(255,255,255,0.82)"},children:h.summary||"Aucun resume."}),f&&!f.enabled&&T.jsxs("div",{style:{marginTop:10},children:[T.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#ffb2aa"},children:"Pourquoi c'est bloque"}),T.jsx("ul",{style:{margin:"6px 0 0",paddingLeft:18,color:"rgba(255,255,255,0.85)",fontSize:12},children:f.reasons.map((E,B)=>T.jsx("li",{children:E},B))})]}),T.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[n.stage==="draft"&&T.jsx("button",{type:"button",onClick:()=>{n.onValidateAction(h)},disabled:!!(f&&!f.enabled),style:{padding:"6px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:f!=null&&f.enabled?"#2ecc71":"rgba(90, 90, 100, 0.55)",color:f!=null&&f.enabled?"#0b0b12":"rgba(255,255,255,0.75)",cursor:f!=null&&f.enabled?"pointer":"not-allowed",fontSize:12,fontWeight:900},title:f!=null&&f.enabled?"Valider l'action":"Action indisponible",children:"Valider"}),n.stage==="active"&&T.jsx("span",{style:{fontSize:12,color:"rgba(255,255,255,0.70)"},children:"Action validee: suivez les etapes ci-dessous."})]}),v&&T.jsxs("div",{style:{marginTop:12},children:[T.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,alignItems:"center"},children:[T.jsx("div",{style:{fontSize:12,fontWeight:900,color:"#fff"},children:"Cible"}),T.jsx("button",{type:"button",onClick:()=>{n.stage==="active"&&n.onSetTargetMode("selecting")},disabled:n.stage!=="active",style:{padding:"4px 8px",borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:n.stage==="active"?"rgba(255,255,255,0.06)":"rgba(90, 90, 100, 0.35)",color:"#fff",cursor:n.stage==="active"?"pointer":"not-allowed",fontSize:12,fontWeight:800},children:"Selectionner cible"})]}),T.jsxs("div",{style:{marginTop:6,fontSize:12,color:"rgba(255,255,255,0.80)"},children:["Cible selectionnee:"," ",T.jsx("strong",{children:n.selectedTargetId?n.selectedTargetId:"aucune"}),n.targetMode==="selecting"&&n.stage==="active"&&T.jsx("span",{style:{marginLeft:8,color:"#cfd3ff"},children:"(clique un ennemi)"})]}),n.stage!=="active"&&T.jsx("div",{style:{marginTop:6,fontSize:12,color:"rgba(255,255,255,0.70)"},children:"Validez l'action pour pouvoir selectionner une cible sur la grille."})]}),n.stage==="active"&&T.jsxs("div",{style:{marginTop:12},children:[T.jsx("div",{style:{fontSize:12,fontWeight:900,color:"#fff",marginBottom:6},children:"Jets"}),T.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:["normal","advantage","disadvantage"].map(E=>T.jsx("button",{type:"button",onClick:()=>n.onSetAdvantageMode(E),style:{padding:"4px 8px",background:n.advantageMode===E?"#8e44ad":"rgba(255,255,255,0.06)",color:"#fff",border:"1px solid rgba(255,255,255,0.12)",borderRadius:10,cursor:"pointer",fontSize:12,fontWeight:800},children:E},E))}),T.jsxs("div",{style:{marginTop:8,display:"flex",gap:8,flexWrap:"wrap"},children:[T.jsx("button",{type:"button",onClick:n.onRollAttack,disabled:!((w=n.validatedAction)!=null&&w.attack),style:{padding:"6px 10px",background:(S=n.validatedAction)!=null&&S.attack?"#2980b9":"rgba(90, 90, 100, 0.55)",color:"#fff",border:"1px solid rgba(255,255,255,0.12)",borderRadius:10,cursor:(b=n.validatedAction)!=null&&b.attack?"pointer":"not-allowed",fontSize:12,fontWeight:900},children:"Jet de touche"}),T.jsx("button",{type:"button",onClick:n.onRollDamage,disabled:!((k=n.validatedAction)!=null&&k.damage),style:{padding:"6px 10px",background:(A=n.validatedAction)!=null&&A.damage?"#27ae60":"rgba(90, 90, 100, 0.55)",color:"#fff",border:"1px solid rgba(255,255,255,0.12)",borderRadius:10,cursor:(M=n.validatedAction)!=null&&M.damage?"pointer":"not-allowed",fontSize:12,fontWeight:900},children:"Degats"}),T.jsx("button",{type:"button",onClick:n.onAutoResolve,style:{padding:"6px 10px",background:"#9b59b6",color:"#fff",border:"1px solid rgba(255,255,255,0.12)",borderRadius:10,cursor:"pointer",fontSize:12,fontWeight:900},children:"Auto"})]}),T.jsxs("div",{style:{marginTop:10,display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[T.jsxs("div",{style:{padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.04)"},children:[T.jsx("div",{style:{fontSize:11,fontWeight:900,color:"rgba(255,255,255,0.85)"},children:"Touche"}),T.jsx("div",{style:{fontSize:12,color:"rgba(255,255,255,0.85)",marginTop:4},children:n.attackRoll?`${n.attackRoll.total}${n.attackRoll.isCrit?" (crit)":""}`:"-"})]}),T.jsxs("div",{style:{padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.04)"},children:[T.jsx("div",{style:{fontSize:11,fontWeight:900,color:"rgba(255,255,255,0.85)"},children:"Degats"}),T.jsx("div",{style:{fontSize:12,color:"rgba(255,255,255,0.85)",marginTop:4},children:n.damageRoll?`${n.damageRoll.total}${n.damageRoll.isCrit?" (crit)":""}`:"-"})]})]}),n.diceLogs.length>0&&T.jsxs("div",{style:{marginTop:10},children:[T.jsx("div",{style:{fontSize:11,fontWeight:900,color:"rgba(255,255,255,0.75)"},children:"Derniers jets"}),T.jsx("div",{style:{marginTop:4,display:"flex",flexDirection:"column",gap:3},children:n.diceLogs.slice(-4).map((E,B)=>T.jsxs("div",{style:{fontSize:11,color:"rgba(255,255,255,0.78)"},children:["- ",E]},B))})]})]})]})}function d7(n){var g;const e=ee.useMemo(()=>n.tabs.filter(v=>!v.hidden),[n.tabs]),t=n.defaultTabId??((g=e[0])==null?void 0:g.id)??"tab",i=n.collapsible??!0,o=n.collapsedByDefault??!0,[a,c]=ee.useState(o&&i?null:t);ee.useEffect(()=>{a!==null&&(e.some(v=>v.id===a)||c(t))},[a,t,e]);const u=a?e.find(v=>v.id===a):void 0,h=n.expandedHeight??320,f=n.collapsedHeight??52,p=a!==null;return T.jsxs("div",{style:{flex:`0 0 ${p?h:f}px`,display:"flex",flexDirection:"column",minHeight:0,background:"rgba(12, 12, 18, 0.9)",border:"1px solid rgba(255,255,255,0.10)",borderRadius:14,boxShadow:"0 18px 60px rgba(0,0,0,0.45)"},children:[T.jsx("div",{style:{display:"flex",gap:8,padding:"10px 10px 0 10px",flexWrap:"wrap"},children:e.map(v=>{const x=v.id===a;return T.jsx("button",{type:"button",onClick:()=>{if(!i){c(v.id);return}c(w=>w===v.id?null:v.id)},style:{padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:x?"rgba(255,255,255,0.10)":"rgba(255,255,255,0.05)",color:x?"#fff":"rgba(255,255,255,0.75)",cursor:"pointer",fontSize:12,fontWeight:700},children:v.label},v.id)})}),p&&T.jsx("div",{style:{padding:10,minHeight:0,flex:"1 1 auto",overflow:"hidden"},children:T.jsx("div",{style:{width:"100%",height:"100%",overflow:"auto",paddingRight:4},children:u==null?void 0:u.content})})]})}const h7={"./melee-strike.json":Yx,"./dash.json":s3,"./second-wind.json":y3,"./throw-dagger.json":R3,"./enemy-move.json":H3,"./enemy-melee-strike.json":r5,"./enemy-bow-shot.json":y5},f7={"./brute.json":A2,"./archer.json":j2,"./assassin.json":X2,"./ghost.json":sy};function p7(){const n=Array.isArray(W1.types)?W1.types:[],e=[];for(const t of n){const i=f7[t];i?e.push(i):console.warn("[enemy-types] Type path missing in bundle:",t)}return e.length===0&&console.warn("[enemy-types] No enemy types loaded from index.json"),e}function m7(n,e,t){const{x:i,y:o}=t,a=e.baseStats;return{id:`enemy-${n+1}`,type:"enemy",enemyTypeId:e.id,enemyTypeLabel:e.label,aiRole:e.aiRole,actionIds:Array.isArray(e.actions)?e.actions:null,speechProfile:e.speechProfile??null,moveRange:a.moveRange,attackDamage:a.attackDamage,attackRange:typeof a.attackRange=="number"?a.attackRange:1,maxAttacksPerTurn:typeof a.maxAttacksPerTurn=="number"?a.maxAttacksPerTurn:1,armorClass:a.armorClass,movementProfile:e.movement?e.movement:{type:"ground",speed:e.baseStats.moveRange,canPassThroughWalls:!1,canPassThroughEntities:!1,canStopOnOccupiedTile:!1},facing:"left",visionProfile:e.vision?e.vision:{shape:"cone",range:5},x:i,y:o,hp:a.hp,maxHp:a.hp}}const g7=[{action:"move",label:"Se deplacer jusqu'a 3 cases (Manhattan)",color:"#2ecc71"},{action:"attack",label:"Attaque le joueur a distance 1 (2 degats)",color:"#e74c3c"},{action:"wait",label:"Attend si aucune action viable",color:"#7f8c8d"}],y7=()=>{const n=ee.useRef(null),e=ee.useRef(!1),t=ee.useRef(null),[i,o]=ee.useState([]),[a,c]=ee.useState([]),[u,h]=ee.useState([]),[f,p]=ee.useState({id:"player-1",type:"player",x:0,y:Math.floor(Qs/2),facing:"right",visionProfile:{shape:"cone",range:5},hp:$r.pvActuels,maxHp:$r.pvMax}),[g,v]=ee.useState([]),[x,w]=ee.useState([]),[S,b]=ee.useState([]),[k,A]=ee.useState([]),[M,E]=ee.useState(null),[B,F]=ee.useState({cols:La,rows:Qs}),[I,N]=ee.useState("player"),[U,q]=ee.useState(1),[H,se]=ee.useState(!1),[Z,Q]=ee.useState(!1),[ae,G]=ee.useState(null),[V,te]=ee.useState([]),[Y,ie]=ee.useState(0),[L,K]=ee.useState(!1),[ve,Pe]=ee.useState(3),[Ee,Re]=ee.useState(""),De=.5,Le=2.5,Ue=.1,[Ke,Mn]=ee.useState(1),[vn,sn]=ee.useState({x:0,y:0}),[on,an]=ee.useState(!1),rr=ee.useRef(null),{obstacleLayerRef:Nr,tokenLayerRef:ts,pathLayerRef:ns,speechLayerRef:yi,viewportRef:Wr,pixiReadyTick:Hr}=Wv({enabled:L,containerRef:n,zoom:Ke,panX:vn.x,panY:vn.y,playableCells:M,grid:B}),[ao,Oa]=ee.useState([]),[_r,Na]=ee.useState([]),[lo,Ur]=ee.useState(null),[rs,xi]=ee.useState(null),[wr,Wa]=ee.useState("normal"),[Pn,is]=ee.useState(null),[Ha,Gr]=ee.useState(null),[ss,co]=ee.useState([]),[uo,vi]=ee.useState(!1),[Dn,ir]=ee.useState({usedAction:!1,usedBonus:!1}),[_i,os]=ee.useState({turn:{},encounter:{}}),[ho,fo]=ee.useState({"bandolier:dagger":3}),[po,wi]=ee.useState(5),[Bt,sr]=ee.useState([]),[St,On]=ee.useState(null),[as,qt]=ee.useState("none"),[Nn,Kt]=ee.useState("idle"),[mo,Ua]=ee.useState(()=>new Set),[Th,Ga]=ee.useState(()=>new Set),[Oe,go]=ee.useState(null),[Et,yo]=ee.useState(null),[Va,Wn]=ee.useState([]),[xo,Ya]=ee.useState(!1),[$c,Lc]=ee.useState(null),[xt,Mh]=ee.useState(null),[bi,vo]=ee.useState(null),[ls,Xa]=ee.useState(null),[_o,or]=ee.useState(!1),[ut,zc]=ee.useState(!1);Uv({obstacleLayerRef:Nr,obstacleTypes:S,obstacles:k,pixiReadyTick:Hr,grid:B}),Yv({tokenLayerRef:ts,player:f,enemies:x,pixiReadyTick:Hr,grid:B}),Vv({speechLayerRef:yi,player:f,enemies:x,speechBubbles:u,pixiReadyTick:Hr,grid:B}),Gv({pathLayerRef:ns,player:f,enemies:x,selectedPath:Bt,effectSpecs:Va,selectedTargetId:St,showVisionDebug:xo,pixiReadyTick:Hr,playableCells:M,grid:B});const Qt=10;function ln(){go(C=>C?{...C,open:!1}:null)}function wo(C,z){return`${C},${z}`}function bo(C,z){return za(C,z,B.cols,B.rows)?!M||M.size===0?!0:M.has(wo(C,z)):!1}const Rt=ee.useMemo(()=>fx(S,k),[S,k]);function Si(C,z){return`${z??"default"}:${C}`}function Vr(C,z){const D=Si(C,z);return typeof ho[D]=="number"?ho[D]:0}ee.useEffect(()=>{(I!=="player"||ut)&&(Kt("idle"),ln())},[I,ut]),ee.useEffect(()=>{const C=z=>{if(z.key==="Escape"){if(Oe!=null&&Oe.open){ln();return}if(as==="selecting"){qt("none");return}Nn!=="idle"&&Kt("idle")}};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[Oe==null?void 0:Oe.open,Nn,as]);function cs(C){var D,X;if(_o)return"Fallback local : action engine";if(bi===null)return"IA non appelee pour l'instant";const z=bi.find(le=>le.enemyId===C);return z?((D=z.target)==null?void 0:D.kind)==="cell"?`${z.actionId} -> (${z.target.x}, ${z.target.y})`:((X=z.target)==null?void 0:X.kind)==="token"?`${z.actionId} -> ${z.target.tokenId}`:z.actionId:"Aucun intent recu pour cet ennemi"}function Fc(){if(g.length===0){ue("Aucun type d'ennemi charge (enemyTypes). Impossible de generer le combat.");return}let C={...B},z=G1({prompt:Ee,grid:C,enemyCount:ve,enemyTypes:g,obstacleTypes:S});const D=z.recommendedGrid;D&&(D.cols>C.cols||D.rows>C.rows)&&(ue(`[map] Redimensionnement automatique: ${C.cols}x${C.rows} -> ${D.cols}x${D.rows} (${D.reason}).`),C={cols:D.cols,rows:D.rows},z=G1({prompt:Ee,grid:C,enemyCount:ve,enemyTypes:g,obstacleTypes:S})),ue(z.summary),F(C),p(le=>({...le,x:z.playerStart.x,y:z.playerStart.y})),A(z.obstacles),E(new Set(z.playableCells??[]));const X=z.enemySpawns.map((le,Ie)=>m7(Ie,le.enemyType,le.position));w(X),Ua(new Set),Ga(new Set),q(1),Q(!1),te([]),ie(0),K(!0),os({turn:{},encounter:{}}),ir({usedAction:!1,usedBonus:!1}),fo({"bandolier:dagger":3}),wi(5)}function So(){if(!Z||V.length===0)return null;const C=Y>=0&&Y<V.length?Y:0;return V[C]??null}function ko(){if(!Z||V.length===0)return{entry:null,willWrap:!1};const C=(Y+1)%V.length;return{entry:V[C]??null,willWrap:C===0}}function us(){V.length!==0&&ie(C=>{const z=(C+1)%V.length;return z===0&&q(D=>D+1),z})}function Co(){if(Z)return;const C=$r.caracs.dexterite.modDEX??0,z=()=>Math.floor(Math.random()*20)+1,D=z(),X=D+C,le=[];le.push({id:f.id,kind:"player",initiative:X});const Ie=x.map(we=>{const pe=z();return le.push({id:we.id,kind:"enemy",initiative:pe}),{...we,initiative:pe}});G(X),w(Ie),le.sort((we,Ae)=>Ae.initiative-we.initiative),te(le),ie(0),Q(!0);const de=le[0];de&&(de.kind==="player"?ue(`Initiative: Joueur ${X} (d20=${D}, mod=${C})  le joueur commence.`):ue(`Initiative: Joueur ${X} (d20=${D}, mod=${C})  ${de.id} commence (initiative ${de.initiative}).`))}function ue(C){o(z=>[C,...z].slice(0,12))}function qa(C){c(z=>[C,...z].slice(0,20))}function Yr(C){co(z=>[C,...z].slice(0,6)),ue(C)}function Xe(C,z){const D=(z??"").trim();D&&h(X=>[...X.filter(Ie=>Ie.tokenId!==C),{tokenId:C,text:D,updatedAtRound:U}])}function Ka(C){h(z=>z.filter(D=>D.tokenId!==C))}function ds(C){const z=(C??"").trim();z&&(t.current!==null&&(window.clearTimeout(t.current),t.current=null),h(D=>[...D.filter(le=>le.tokenId!==f.id),{tokenId:f.id,text:z,updatedAtRound:U}]),t.current=window.setTimeout(()=>{h(D=>D.filter(X=>X.tokenId!==f.id))},2600))}function hs(C,z,D){const X=[{id:z.id,kind:"player",label:"Heros",aiRole:null,enemyTypeId:null,x:z.x,y:z.y,hp:z.hp,maxHp:z.maxHp},...D.map(le=>({id:le.id,kind:"enemy",label:le.enemyTypeLabel||le.enemyTypeId||le.id,aiRole:le.aiRole??null,enemyTypeId:le.enemyTypeId??null,x:le.x,y:le.y,hp:le.hp,maxHp:le.maxHp}))];return{round:U,phase:C,grid:{cols:B.cols,rows:B.rows},actors:X}}function Qa(C){return hs(C,f,x)}ee.useEffect(()=>{const C=p7();v(C)},[]),ee.useEffect(()=>{const C=sx();b(C)},[]),ee.useEffect(()=>{L&&!Z&&x.length>0&&Co()},[L,Z,x.length]),ee.useEffect(()=>{h(C=>C.filter(z=>z.tokenId===f.id||x.some(D=>D.id===z.tokenId&&D.hp>0)))},[x,f.id]),ee.useEffect(()=>{const C=Array.isArray(V1.actions)?V1.actions:[],z=[];for(const X of C){const le=h7[X];le?z.push(le):console.warn("[actions] Action path missing in bundle:",X)}z.length===0&&console.warn("[actions] No actions loaded from index.json"),Oa(z);const D=z.filter(X=>!(X.tags||[]).includes("enemy"));Na(D),Ur(D.length?D[0].id:null)},[]),ee.useEffect(()=>{if(!L||!Z)return;const C=So();if(C){if(C.kind==="player"){N("player"),ir({usedAction:!1,usedBonus:!1}),os(z=>({...z,turn:{}})),wi(5),vi(!1),is(null),Gr(null),e.current=!1,T5(U,Qa("player")),kn({round:U,phase:"player",kind:"turn_start",actorId:f.id,actorKind:"player",summary:`Debut du tour du heros (round ${U}).`});return}H||(N("enemies"),Bc(C.id))}},[L,Z,V,Y,H]);function fs(){if(x.length===0)return null;let C=null;for(const z of x){const D=di(f,z);(C===null||D<C)&&(C=D)}return C}function Ao(C,z,D,X){if(z.type!=="enemy")return{ok:!1,reason:"La cible selectionnee n'est pas un ennemi."};if(z.hp<=0)return{ok:!1,reason:"La cible est deja a terre."};const le=C.targeting;if(!le||le.target!=="enemy")return{ok:!1,reason:"Cette action ne cible pas un ennemi."};const Ie=di(D,z),de=le.range;if(de){if(typeof de.min=="number"&&Ie<de.min)return{ok:!1,reason:`Cible trop proche pour ${C.name} (distance ${Ie}, min ${de.min}).`};if(typeof de.max=="number"&&Ie>de.max)return{ok:!1,reason:`Cible hors portee pour ${C.name} (distance ${Ie}, max ${de.max}).`}}for(const we of C.conditions||[]){if(we.type==="distance_max"&&typeof we.max=="number"&&Ie>we.max)return{ok:!1,reason:we.reason||`Distance cible > ${we.max}.`};if(we.type==="distance_between"){const Ae=typeof we.min=="number"?we.min:typeof(de==null?void 0:de.min)=="number"?de.min:null,pe=typeof we.max=="number"?we.max:typeof(de==null?void 0:de.max)=="number"?de.max:null;if(Ae!==null&&Ie<Ae)return{ok:!1,reason:we.reason||`Distance cible < ${Ae}.`};if(pe!==null&&Ie>pe)return{ok:!1,reason:we.reason||`Distance cible > ${pe}.`}}if(we.type==="target_alive"&&z.hp<=0)return{ok:!1,reason:we.reason||"La cible doit avoir des PV restants."}}if(le.requiresLos){if(!_c(D,z,X,Rt.vision,M))return{ok:!1,reason:"Cible hors du champ de vision ou derriere un obstacle (ligne de vue requise)."};if(!ka({x:D.x,y:D.y},{x:z.x,y:z.y},Rt.attacks))return{ok:!1,reason:"Trajectoire bloquee (obstacle entre l'attaquant et la cible)."}}return{ok:!0}}function br(C){var pe,Ge,Ze,dt,_e,Se;const z=[],D=[];I!=="player"&&z.push("Action bloquee pendant le tour des ennemis.");const X=(pe=C.actionCost)==null?void 0:pe.actionType;X==="action"&&Dn.usedAction&&z.push("Action principale deja utilisee ce tour."),X==="bonus"&&Dn.usedBonus&&z.push("Action bonus deja utilisee ce tour.");const le=typeof _i.turn[C.id]=="number"?_i.turn[C.id]:0,Ie=typeof _i.encounter[C.id]=="number"?_i.encounter[C.id]:0;typeof((Ge=C.usage)==null?void 0:Ge.perTurn)=="number"&&(D.push(`Usages/tour: ${le}/${C.usage.perTurn}`),le>=C.usage.perTurn&&z.push("Limite d'usage atteinte pour ce tour.")),typeof((Ze=C.usage)==null?void 0:Ze.perEncounter)=="number"&&(D.push(`Usages/rencontre: ${Ie}/${C.usage.perEncounter}`),Ie>=C.usage.perEncounter&&z.push("Limite d'usage atteinte pour la rencontre."));const de=(dt=C.usage)==null?void 0:dt.resource;if(de!=null&&de.name&&typeof de.min=="number"){const Te=Vr(de.name,de.pool);if(Te<de.min){const We=de.pool?` (${de.pool})`:"";z.push(`Ressource insuffisante: ${de.name}${We} (${Te}/${de.min}).`)}}const we=(_e=C.targeting)==null?void 0:_e.target,Ae=(Se=C.targeting)==null?void 0:Se.range;if(we==="enemy"){const Te=fs();Te===null?z.push("Aucune cible ennemie presente."):(D.push(`Distance mini ennemie: ${Te}`),typeof(Ae==null?void 0:Ae.min)=="number"&&Te<Ae.min&&z.push(`Trop proche (< ${Ae.min}).`),typeof(Ae==null?void 0:Ae.max)=="number"&&Te>Ae.max&&z.push(`Hors portee (> ${Ae.max}).`))}for(const Te of C.conditions||[]){if(Te.type==="phase"&&Te.mustBe&&Te.mustBe!==I&&z.push(Te.reason||"Phase incorrecte."),Te.type==="stat_below_percent"&&Te.who==="self"&&Te.stat==="hp"){const We=Math.max(1,f.maxHp||1),it=f.hp/We;typeof Te.percentMax=="number"&&it>=Te.percentMax&&z.push(Te.reason||`PV trop hauts (>= ${Math.round(Te.percentMax*100)}%).`)}if(Te.type==="distance_max"&&we==="enemy"){const We=fs();We!==null&&typeof Te.max=="number"&&We>Te.max&&z.push(Te.reason||`Distance > ${Te.max}.`)}if(Te.type==="distance_between"&&we==="enemy"){const We=fs();We!==null&&(typeof Te.min=="number"&&We<Te.min&&z.push(Te.reason||`Distance < ${Te.min}.`),typeof Te.max=="number"&&We>Te.max&&z.push(Te.reason||`Distance > ${Te.max}.`))}if(Te.type==="resource_at_least"&&Te.resource){const We=typeof Te.pool=="string"?Te.pool:void 0,it=Vr(String(Te.resource),We),ye=typeof Te.value=="number"?Te.value:1;if(it<ye){const $e=We?` (${We})`:"";z.push(Te.reason||`Ressource insuffisante: ${Te.resource}${$e} (${it}/${ye}).`)}}}return{enabled:z.length===0,reasons:z,details:D}}function ps(C){var Ie,de,we,Ae,pe,Ge;const z=Number($r.niveauGlobal||1),D=Number(((de=(Ie=$r.caracs)==null?void 0:Ie.force)==null?void 0:de.modFOR)||0),X=Number(((Ae=(we=$r.caracs)==null?void 0:we.dexterite)==null?void 0:Ae.modDEX)||0),le=Number(((Ge=(pe=$r.caracs)==null?void 0:pe.constitution)==null?void 0:Ge.modCON)||0);return C.replace(/\s+/g,"").replace(/niveau/gi,String(z)).replace(/modFOR/gi,String(D)).replace(/modDEX/gi,String(X)).replace(/modCON/gi,String(le))}function ar(C){var D;const z=[];if(C.perTurn&&z.push(`${C.perTurn}/tour`),C.perEncounter&&z.push(`${C.perEncounter}/rencontre`),(D=C.resource)!=null&&D.name){const X=C.resource.pool?` (${C.resource.pool})`:"";z.push(`Ressource: ${C.resource.name}${X}`)}return z.length?z.join(" | "):"Libre"}function lr(C){const{range:z,target:D}=C;return z.shape==="self"?"Portee: soi-meme":z.min===z.max?`Portee: ${z.max} (${D})`:`Portee: ${z.min}-${z.max} (${D})`}function cr(C){switch(C.type){case"phase":return`Phase requise: ${C.mustBe??"?"}`;case"distance_max":return`Distance <= ${C.max??"?"}`;case"distance_between":return`Distance ${C.min??0}-${C.max??"?"}`;case"stat_below_percent":return`Stat ${C.stat} < ${Math.round((C.percentMax??0)*100)}%`;case"target_alive":return"Cible doit etre vivante";case"resource_at_least":return`Ressource ${C.resource??"?"} >= ${C.value??"?"}`;default:return C.reason||C.type}}function ki(C){switch(C.type){case"damage":return`Degats ${C.damageType??""} (${C.formula??"?"})`;case"heal":return`Soin (${C.formula??"?"})`;case"status":return`Etat: ${C.status??"?"} (${C.duration??"?"} tour)`;case"temp_hp":return`PV temporaires: ${C.amount??"?"}`;case"move":return`Deplacement +${C.maxSteps??"?"} (${C.direction??"direction libre"})`;case"resource_spend":return`Consomme ${C.amount??1} ${C.resource??"ressource"}`;case"modify_path_limit":return`+${C.delta??"?"} cases de mouvement ce tour`;default:return C.type}}function Ci(C){var X;const z=(X=C.targeting)==null?void 0:X.range;if(!z)return;const D=`preview-${C.id}`;if(z.shape==="rectangle"){Wn([{id:D,kind:"rectangle",width:Math.max(1,z.max),height:Math.max(1,z.max)}]),ue(`Previsualisation rectangle pour ${C.name}.`);return}if(z.shape==="cone"){Wn([{id:D,kind:"cone",range:Math.max(1,z.max),direction:"right"}]),ue(`Previsualisation cone (direction droite) pour ${C.name}.`);return}Wn([{id:D,kind:"circle",radius:Math.max(1,z.max)}]),ue(`Previsualisation de portee pour ${C.name}.`)}function Hn(C){var de,we,Ae;const z=(de=C.actionCost)==null?void 0:de.actionType,D=z==="action",X=z==="bonus";if(D&&Dn.usedAction){ue(`Action ${C.name} refusee: action principale deja utilisee ce tour.`);return}if(X&&Dn.usedBonus){ue(`Action ${C.name} refusee: action bonus deja utilisee ce tour.`);return}const le=br(C);if(!le.enabled){ue(`Action ${C.name} bloque: ${le.reasons.join(" | ")}`);return}os(pe=>({turn:{...pe.turn,[C.id]:(pe.turn[C.id]??0)+1},encounter:{...pe.encounter,[C.id]:(pe.encounter[C.id]??0)+1}}));for(const pe of C.effects||[]){if(pe.type==="modify_path_limit"&&typeof pe.delta=="number"&&(wi(Ge=>Math.max(1,Ge+pe.delta)),typeof pe.delta=="number"&&ue(`Mouvement: limite de trajet modifiee (${pe.delta>=0?"+":""}${pe.delta}).`)),pe.type==="resource_spend"&&pe.resource){const Ge=typeof pe.pool=="string"?pe.pool:null,Ze=typeof pe.amount=="number"?pe.amount:1,dt=Si(String(pe.resource),Ge);fo(_e=>({..._e,[dt]:Math.max(0,(_e[dt]??0)-Ze)}))}if(pe.type==="heal"&&typeof pe.formula=="string"){const Ge=ps(pe.formula),Ze=Nd(Ge,{isCrit:!1,critRule:"double-dice"}),dt=typeof pe.min=="number"?pe.min:null,_e=dt!==null?Math.max(dt,Ze.total):Ze.total;p(Se=>({...Se,hp:Math.min(Se.maxHp,Se.hp+_e)})),Yr(`Soin (${C.name}) : ${Ge} -> +${_e} PV`)}pe.type==="log"&&typeof pe.message=="string"&&ue(pe.message)}xi(C.id),is(null),Gr(null),vi(!1),ir(pe=>({usedAction:pe.usedAction||D,usedBonus:pe.usedBonus||X}));const Ie=((we=C.aiHints)==null?void 0:we.successLog)||"Action validee. Prets pour les jets.";ue(`${C.name}: ${Ie}`),((Ae=C.targeting)==null?void 0:Ae.target)==="enemy"?(qt("selecting"),On(null),ue("Selection de cible: cliquez sur un ennemi sur la grille ou dans la liste.")):(qt("none"),On(null))}function Ai(){return rs&&_r.find(C=>C.id===rs)||null}function Za(C){return C?C.attack||C.damage||C.skillCheck?!0:(C.effects||[]).some(D=>typeof D.formula=="string"&&D.formula.trim().length>0):!1}function Sr(){var de,we;if(ut||Yt(f))return;const C=Ai();if(!C){ue("Aucune action validee pour lancer un jet.");return}if(!C.attack){ue("Cette action ne requiert pas de jet de touche.");return}if(uo){ue("Jet de touche deja effectue pour cette action ce tour. Validez une nouvelle action ou terminez le tour.");return}let z=null;if(((de=C.targeting)==null?void 0:de.target)==="enemy"){if(!St){ue("Aucune cible ennemie selectionnee pour cette action. Selectionnez une cible avant le jet.");return}const Ae=x.find(pe=>pe.id===St);if(!Ae){ue("Cible ennemie introuvable ou deja vaincue.");return}z=typeof Ae.armorClass=="number"?Ae.armorClass:null}const D=x0(C.attack.bonus,wr,C.attack.critRange??20);is(D),vi(!0),Gr(null);const X=D.mode==="normal"?`${D.d20.total}`:`${D.d20.rolls.join(" / ")} -> ${D.d20.total}`,le=((we=C.targeting)==null?void 0:we.target)==="enemy"&&St?` sur ${St}`:"",Ie=`Jet de touche (${C.name})${le} : ${X} + ${D.bonus} = ${D.total}`;if(z!==null){const pe=D.total>=z||D.isCrit?`TOUCHE (CA ${z})${D.isCrit?" (critique!)":""}`:`RATE (CA ${z})`;Yr(`${Ie} -> ${pe}`)}else Yr(`${Ie}${D.isCrit?" (critique!)":""}`)}function ms(){var Ae,pe,Ge;if(ut||Yt(f))return;const C=Ai();if(!C){ue("Aucune action validee pour lancer un jet.");return}if(!C.damage){ue("Cette action ne requiert pas de jet de degats.");return}if(C.attack&&!Pn){ue("Un jet de touche est requis avant les degats pour cette action.");return}let z=null,D=null;if(((Ae=C.targeting)==null?void 0:Ae.target)==="enemy"){if(!St){ue("Aucune cible ennemie selectionnee pour cette action. Selectionnez une cible avant le jet de degats.");return}if(z=x.findIndex(dt=>dt.id===St),z===-1){ue("Cible ennemie introuvable ou deja vaincue.");return}const Ze=x[z];D=typeof Ze.armorClass=="number"?Ze.armorClass:null}const X=!!(Pn!=null&&Pn.isCrit);if(D!==null&&C.attack&&Pn){const Ze=Pn.total;if(!(Ze>=D||Pn.isCrit)){const _e=((pe=C.targeting)==null?void 0:pe.target)==="enemy"&&St?` sur ${St}`:"";ue(`L'attaque (${C.name})${_e} a manque la cible (CA ${D}). Pas de degats.`),St&&kn({round:U,phase:I,kind:"player_attack",actorId:f.id,actorKind:"player",targetId:St,targetKind:"enemy",summary:`Le heros attaque ${St} (${C.name}) mais manque (CA ${D}).`,data:{actionId:C.id,attackTotal:Ze,targetArmorClass:D,hit:!1}});return}}const le=Nd(C.damage.formula,{isCrit:X,critRule:C.damage.critRule});Gr(le);const Ie=le.dice.map(Ze=>Ze.rolls.join("+")).join(" | "),de=le.total,we=((Ge=C.targeting)==null?void 0:Ge.target)==="enemy"&&St?` sur ${St}`:"";Yr(`Degats (${C.name})${we} : ${Ie||"0"} + ${le.flatModifier} = ${de}${X?" (critique)":""}`),typeof z=="number"&&z>=0&&w(Ze=>{if(z===null||z<0||z>=Ze.length)return Ze;const dt=[...Ze],_e={...dt[z]},Se=_e.hp;return _e.hp=Math.max(0,_e.hp-de),dt[z]=_e,kn({round:U,phase:I,kind:"player_attack",actorId:f.id,actorKind:"player",targetId:_e.id,targetKind:"enemy",summary:`Le heros frappe ${_e.id} et inflige ${de} degats (PV ${Se} -> ${_e.hp}).`,data:{actionId:C.id,damage:de,isCrit:X,targetHpBefore:Se,targetHpAfter:_e.hp}}),_e.hp<=0&&Se>0&&kn({round:U,phase:I,kind:"death",actorId:_e.id,actorKind:"enemy",summary:`${_e.id} s'effondre, hors de combat.`,targetId:_e.id,targetKind:"enemy",data:{killedBy:f.id}}),dt})}function To(){const C=Ai();if(!C){ue("Aucune action validee pour lancer un jet.");return}if(!C.attack){ue("Mode auto: pas de jet de touche necessaire."),C.damage&&ms();return}Sr(),setTimeout(()=>{C.damage&&ms()},50)}function gs(C){if(I!=="player"||ut||Yt(f))return;const z=n.current;if(!z)return;const D=z.querySelector("canvas");if(!D)return;const X=D.getBoundingClientRect(),le=C.clientX-X.left,Ie=C.clientY-X.top,de=Wr.current;if(!de)return;const we=(le-de.offsetX)/de.scale,Ae=(Ie-de.offsetY)/de.scale,pe=Sa(B.cols),Ge=Od(B.rows);if(we<0||Ae<0||we>pe||Ae>Ge)return;const{x:Ze,y:dt}=s2(we,Ae,B.cols,B.rows),_e=Ze,Se=dt;if(!bo(_e,Se))return;if(as==="selecting"){const We=[f,...x],it=Kl({x:_e,y:Se},We);if(!it||it.type!=="enemy"){ue(`Pas d'ennemi sur (${_e}, ${Se}).`);return}const ye=Ai();if(!ye){ue("Aucune action validee pour selectionner une cible.");return}const $e=Ao(ye,it,f,[f,...x]);if(!$e.ok){ue($e.reason||"Cette cible n'est pas valide pour cette action.");return}On(it.id),qt("none"),ue(`Cible selectionnee: ${it.id}.`);return}if(Nn==="inspect-select"){const We=di(f,{x:_e,y:Se});if(We>Qt){ue(`Inspection: case hors portee (${We} > ${Qt}).`);return}if(!f2(f,{x:_e,y:Se},Rt.vision,M)){ue("Inspection: la case n'est pas dans votre champ de vision.");return}Ga($e=>{const kt=new Set($e);return kt.add(wo(_e,Se)),kt});const it=[f,...x],ye=Kl({x:_e,y:Se},it);if(!ye){ue(`Inspection: case (${_e}, ${Se}) -> sol.`),ds(`Inspection (${_e},${Se}) : sol.`),Kt("idle");return}if(ye.type==="enemy"){Ua(It=>{const qe=new Set(It);return qe.add(ye.id),qe});const $e=ye.enemyTypeLabel??ye.enemyTypeId??"inconnu",kt=ye.aiRole??"inconnu",Tt=`Inspection (${_e},${Se}) : ${$e}
Etat: PV ${ye.hp}/${ye.maxHp}
Role: ${kt}`;ue(`Inspection: ennemi (${ye.id}) -> nature: ${$e}, etat: PV ${ye.hp}/${ye.maxHp}, role: ${kt}.`),ds(Tt)}else{const $e=`Inspection (${_e},${Se}) : joueur
Etat: PV ${ye.hp}/${ye.maxHp}`;ue(`Inspection: joueur (${ye.id}) -> etat: PV ${ye.hp}/${ye.maxHp}.`),ds($e)}Kt("idle");return}if(Nn==="look-select"){const We=p2(f,{x:_e,y:Se});Ti(We),Kt("idle");return}if(Nn!=="moving"){const We=[f,...x],it=Kl({x:_e,y:Se},We)??null;go({open:!0,anchorX:le,anchorY:Ie,cell:{x:_e,y:Se},token:it});return}if(((We,it)=>x.some(ye=>ye.hp>0&&ye.x===We&&ye.y===it))(_e,Se)){ue(`Case (${_e}, ${Se}) occupee par un ennemi : impossible de s'y deplacer.`);return}if(!bo(_e,Se)){ue(`Case (${_e}, ${Se}) hors zone jouable.`);return}if(Rt.movement.has(wo(_e,Se))){ue(`Case (${_e}, ${Se}) bloquee par un obstacle.`);return}sr(We=>{const it=Math.max(1,po),ye=[...We];if(ye.length>=it)return ue(`Limite de ${it} cases atteinte pour ce tour.`),ye;const $e=ye.length>0?ye[ye.length-1]:{x:f.x,y:f.y};if($e.x===_e&&$e.y===Se)return ye;const kt=it-ye.length,Tt={...f,x:$e.x,y:$e.y},It=[Tt,...x],qe=mc(Tt,{x:_e,y:Se},It,{maxDistance:Math.max(0,kt),allowTargetOccupied:!1,blockedCells:Rt.movement,playableCells:M,grid:B});if(qe.length<=1)return ue("Aucun chemin valide vers cette case (bloque par obstacle ou entites)."),ye;const cn=qe.slice(1);return ue(`Trajectoire: +${cn.length} case(s) vers (${_e}, ${Se}).`),ye.concat(cn)})}function Mo(){if(I!=="player"||ut||Yt(f)||Bt.length===0)return;const C=Bt[Bt.length-1],z={x:f.x,y:f.y};p(D=>({...D,x:C.x,y:C.y})),ue(`Deplacement valide vers (${C.x}, ${C.y}) via ${Bt.length} etape(s).`),kn({round:U,phase:"player",kind:"move",actorId:f.id,actorKind:"player",summary:`Le heros se deplace de (${z.x}, ${z.y}) vers (${C.x}, ${C.y}).`,data:{from:z,to:{x:C.x,y:C.y},steps:Bt.length}}),sr([]),Kt("idle"),ln()}function Ja(){I==="player"&&(ut||(sr([]),ue("Trajectoire reinitialisee.")))}function Ti(C){I==="player"&&(ut||(p(z=>({...z,facing:C})),ue(`Orientation du joueur mise a jour: ${C}.`)))}function Mi(){const C={id:f.id,x:f.x,y:f.y,hp:f.hp,maxHp:f.maxHp},z=x.map(D=>({id:D.id,x:D.x,y:D.y,hp:D.hp,maxHp:D.maxHp,type:D.enemyTypeId,aiRole:D.aiRole??null,moveRange:D.moveRange??null,attackDamage:D.attackDamage??null,attackRange:D.attackRange??null,maxAttacksPerTurn:D.maxAttacksPerTurn??null,actionIds:D.actionIds??null}));return{round:U,phase:I,grid:{cols:B.cols,rows:B.rows},player:C,enemies:z,actionsCatalog:ao.map(D=>{var X,le,Ie,de,we,Ae,pe,Ge;return{id:D.id,name:D.name,category:String(D.category??""),targeting:{target:String(((X=D.targeting)==null?void 0:X.target)??""),range:{min:Number(((Ie=(le=D.targeting)==null?void 0:le.range)==null?void 0:Ie.min)??0),max:Number(((we=(de=D.targeting)==null?void 0:de.range)==null?void 0:we.max)??0),shape:String(((pe=(Ae=D.targeting)==null?void 0:Ae.range)==null?void 0:pe.shape)??"")},requiresLos:!!((Ge=D.targeting)!=null&&Ge.requiresLos)}}})}}function Xr(C){const z=new Set(x.map(X=>X.id)),D=[];for(const X of C){if(!X||typeof X!="object"||typeof X.enemyId!="string"||!z.has(X.enemyId)||typeof X.actionId!="string"||!X.actionId.trim())continue;const le=X.target;let Ie={kind:"none"};le&&typeof le=="object"&&(le.kind==="token"&&typeof le.tokenId=="string"?Ie={kind:"token",tokenId:le.tokenId}:le.kind==="cell"&&typeof le.x=="number"&&typeof le.y=="number"&&(Ie={kind:"cell",x:le.x,y:le.y}));const de=X.advantageMode,we=de==="advantage"||de==="disadvantage"?de:"normal";D.push({enemyId:X.enemyId,actionId:X.actionId.trim(),target:Ie,advantageMode:we})}return D}async function ys(C){console.log("[enemy-ai] Envoi etat au backend:",C),Lc(C),Xa(null),or(!1);try{const z=await fetch("/api/enemy-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!z.ok)throw new Error(`HTTP ${z.status}`);const D=await z.json();if(!D.intents||!Array.isArray(D.intents))throw new Error("Reponse backend invalide (intents manquant).");const X=Xr(D.intents);return vo(X),X.length===0&&or(!0),X}catch(z){return Xa(z instanceof Error?z.message:String(z??"unknown")),vo(null),or(!0),[]}}async function jc(C,z,D){const X=D.find(Se=>Se.id===C);if(!X||Yt(X))return;const le=[z,...D],Ie=p0(X,le,Rt.vision,M),de=Ie.filter(Se=>Se.type==="enemy"&&Se.id!==C&&!Yt(Se)).map(Se=>Se.id),we=Ie.filter(Se=>Se.type==="player"&&!Yt(Se)).map(Se=>Se.id),Ae=N1(X,z,le,Rt.vision,M),pe=di(X,z),Ge=X.maxHp>0?X.hp/X.maxHp:0,Ze={language:"fr",maxLines:2,enemyId:C,enemyTypeId:X.enemyTypeId??null,aiRole:X.aiRole??null,speechProfile:X.speechProfile??null,perception:{canSeePlayer:Ae,distanceToPlayer:Number.isFinite(pe)?pe:null,hpRatio:Number.isFinite(Ge)?Ge:0,alliesVisible:de,enemiesVisible:we,lastKnownPlayerPos:Ae?{x:z.x,y:z.y}:null},priorSpeechesThisRound:P5(),selfLastSpeech:E5(C),recentEvents:R5(16)},_e=((await z5(Ze)).line??"").trim();if(!_e){Ka(C);return}Xe(C,_e),M5(C,_e)}async function Bc(C){var _e,Se,Te,We,it;se(!0),sr([]),Wn([]);const z=x.map(ye=>({...ye}));let D={...f};const X=z.find(ye=>ye.id===C);if(!X||Yt(X)){se(!1),us();return}const le=Mi(),de=(await ys(le)).filter(ye=>ye.enemyId===C),we=[D,...z],Ae=Array.isArray(X.actionIds)&&X.actionIds.length?X.actionIds:["enemy-move","enemy-melee-strike"],pe=ye=>ao.find($e=>$e.id===ye)??null,Ge=(ye,$e,kt)=>{const Tt=pe(ye);if(!Tt)return{ok:!1,reason:`Action inconnue: ${ye}`};if(!Ae.includes(ye))return{ok:!1,reason:`Action non autorisee pour ${X.id}: ${ye}`};const It=C5(Tt,{round:U,phase:"enemies",actor:X,player:D,enemies:z,blockedMovementCells:Rt.movement,blockedVisionCells:Rt.vision,blockedAttackCells:Rt.attacks,playableCells:M,grid:B,sampleCharacter:$r,onLog:ue,emitEvent:qe=>{kn({round:U,phase:"enemies",kind:qe.kind,actorId:qe.actorId,actorKind:qe.actorKind,targetId:qe.targetId??null,targetKind:qe.targetKind??null,summary:qe.summary,data:qe.data??{}})}},$e,{advantageMode:kt});if(!It.ok||!It.playerAfter||!It.enemiesAfter)return{ok:!1,reason:It.reason||"Echec de resolution."};D=It.playerAfter;for(let qe=0;qe<z.length;qe++)z[qe]=It.enemiesAfter[qe]??z[qe];return{ok:!0,action:Tt}};let Ze=!1;if(de.length>0){const ye=de[0],$e=ye.target;let kt={kind:"none"};if($e.kind==="token"){const It=we.find(qe=>qe.id===$e.tokenId)??null;It&&(kt={kind:"token",token:It})}else $e.kind==="cell"&&(kt={kind:"cell",x:$e.x,y:$e.y});const Tt=Ge(ye.actionId,kt,ye.advantageMode);Tt.ok?or(!1):(Ze=!0,ue(`${X.id}: intent IA invalide (${Tt.reason}).`))}else Ze=!0;if(Ze)if(or(!0),!N1(X,D,we,Rt.vision,M))ue(`${X.id} ne voit pas le joueur et reste en alerte.`);else{const $e=di(X,D),kt=Ae.includes("enemy-bow-shot"),Tt=Ae.includes("enemy-melee-strike"),It=Ae.includes("enemy-move"),qe=typeof X.moveRange=="number"?X.moveRange:3,cn=X.aiRole==="archer",$i=cn?3:1,Wc=cn?2:0;let _n=!1;const Lo=()=>{let je=null,pt=-1;for(let Jt=-qe;Jt<=qe;Jt++)for(let en=-qe;en<=qe;en++){const nl=Math.abs(Jt)+Math.abs(en);if(nl===0||nl>qe)continue;const bs=X.x+Jt,Ss=X.y+en;if(!bo(bs,Ss)||Kl({x:bs,y:Ss},we))continue;const zo=di({x:bs,y:Ss},D);zo>pt&&(pt=zo,je={x:bs,y:Ss})}return je};if(!_n&&D.hp>0&&cn&&kt){const je=pe("enemy-bow-shot"),pt=((Se=(_e=je==null?void 0:je.targeting)==null?void 0:_e.range)==null?void 0:Se.min)??2,Jt=((We=(Te=je==null?void 0:je.targeting)==null?void 0:Te.range)==null?void 0:We.max)??6;if($e>=pt&&$e<=Jt){const en=Ge("enemy-bow-shot",{kind:"token",token:D});en.ok&&(kn({round:U,phase:"enemies",kind:"enemy_attack",actorId:X.id,actorKind:"enemy",targetId:D.id,targetKind:"player",summary:`${X.id} tire a distance (${en.action.name}).`,data:{actionId:en.action.id,fallback:!0}}),_n=!0)}}if(!_n&&D.hp>0&&cn&&It&&$e<=Wc){const je=Lo();if(je){const pt={x:X.x,y:X.y},Jt=Ge("enemy-move",{kind:"cell",x:je.x,y:je.y});Jt.ok&&(kn({round:U,phase:"enemies",kind:"move",actorId:X.id,actorKind:"enemy",summary:`${X.id} recule de (${pt.x}, ${pt.y}) vers (${je.x}, ${je.y}).`,data:{from:pt,to:je,fallback:!0,actionId:Jt.action.id}}),_n=!0)}}if(!_n&&D.hp>0&&!cn&&Tt&&$e<=1){const je=Ge("enemy-melee-strike",{kind:"token",token:D});je.ok&&(kn({round:U,phase:"enemies",kind:"enemy_attack",actorId:X.id,actorKind:"enemy",targetId:D.id,targetKind:"player",summary:`${X.id} attaque au contact (${je.action.name}).`,data:{actionId:je.action.id,fallback:!0}}),_n=!0)}if(!_n&&D.hp>0&&It){let je=null;if(cn)if($e>$i){const pt=mc(X,{x:D.x,y:D.y},we,{maxDistance:qe,allowTargetOccupied:!1,blockedCells:Rt.movement,playableCells:M,grid:B});pt.length&&(je=pt[pt.length-1])}else je=Lo();else{const pt=mc(X,{x:D.x,y:D.y},we,{maxDistance:qe,allowTargetOccupied:!1,blockedCells:Rt.movement,playableCells:M,grid:B});pt.length&&(je=pt[pt.length-1])}if(je){const pt={x:X.x,y:X.y},Jt=Ge("enemy-move",{kind:"cell",x:je.x,y:je.y});Jt.ok&&(kn({round:U,phase:"enemies",kind:"move",actorId:X.id,actorKind:"enemy",summary:`${X.id} se deplace de (${pt.x}, ${pt.y}) vers (${je.x}, ${je.y}).`,data:{from:pt,to:je,fallback:!0,actionId:Jt.action.id}}),_n=!0)}}if(!_n&&D.hp>0&&cn&&Tt&&$e<=1){const je=Ge("enemy-melee-strike",{kind:"token",token:D});je.ok&&(kn({round:U,phase:"enemies",kind:"enemy_attack",actorId:X.id,actorKind:"enemy",targetId:D.id,targetKind:"player",summary:`${X.id} attaque au contact (${je.action.name}).`,data:{actionId:je.action.id,fallback:!0}}),_n=!0)}}p(D),w(z);try{await jc(C,D,z)}catch{}const dt=ko();if(e.current&&((it=dt.entry)==null?void 0:it.kind)==="player")try{const ye=hs("player",D,z),$e=I5({focusActorId:D.id??null,stateEnd:ye});if($e){const kt=await L5($e),Tt=(kt.error||kt.summary||"").trim();Tt&&qa(Tt)}}catch{qa("IA non fonctionnel.")}finally{$5(),e.current=!1}se(!1),us()}function Po(){if(ut)return;const C=So();!C||C.kind!=="player"||(ue(`Fin du tour joueur (round ${U}).`),e.current=!0,kn({round:U,phase:"player",kind:"turn_end",actorId:f.id,actorKind:"player",summary:`Fin du tour du heros (round ${U}).`}),us())}function xs(){Wn([{id:"demo-circle",kind:"circle",radius:2}]),ue("Zone d'effet: cercle (rayon 2) autour du joueur.")}function Eo(){Wn([{id:"demo-rect",kind:"rectangle",width:3,height:3}]),ue("Zone d'effet: rectangle 3x3 centre sur le joueur.")}function el(){Wn([{id:"demo-cone",kind:"cone",range:4,direction:"right"}]),ue("Zone d'effet: cone vers la droite (portee 4).")}function ur(){Wn([]),ue("Zones d'effet effacees.")}ee.useEffect(()=>{ut||f.hp<=0&&([f,...x].some(z=>z.type==="player"&&!Yt(z))||zc(!0))},[f,x,ut]);const Pi=_r.find(C=>C.id===lo)||_r[0]||null,vs=Pi?br(Pi):null,Ei=Ai(),_s=Za(Ei),dr=Et&&_r.find(C=>C.id===Et.actionId)||null,Ri=dr?br(dr):null,Zt=(Et==null?void 0:Et.stage)==="active"&&dr&&rs===dr.id?{enabled:!0,reasons:[],details:(Ri==null?void 0:Ri.details)??[]}:Ri,qr=So(),Ro=V;if(!L)return T.jsx(Xv,{configEnemyCount:ve,enemyTypeCount:g.length,gridCols:B.cols,gridRows:B.rows,mapPrompt:Ee,onChangeMapPrompt:Re,onChangeEnemyCount:Pe,onNoEnemyTypes:()=>ue("Aucun type d'ennemi charge (enemyTypes). Impossible de generer le combat."),onStartCombat:Fc});const kr=I==="player"&&!ut&&!Yt(f);function Dc(C){const z=(Oe==null?void 0:Oe.anchorX)??0,D=(Oe==null?void 0:Oe.anchorY)??0;Ur(C.id),yo({anchorX:z,anchorY:D,actionId:C.id,stage:"draft"}),ln()}function Io(){yo(null),qt("none")}function $o(C){Hn(C),yo(z=>z&&{...z,actionId:C.id,stage:"active"})}function Ii(){kr&&(qt("none"),Kt("inspect-select"),ln(),ue(`Inspection: cliquez sur une case VISIBLE (portee ${Qt}) pour reveler nature / etat / role.`))}function ws(){kr&&(qt("none"),Kt("look-select"),ln(),ue("Tourner le regard: cliquez sur une case pour orienter le champ de vision."))}function tl(){const C=Oe==null?void 0:Oe.cell;ue(C?`Interagir: (a integrer) sur (${C.x}, ${C.y}).`:"Interagir: (a integrer)."),ln()}function Oc(){ue("Se cacher: (a integrer)."),ln()}const Nc=[{id:"combat",label:"Combat",content:T.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"flex-start"},children:[T.jsx("div",{style:{flex:"1 1 340px",minWidth:340},children:T.jsx(qv,{round:U,phase:I,playerInitiative:ae,player:f,selectedPath:Bt,sampleCharacter:$r,aiLastState:$c,aiLastIntents:bi,aiUsedFallback:_o,aiLastError:ls})}),T.jsx("div",{style:{flex:"1 1 340px",minWidth:340},children:T.jsx(Kv,{enemies:x,player:f,revealedEnemyIds:mo,capabilities:g7,validatedAction:Ei,selectedTargetId:St,describeEnemyLastDecision:cs,validateEnemyTargetForAction:Ao,onSelectTargetId:On,onSetTargetMode:qt,onLog:ue})}),T.jsx("div",{style:{flex:"1 1 340px",minWidth:340},children:T.jsx(e7,{actions:_r,selectedAction:Pi,selectedAvailability:vs,computeActionAvailability:br,onSelectActionId:Ur,describeRange:lr,describeUsage:ar,conditionLabel:cr,effectLabel:ki,onPreviewActionArea:Ci,onValidateAction:Hn})}),_s&&T.jsx("div",{style:{flex:"1 1 340px",minWidth:340},children:T.jsx(t7,{validatedAction:Ei,advantageMode:wr,onSetAdvantageMode:Wa,onRollAttack:Sr,onRollDamage:ms,onAutoResolve:To,attackRoll:Pn,damageRoll:Ha,diceLogs:ss})})]})},{id:"effects",label:"Effets",content:T.jsx("div",{style:{maxWidth:520},children:T.jsx(n7,{showVisionDebug:xo,onShowCircle:xs,onShowRectangle:Eo,onShowCone:el,onToggleVisionDebug:()=>Ya(C=>!C),onClear:ur})})},{id:"logs",label:"Logs",content:T.jsx(r7,{log:i})}];return T.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",height:"100vh",overflow:"hidden",background:"#0b0b12",color:"#f5f5f5",fontFamily:"system-ui, sans-serif",padding:"16px",boxSizing:"border-box",position:"relative"},children:[ut&&T.jsx(Qv,{onRestart:()=>window.location.reload()}),T.jsxs("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"flex-start",gap:10,minHeight:0,overflow:"hidden"},children:[T.jsx("div",{style:{flex:"0 0 auto",padding:"10px 12px",borderRadius:14,background:"rgba(12,12,18,0.88)",border:"1px solid rgba(255,255,255,0.10)",boxShadow:"0 18px 60px rgba(0,0,0,0.35)"},children:T.jsx(Zv,{round:U,timelineEntries:Ro,activeEntry:qr,player:f,enemies:x})}),T.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",padding:"0 4px"},children:[T.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[T.jsx("span",{style:{fontSize:18,fontWeight:900,letterSpacing:.4},children:"Mini Donjon"}),T.jsx("span",{style:{fontSize:12,color:"rgba(255,255,255,0.70)"},children:"Clic gauche: roue d'actions  Deplacer: clics successifs (max 5)"})]}),T.jsx("span",{style:{fontSize:12,color:"rgba(255,255,255,0.65)"},children:I==="player"?"Tour joueur":"Tour ennemis"})]}),T.jsx("div",{style:{flex:"1 1 auto",minHeight:0,borderRadius:18,padding:10,background:"radial-gradient(1200px 500px at 40% 0%, rgba(120,90,40,0.20), rgba(12,12,18,0.92))",border:"1px solid rgba(255,255,255,0.12)",boxShadow:"0 25px 90px rgba(0,0,0,0.55)",overflow:"visible"},children:T.jsxs("div",{ref:n,onClick:gs,onContextMenu:C=>{C.preventDefault()},onMouseDown:C=>{C.button===2&&(C.preventDefault(),C.stopPropagation(),an(!0),rr.current={x:C.clientX,y:C.clientY})},onMouseMove:C=>{if(!on)return;const z=rr.current;if(!z)return;const D=C.clientX-z.x,X=C.clientY-z.y;D===0&&X===0||(rr.current={x:C.clientX,y:C.clientY},sn(le=>({x:le.x+D,y:le.y+X})))},onMouseUp:C=>{C.button===2&&(an(!1),rr.current=null)},onMouseLeave:()=>{an(!1),rr.current=null},style:{width:"100%",height:"100%",minHeight:0,borderRadius:14,border:"1px solid rgba(255,255,255,0.10)",background:"#05050a",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"visible",cursor:on?"grabbing":"default"},children:[T.jsxs("div",{onMouseDown:C=>C.stopPropagation(),style:{position:"absolute",right:12,top:12,zIndex:45,display:"flex",flexDirection:"column",gap:6,padding:8,borderRadius:12,background:"rgba(10, 10, 16, 0.72)",border:"1px solid rgba(255,255,255,0.14)",backdropFilter:"blur(6px)",boxShadow:"0 14px 40px rgba(0,0,0,0.35)"},children:[T.jsx("button",{type:"button",onClick:()=>Mn(C=>wc(Math.round((C+Ue)*10)/10,De,Le)),disabled:Ke>=Le-1e-6,style:{width:34,height:34,borderRadius:10,border:"1px solid rgba(255,255,255,0.14)",background:Ke>=Le-1e-6?"rgba(80,80,90,0.55)":"rgba(255,255,255,0.08)",color:"#fff",cursor:Ke>=Le-1e-6?"default":"pointer",fontSize:18,fontWeight:800,lineHeight:1},title:"Zoom +",children:"+"}),T.jsxs("div",{style:{textAlign:"center",fontSize:12,color:"rgba(255,255,255,0.75)",fontWeight:700},title:"Niveau de zoom",children:[Math.round(Ke*100),"%"]}),T.jsx("button",{type:"button",onClick:()=>Mn(C=>wc(Math.round((C-Ue)*10)/10,De,Le)),disabled:Ke<=De+1e-6,style:{width:34,height:34,borderRadius:10,border:"1px solid rgba(255,255,255,0.14)",background:Ke<=De+1e-6?"rgba(80,80,90,0.55)":"rgba(255,255,255,0.08)",color:"#fff",cursor:Ke<=De+1e-6?"default":"pointer",fontSize:22,fontWeight:800,lineHeight:1},title:"Zoom -",children:""}),T.jsx("button",{type:"button",onClick:()=>Mn(1),disabled:Math.abs(Ke-1)<1e-6,style:{marginTop:4,width:34,height:28,borderRadius:10,border:"1px solid rgba(255,255,255,0.14)",background:Math.abs(Ke-1)<1e-6?"rgba(80,80,90,0.55)":"rgba(255,255,255,0.06)",color:"rgba(255,255,255,0.85)",cursor:Math.abs(Ke-1)<1e-6?"default":"pointer",fontSize:11,fontWeight:800},title:"Reset zoom",children:"1"})]}),T.jsx(l7,{open:!!(Oe!=null&&Oe.open),anchorX:(Oe==null?void 0:Oe.anchorX)??0,anchorY:(Oe==null?void 0:Oe.anchorY)??0,size:240,canInteractWithBoard:kr,hasCell:!!(Oe!=null&&Oe.cell),selectedPathLength:Bt.length,isResolvingEnemies:H,actions:_r,computeActionAvailability:br,onClose:ln,onEnterMoveMode:()=>{Kt("moving"),ln(),ue(`Mode deplacement active: cliquez sur des cases pour tracer un trajet (max ${po}).`)},onValidateMove:Mo,onResetMove:()=>{Ja(),ln()},onInspectCell:Ii,onLook:ws,onInteract:tl,onHide:Oc,onEndTurn:()=>{Po(),ln()},onPickAction:Dc}),T.jsx(u7,{open:!!Et,anchorX:(Et==null?void 0:Et.anchorX)??0,anchorY:(Et==null?void 0:Et.anchorY)??0,stage:(Et==null?void 0:Et.stage)??"draft",action:dr,availability:Zt,player:f,enemies:x,validatedAction:Ei,targetMode:as,selectedTargetId:St,onSelectTargetId:On,onSetTargetMode:qt,advantageMode:wr,onSetAdvantageMode:Wa,onRollAttack:Sr,onRollDamage:ms,onAutoResolve:To,attackRoll:Pn,damageRoll:Ha,diceLogs:ss,onValidateAction:$o,onClose:Io}),Nn==="moving"&&T.jsxs("div",{onMouseDown:C=>C.stopPropagation(),style:{position:"absolute",left:10,bottom:10,zIndex:40,display:"flex",gap:8,padding:"8px 10px",borderRadius:10,background:"rgba(10, 10, 16, 0.75)",border:"1px solid rgba(255,255,255,0.14)",backdropFilter:"blur(6px)",boxShadow:"0 14px 40px rgba(0,0,0,0.35)"},children:[T.jsx("span",{style:{fontSize:12,alignSelf:"center",color:"#cfd3ff"},children:"Mode deplacement"}),T.jsx("button",{type:"button",onClick:()=>Kt("idle"),style:{padding:"4px 8px",background:"#34495e",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:12},children:"Quitter"}),T.jsx("button",{type:"button",onClick:Ja,disabled:Bt.length===0,style:{padding:"4px 8px",background:Bt.length?"#e67e22":"#555",color:"#fff",border:"none",borderRadius:6,cursor:Bt.length?"pointer":"default",fontSize:12},children:"Annuler"}),T.jsx("button",{type:"button",onClick:Mo,disabled:Bt.length===0,style:{padding:"4px 8px",background:Bt.length?"#2ecc71":"#555",color:"#fff",border:"none",borderRadius:6,cursor:Bt.length?"pointer":"default",fontSize:12,fontWeight:600},children:"Valider"})]})]})}),T.jsx(Jv,{round:U,narrativeLog:a})]}),T.jsx(d7,{tabs:Nc,defaultTabId:"combat",collapsible:!0,collapsedByDefault:!0,collapsedHeight:52,expandedHeight:320})]})},x7=document.getElementById("root");n2.createRoot(x7).render(T.jsx(y7,{}));export{M8 as $,hm as A,yn as B,xn as C,rt as D,be as E,j0 as F,Pc as G,cp as H,no as I,Q8 as J,o6 as K,Da as L,Be as M,wt as N,ft as O,Xt as P,k6 as Q,Qd as R,yh as S,rc as T,Yd as U,dp as V,Sd as W,hp as X,E8 as Y,eo as Z,At as _,em as a,$0 as a0,fm as a1,Fe as a2,Je as a3,P6 as a4,J6 as a5,V6 as a6,x4 as a7,_4 as a8,C4 as a9,T4 as aa,M4 as ab,Mm as ac,Tp as ad,Cp as ae,Jp as af,vr as ag,P9 as ah,lt as ai,mi as aj,Q5 as ak,Ia as al,c0 as am,Rm as an,er as b,H6 as c,Ea as d,Wt as e,Ap as f,O6 as g,yc as h,gh as i,cm as j,U0 as k,tr as l,im as m,$a as n,y4 as o,v4 as p,S4 as q,d8 as r,A4 as s,Ne as t,K5 as u,P4 as v,ct as w,Bn as x,E0 as y,Jn as z};
