const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-qb7aV80Q.js","assets/webworkerAll-qfLSi89H.js","assets/colorToUniform-Bgh8zzcd.js","assets/WebGPURenderer-BUggpxeh.js","assets/SharedSystems-Dol4cpLP.js","assets/WebGLRenderer-B0og6Ac3.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function Gd(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Vc={exports:{}},Do={},Yc={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p1;function Eg(){if(p1)return Le;p1=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function v(j){return j===null||typeof j!="object"?null:(j=y&&j[y]||j["@@iterator"],typeof j=="function"?j:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,S={};function w(j,V,Se){this.props=j,this.context=V,this.refs=S,this.updater=Se||x}w.prototype.isReactComponent={},w.prototype.setState=function(j,V){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,V,"setState")},w.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function A(){}A.prototype=w.prototype;function E(j,V,Se){this.props=j,this.context=V,this.refs=S,this.updater=Se||x}var P=E.prototype=new A;P.constructor=E,b(P,w.prototype),P.isPureReactComponent=!0;var M=Array.isArray,D=Object.prototype.hasOwnProperty,z={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function G(j,V,Se){var Pe,Re={},ke=null,We=null;if(V!=null)for(Pe in V.ref!==void 0&&(We=V.ref),V.key!==void 0&&(ke=""+V.key),V)D.call(V,Pe)&&!L.hasOwnProperty(Pe)&&(Re[Pe]=V[Pe]);var Fe=arguments.length-2;if(Fe===1)Re.children=Se;else if(1<Fe){for(var Xe=Array(Fe),vt=0;vt<Fe;vt++)Xe[vt]=arguments[vt+2];Re.children=Xe}if(j&&j.defaultProps)for(Pe in Fe=j.defaultProps,Fe)Re[Pe]===void 0&&(Re[Pe]=Fe[Pe]);return{$$typeof:r,type:j,key:ke,ref:We,props:Re,_owner:z.current}}function H(j,V){return{$$typeof:r,type:j.type,key:V,ref:j.ref,props:j.props,_owner:j._owner}}function W(j){return typeof j=="object"&&j!==null&&j.$$typeof===r}function Y(j){var V={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(Se){return V[Se]})}var ge=/\/+/g;function K(j,V){return typeof j=="object"&&j!==null&&j.key!=null?Y(""+j.key):V.toString(36)}function xe(j,V,Se,Pe,Re){var ke=typeof j;(ke==="undefined"||ke==="boolean")&&(j=null);var We=!1;if(j===null)We=!0;else switch(ke){case"string":case"number":We=!0;break;case"object":switch(j.$$typeof){case r:case e:We=!0}}if(We)return We=j,Re=Re(We),j=Pe===""?"."+K(We,0):Pe,M(Re)?(Se="",j!=null&&(Se=j.replace(ge,"$&/")+"/"),xe(Re,V,Se,"",function(vt){return vt})):Re!=null&&(W(Re)&&(Re=H(Re,Se+(!Re.key||We&&We.key===Re.key?"":(""+Re.key).replace(ge,"$&/")+"/")+j)),V.push(Re)),1;if(We=0,Pe=Pe===""?".":Pe+":",M(j))for(var Fe=0;Fe<j.length;Fe++){ke=j[Fe];var Xe=Pe+K(ke,Fe);We+=xe(ke,V,Se,Xe,Re)}else if(Xe=v(j),typeof Xe=="function")for(j=Xe.call(j),Fe=0;!(ke=j.next()).done;)ke=ke.value,Xe=Pe+K(ke,Fe++),We+=xe(ke,V,Se,Xe,Re);else if(ke==="object")throw V=String(j),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return We}function Be(j,V,Se){if(j==null)return j;var Pe=[],Re=0;return xe(j,Pe,"","",function(ke){return V.call(Se,ke,Re++)}),Pe}function ee(j){if(j._status===-1){var V=j._result;V=V(),V.then(function(Se){(j._status===0||j._status===-1)&&(j._status=1,j._result=Se)},function(Se){(j._status===0||j._status===-1)&&(j._status=2,j._result=Se)}),j._status===-1&&(j._status=0,j._result=V)}if(j._status===1)return j._result.default;throw j._result}var te={current:null},re={transition:null},ne={ReactCurrentDispatcher:te,ReactCurrentBatchConfig:re,ReactCurrentOwner:z};function ie(){throw Error("act(...) is not supported in production builds of React.")}return Le.Children={map:Be,forEach:function(j,V,Se){Be(j,function(){V.apply(this,arguments)},Se)},count:function(j){var V=0;return Be(j,function(){V++}),V},toArray:function(j){return Be(j,function(V){return V})||[]},only:function(j){if(!W(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},Le.Component=w,Le.Fragment=t,Le.Profiler=o,Le.PureComponent=E,Le.StrictMode=s,Le.Suspense=h,Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,Le.act=ie,Le.cloneElement=function(j,V,Se){if(j==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+j+".");var Pe=b({},j.props),Re=j.key,ke=j.ref,We=j._owner;if(V!=null){if(V.ref!==void 0&&(ke=V.ref,We=z.current),V.key!==void 0&&(Re=""+V.key),j.type&&j.type.defaultProps)var Fe=j.type.defaultProps;for(Xe in V)D.call(V,Xe)&&!L.hasOwnProperty(Xe)&&(Pe[Xe]=V[Xe]===void 0&&Fe!==void 0?Fe[Xe]:V[Xe])}var Xe=arguments.length-2;if(Xe===1)Pe.children=Se;else if(1<Xe){Fe=Array(Xe);for(var vt=0;vt<Xe;vt++)Fe[vt]=arguments[vt+2];Pe.children=Fe}return{$$typeof:r,type:j.type,key:Re,ref:ke,props:Pe,_owner:We}},Le.createContext=function(j){return j={$$typeof:u,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},j.Provider={$$typeof:a,_context:j},j.Consumer=j},Le.createElement=G,Le.createFactory=function(j){var V=G.bind(null,j);return V.type=j,V},Le.createRef=function(){return{current:null}},Le.forwardRef=function(j){return{$$typeof:c,render:j}},Le.isValidElement=W,Le.lazy=function(j){return{$$typeof:m,_payload:{_status:-1,_result:j},_init:ee}},Le.memo=function(j,V){return{$$typeof:f,type:j,compare:V===void 0?null:V}},Le.startTransition=function(j){var V=re.transition;re.transition={};try{j()}finally{re.transition=V}},Le.unstable_act=ie,Le.useCallback=function(j,V){return te.current.useCallback(j,V)},Le.useContext=function(j){return te.current.useContext(j)},Le.useDebugValue=function(){},Le.useDeferredValue=function(j){return te.current.useDeferredValue(j)},Le.useEffect=function(j,V){return te.current.useEffect(j,V)},Le.useId=function(){return te.current.useId()},Le.useImperativeHandle=function(j,V,Se){return te.current.useImperativeHandle(j,V,Se)},Le.useInsertionEffect=function(j,V){return te.current.useInsertionEffect(j,V)},Le.useLayoutEffect=function(j,V){return te.current.useLayoutEffect(j,V)},Le.useMemo=function(j,V){return te.current.useMemo(j,V)},Le.useReducer=function(j,V,Se){return te.current.useReducer(j,V,Se)},Le.useRef=function(j){return te.current.useRef(j)},Le.useState=function(j){return te.current.useState(j)},Le.useSyncExternalStore=function(j,V,Se){return te.current.useSyncExternalStore(j,V,Se)},Le.useTransition=function(){return te.current.useTransition()},Le.version="18.3.1",Le}var m1;function Vd(){return m1||(m1=1,Yc.exports=Eg()),Yc.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1;function Rg(){if(g1)return Do;g1=1;var r=Vd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function u(c,h,f){var m,y={},v=null,x=null;f!==void 0&&(v=""+f),h.key!==void 0&&(v=""+h.key),h.ref!==void 0&&(x=h.ref);for(m in h)s.call(h,m)&&!a.hasOwnProperty(m)&&(y[m]=h[m]);if(c&&c.defaultProps)for(m in h=c.defaultProps,h)y[m]===void 0&&(y[m]=h[m]);return{$$typeof:e,type:c,key:v,ref:x,props:y,_owner:o.current}}return Do.Fragment=t,Do.jsx=u,Do.jsxs=u,Do}var y1;function Ig(){return y1||(y1=1,Vc.exports=Rg()),Vc.exports}var C=Ig(),Tl={},Xc={exports:{}},dn={},qc={exports:{}},Kc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x1;function Lg(){return x1||(x1=1,(function(r){function e(re,ne){var ie=re.length;re.push(ne);e:for(;0<ie;){var j=ie-1>>>1,V=re[j];if(0<o(V,ne))re[j]=ne,re[ie]=V,ie=j;else break e}}function t(re){return re.length===0?null:re[0]}function s(re){if(re.length===0)return null;var ne=re[0],ie=re.pop();if(ie!==ne){re[0]=ie;e:for(var j=0,V=re.length,Se=V>>>1;j<Se;){var Pe=2*(j+1)-1,Re=re[Pe],ke=Pe+1,We=re[ke];if(0>o(Re,ie))ke<V&&0>o(We,Re)?(re[j]=We,re[ke]=ie,j=ke):(re[j]=Re,re[Pe]=ie,j=Pe);else if(ke<V&&0>o(We,ie))re[j]=We,re[ke]=ie,j=ke;else break e}}return ne}function o(re,ne){var ie=re.sortIndex-ne.sortIndex;return ie!==0?ie:re.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var u=Date,c=u.now();r.unstable_now=function(){return u.now()-c}}var h=[],f=[],m=1,y=null,v=3,x=!1,b=!1,S=!1,w=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(re){for(var ne=t(f);ne!==null;){if(ne.callback===null)s(f);else if(ne.startTime<=re)s(f),ne.sortIndex=ne.expirationTime,e(h,ne);else break;ne=t(f)}}function M(re){if(S=!1,P(re),!b)if(t(h)!==null)b=!0,ee(D);else{var ne=t(f);ne!==null&&te(M,ne.startTime-re)}}function D(re,ne){b=!1,S&&(S=!1,A(G),G=-1),x=!0;var ie=v;try{for(P(ne),y=t(h);y!==null&&(!(y.expirationTime>ne)||re&&!Y());){var j=y.callback;if(typeof j=="function"){y.callback=null,v=y.priorityLevel;var V=j(y.expirationTime<=ne);ne=r.unstable_now(),typeof V=="function"?y.callback=V:y===t(h)&&s(h),P(ne)}else s(h);y=t(h)}if(y!==null)var Se=!0;else{var Pe=t(f);Pe!==null&&te(M,Pe.startTime-ne),Se=!1}return Se}finally{y=null,v=ie,x=!1}}var z=!1,L=null,G=-1,H=5,W=-1;function Y(){return!(r.unstable_now()-W<H)}function ge(){if(L!==null){var re=r.unstable_now();W=re;var ne=!0;try{ne=L(!0,re)}finally{ne?K():(z=!1,L=null)}}else z=!1}var K;if(typeof E=="function")K=function(){E(ge)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,Be=xe.port2;xe.port1.onmessage=ge,K=function(){Be.postMessage(null)}}else K=function(){w(ge,0)};function ee(re){L=re,z||(z=!0,K())}function te(re,ne){G=w(function(){re(r.unstable_now())},ne)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(re){re.callback=null},r.unstable_continueExecution=function(){b||x||(b=!0,ee(D))},r.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<re?Math.floor(1e3/re):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_getFirstCallbackNode=function(){return t(h)},r.unstable_next=function(re){switch(v){case 1:case 2:case 3:var ne=3;break;default:ne=v}var ie=v;v=ne;try{return re()}finally{v=ie}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(re,ne){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var ie=v;v=re;try{return ne()}finally{v=ie}},r.unstable_scheduleCallback=function(re,ne,ie){var j=r.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?j+ie:j):ie=j,re){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=ie+V,re={id:m++,callback:ne,priorityLevel:re,startTime:ie,expirationTime:V,sortIndex:-1},ie>j?(re.sortIndex=ie,e(f,re),t(h)===null&&re===t(f)&&(S?(A(G),G=-1):S=!0,te(M,ie-j))):(re.sortIndex=V,e(h,re),b||x||(b=!0,ee(D))),re},r.unstable_shouldYield=Y,r.unstable_wrapCallback=function(re){var ne=v;return function(){var ie=v;v=ne;try{return re.apply(this,arguments)}finally{v=ie}}}})(Kc)),Kc}var v1;function $g(){return v1||(v1=1,qc.exports=Lg()),qc.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _1;function zg(){if(_1)return dn;_1=1;var r=Vd(),e=$g();function t(n){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function a(n,i){u(n,i),u(n+"Capture",i)}function u(n,i){for(o[n]=i,n=0;n<i.length;n++)s.add(i[n])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},y={};function v(n){return h.call(y,n)?!0:h.call(m,n)?!1:f.test(n)?y[n]=!0:(m[n]=!0,!1)}function x(n,i,l,d){if(l!==null&&l.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return d?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function b(n,i,l,d){if(i===null||typeof i>"u"||x(n,i,l,d))return!0;if(d)return!1;if(l!==null)switch(l.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function S(n,i,l,d,p,g,_){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=d,this.attributeNamespace=p,this.mustUseProperty=l,this.propertyName=n,this.type=i,this.sanitizeURL=g,this.removeEmptyString=_}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){w[n]=new S(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var i=n[0];w[i]=new S(i,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){w[n]=new S(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){w[n]=new S(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){w[n]=new S(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){w[n]=new S(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){w[n]=new S(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){w[n]=new S(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){w[n]=new S(n,5,!1,n.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function E(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var i=n.replace(A,E);w[i]=new S(i,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var i=n.replace(A,E);w[i]=new S(i,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var i=n.replace(A,E);w[i]=new S(i,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){w[n]=new S(n,1,!1,n.toLowerCase(),null,!1,!1)}),w.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){w[n]=new S(n,1,!1,n.toLowerCase(),null,!0,!0)});function P(n,i,l,d){var p=w.hasOwnProperty(i)?w[i]:null;(p!==null?p.type!==0:d||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(b(i,l,p,d)&&(l=null),d||p===null?v(i)&&(l===null?n.removeAttribute(i):n.setAttribute(i,""+l)):p.mustUseProperty?n[p.propertyName]=l===null?p.type===3?!1:"":l:(i=p.attributeName,d=p.attributeNamespace,l===null?n.removeAttribute(i):(p=p.type,l=p===3||p===4&&l===!0?"":""+l,d?n.setAttributeNS(d,i,l):n.setAttribute(i,l))))}var M=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),z=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),G=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),W=Symbol.for("react.provider"),Y=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),xe=Symbol.for("react.suspense_list"),Be=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),re=Symbol.iterator;function ne(n){return n===null||typeof n!="object"?null:(n=re&&n[re]||n["@@iterator"],typeof n=="function"?n:null)}var ie=Object.assign,j;function V(n){if(j===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);j=i&&i[1]||""}return`
`+j+n}var Se=!1;function Pe(n,i){if(!n||Se)return"";Se=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(N){var d=N}Reflect.construct(n,[],i)}else{try{i.call()}catch(N){d=N}n.call(i.prototype)}else{try{throw Error()}catch(N){d=N}n()}}catch(N){if(N&&d&&typeof N.stack=="string"){for(var p=N.stack.split(`
`),g=d.stack.split(`
`),_=p.length-1,T=g.length-1;1<=_&&0<=T&&p[_]!==g[T];)T--;for(;1<=_&&0<=T;_--,T--)if(p[_]!==g[T]){if(_!==1||T!==1)do if(_--,T--,0>T||p[_]!==g[T]){var R=`
`+p[_].replace(" at new "," at ");return n.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",n.displayName)),R}while(1<=_&&0<=T);break}}}finally{Se=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?V(n):""}function Re(n){switch(n.tag){case 5:return V(n.type);case 16:return V("Lazy");case 13:return V("Suspense");case 19:return V("SuspenseList");case 0:case 2:case 15:return n=Pe(n.type,!1),n;case 11:return n=Pe(n.type.render,!1),n;case 1:return n=Pe(n.type,!0),n;default:return""}}function ke(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case L:return"Fragment";case z:return"Portal";case H:return"Profiler";case G:return"StrictMode";case K:return"Suspense";case xe:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Y:return(n.displayName||"Context")+".Consumer";case W:return(n._context.displayName||"Context")+".Provider";case ge:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Be:return i=n.displayName||null,i!==null?i:ke(n.type)||"Memo";case ee:i=n._payload,n=n._init;try{return ke(n(i))}catch{}}return null}function We(n){var i=n.type;switch(n.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=i.render,n=n.displayName||n.name||"",i.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(i);case 8:return i===G?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Fe(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Xe(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function vt(n){var i=Xe(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),d=""+n[i];if(!n.hasOwnProperty(i)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var p=l.get,g=l.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return p.call(this)},set:function(_){d=""+_,g.call(this,_)}}),Object.defineProperty(n,i,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(_){d=""+_},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function kn(n){n._valueTracker||(n._valueTracker=vt(n))}function Dt(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var l=i.getValue(),d="";return n&&(d=Xe(n)?n.checked?"true":"false":n.value),n=d,n!==l?(i.setValue(n),!0):!1}function en(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function mn(n,i){var l=i.checked;return ie({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function Cn(n,i){var l=i.defaultValue==null?"":i.defaultValue,d=i.checked!=null?i.checked:i.defaultChecked;l=Fe(i.value!=null?i.value:l),n._wrapperState={initialChecked:d,initialValue:l,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Ki(n,i){i=i.checked,i!=null&&P(n,"checked",i,!1)}function Ir(n,i){Ki(n,i);var l=Fe(i.value),d=i.type;if(l!=null)d==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(d==="submit"||d==="reset"){n.removeAttribute("value");return}i.hasOwnProperty("value")?Qi(n,i.type,l):i.hasOwnProperty("defaultValue")&&Qi(n,i.type,Fe(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(n.defaultChecked=!!i.defaultChecked)}function hi(n,i,l){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var d=i.type;if(!(d!=="submit"&&d!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+n._wrapperState.initialValue,l||i===n.value||(n.value=i),n.defaultValue=i}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function Qi(n,i,l){(i!=="number"||en(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var An=Array.isArray;function Lr(n,i,l,d){if(n=n.options,i){i={};for(var p=0;p<l.length;p++)i["$"+l[p]]=!0;for(l=0;l<n.length;l++)p=i.hasOwnProperty("$"+n[l].value),n[l].selected!==p&&(n[l].selected=p),p&&d&&(n[l].defaultSelected=!0)}else{for(l=""+Fe(l),i=null,p=0;p<n.length;p++){if(n[p].value===l){n[p].selected=!0,d&&(n[p].defaultSelected=!0);return}i!==null||n[p].disabled||(i=n[p])}i!==null&&(i.selected=!0)}}function Qs(n,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return ie({},i,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Zi(n,i){var l=i.value;if(l==null){if(l=i.children,i=i.defaultValue,l!=null){if(i!=null)throw Error(t(92));if(An(l)){if(1<l.length)throw Error(t(93));l=l[0]}i=l}i==null&&(i=""),l=i}n._wrapperState={initialValue:Fe(l)}}function Ji(n,i){var l=Fe(i.value),d=Fe(i.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),i.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),d!=null&&(n.defaultValue=""+d)}function fa(n){var i=n.textContent;i===n._wrapperState.initialValue&&i!==""&&i!==null&&(n.value=i)}function es(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ts(n,i){return n==null||n==="http://www.w3.org/1999/xhtml"?es(i):n==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var tn,ns=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,l,d,p){MSApp.execUnsafeLocalFunction(function(){return n(i,l,d,p)})}:n})(function(n,i){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=i;else{for(tn=tn||document.createElement("div"),tn.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=tn.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;i.firstChild;)n.appendChild(i.firstChild)}});function $r(n,i){if(i){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=i;return}}n.textContent=i}var Zn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pa=["Webkit","ms","Moz","O"];Object.keys(Zn).forEach(function(n){pa.forEach(function(i){i=i+n.charAt(0).toUpperCase()+n.substring(1),Zn[i]=Zn[n]})});function ma(n,i,l){return i==null||typeof i=="boolean"||i===""?"":l||typeof i!="number"||i===0||Zn.hasOwnProperty(n)&&Zn[n]?(""+i).trim():i+"px"}function ga(n,i){n=n.style;for(var l in i)if(i.hasOwnProperty(l)){var d=l.indexOf("--")===0,p=ma(l,i[l],d);l==="float"&&(l="cssFloat"),d?n.setProperty(l,p):n[l]=p}}var Zs=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zr(n,i){if(i){if(Zs[n]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function fi(n,i){if(n.indexOf("-")===-1)return typeof i.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jr=null;function pi(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var rs=null,dr=null,hr=null;function is(n){if(n=ko(n)){if(typeof rs!="function")throw Error(t(280));var i=n.stateNode;i&&(i=Wa(i),rs(n.stateNode,n.type,i))}}function Lt(n){dr?hr?hr.push(n):hr=[n]:dr=n}function mi(){if(dr){var n=dr,i=hr;if(hr=dr=null,is(n),i)for(n=0;n<i.length;n++)is(i[n])}}function kt(n,i){return n(i)}function Fr(){}var Br=!1;function Tn(n,i,l){if(Br)return n(i,l);Br=!0;try{return kt(n,i,l)}finally{Br=!1,(dr!==null||hr!==null)&&(Fr(),mi())}}function Pn(n,i){var l=n.stateNode;if(l===null)return null;var d=Wa(l);if(d===null)return null;l=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(t(231,i,typeof l));return l}var nn=!1;if(c)try{var gi={};Object.defineProperty(gi,"passive",{get:function(){nn=!0}}),window.addEventListener("test",gi,gi),window.removeEventListener("test",gi,gi)}catch{nn=!1}function ya(n,i,l,d,p,g,_,T,R){var N=Array.prototype.slice.call(arguments,3);try{i.apply(l,N)}catch(q){this.onError(q)}}var ss=!1,yi=null,Ue=!1,os=null,$t={onError:function(n){ss=!0,yi=n}};function Js(n,i,l,d,p,g,_,T,R){ss=!1,yi=null,ya.apply($t,arguments)}function fu(n,i,l,d,p,g,_,T,R){if(Js.apply(this,arguments),ss){if(ss){var N=yi;ss=!1,yi=null}else throw Error(t(198));Ue||(Ue=!0,os=N)}}function Ot(n){var i=n,l=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(l=i.return),n=i.return;while(n)}return i.tag===3?l:null}function eo(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function xa(n){if(Ot(n)!==n)throw Error(t(188))}function pu(n){var i=n.alternate;if(!i){if(i=Ot(n),i===null)throw Error(t(188));return i!==n?null:n}for(var l=n,d=i;;){var p=l.return;if(p===null)break;var g=p.alternate;if(g===null){if(d=p.return,d!==null){l=d;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===l)return xa(p),n;if(g===d)return xa(p),i;g=g.sibling}throw Error(t(188))}if(l.return!==d.return)l=p,d=g;else{for(var _=!1,T=p.child;T;){if(T===l){_=!0,l=p,d=g;break}if(T===d){_=!0,d=p,l=g;break}T=T.sibling}if(!_){for(T=g.child;T;){if(T===l){_=!0,l=g,d=p;break}if(T===d){_=!0,d=g,l=p;break}T=T.sibling}if(!_)throw Error(t(189))}}if(l.alternate!==d)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?n:i}function va(n){return n=pu(n),n!==null?mu(n):null}function mu(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var i=mu(n);if(i!==null)return i;n=n.sibling}return null}var gu=e.unstable_scheduleCallback,as=e.unstable_cancelCallback,_a=e.unstable_shouldYield,yu=e.unstable_requestPaint,lt=e.unstable_now,wa=e.unstable_getCurrentPriorityLevel,fr=e.unstable_ImmediatePriority,Nt=e.unstable_UserBlockingPriority,ls=e.unstable_NormalPriority,to=e.unstable_LowPriority,qt=e.unstable_IdlePriority,xi=null,ut=null;function ba(n){if(ut&&typeof ut.onCommitFiberRoot=="function")try{ut.onCommitFiberRoot(xi,n,void 0,(n.current.flags&128)===128)}catch{}}var rn=Math.clz32?Math.clz32:no,xu=Math.log,vu=Math.LN2;function no(n){return n>>>=0,n===0?32:31-(xu(n)/vu|0)|0}var us=64,Dr=4194304;function vi(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function ae(n,i){var l=n.pendingLanes;if(l===0)return 0;var d=0,p=n.suspendedLanes,g=n.pingedLanes,_=l&268435455;if(_!==0){var T=_&~p;T!==0?d=vi(T):(g&=_,g!==0&&(d=vi(g)))}else _=l&~p,_!==0?d=vi(_):g!==0&&(d=vi(g));if(d===0)return 0;if(i!==0&&i!==d&&(i&p)===0&&(p=d&-d,g=i&-i,p>=g||p===16&&(g&4194240)!==0))return i;if((d&4)!==0&&(d|=l&16),i=n.entangledLanes,i!==0)for(n=n.entanglements,i&=d;0<i;)l=31-rn(i),p=1<<l,d|=n[l],i&=~p;return d}function Sa(n,i){switch(n){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cs(n,i){for(var l=n.suspendedLanes,d=n.pingedLanes,p=n.expirationTimes,g=n.pendingLanes;0<g;){var _=31-rn(g),T=1<<_,R=p[_];R===-1?((T&l)===0||(T&d)!==0)&&(p[_]=Sa(T,i)):R<=i&&(n.expiredLanes|=T),g&=~T}}function ro(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function ka(){var n=us;return us<<=1,(us&4194240)===0&&(us=64),n}function _i(n){for(var i=[],l=0;31>l;l++)i.push(n);return i}function Or(n,i,l){n.pendingLanes|=i,i!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,i=31-rn(i),n[i]=l}function _u(n,i){var l=n.pendingLanes&~i;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=i,n.mutableReadLanes&=i,n.entangledLanes&=i,i=n.entanglements;var d=n.eventTimes;for(n=n.expirationTimes;0<l;){var p=31-rn(l),g=1<<p;i[p]=0,d[p]=-1,n[p]=-1,l&=~g}}function wi(n,i){var l=n.entangledLanes|=i;for(n=n.entanglements;l;){var d=31-rn(l),p=1<<d;p&i|n[d]&i&&(n[d]|=i),l&=~p}}var Ge=0;function Nr(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Ca,io,Aa,Ta,Pa,so=!1,bi=[],sn=null,Jn=null,Mn=null,er=new Map,Wr=new Map,tr=[],Ma="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oo(n,i){switch(n){case"focusin":case"focusout":sn=null;break;case"dragenter":case"dragleave":Jn=null;break;case"mouseover":case"mouseout":Mn=null;break;case"pointerover":case"pointerout":er.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wr.delete(i.pointerId)}}function Si(n,i,l,d,p,g){return n===null||n.nativeEvent!==g?(n={blockedOn:i,domEventName:l,eventSystemFlags:d,nativeEvent:g,targetContainers:[p]},i!==null&&(i=ko(i),i!==null&&io(i)),n):(n.eventSystemFlags|=d,i=n.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),n)}function wu(n,i,l,d,p){switch(i){case"focusin":return sn=Si(sn,n,i,l,d,p),!0;case"dragenter":return Jn=Si(Jn,n,i,l,d,p),!0;case"mouseover":return Mn=Si(Mn,n,i,l,d,p),!0;case"pointerover":var g=p.pointerId;return er.set(g,Si(er.get(g)||null,n,i,l,d,p)),!0;case"gotpointercapture":return g=p.pointerId,Wr.set(g,Si(Wr.get(g)||null,n,i,l,d,p)),!0}return!1}function Ea(n){var i=Mi(n.target);if(i!==null){var l=Ot(i);if(l!==null){if(i=l.tag,i===13){if(i=eo(l),i!==null){n.blockedOn=i,Pa(n.priority,function(){Aa(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ds(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var l=uo(n.domEventName,n.eventSystemFlags,i[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var d=new l.constructor(l.type,l);jr=d,l.target.dispatchEvent(d),jr=null}else return i=ko(l),i!==null&&io(i),n.blockedOn=l,!1;i.shift()}return!0}function Ra(n,i,l){ds(n)&&l.delete(i)}function bu(){so=!1,sn!==null&&ds(sn)&&(sn=null),Jn!==null&&ds(Jn)&&(Jn=null),Mn!==null&&ds(Mn)&&(Mn=null),er.forEach(Ra),Wr.forEach(Ra)}function ki(n,i){n.blockedOn===i&&(n.blockedOn=null,so||(so=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,bu)))}function Ci(n){function i(p){return ki(p,n)}if(0<bi.length){ki(bi[0],n);for(var l=1;l<bi.length;l++){var d=bi[l];d.blockedOn===n&&(d.blockedOn=null)}}for(sn!==null&&ki(sn,n),Jn!==null&&ki(Jn,n),Mn!==null&&ki(Mn,n),er.forEach(i),Wr.forEach(i),l=0;l<tr.length;l++)d=tr[l],d.blockedOn===n&&(d.blockedOn=null);for(;0<tr.length&&(l=tr[0],l.blockedOn===null);)Ea(l),l.blockedOn===null&&tr.shift()}var Hr=M.ReactCurrentBatchConfig,hs=!0;function Su(n,i,l,d){var p=Ge,g=Hr.transition;Hr.transition=null;try{Ge=1,lo(n,i,l,d)}finally{Ge=p,Hr.transition=g}}function ao(n,i,l,d){var p=Ge,g=Hr.transition;Hr.transition=null;try{Ge=4,lo(n,i,l,d)}finally{Ge=p,Hr.transition=g}}function lo(n,i,l,d){if(hs){var p=uo(n,i,l,d);if(p===null)ju(n,i,d,pr,l),oo(n,d);else if(wu(p,n,i,l,d))d.stopPropagation();else if(oo(n,d),i&4&&-1<Ma.indexOf(n)){for(;p!==null;){var g=ko(p);if(g!==null&&Ca(g),g=uo(n,i,l,d),g===null&&ju(n,i,d,pr,l),g===p)break;p=g}p!==null&&d.stopPropagation()}else ju(n,i,d,null,l)}}var pr=null;function uo(n,i,l,d){if(pr=null,n=pi(d),n=Mi(n),n!==null)if(i=Ot(n),i===null)n=null;else if(l=i.tag,l===13){if(n=eo(i),n!==null)return n;n=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null);return pr=n,null}function Ur(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wa()){case fr:return 1;case Nt:return 4;case ls:case to:return 16;case qt:return 536870912;default:return 16}default:return 16}}var gn=null,co=null,fs=null;function Ia(){if(fs)return fs;var n,i=co,l=i.length,d,p="value"in gn?gn.value:gn.textContent,g=p.length;for(n=0;n<l&&i[n]===p[n];n++);var _=l-n;for(d=1;d<=_&&i[l-d]===p[g-d];d++);return fs=p.slice(n,1<d?1-d:void 0)}function Gr(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function ps(){return!0}function La(){return!1}function Kt(n){function i(l,d,p,g,_){this._reactName=l,this._targetInst=p,this.type=d,this.nativeEvent=g,this.target=_,this.currentTarget=null;for(var T in n)n.hasOwnProperty(T)&&(l=n[T],this[T]=l?l(g):g[T]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?ps:La,this.isPropagationStopped=La,this}return ie(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ps)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ps)},persist:function(){},isPersistent:ps}),i}var Vr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ho=Kt(Vr),Ai=ie({},Vr,{view:0,detail:0}),ku=Kt(Ai),fo,k,$,B=ie({},Ai,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Oe,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==$&&($&&n.type==="mousemove"?(fo=n.screenX-$.screenX,k=n.screenY-$.screenY):k=fo=0,$=n),fo)},movementY:function(n){return"movementY"in n?n.movementY:k}}),U=Kt(B),se=ie({},B,{dataTransfer:0}),Ie=Kt(se),le=ie({},Ai,{relatedTarget:0}),ye=Kt(le),Ce=ie({},Vr,{animationName:0,elapsedTime:0,pseudoElement:0}),he=Kt(Ce),Ve=ie({},Vr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ae=Kt(Ve),Me=ie({},Vr,{data:0}),De=Kt(Me),Ee={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},de={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tt(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=_e[n])?!!i[n]:!1}function Oe(){return tt}var Qe=ie({},Ai,{key:function(n){if(n.key){var i=Ee[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Gr(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?de[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Oe,charCode:function(n){return n.type==="keypress"?Gr(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Gr(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Wt=Kt(Qe),wt=ie({},B,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tt=Kt(wt),nt=ie({},Ai,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Oe}),mr=Kt(nt),Cu=ie({},Vr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Au=Kt(Cu),En=ie({},B,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),$a=Kt(En),ze=[9,13,27,32],ct=c&&"CompositionEvent"in window,Pt=null;c&&"documentMode"in document&&(Pt=document.documentMode);var nr=c&&"TextEvent"in window&&!Pt,po=c&&(!ct||Pt&&8<Pt&&11>=Pt),Ti=" ",Pi=!1;function mo(n,i){switch(n){case"keyup":return ze.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uh(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ms=!1;function Tm(n,i){switch(n){case"compositionend":return uh(i);case"keypress":return i.which!==32?null:(Pi=!0,Ti);case"textInput":return n=i.data,n===Ti&&Pi?null:n;default:return null}}function Pm(n,i){if(ms)return n==="compositionend"||!ct&&mo(n,i)?(n=Ia(),fs=co=gn=null,ms=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return po&&i.locale!=="ko"?null:i.data;default:return null}}var Mm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ch(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Mm[n.type]:i==="textarea"}function dh(n,i,l,d){Lt(d),i=Da(i,"onChange"),0<i.length&&(l=new ho("onChange","change",null,l,d),n.push({event:l,listeners:i}))}var go=null,yo=null;function Em(n){Mh(n,0)}function za(n){var i=_s(n);if(Dt(i))return n}function Rm(n,i){if(n==="change")return i}var hh=!1;if(c){var Tu;if(c){var Pu="oninput"in document;if(!Pu){var fh=document.createElement("div");fh.setAttribute("oninput","return;"),Pu=typeof fh.oninput=="function"}Tu=Pu}else Tu=!1;hh=Tu&&(!document.documentMode||9<document.documentMode)}function ph(){go&&(go.detachEvent("onpropertychange",mh),yo=go=null)}function mh(n){if(n.propertyName==="value"&&za(yo)){var i=[];dh(i,yo,n,pi(n)),Tn(Em,i)}}function Im(n,i,l){n==="focusin"?(ph(),go=i,yo=l,go.attachEvent("onpropertychange",mh)):n==="focusout"&&ph()}function Lm(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return za(yo)}function $m(n,i){if(n==="click")return za(i)}function zm(n,i){if(n==="input"||n==="change")return za(i)}function jm(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var On=typeof Object.is=="function"?Object.is:jm;function xo(n,i){if(On(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var l=Object.keys(n),d=Object.keys(i);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var p=l[d];if(!h.call(i,p)||!On(n[p],i[p]))return!1}return!0}function gh(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function yh(n,i){var l=gh(n);n=0;for(var d;l;){if(l.nodeType===3){if(d=n+l.textContent.length,n<=i&&d>=i)return{node:l,offset:i-n};n=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=gh(l)}}function xh(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?xh(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function vh(){for(var n=window,i=en();i instanceof n.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)n=i.contentWindow;else break;i=en(n.document)}return i}function Mu(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}function Fm(n){var i=vh(),l=n.focusedElem,d=n.selectionRange;if(i!==l&&l&&l.ownerDocument&&xh(l.ownerDocument.documentElement,l)){if(d!==null&&Mu(l)){if(i=d.start,n=d.end,n===void 0&&(n=i),"selectionStart"in l)l.selectionStart=i,l.selectionEnd=Math.min(n,l.value.length);else if(n=(i=l.ownerDocument||document)&&i.defaultView||window,n.getSelection){n=n.getSelection();var p=l.textContent.length,g=Math.min(d.start,p);d=d.end===void 0?g:Math.min(d.end,p),!n.extend&&g>d&&(p=d,d=g,g=p),p=yh(l,g);var _=yh(l,d);p&&_&&(n.rangeCount!==1||n.anchorNode!==p.node||n.anchorOffset!==p.offset||n.focusNode!==_.node||n.focusOffset!==_.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),n.removeAllRanges(),g>d?(n.addRange(i),n.extend(_.node,_.offset)):(i.setEnd(_.node,_.offset),n.addRange(i)))}}for(i=[],n=l;n=n.parentNode;)n.nodeType===1&&i.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<i.length;l++)n=i[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Bm=c&&"documentMode"in document&&11>=document.documentMode,gs=null,Eu=null,vo=null,Ru=!1;function _h(n,i,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Ru||gs==null||gs!==en(d)||(d=gs,"selectionStart"in d&&Mu(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),vo&&xo(vo,d)||(vo=d,d=Da(Eu,"onSelect"),0<d.length&&(i=new ho("onSelect","select",null,i,l),n.push({event:i,listeners:d}),i.target=gs)))}function ja(n,i){var l={};return l[n.toLowerCase()]=i.toLowerCase(),l["Webkit"+n]="webkit"+i,l["Moz"+n]="moz"+i,l}var ys={animationend:ja("Animation","AnimationEnd"),animationiteration:ja("Animation","AnimationIteration"),animationstart:ja("Animation","AnimationStart"),transitionend:ja("Transition","TransitionEnd")},Iu={},wh={};c&&(wh=document.createElement("div").style,"AnimationEvent"in window||(delete ys.animationend.animation,delete ys.animationiteration.animation,delete ys.animationstart.animation),"TransitionEvent"in window||delete ys.transitionend.transition);function Fa(n){if(Iu[n])return Iu[n];if(!ys[n])return n;var i=ys[n],l;for(l in i)if(i.hasOwnProperty(l)&&l in wh)return Iu[n]=i[l];return n}var bh=Fa("animationend"),Sh=Fa("animationiteration"),kh=Fa("animationstart"),Ch=Fa("transitionend"),Ah=new Map,Th="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yr(n,i){Ah.set(n,i),a(i,[n])}for(var Lu=0;Lu<Th.length;Lu++){var $u=Th[Lu],Dm=$u.toLowerCase(),Om=$u[0].toUpperCase()+$u.slice(1);Yr(Dm,"on"+Om)}Yr(bh,"onAnimationEnd"),Yr(Sh,"onAnimationIteration"),Yr(kh,"onAnimationStart"),Yr("dblclick","onDoubleClick"),Yr("focusin","onFocus"),Yr("focusout","onBlur"),Yr(Ch,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _o="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nm=new Set("cancel close invalid load scroll toggle".split(" ").concat(_o));function Ph(n,i,l){var d=n.type||"unknown-event";n.currentTarget=l,fu(d,i,void 0,n),n.currentTarget=null}function Mh(n,i){i=(i&4)!==0;for(var l=0;l<n.length;l++){var d=n[l],p=d.event;d=d.listeners;e:{var g=void 0;if(i)for(var _=d.length-1;0<=_;_--){var T=d[_],R=T.instance,N=T.currentTarget;if(T=T.listener,R!==g&&p.isPropagationStopped())break e;Ph(p,T,N),g=R}else for(_=0;_<d.length;_++){if(T=d[_],R=T.instance,N=T.currentTarget,T=T.listener,R!==g&&p.isPropagationStopped())break e;Ph(p,T,N),g=R}}}if(Ue)throw n=os,Ue=!1,os=null,n}function rt(n,i){var l=i[Wu];l===void 0&&(l=i[Wu]=new Set);var d=n+"__bubble";l.has(d)||(Eh(i,n,2,!1),l.add(d))}function zu(n,i,l){var d=0;i&&(d|=4),Eh(l,n,d,i)}var Ba="_reactListening"+Math.random().toString(36).slice(2);function wo(n){if(!n[Ba]){n[Ba]=!0,s.forEach(function(l){l!=="selectionchange"&&(Nm.has(l)||zu(l,!1,n),zu(l,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[Ba]||(i[Ba]=!0,zu("selectionchange",!1,i))}}function Eh(n,i,l,d){switch(Ur(i)){case 1:var p=Su;break;case 4:p=ao;break;default:p=lo}l=p.bind(null,i,l,n),p=void 0,!nn||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),d?p!==void 0?n.addEventListener(i,l,{capture:!0,passive:p}):n.addEventListener(i,l,!0):p!==void 0?n.addEventListener(i,l,{passive:p}):n.addEventListener(i,l,!1)}function ju(n,i,l,d,p){var g=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var _=d.tag;if(_===3||_===4){var T=d.stateNode.containerInfo;if(T===p||T.nodeType===8&&T.parentNode===p)break;if(_===4)for(_=d.return;_!==null;){var R=_.tag;if((R===3||R===4)&&(R=_.stateNode.containerInfo,R===p||R.nodeType===8&&R.parentNode===p))return;_=_.return}for(;T!==null;){if(_=Mi(T),_===null)return;if(R=_.tag,R===5||R===6){d=g=_;continue e}T=T.parentNode}}d=d.return}Tn(function(){var N=g,q=pi(l),Q=[];e:{var X=Ah.get(n);if(X!==void 0){var oe=ho,ce=n;switch(n){case"keypress":if(Gr(l)===0)break e;case"keydown":case"keyup":oe=Wt;break;case"focusin":ce="focus",oe=ye;break;case"focusout":ce="blur",oe=ye;break;case"beforeblur":case"afterblur":oe=ye;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=U;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=Ie;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=mr;break;case bh:case Sh:case kh:oe=he;break;case Ch:oe=Au;break;case"scroll":oe=ku;break;case"wheel":oe=$a;break;case"copy":case"cut":case"paste":oe=Ae;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=Tt}var fe=(i&4)!==0,_t=!fe&&n==="scroll",F=fe?X!==null?X+"Capture":null:X;fe=[];for(var I=N,O;I!==null;){O=I;var J=O.stateNode;if(O.tag===5&&J!==null&&(O=J,F!==null&&(J=Pn(I,F),J!=null&&fe.push(bo(I,J,O)))),_t)break;I=I.return}0<fe.length&&(X=new oe(X,ce,null,l,q),Q.push({event:X,listeners:fe}))}}if((i&7)===0){e:{if(X=n==="mouseover"||n==="pointerover",oe=n==="mouseout"||n==="pointerout",X&&l!==jr&&(ce=l.relatedTarget||l.fromElement)&&(Mi(ce)||ce[gr]))break e;if((oe||X)&&(X=q.window===q?q:(X=q.ownerDocument)?X.defaultView||X.parentWindow:window,oe?(ce=l.relatedTarget||l.toElement,oe=N,ce=ce?Mi(ce):null,ce!==null&&(_t=Ot(ce),ce!==_t||ce.tag!==5&&ce.tag!==6)&&(ce=null)):(oe=null,ce=N),oe!==ce)){if(fe=U,J="onMouseLeave",F="onMouseEnter",I="mouse",(n==="pointerout"||n==="pointerover")&&(fe=Tt,J="onPointerLeave",F="onPointerEnter",I="pointer"),_t=oe==null?X:_s(oe),O=ce==null?X:_s(ce),X=new fe(J,I+"leave",oe,l,q),X.target=_t,X.relatedTarget=O,J=null,Mi(q)===N&&(fe=new fe(F,I+"enter",ce,l,q),fe.target=O,fe.relatedTarget=_t,J=fe),_t=J,oe&&ce)t:{for(fe=oe,F=ce,I=0,O=fe;O;O=xs(O))I++;for(O=0,J=F;J;J=xs(J))O++;for(;0<I-O;)fe=xs(fe),I--;for(;0<O-I;)F=xs(F),O--;for(;I--;){if(fe===F||F!==null&&fe===F.alternate)break t;fe=xs(fe),F=xs(F)}fe=null}else fe=null;oe!==null&&Rh(Q,X,oe,fe,!1),ce!==null&&_t!==null&&Rh(Q,_t,ce,fe,!0)}}e:{if(X=N?_s(N):window,oe=X.nodeName&&X.nodeName.toLowerCase(),oe==="select"||oe==="input"&&X.type==="file")var pe=Rm;else if(ch(X))if(hh)pe=zm;else{pe=Lm;var we=Im}else(oe=X.nodeName)&&oe.toLowerCase()==="input"&&(X.type==="checkbox"||X.type==="radio")&&(pe=$m);if(pe&&(pe=pe(n,N))){dh(Q,pe,l,q);break e}we&&we(n,X,N),n==="focusout"&&(we=X._wrapperState)&&we.controlled&&X.type==="number"&&Qi(X,"number",X.value)}switch(we=N?_s(N):window,n){case"focusin":(ch(we)||we.contentEditable==="true")&&(gs=we,Eu=N,vo=null);break;case"focusout":vo=Eu=gs=null;break;case"mousedown":Ru=!0;break;case"contextmenu":case"mouseup":case"dragend":Ru=!1,_h(Q,l,q);break;case"selectionchange":if(Bm)break;case"keydown":case"keyup":_h(Q,l,q)}var be;if(ct)e:{switch(n){case"compositionstart":var Te="onCompositionStart";break e;case"compositionend":Te="onCompositionEnd";break e;case"compositionupdate":Te="onCompositionUpdate";break e}Te=void 0}else ms?mo(n,l)&&(Te="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(Te="onCompositionStart");Te&&(po&&l.locale!=="ko"&&(ms||Te!=="onCompositionStart"?Te==="onCompositionEnd"&&ms&&(be=Ia()):(gn=q,co="value"in gn?gn.value:gn.textContent,ms=!0)),we=Da(N,Te),0<we.length&&(Te=new De(Te,n,null,l,q),Q.push({event:Te,listeners:we}),be?Te.data=be:(be=uh(l),be!==null&&(Te.data=be)))),(be=nr?Tm(n,l):Pm(n,l))&&(N=Da(N,"onBeforeInput"),0<N.length&&(q=new De("onBeforeInput","beforeinput",null,l,q),Q.push({event:q,listeners:N}),q.data=be))}Mh(Q,i)})}function bo(n,i,l){return{instance:n,listener:i,currentTarget:l}}function Da(n,i){for(var l=i+"Capture",d=[];n!==null;){var p=n,g=p.stateNode;p.tag===5&&g!==null&&(p=g,g=Pn(n,l),g!=null&&d.unshift(bo(n,g,p)),g=Pn(n,i),g!=null&&d.push(bo(n,g,p))),n=n.return}return d}function xs(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Rh(n,i,l,d,p){for(var g=i._reactName,_=[];l!==null&&l!==d;){var T=l,R=T.alternate,N=T.stateNode;if(R!==null&&R===d)break;T.tag===5&&N!==null&&(T=N,p?(R=Pn(l,g),R!=null&&_.unshift(bo(l,R,T))):p||(R=Pn(l,g),R!=null&&_.push(bo(l,R,T)))),l=l.return}_.length!==0&&n.push({event:i,listeners:_})}var Wm=/\r\n?/g,Hm=/\u0000|\uFFFD/g;function Ih(n){return(typeof n=="string"?n:""+n).replace(Wm,`
`).replace(Hm,"")}function Oa(n,i,l){if(i=Ih(i),Ih(n)!==i&&l)throw Error(t(425))}function Na(){}var Fu=null,Bu=null;function Du(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ou=typeof setTimeout=="function"?setTimeout:void 0,Um=typeof clearTimeout=="function"?clearTimeout:void 0,Lh=typeof Promise=="function"?Promise:void 0,Gm=typeof queueMicrotask=="function"?queueMicrotask:typeof Lh<"u"?function(n){return Lh.resolve(null).then(n).catch(Vm)}:Ou;function Vm(n){setTimeout(function(){throw n})}function Nu(n,i){var l=i,d=0;do{var p=l.nextSibling;if(n.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"){if(d===0){n.removeChild(p),Ci(i);return}d--}else l!=="$"&&l!=="$?"&&l!=="$!"||d++;l=p}while(l);Ci(i)}function Xr(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return n}function $h(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(i===0)return n;i--}else l==="/$"&&i++}n=n.previousSibling}return null}var vs=Math.random().toString(36).slice(2),rr="__reactFiber$"+vs,So="__reactProps$"+vs,gr="__reactContainer$"+vs,Wu="__reactEvents$"+vs,Ym="__reactListeners$"+vs,Xm="__reactHandles$"+vs;function Mi(n){var i=n[rr];if(i)return i;for(var l=n.parentNode;l;){if(i=l[gr]||l[rr]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(n=$h(n);n!==null;){if(l=n[rr])return l;n=$h(n)}return i}n=l,l=n.parentNode}return null}function ko(n){return n=n[rr]||n[gr],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function _s(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function Wa(n){return n[So]||null}var Hu=[],ws=-1;function qr(n){return{current:n}}function it(n){0>ws||(n.current=Hu[ws],Hu[ws]=null,ws--)}function Je(n,i){ws++,Hu[ws]=n.current,n.current=i}var Kr={},Ht=qr(Kr),on=qr(!1),Ei=Kr;function bs(n,i){var l=n.type.contextTypes;if(!l)return Kr;var d=n.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===i)return d.__reactInternalMemoizedMaskedChildContext;var p={},g;for(g in l)p[g]=i[g];return d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=p),p}function an(n){return n=n.childContextTypes,n!=null}function Ha(){it(on),it(Ht)}function zh(n,i,l){if(Ht.current!==Kr)throw Error(t(168));Je(Ht,i),Je(on,l)}function jh(n,i,l){var d=n.stateNode;if(i=i.childContextTypes,typeof d.getChildContext!="function")return l;d=d.getChildContext();for(var p in d)if(!(p in i))throw Error(t(108,We(n)||"Unknown",p));return ie({},l,d)}function Ua(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Kr,Ei=Ht.current,Je(Ht,n),Je(on,on.current),!0}function Fh(n,i,l){var d=n.stateNode;if(!d)throw Error(t(169));l?(n=jh(n,i,Ei),d.__reactInternalMemoizedMergedChildContext=n,it(on),it(Ht),Je(Ht,n)):it(on),Je(on,l)}var yr=null,Ga=!1,Uu=!1;function Bh(n){yr===null?yr=[n]:yr.push(n)}function qm(n){Ga=!0,Bh(n)}function Qr(){if(!Uu&&yr!==null){Uu=!0;var n=0,i=Ge;try{var l=yr;for(Ge=1;n<l.length;n++){var d=l[n];do d=d(!0);while(d!==null)}yr=null,Ga=!1}catch(p){throw yr!==null&&(yr=yr.slice(n+1)),gu(fr,Qr),p}finally{Ge=i,Uu=!1}}return null}var Ss=[],ks=0,Va=null,Ya=0,Rn=[],In=0,Ri=null,xr=1,vr="";function Ii(n,i){Ss[ks++]=Ya,Ss[ks++]=Va,Va=n,Ya=i}function Dh(n,i,l){Rn[In++]=xr,Rn[In++]=vr,Rn[In++]=Ri,Ri=n;var d=xr;n=vr;var p=32-rn(d)-1;d&=~(1<<p),l+=1;var g=32-rn(i)+p;if(30<g){var _=p-p%5;g=(d&(1<<_)-1).toString(32),d>>=_,p-=_,xr=1<<32-rn(i)+p|l<<p|d,vr=g+n}else xr=1<<g|l<<p|d,vr=n}function Gu(n){n.return!==null&&(Ii(n,1),Dh(n,1,0))}function Vu(n){for(;n===Va;)Va=Ss[--ks],Ss[ks]=null,Ya=Ss[--ks],Ss[ks]=null;for(;n===Ri;)Ri=Rn[--In],Rn[In]=null,vr=Rn[--In],Rn[In]=null,xr=Rn[--In],Rn[In]=null}var yn=null,xn=null,dt=!1,Nn=null;function Oh(n,i){var l=jn(5,null,null,0);l.elementType="DELETED",l.stateNode=i,l.return=n,i=n.deletions,i===null?(n.deletions=[l],n.flags|=16):i.push(l)}function Nh(n,i){switch(n.tag){case 5:var l=n.type;return i=i.nodeType!==1||l.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(n.stateNode=i,yn=n,xn=Xr(i.firstChild),!0):!1;case 6:return i=n.pendingProps===""||i.nodeType!==3?null:i,i!==null?(n.stateNode=i,yn=n,xn=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(l=Ri!==null?{id:xr,overflow:vr}:null,n.memoizedState={dehydrated:i,treeContext:l,retryLane:1073741824},l=jn(18,null,null,0),l.stateNode=i,l.return=n,n.child=l,yn=n,xn=null,!0):!1;default:return!1}}function Yu(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Xu(n){if(dt){var i=xn;if(i){var l=i;if(!Nh(n,i)){if(Yu(n))throw Error(t(418));i=Xr(l.nextSibling);var d=yn;i&&Nh(n,i)?Oh(d,l):(n.flags=n.flags&-4097|2,dt=!1,yn=n)}}else{if(Yu(n))throw Error(t(418));n.flags=n.flags&-4097|2,dt=!1,yn=n}}}function Wh(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;yn=n}function Xa(n){if(n!==yn)return!1;if(!dt)return Wh(n),dt=!0,!1;var i;if((i=n.tag!==3)&&!(i=n.tag!==5)&&(i=n.type,i=i!=="head"&&i!=="body"&&!Du(n.type,n.memoizedProps)),i&&(i=xn)){if(Yu(n))throw Hh(),Error(t(418));for(;i;)Oh(n,i),i=Xr(i.nextSibling)}if(Wh(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(i===0){xn=Xr(n.nextSibling);break e}i--}else l!=="$"&&l!=="$!"&&l!=="$?"||i++}n=n.nextSibling}xn=null}}else xn=yn?Xr(n.stateNode.nextSibling):null;return!0}function Hh(){for(var n=xn;n;)n=Xr(n.nextSibling)}function Cs(){xn=yn=null,dt=!1}function qu(n){Nn===null?Nn=[n]:Nn.push(n)}var Km=M.ReactCurrentBatchConfig;function Co(n,i,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var d=l.stateNode}if(!d)throw Error(t(147,n));var p=d,g=""+n;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===g?i.ref:(i=function(_){var T=p.refs;_===null?delete T[g]:T[g]=_},i._stringRef=g,i)}if(typeof n!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,n))}return n}function qa(n,i){throw n=Object.prototype.toString.call(i),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n))}function Uh(n){var i=n._init;return i(n._payload)}function Gh(n){function i(F,I){if(n){var O=F.deletions;O===null?(F.deletions=[I],F.flags|=16):O.push(I)}}function l(F,I){if(!n)return null;for(;I!==null;)i(F,I),I=I.sibling;return null}function d(F,I){for(F=new Map;I!==null;)I.key!==null?F.set(I.key,I):F.set(I.index,I),I=I.sibling;return F}function p(F,I){return F=si(F,I),F.index=0,F.sibling=null,F}function g(F,I,O){return F.index=O,n?(O=F.alternate,O!==null?(O=O.index,O<I?(F.flags|=2,I):O):(F.flags|=2,I)):(F.flags|=1048576,I)}function _(F){return n&&F.alternate===null&&(F.flags|=2),F}function T(F,I,O,J){return I===null||I.tag!==6?(I=Oc(O,F.mode,J),I.return=F,I):(I=p(I,O),I.return=F,I)}function R(F,I,O,J){var pe=O.type;return pe===L?q(F,I,O.props.children,J,O.key):I!==null&&(I.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===ee&&Uh(pe)===I.type)?(J=p(I,O.props),J.ref=Co(F,I,O),J.return=F,J):(J=vl(O.type,O.key,O.props,null,F.mode,J),J.ref=Co(F,I,O),J.return=F,J)}function N(F,I,O,J){return I===null||I.tag!==4||I.stateNode.containerInfo!==O.containerInfo||I.stateNode.implementation!==O.implementation?(I=Nc(O,F.mode,J),I.return=F,I):(I=p(I,O.children||[]),I.return=F,I)}function q(F,I,O,J,pe){return I===null||I.tag!==7?(I=Oi(O,F.mode,J,pe),I.return=F,I):(I=p(I,O),I.return=F,I)}function Q(F,I,O){if(typeof I=="string"&&I!==""||typeof I=="number")return I=Oc(""+I,F.mode,O),I.return=F,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case D:return O=vl(I.type,I.key,I.props,null,F.mode,O),O.ref=Co(F,null,I),O.return=F,O;case z:return I=Nc(I,F.mode,O),I.return=F,I;case ee:var J=I._init;return Q(F,J(I._payload),O)}if(An(I)||ne(I))return I=Oi(I,F.mode,O,null),I.return=F,I;qa(F,I)}return null}function X(F,I,O,J){var pe=I!==null?I.key:null;if(typeof O=="string"&&O!==""||typeof O=="number")return pe!==null?null:T(F,I,""+O,J);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case D:return O.key===pe?R(F,I,O,J):null;case z:return O.key===pe?N(F,I,O,J):null;case ee:return pe=O._init,X(F,I,pe(O._payload),J)}if(An(O)||ne(O))return pe!==null?null:q(F,I,O,J,null);qa(F,O)}return null}function oe(F,I,O,J,pe){if(typeof J=="string"&&J!==""||typeof J=="number")return F=F.get(O)||null,T(I,F,""+J,pe);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case D:return F=F.get(J.key===null?O:J.key)||null,R(I,F,J,pe);case z:return F=F.get(J.key===null?O:J.key)||null,N(I,F,J,pe);case ee:var we=J._init;return oe(F,I,O,we(J._payload),pe)}if(An(J)||ne(J))return F=F.get(O)||null,q(I,F,J,pe,null);qa(I,J)}return null}function ce(F,I,O,J){for(var pe=null,we=null,be=I,Te=I=0,Rt=null;be!==null&&Te<O.length;Te++){be.index>Te?(Rt=be,be=null):Rt=be.sibling;var Ye=X(F,be,O[Te],J);if(Ye===null){be===null&&(be=Rt);break}n&&be&&Ye.alternate===null&&i(F,be),I=g(Ye,I,Te),we===null?pe=Ye:we.sibling=Ye,we=Ye,be=Rt}if(Te===O.length)return l(F,be),dt&&Ii(F,Te),pe;if(be===null){for(;Te<O.length;Te++)be=Q(F,O[Te],J),be!==null&&(I=g(be,I,Te),we===null?pe=be:we.sibling=be,we=be);return dt&&Ii(F,Te),pe}for(be=d(F,be);Te<O.length;Te++)Rt=oe(be,F,Te,O[Te],J),Rt!==null&&(n&&Rt.alternate!==null&&be.delete(Rt.key===null?Te:Rt.key),I=g(Rt,I,Te),we===null?pe=Rt:we.sibling=Rt,we=Rt);return n&&be.forEach(function(oi){return i(F,oi)}),dt&&Ii(F,Te),pe}function fe(F,I,O,J){var pe=ne(O);if(typeof pe!="function")throw Error(t(150));if(O=pe.call(O),O==null)throw Error(t(151));for(var we=pe=null,be=I,Te=I=0,Rt=null,Ye=O.next();be!==null&&!Ye.done;Te++,Ye=O.next()){be.index>Te?(Rt=be,be=null):Rt=be.sibling;var oi=X(F,be,Ye.value,J);if(oi===null){be===null&&(be=Rt);break}n&&be&&oi.alternate===null&&i(F,be),I=g(oi,I,Te),we===null?pe=oi:we.sibling=oi,we=oi,be=Rt}if(Ye.done)return l(F,be),dt&&Ii(F,Te),pe;if(be===null){for(;!Ye.done;Te++,Ye=O.next())Ye=Q(F,Ye.value,J),Ye!==null&&(I=g(Ye,I,Te),we===null?pe=Ye:we.sibling=Ye,we=Ye);return dt&&Ii(F,Te),pe}for(be=d(F,be);!Ye.done;Te++,Ye=O.next())Ye=oe(be,F,Te,Ye.value,J),Ye!==null&&(n&&Ye.alternate!==null&&be.delete(Ye.key===null?Te:Ye.key),I=g(Ye,I,Te),we===null?pe=Ye:we.sibling=Ye,we=Ye);return n&&be.forEach(function(Mg){return i(F,Mg)}),dt&&Ii(F,Te),pe}function _t(F,I,O,J){if(typeof O=="object"&&O!==null&&O.type===L&&O.key===null&&(O=O.props.children),typeof O=="object"&&O!==null){switch(O.$$typeof){case D:e:{for(var pe=O.key,we=I;we!==null;){if(we.key===pe){if(pe=O.type,pe===L){if(we.tag===7){l(F,we.sibling),I=p(we,O.props.children),I.return=F,F=I;break e}}else if(we.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===ee&&Uh(pe)===we.type){l(F,we.sibling),I=p(we,O.props),I.ref=Co(F,we,O),I.return=F,F=I;break e}l(F,we);break}else i(F,we);we=we.sibling}O.type===L?(I=Oi(O.props.children,F.mode,J,O.key),I.return=F,F=I):(J=vl(O.type,O.key,O.props,null,F.mode,J),J.ref=Co(F,I,O),J.return=F,F=J)}return _(F);case z:e:{for(we=O.key;I!==null;){if(I.key===we)if(I.tag===4&&I.stateNode.containerInfo===O.containerInfo&&I.stateNode.implementation===O.implementation){l(F,I.sibling),I=p(I,O.children||[]),I.return=F,F=I;break e}else{l(F,I);break}else i(F,I);I=I.sibling}I=Nc(O,F.mode,J),I.return=F,F=I}return _(F);case ee:return we=O._init,_t(F,I,we(O._payload),J)}if(An(O))return ce(F,I,O,J);if(ne(O))return fe(F,I,O,J);qa(F,O)}return typeof O=="string"&&O!==""||typeof O=="number"?(O=""+O,I!==null&&I.tag===6?(l(F,I.sibling),I=p(I,O),I.return=F,F=I):(l(F,I),I=Oc(O,F.mode,J),I.return=F,F=I),_(F)):l(F,I)}return _t}var As=Gh(!0),Vh=Gh(!1),Ka=qr(null),Qa=null,Ts=null,Ku=null;function Qu(){Ku=Ts=Qa=null}function Zu(n){var i=Ka.current;it(Ka),n._currentValue=i}function Ju(n,i,l){for(;n!==null;){var d=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),n===l)break;n=n.return}}function Ps(n,i){Qa=n,Ku=Ts=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&i)!==0&&(ln=!0),n.firstContext=null)}function Ln(n){var i=n._currentValue;if(Ku!==n)if(n={context:n,memoizedValue:i,next:null},Ts===null){if(Qa===null)throw Error(t(308));Ts=n,Qa.dependencies={lanes:0,firstContext:n}}else Ts=Ts.next=n;return i}var Li=null;function ec(n){Li===null?Li=[n]:Li.push(n)}function Yh(n,i,l,d){var p=i.interleaved;return p===null?(l.next=l,ec(i)):(l.next=p.next,p.next=l),i.interleaved=l,_r(n,d)}function _r(n,i){n.lanes|=i;var l=n.alternate;for(l!==null&&(l.lanes|=i),l=n,n=n.return;n!==null;)n.childLanes|=i,l=n.alternate,l!==null&&(l.childLanes|=i),l=n,n=n.return;return l.tag===3?l.stateNode:null}var Zr=!1;function tc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xh(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function wr(n,i){return{eventTime:n,lane:i,tag:0,payload:null,callback:null,next:null}}function Jr(n,i,l){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(He&2)!==0){var p=d.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),d.pending=i,_r(n,l)}return p=d.interleaved,p===null?(i.next=i,ec(d)):(i.next=p.next,p.next=i),d.interleaved=i,_r(n,l)}function Za(n,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194240)!==0)){var d=i.lanes;d&=n.pendingLanes,l|=d,i.lanes=l,wi(n,l)}}function qh(n,i){var l=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var p=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var _={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};g===null?p=g=_:g=g.next=_,l=l.next}while(l!==null);g===null?p=g=i:g=g.next=i}else p=g=i;l={baseState:d.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:d.shared,effects:d.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=i:n.next=i,l.lastBaseUpdate=i}function Ja(n,i,l,d){var p=n.updateQueue;Zr=!1;var g=p.firstBaseUpdate,_=p.lastBaseUpdate,T=p.shared.pending;if(T!==null){p.shared.pending=null;var R=T,N=R.next;R.next=null,_===null?g=N:_.next=N,_=R;var q=n.alternate;q!==null&&(q=q.updateQueue,T=q.lastBaseUpdate,T!==_&&(T===null?q.firstBaseUpdate=N:T.next=N,q.lastBaseUpdate=R))}if(g!==null){var Q=p.baseState;_=0,q=N=R=null,T=g;do{var X=T.lane,oe=T.eventTime;if((d&X)===X){q!==null&&(q=q.next={eventTime:oe,lane:0,tag:T.tag,payload:T.payload,callback:T.callback,next:null});e:{var ce=n,fe=T;switch(X=i,oe=l,fe.tag){case 1:if(ce=fe.payload,typeof ce=="function"){Q=ce.call(oe,Q,X);break e}Q=ce;break e;case 3:ce.flags=ce.flags&-65537|128;case 0:if(ce=fe.payload,X=typeof ce=="function"?ce.call(oe,Q,X):ce,X==null)break e;Q=ie({},Q,X);break e;case 2:Zr=!0}}T.callback!==null&&T.lane!==0&&(n.flags|=64,X=p.effects,X===null?p.effects=[T]:X.push(T))}else oe={eventTime:oe,lane:X,tag:T.tag,payload:T.payload,callback:T.callback,next:null},q===null?(N=q=oe,R=Q):q=q.next=oe,_|=X;if(T=T.next,T===null){if(T=p.shared.pending,T===null)break;X=T,T=X.next,X.next=null,p.lastBaseUpdate=X,p.shared.pending=null}}while(!0);if(q===null&&(R=Q),p.baseState=R,p.firstBaseUpdate=N,p.lastBaseUpdate=q,i=p.shared.interleaved,i!==null){p=i;do _|=p.lane,p=p.next;while(p!==i)}else g===null&&(p.shared.lanes=0);ji|=_,n.lanes=_,n.memoizedState=Q}}function Kh(n,i,l){if(n=i.effects,i.effects=null,n!==null)for(i=0;i<n.length;i++){var d=n[i],p=d.callback;if(p!==null){if(d.callback=null,d=l,typeof p!="function")throw Error(t(191,p));p.call(d)}}}var Ao={},ir=qr(Ao),To=qr(Ao),Po=qr(Ao);function $i(n){if(n===Ao)throw Error(t(174));return n}function nc(n,i){switch(Je(Po,i),Je(To,n),Je(ir,Ao),n=i.nodeType,n){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:ts(null,"");break;default:n=n===8?i.parentNode:i,i=n.namespaceURI||null,n=n.tagName,i=ts(i,n)}it(ir),Je(ir,i)}function Ms(){it(ir),it(To),it(Po)}function Qh(n){$i(Po.current);var i=$i(ir.current),l=ts(i,n.type);i!==l&&(Je(To,n),Je(ir,l))}function rc(n){To.current===n&&(it(ir),it(To))}var ft=qr(0);function el(n){for(var i=n;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var ic=[];function sc(){for(var n=0;n<ic.length;n++)ic[n]._workInProgressVersionPrimary=null;ic.length=0}var tl=M.ReactCurrentDispatcher,oc=M.ReactCurrentBatchConfig,zi=0,pt=null,Ct=null,Mt=null,nl=!1,Mo=!1,Eo=0,Qm=0;function Ut(){throw Error(t(321))}function ac(n,i){if(i===null)return!1;for(var l=0;l<i.length&&l<n.length;l++)if(!On(n[l],i[l]))return!1;return!0}function lc(n,i,l,d,p,g){if(zi=g,pt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,tl.current=n===null||n.memoizedState===null?tg:ng,n=l(d,p),Mo){g=0;do{if(Mo=!1,Eo=0,25<=g)throw Error(t(301));g+=1,Mt=Ct=null,i.updateQueue=null,tl.current=rg,n=l(d,p)}while(Mo)}if(tl.current=sl,i=Ct!==null&&Ct.next!==null,zi=0,Mt=Ct=pt=null,nl=!1,i)throw Error(t(300));return n}function uc(){var n=Eo!==0;return Eo=0,n}function sr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?pt.memoizedState=Mt=n:Mt=Mt.next=n,Mt}function $n(){if(Ct===null){var n=pt.alternate;n=n!==null?n.memoizedState:null}else n=Ct.next;var i=Mt===null?pt.memoizedState:Mt.next;if(i!==null)Mt=i,Ct=n;else{if(n===null)throw Error(t(310));Ct=n,n={memoizedState:Ct.memoizedState,baseState:Ct.baseState,baseQueue:Ct.baseQueue,queue:Ct.queue,next:null},Mt===null?pt.memoizedState=Mt=n:Mt=Mt.next=n}return Mt}function Ro(n,i){return typeof i=="function"?i(n):i}function cc(n){var i=$n(),l=i.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=n;var d=Ct,p=d.baseQueue,g=l.pending;if(g!==null){if(p!==null){var _=p.next;p.next=g.next,g.next=_}d.baseQueue=p=g,l.pending=null}if(p!==null){g=p.next,d=d.baseState;var T=_=null,R=null,N=g;do{var q=N.lane;if((zi&q)===q)R!==null&&(R=R.next={lane:0,action:N.action,hasEagerState:N.hasEagerState,eagerState:N.eagerState,next:null}),d=N.hasEagerState?N.eagerState:n(d,N.action);else{var Q={lane:q,action:N.action,hasEagerState:N.hasEagerState,eagerState:N.eagerState,next:null};R===null?(T=R=Q,_=d):R=R.next=Q,pt.lanes|=q,ji|=q}N=N.next}while(N!==null&&N!==g);R===null?_=d:R.next=T,On(d,i.memoizedState)||(ln=!0),i.memoizedState=d,i.baseState=_,i.baseQueue=R,l.lastRenderedState=d}if(n=l.interleaved,n!==null){p=n;do g=p.lane,pt.lanes|=g,ji|=g,p=p.next;while(p!==n)}else p===null&&(l.lanes=0);return[i.memoizedState,l.dispatch]}function dc(n){var i=$n(),l=i.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=n;var d=l.dispatch,p=l.pending,g=i.memoizedState;if(p!==null){l.pending=null;var _=p=p.next;do g=n(g,_.action),_=_.next;while(_!==p);On(g,i.memoizedState)||(ln=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),l.lastRenderedState=g}return[g,d]}function Zh(){}function Jh(n,i){var l=pt,d=$n(),p=i(),g=!On(d.memoizedState,p);if(g&&(d.memoizedState=p,ln=!0),d=d.queue,hc(nf.bind(null,l,d,n),[n]),d.getSnapshot!==i||g||Mt!==null&&Mt.memoizedState.tag&1){if(l.flags|=2048,Io(9,tf.bind(null,l,d,p,i),void 0,null),Et===null)throw Error(t(349));(zi&30)!==0||ef(l,i,p)}return p}function ef(n,i,l){n.flags|=16384,n={getSnapshot:i,value:l},i=pt.updateQueue,i===null?(i={lastEffect:null,stores:null},pt.updateQueue=i,i.stores=[n]):(l=i.stores,l===null?i.stores=[n]:l.push(n))}function tf(n,i,l,d){i.value=l,i.getSnapshot=d,rf(i)&&sf(n)}function nf(n,i,l){return l(function(){rf(i)&&sf(n)})}function rf(n){var i=n.getSnapshot;n=n.value;try{var l=i();return!On(n,l)}catch{return!0}}function sf(n){var i=_r(n,1);i!==null&&Gn(i,n,1,-1)}function of(n){var i=sr();return typeof n=="function"&&(n=n()),i.memoizedState=i.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:n},i.queue=n,n=n.dispatch=eg.bind(null,pt,n),[i.memoizedState,n]}function Io(n,i,l,d){return n={tag:n,create:i,destroy:l,deps:d,next:null},i=pt.updateQueue,i===null?(i={lastEffect:null,stores:null},pt.updateQueue=i,i.lastEffect=n.next=n):(l=i.lastEffect,l===null?i.lastEffect=n.next=n:(d=l.next,l.next=n,n.next=d,i.lastEffect=n)),n}function af(){return $n().memoizedState}function rl(n,i,l,d){var p=sr();pt.flags|=n,p.memoizedState=Io(1|i,l,void 0,d===void 0?null:d)}function il(n,i,l,d){var p=$n();d=d===void 0?null:d;var g=void 0;if(Ct!==null){var _=Ct.memoizedState;if(g=_.destroy,d!==null&&ac(d,_.deps)){p.memoizedState=Io(i,l,g,d);return}}pt.flags|=n,p.memoizedState=Io(1|i,l,g,d)}function lf(n,i){return rl(8390656,8,n,i)}function hc(n,i){return il(2048,8,n,i)}function uf(n,i){return il(4,2,n,i)}function cf(n,i){return il(4,4,n,i)}function df(n,i){if(typeof i=="function")return n=n(),i(n),function(){i(null)};if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function hf(n,i,l){return l=l!=null?l.concat([n]):null,il(4,4,df.bind(null,i,n),l)}function fc(){}function ff(n,i){var l=$n();i=i===void 0?null:i;var d=l.memoizedState;return d!==null&&i!==null&&ac(i,d[1])?d[0]:(l.memoizedState=[n,i],n)}function pf(n,i){var l=$n();i=i===void 0?null:i;var d=l.memoizedState;return d!==null&&i!==null&&ac(i,d[1])?d[0]:(n=n(),l.memoizedState=[n,i],n)}function mf(n,i,l){return(zi&21)===0?(n.baseState&&(n.baseState=!1,ln=!0),n.memoizedState=l):(On(l,i)||(l=ka(),pt.lanes|=l,ji|=l,n.baseState=!0),i)}function Zm(n,i){var l=Ge;Ge=l!==0&&4>l?l:4,n(!0);var d=oc.transition;oc.transition={};try{n(!1),i()}finally{Ge=l,oc.transition=d}}function gf(){return $n().memoizedState}function Jm(n,i,l){var d=ri(n);if(l={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null},yf(n))xf(i,l);else if(l=Yh(n,i,l,d),l!==null){var p=Zt();Gn(l,n,d,p),vf(l,i,d)}}function eg(n,i,l){var d=ri(n),p={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null};if(yf(n))xf(i,p);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var _=i.lastRenderedState,T=g(_,l);if(p.hasEagerState=!0,p.eagerState=T,On(T,_)){var R=i.interleaved;R===null?(p.next=p,ec(i)):(p.next=R.next,R.next=p),i.interleaved=p;return}}catch{}finally{}l=Yh(n,i,p,d),l!==null&&(p=Zt(),Gn(l,n,d,p),vf(l,i,d))}}function yf(n){var i=n.alternate;return n===pt||i!==null&&i===pt}function xf(n,i){Mo=nl=!0;var l=n.pending;l===null?i.next=i:(i.next=l.next,l.next=i),n.pending=i}function vf(n,i,l){if((l&4194240)!==0){var d=i.lanes;d&=n.pendingLanes,l|=d,i.lanes=l,wi(n,l)}}var sl={readContext:Ln,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useInsertionEffect:Ut,useLayoutEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useMutableSource:Ut,useSyncExternalStore:Ut,useId:Ut,unstable_isNewReconciler:!1},tg={readContext:Ln,useCallback:function(n,i){return sr().memoizedState=[n,i===void 0?null:i],n},useContext:Ln,useEffect:lf,useImperativeHandle:function(n,i,l){return l=l!=null?l.concat([n]):null,rl(4194308,4,df.bind(null,i,n),l)},useLayoutEffect:function(n,i){return rl(4194308,4,n,i)},useInsertionEffect:function(n,i){return rl(4,2,n,i)},useMemo:function(n,i){var l=sr();return i=i===void 0?null:i,n=n(),l.memoizedState=[n,i],n},useReducer:function(n,i,l){var d=sr();return i=l!==void 0?l(i):i,d.memoizedState=d.baseState=i,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:i},d.queue=n,n=n.dispatch=Jm.bind(null,pt,n),[d.memoizedState,n]},useRef:function(n){var i=sr();return n={current:n},i.memoizedState=n},useState:of,useDebugValue:fc,useDeferredValue:function(n){return sr().memoizedState=n},useTransition:function(){var n=of(!1),i=n[0];return n=Zm.bind(null,n[1]),sr().memoizedState=n,[i,n]},useMutableSource:function(){},useSyncExternalStore:function(n,i,l){var d=pt,p=sr();if(dt){if(l===void 0)throw Error(t(407));l=l()}else{if(l=i(),Et===null)throw Error(t(349));(zi&30)!==0||ef(d,i,l)}p.memoizedState=l;var g={value:l,getSnapshot:i};return p.queue=g,lf(nf.bind(null,d,g,n),[n]),d.flags|=2048,Io(9,tf.bind(null,d,g,l,i),void 0,null),l},useId:function(){var n=sr(),i=Et.identifierPrefix;if(dt){var l=vr,d=xr;l=(d&~(1<<32-rn(d)-1)).toString(32)+l,i=":"+i+"R"+l,l=Eo++,0<l&&(i+="H"+l.toString(32)),i+=":"}else l=Qm++,i=":"+i+"r"+l.toString(32)+":";return n.memoizedState=i},unstable_isNewReconciler:!1},ng={readContext:Ln,useCallback:ff,useContext:Ln,useEffect:hc,useImperativeHandle:hf,useInsertionEffect:uf,useLayoutEffect:cf,useMemo:pf,useReducer:cc,useRef:af,useState:function(){return cc(Ro)},useDebugValue:fc,useDeferredValue:function(n){var i=$n();return mf(i,Ct.memoizedState,n)},useTransition:function(){var n=cc(Ro)[0],i=$n().memoizedState;return[n,i]},useMutableSource:Zh,useSyncExternalStore:Jh,useId:gf,unstable_isNewReconciler:!1},rg={readContext:Ln,useCallback:ff,useContext:Ln,useEffect:hc,useImperativeHandle:hf,useInsertionEffect:uf,useLayoutEffect:cf,useMemo:pf,useReducer:dc,useRef:af,useState:function(){return dc(Ro)},useDebugValue:fc,useDeferredValue:function(n){var i=$n();return Ct===null?i.memoizedState=n:mf(i,Ct.memoizedState,n)},useTransition:function(){var n=dc(Ro)[0],i=$n().memoizedState;return[n,i]},useMutableSource:Zh,useSyncExternalStore:Jh,useId:gf,unstable_isNewReconciler:!1};function Wn(n,i){if(n&&n.defaultProps){i=ie({},i),n=n.defaultProps;for(var l in n)i[l]===void 0&&(i[l]=n[l]);return i}return i}function pc(n,i,l,d){i=n.memoizedState,l=l(d,i),l=l==null?i:ie({},i,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var ol={isMounted:function(n){return(n=n._reactInternals)?Ot(n)===n:!1},enqueueSetState:function(n,i,l){n=n._reactInternals;var d=Zt(),p=ri(n),g=wr(d,p);g.payload=i,l!=null&&(g.callback=l),i=Jr(n,g,p),i!==null&&(Gn(i,n,p,d),Za(i,n,p))},enqueueReplaceState:function(n,i,l){n=n._reactInternals;var d=Zt(),p=ri(n),g=wr(d,p);g.tag=1,g.payload=i,l!=null&&(g.callback=l),i=Jr(n,g,p),i!==null&&(Gn(i,n,p,d),Za(i,n,p))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var l=Zt(),d=ri(n),p=wr(l,d);p.tag=2,i!=null&&(p.callback=i),i=Jr(n,p,d),i!==null&&(Gn(i,n,d,l),Za(i,n,d))}};function _f(n,i,l,d,p,g,_){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,g,_):i.prototype&&i.prototype.isPureReactComponent?!xo(l,d)||!xo(p,g):!0}function wf(n,i,l){var d=!1,p=Kr,g=i.contextType;return typeof g=="object"&&g!==null?g=Ln(g):(p=an(i)?Ei:Ht.current,d=i.contextTypes,g=(d=d!=null)?bs(n,p):Kr),i=new i(l,g),n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=ol,n.stateNode=i,i._reactInternals=n,d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=p,n.__reactInternalMemoizedMaskedChildContext=g),i}function bf(n,i,l,d){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,d),i.state!==n&&ol.enqueueReplaceState(i,i.state,null)}function mc(n,i,l,d){var p=n.stateNode;p.props=l,p.state=n.memoizedState,p.refs={},tc(n);var g=i.contextType;typeof g=="object"&&g!==null?p.context=Ln(g):(g=an(i)?Ei:Ht.current,p.context=bs(n,g)),p.state=n.memoizedState,g=i.getDerivedStateFromProps,typeof g=="function"&&(pc(n,i,g,l),p.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&ol.enqueueReplaceState(p,p.state,null),Ja(n,l,p,d),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308)}function Es(n,i){try{var l="",d=i;do l+=Re(d),d=d.return;while(d);var p=l}catch(g){p=`
Error generating stack: `+g.message+`
`+g.stack}return{value:n,source:i,stack:p,digest:null}}function gc(n,i,l){return{value:n,source:null,stack:l??null,digest:i??null}}function yc(n,i){try{console.error(i.value)}catch(l){setTimeout(function(){throw l})}}var ig=typeof WeakMap=="function"?WeakMap:Map;function Sf(n,i,l){l=wr(-1,l),l.tag=3,l.payload={element:null};var d=i.value;return l.callback=function(){fl||(fl=!0,Ic=d),yc(n,i)},l}function kf(n,i,l){l=wr(-1,l),l.tag=3;var d=n.type.getDerivedStateFromError;if(typeof d=="function"){var p=i.value;l.payload=function(){return d(p)},l.callback=function(){yc(n,i)}}var g=n.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(l.callback=function(){yc(n,i),typeof d!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var _=i.stack;this.componentDidCatch(i.value,{componentStack:_!==null?_:""})}),l}function Cf(n,i,l){var d=n.pingCache;if(d===null){d=n.pingCache=new ig;var p=new Set;d.set(i,p)}else p=d.get(i),p===void 0&&(p=new Set,d.set(i,p));p.has(l)||(p.add(l),n=xg.bind(null,n,i,l),i.then(n,n))}function Af(n){do{var i;if((i=n.tag===13)&&(i=n.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return n;n=n.return}while(n!==null);return null}function Tf(n,i,l,d,p){return(n.mode&1)===0?(n===i?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(i=wr(-1,1),i.tag=2,Jr(l,i,1))),l.lanes|=1),n):(n.flags|=65536,n.lanes=p,n)}var sg=M.ReactCurrentOwner,ln=!1;function Qt(n,i,l,d){i.child=n===null?Vh(i,null,l,d):As(i,n.child,l,d)}function Pf(n,i,l,d,p){l=l.render;var g=i.ref;return Ps(i,p),d=lc(n,i,l,d,g,p),l=uc(),n!==null&&!ln?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~p,br(n,i,p)):(dt&&l&&Gu(i),i.flags|=1,Qt(n,i,d,p),i.child)}function Mf(n,i,l,d,p){if(n===null){var g=l.type;return typeof g=="function"&&!Dc(g)&&g.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(i.tag=15,i.type=g,Ef(n,i,g,d,p)):(n=vl(l.type,null,d,i,i.mode,p),n.ref=i.ref,n.return=i,i.child=n)}if(g=n.child,(n.lanes&p)===0){var _=g.memoizedProps;if(l=l.compare,l=l!==null?l:xo,l(_,d)&&n.ref===i.ref)return br(n,i,p)}return i.flags|=1,n=si(g,d),n.ref=i.ref,n.return=i,i.child=n}function Ef(n,i,l,d,p){if(n!==null){var g=n.memoizedProps;if(xo(g,d)&&n.ref===i.ref)if(ln=!1,i.pendingProps=d=g,(n.lanes&p)!==0)(n.flags&131072)!==0&&(ln=!0);else return i.lanes=n.lanes,br(n,i,p)}return xc(n,i,l,d,p)}function Rf(n,i,l){var d=i.pendingProps,p=d.children,g=n!==null?n.memoizedState:null;if(d.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(Is,vn),vn|=l;else{if((l&1073741824)===0)return n=g!==null?g.baseLanes|l:l,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:n,cachePool:null,transitions:null},i.updateQueue=null,Je(Is,vn),vn|=n,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=g!==null?g.baseLanes:l,Je(Is,vn),vn|=d}else g!==null?(d=g.baseLanes|l,i.memoizedState=null):d=l,Je(Is,vn),vn|=d;return Qt(n,i,p,l),i.child}function If(n,i){var l=i.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(i.flags|=512,i.flags|=2097152)}function xc(n,i,l,d,p){var g=an(l)?Ei:Ht.current;return g=bs(i,g),Ps(i,p),l=lc(n,i,l,d,g,p),d=uc(),n!==null&&!ln?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~p,br(n,i,p)):(dt&&d&&Gu(i),i.flags|=1,Qt(n,i,l,p),i.child)}function Lf(n,i,l,d,p){if(an(l)){var g=!0;Ua(i)}else g=!1;if(Ps(i,p),i.stateNode===null)ll(n,i),wf(i,l,d),mc(i,l,d,p),d=!0;else if(n===null){var _=i.stateNode,T=i.memoizedProps;_.props=T;var R=_.context,N=l.contextType;typeof N=="object"&&N!==null?N=Ln(N):(N=an(l)?Ei:Ht.current,N=bs(i,N));var q=l.getDerivedStateFromProps,Q=typeof q=="function"||typeof _.getSnapshotBeforeUpdate=="function";Q||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(T!==d||R!==N)&&bf(i,_,d,N),Zr=!1;var X=i.memoizedState;_.state=X,Ja(i,d,_,p),R=i.memoizedState,T!==d||X!==R||on.current||Zr?(typeof q=="function"&&(pc(i,l,q,d),R=i.memoizedState),(T=Zr||_f(i,l,T,d,X,R,N))?(Q||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(i.flags|=4194308)):(typeof _.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=R),_.props=d,_.state=R,_.context=N,d=T):(typeof _.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{_=i.stateNode,Xh(n,i),T=i.memoizedProps,N=i.type===i.elementType?T:Wn(i.type,T),_.props=N,Q=i.pendingProps,X=_.context,R=l.contextType,typeof R=="object"&&R!==null?R=Ln(R):(R=an(l)?Ei:Ht.current,R=bs(i,R));var oe=l.getDerivedStateFromProps;(q=typeof oe=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(T!==Q||X!==R)&&bf(i,_,d,R),Zr=!1,X=i.memoizedState,_.state=X,Ja(i,d,_,p);var ce=i.memoizedState;T!==Q||X!==ce||on.current||Zr?(typeof oe=="function"&&(pc(i,l,oe,d),ce=i.memoizedState),(N=Zr||_f(i,l,N,d,X,ce,R)||!1)?(q||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(d,ce,R),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(d,ce,R)),typeof _.componentDidUpdate=="function"&&(i.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof _.componentDidUpdate!="function"||T===n.memoizedProps&&X===n.memoizedState||(i.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&X===n.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=ce),_.props=d,_.state=ce,_.context=R,d=N):(typeof _.componentDidUpdate!="function"||T===n.memoizedProps&&X===n.memoizedState||(i.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&X===n.memoizedState||(i.flags|=1024),d=!1)}return vc(n,i,l,d,g,p)}function vc(n,i,l,d,p,g){If(n,i);var _=(i.flags&128)!==0;if(!d&&!_)return p&&Fh(i,l,!1),br(n,i,g);d=i.stateNode,sg.current=i;var T=_&&typeof l.getDerivedStateFromError!="function"?null:d.render();return i.flags|=1,n!==null&&_?(i.child=As(i,n.child,null,g),i.child=As(i,null,T,g)):Qt(n,i,T,g),i.memoizedState=d.state,p&&Fh(i,l,!0),i.child}function $f(n){var i=n.stateNode;i.pendingContext?zh(n,i.pendingContext,i.pendingContext!==i.context):i.context&&zh(n,i.context,!1),nc(n,i.containerInfo)}function zf(n,i,l,d,p){return Cs(),qu(p),i.flags|=256,Qt(n,i,l,d),i.child}var _c={dehydrated:null,treeContext:null,retryLane:0};function wc(n){return{baseLanes:n,cachePool:null,transitions:null}}function jf(n,i,l){var d=i.pendingProps,p=ft.current,g=!1,_=(i.flags&128)!==0,T;if((T=_)||(T=n!==null&&n.memoizedState===null?!1:(p&2)!==0),T?(g=!0,i.flags&=-129):(n===null||n.memoizedState!==null)&&(p|=1),Je(ft,p&1),n===null)return Xu(i),n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((i.mode&1)===0?i.lanes=1:n.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(_=d.children,n=d.fallback,g?(d=i.mode,g=i.child,_={mode:"hidden",children:_},(d&1)===0&&g!==null?(g.childLanes=0,g.pendingProps=_):g=_l(_,d,0,null),n=Oi(n,d,l,null),g.return=i,n.return=i,g.sibling=n,i.child=g,i.child.memoizedState=wc(l),i.memoizedState=_c,n):bc(i,_));if(p=n.memoizedState,p!==null&&(T=p.dehydrated,T!==null))return og(n,i,_,d,T,p,l);if(g){g=d.fallback,_=i.mode,p=n.child,T=p.sibling;var R={mode:"hidden",children:d.children};return(_&1)===0&&i.child!==p?(d=i.child,d.childLanes=0,d.pendingProps=R,i.deletions=null):(d=si(p,R),d.subtreeFlags=p.subtreeFlags&14680064),T!==null?g=si(T,g):(g=Oi(g,_,l,null),g.flags|=2),g.return=i,d.return=i,d.sibling=g,i.child=d,d=g,g=i.child,_=n.child.memoizedState,_=_===null?wc(l):{baseLanes:_.baseLanes|l,cachePool:null,transitions:_.transitions},g.memoizedState=_,g.childLanes=n.childLanes&~l,i.memoizedState=_c,d}return g=n.child,n=g.sibling,d=si(g,{mode:"visible",children:d.children}),(i.mode&1)===0&&(d.lanes=l),d.return=i,d.sibling=null,n!==null&&(l=i.deletions,l===null?(i.deletions=[n],i.flags|=16):l.push(n)),i.child=d,i.memoizedState=null,d}function bc(n,i){return i=_l({mode:"visible",children:i},n.mode,0,null),i.return=n,n.child=i}function al(n,i,l,d){return d!==null&&qu(d),As(i,n.child,null,l),n=bc(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function og(n,i,l,d,p,g,_){if(l)return i.flags&256?(i.flags&=-257,d=gc(Error(t(422))),al(n,i,_,d)):i.memoizedState!==null?(i.child=n.child,i.flags|=128,null):(g=d.fallback,p=i.mode,d=_l({mode:"visible",children:d.children},p,0,null),g=Oi(g,p,_,null),g.flags|=2,d.return=i,g.return=i,d.sibling=g,i.child=d,(i.mode&1)!==0&&As(i,n.child,null,_),i.child.memoizedState=wc(_),i.memoizedState=_c,g);if((i.mode&1)===0)return al(n,i,_,null);if(p.data==="$!"){if(d=p.nextSibling&&p.nextSibling.dataset,d)var T=d.dgst;return d=T,g=Error(t(419)),d=gc(g,d,void 0),al(n,i,_,d)}if(T=(_&n.childLanes)!==0,ln||T){if(d=Et,d!==null){switch(_&-_){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(d.suspendedLanes|_))!==0?0:p,p!==0&&p!==g.retryLane&&(g.retryLane=p,_r(n,p),Gn(d,n,p,-1))}return Bc(),d=gc(Error(t(421))),al(n,i,_,d)}return p.data==="$?"?(i.flags|=128,i.child=n.child,i=vg.bind(null,n),p._reactRetry=i,null):(n=g.treeContext,xn=Xr(p.nextSibling),yn=i,dt=!0,Nn=null,n!==null&&(Rn[In++]=xr,Rn[In++]=vr,Rn[In++]=Ri,xr=n.id,vr=n.overflow,Ri=i),i=bc(i,d.children),i.flags|=4096,i)}function Ff(n,i,l){n.lanes|=i;var d=n.alternate;d!==null&&(d.lanes|=i),Ju(n.return,i,l)}function Sc(n,i,l,d,p){var g=n.memoizedState;g===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:p}:(g.isBackwards=i,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=l,g.tailMode=p)}function Bf(n,i,l){var d=i.pendingProps,p=d.revealOrder,g=d.tail;if(Qt(n,i,d.children,l),d=ft.current,(d&2)!==0)d=d&1|2,i.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Ff(n,l,i);else if(n.tag===19)Ff(n,l,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}d&=1}if(Je(ft,d),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(l=i.child,p=null;l!==null;)n=l.alternate,n!==null&&el(n)===null&&(p=l),l=l.sibling;l=p,l===null?(p=i.child,i.child=null):(p=l.sibling,l.sibling=null),Sc(i,!1,p,l,g);break;case"backwards":for(l=null,p=i.child,i.child=null;p!==null;){if(n=p.alternate,n!==null&&el(n)===null){i.child=p;break}n=p.sibling,p.sibling=l,l=p,p=n}Sc(i,!0,l,null,g);break;case"together":Sc(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ll(n,i){(i.mode&1)===0&&n!==null&&(n.alternate=null,i.alternate=null,i.flags|=2)}function br(n,i,l){if(n!==null&&(i.dependencies=n.dependencies),ji|=i.lanes,(l&i.childLanes)===0)return null;if(n!==null&&i.child!==n.child)throw Error(t(153));if(i.child!==null){for(n=i.child,l=si(n,n.pendingProps),i.child=l,l.return=i;n.sibling!==null;)n=n.sibling,l=l.sibling=si(n,n.pendingProps),l.return=i;l.sibling=null}return i.child}function ag(n,i,l){switch(i.tag){case 3:$f(i),Cs();break;case 5:Qh(i);break;case 1:an(i.type)&&Ua(i);break;case 4:nc(i,i.stateNode.containerInfo);break;case 10:var d=i.type._context,p=i.memoizedProps.value;Je(Ka,d._currentValue),d._currentValue=p;break;case 13:if(d=i.memoizedState,d!==null)return d.dehydrated!==null?(Je(ft,ft.current&1),i.flags|=128,null):(l&i.child.childLanes)!==0?jf(n,i,l):(Je(ft,ft.current&1),n=br(n,i,l),n!==null?n.sibling:null);Je(ft,ft.current&1);break;case 19:if(d=(l&i.childLanes)!==0,(n.flags&128)!==0){if(d)return Bf(n,i,l);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Je(ft,ft.current),d)break;return null;case 22:case 23:return i.lanes=0,Rf(n,i,l)}return br(n,i,l)}var Df,kc,Of,Nf;Df=function(n,i){for(var l=i.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},kc=function(){},Of=function(n,i,l,d){var p=n.memoizedProps;if(p!==d){n=i.stateNode,$i(ir.current);var g=null;switch(l){case"input":p=mn(n,p),d=mn(n,d),g=[];break;case"select":p=ie({},p,{value:void 0}),d=ie({},d,{value:void 0}),g=[];break;case"textarea":p=Qs(n,p),d=Qs(n,d),g=[];break;default:typeof p.onClick!="function"&&typeof d.onClick=="function"&&(n.onclick=Na)}zr(l,d);var _;l=null;for(N in p)if(!d.hasOwnProperty(N)&&p.hasOwnProperty(N)&&p[N]!=null)if(N==="style"){var T=p[N];for(_ in T)T.hasOwnProperty(_)&&(l||(l={}),l[_]="")}else N!=="dangerouslySetInnerHTML"&&N!=="children"&&N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&N!=="autoFocus"&&(o.hasOwnProperty(N)?g||(g=[]):(g=g||[]).push(N,null));for(N in d){var R=d[N];if(T=p!=null?p[N]:void 0,d.hasOwnProperty(N)&&R!==T&&(R!=null||T!=null))if(N==="style")if(T){for(_ in T)!T.hasOwnProperty(_)||R&&R.hasOwnProperty(_)||(l||(l={}),l[_]="");for(_ in R)R.hasOwnProperty(_)&&T[_]!==R[_]&&(l||(l={}),l[_]=R[_])}else l||(g||(g=[]),g.push(N,l)),l=R;else N==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,T=T?T.__html:void 0,R!=null&&T!==R&&(g=g||[]).push(N,R)):N==="children"?typeof R!="string"&&typeof R!="number"||(g=g||[]).push(N,""+R):N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&(o.hasOwnProperty(N)?(R!=null&&N==="onScroll"&&rt("scroll",n),g||T===R||(g=[])):(g=g||[]).push(N,R))}l&&(g=g||[]).push("style",l);var N=g;(i.updateQueue=N)&&(i.flags|=4)}},Nf=function(n,i,l,d){l!==d&&(i.flags|=4)};function Lo(n,i){if(!dt)switch(n.tailMode){case"hidden":i=n.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function Gt(n){var i=n.alternate!==null&&n.alternate.child===n.child,l=0,d=0;if(i)for(var p=n.child;p!==null;)l|=p.lanes|p.childLanes,d|=p.subtreeFlags&14680064,d|=p.flags&14680064,p.return=n,p=p.sibling;else for(p=n.child;p!==null;)l|=p.lanes|p.childLanes,d|=p.subtreeFlags,d|=p.flags,p.return=n,p=p.sibling;return n.subtreeFlags|=d,n.childLanes=l,i}function lg(n,i,l){var d=i.pendingProps;switch(Vu(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gt(i),null;case 1:return an(i.type)&&Ha(),Gt(i),null;case 3:return d=i.stateNode,Ms(),it(on),it(Ht),sc(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(Xa(i)?i.flags|=4:n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Nn!==null&&(zc(Nn),Nn=null))),kc(n,i),Gt(i),null;case 5:rc(i);var p=$i(Po.current);if(l=i.type,n!==null&&i.stateNode!=null)Of(n,i,l,d,p),n.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!d){if(i.stateNode===null)throw Error(t(166));return Gt(i),null}if(n=$i(ir.current),Xa(i)){d=i.stateNode,l=i.type;var g=i.memoizedProps;switch(d[rr]=i,d[So]=g,n=(i.mode&1)!==0,l){case"dialog":rt("cancel",d),rt("close",d);break;case"iframe":case"object":case"embed":rt("load",d);break;case"video":case"audio":for(p=0;p<_o.length;p++)rt(_o[p],d);break;case"source":rt("error",d);break;case"img":case"image":case"link":rt("error",d),rt("load",d);break;case"details":rt("toggle",d);break;case"input":Cn(d,g),rt("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!g.multiple},rt("invalid",d);break;case"textarea":Zi(d,g),rt("invalid",d)}zr(l,g),p=null;for(var _ in g)if(g.hasOwnProperty(_)){var T=g[_];_==="children"?typeof T=="string"?d.textContent!==T&&(g.suppressHydrationWarning!==!0&&Oa(d.textContent,T,n),p=["children",T]):typeof T=="number"&&d.textContent!==""+T&&(g.suppressHydrationWarning!==!0&&Oa(d.textContent,T,n),p=["children",""+T]):o.hasOwnProperty(_)&&T!=null&&_==="onScroll"&&rt("scroll",d)}switch(l){case"input":kn(d),hi(d,g,!0);break;case"textarea":kn(d),fa(d);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(d.onclick=Na)}d=p,i.updateQueue=d,d!==null&&(i.flags|=4)}else{_=p.nodeType===9?p:p.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=es(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=_.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof d.is=="string"?n=_.createElement(l,{is:d.is}):(n=_.createElement(l),l==="select"&&(_=n,d.multiple?_.multiple=!0:d.size&&(_.size=d.size))):n=_.createElementNS(n,l),n[rr]=i,n[So]=d,Df(n,i,!1,!1),i.stateNode=n;e:{switch(_=fi(l,d),l){case"dialog":rt("cancel",n),rt("close",n),p=d;break;case"iframe":case"object":case"embed":rt("load",n),p=d;break;case"video":case"audio":for(p=0;p<_o.length;p++)rt(_o[p],n);p=d;break;case"source":rt("error",n),p=d;break;case"img":case"image":case"link":rt("error",n),rt("load",n),p=d;break;case"details":rt("toggle",n),p=d;break;case"input":Cn(n,d),p=mn(n,d),rt("invalid",n);break;case"option":p=d;break;case"select":n._wrapperState={wasMultiple:!!d.multiple},p=ie({},d,{value:void 0}),rt("invalid",n);break;case"textarea":Zi(n,d),p=Qs(n,d),rt("invalid",n);break;default:p=d}zr(l,p),T=p;for(g in T)if(T.hasOwnProperty(g)){var R=T[g];g==="style"?ga(n,R):g==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&ns(n,R)):g==="children"?typeof R=="string"?(l!=="textarea"||R!=="")&&$r(n,R):typeof R=="number"&&$r(n,""+R):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(o.hasOwnProperty(g)?R!=null&&g==="onScroll"&&rt("scroll",n):R!=null&&P(n,g,R,_))}switch(l){case"input":kn(n),hi(n,d,!1);break;case"textarea":kn(n),fa(n);break;case"option":d.value!=null&&n.setAttribute("value",""+Fe(d.value));break;case"select":n.multiple=!!d.multiple,g=d.value,g!=null?Lr(n,!!d.multiple,g,!1):d.defaultValue!=null&&Lr(n,!!d.multiple,d.defaultValue,!0);break;default:typeof p.onClick=="function"&&(n.onclick=Na)}switch(l){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Gt(i),null;case 6:if(n&&i.stateNode!=null)Nf(n,i,n.memoizedProps,d);else{if(typeof d!="string"&&i.stateNode===null)throw Error(t(166));if(l=$i(Po.current),$i(ir.current),Xa(i)){if(d=i.stateNode,l=i.memoizedProps,d[rr]=i,(g=d.nodeValue!==l)&&(n=yn,n!==null))switch(n.tag){case 3:Oa(d.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Oa(d.nodeValue,l,(n.mode&1)!==0)}g&&(i.flags|=4)}else d=(l.nodeType===9?l:l.ownerDocument).createTextNode(d),d[rr]=i,i.stateNode=d}return Gt(i),null;case 13:if(it(ft),d=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(dt&&xn!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Hh(),Cs(),i.flags|=98560,g=!1;else if(g=Xa(i),d!==null&&d.dehydrated!==null){if(n===null){if(!g)throw Error(t(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(t(317));g[rr]=i}else Cs(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Gt(i),g=!1}else Nn!==null&&(zc(Nn),Nn=null),g=!0;if(!g)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=l,i):(d=d!==null,d!==(n!==null&&n.memoizedState!==null)&&d&&(i.child.flags|=8192,(i.mode&1)!==0&&(n===null||(ft.current&1)!==0?At===0&&(At=3):Bc())),i.updateQueue!==null&&(i.flags|=4),Gt(i),null);case 4:return Ms(),kc(n,i),n===null&&wo(i.stateNode.containerInfo),Gt(i),null;case 10:return Zu(i.type._context),Gt(i),null;case 17:return an(i.type)&&Ha(),Gt(i),null;case 19:if(it(ft),g=i.memoizedState,g===null)return Gt(i),null;if(d=(i.flags&128)!==0,_=g.rendering,_===null)if(d)Lo(g,!1);else{if(At!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(_=el(n),_!==null){for(i.flags|=128,Lo(g,!1),d=_.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),i.subtreeFlags=0,d=l,l=i.child;l!==null;)g=l,n=d,g.flags&=14680066,_=g.alternate,_===null?(g.childLanes=0,g.lanes=n,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=_.childLanes,g.lanes=_.lanes,g.child=_.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=_.memoizedProps,g.memoizedState=_.memoizedState,g.updateQueue=_.updateQueue,g.type=_.type,n=_.dependencies,g.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return Je(ft,ft.current&1|2),i.child}n=n.sibling}g.tail!==null&&lt()>Ls&&(i.flags|=128,d=!0,Lo(g,!1),i.lanes=4194304)}else{if(!d)if(n=el(_),n!==null){if(i.flags|=128,d=!0,l=n.updateQueue,l!==null&&(i.updateQueue=l,i.flags|=4),Lo(g,!0),g.tail===null&&g.tailMode==="hidden"&&!_.alternate&&!dt)return Gt(i),null}else 2*lt()-g.renderingStartTime>Ls&&l!==1073741824&&(i.flags|=128,d=!0,Lo(g,!1),i.lanes=4194304);g.isBackwards?(_.sibling=i.child,i.child=_):(l=g.last,l!==null?l.sibling=_:i.child=_,g.last=_)}return g.tail!==null?(i=g.tail,g.rendering=i,g.tail=i.sibling,g.renderingStartTime=lt(),i.sibling=null,l=ft.current,Je(ft,d?l&1|2:l&1),i):(Gt(i),null);case 22:case 23:return Fc(),d=i.memoizedState!==null,n!==null&&n.memoizedState!==null!==d&&(i.flags|=8192),d&&(i.mode&1)!==0?(vn&1073741824)!==0&&(Gt(i),i.subtreeFlags&6&&(i.flags|=8192)):Gt(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function ug(n,i){switch(Vu(i),i.tag){case 1:return an(i.type)&&Ha(),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Ms(),it(on),it(Ht),sc(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 5:return rc(i),null;case 13:if(it(ft),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Cs()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return it(ft),null;case 4:return Ms(),null;case 10:return Zu(i.type._context),null;case 22:case 23:return Fc(),null;case 24:return null;default:return null}}var ul=!1,Vt=!1,cg=typeof WeakSet=="function"?WeakSet:Set,ue=null;function Rs(n,i){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(d){gt(n,i,d)}else l.current=null}function Cc(n,i,l){try{l()}catch(d){gt(n,i,d)}}var Wf=!1;function dg(n,i){if(Fu=hs,n=vh(),Mu(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var p=d.anchorOffset,g=d.focusNode;d=d.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var _=0,T=-1,R=-1,N=0,q=0,Q=n,X=null;t:for(;;){for(var oe;Q!==l||p!==0&&Q.nodeType!==3||(T=_+p),Q!==g||d!==0&&Q.nodeType!==3||(R=_+d),Q.nodeType===3&&(_+=Q.nodeValue.length),(oe=Q.firstChild)!==null;)X=Q,Q=oe;for(;;){if(Q===n)break t;if(X===l&&++N===p&&(T=_),X===g&&++q===d&&(R=_),(oe=Q.nextSibling)!==null)break;Q=X,X=Q.parentNode}Q=oe}l=T===-1||R===-1?null:{start:T,end:R}}else l=null}l=l||{start:0,end:0}}else l=null;for(Bu={focusedElem:n,selectionRange:l},hs=!1,ue=i;ue!==null;)if(i=ue,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,ue=n;else for(;ue!==null;){i=ue;try{var ce=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(ce!==null){var fe=ce.memoizedProps,_t=ce.memoizedState,F=i.stateNode,I=F.getSnapshotBeforeUpdate(i.elementType===i.type?fe:Wn(i.type,fe),_t);F.__reactInternalSnapshotBeforeUpdate=I}break;case 3:var O=i.stateNode.containerInfo;O.nodeType===1?O.textContent="":O.nodeType===9&&O.documentElement&&O.removeChild(O.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(J){gt(i,i.return,J)}if(n=i.sibling,n!==null){n.return=i.return,ue=n;break}ue=i.return}return ce=Wf,Wf=!1,ce}function $o(n,i,l){var d=i.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var p=d=d.next;do{if((p.tag&n)===n){var g=p.destroy;p.destroy=void 0,g!==void 0&&Cc(i,l,g)}p=p.next}while(p!==d)}}function cl(n,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var l=i=i.next;do{if((l.tag&n)===n){var d=l.create;l.destroy=d()}l=l.next}while(l!==i)}}function Ac(n){var i=n.ref;if(i!==null){var l=n.stateNode;switch(n.tag){case 5:n=l;break;default:n=l}typeof i=="function"?i(n):i.current=n}}function Hf(n){var i=n.alternate;i!==null&&(n.alternate=null,Hf(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&(delete i[rr],delete i[So],delete i[Wu],delete i[Ym],delete i[Xm])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Uf(n){return n.tag===5||n.tag===3||n.tag===4}function Gf(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Uf(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Tc(n,i,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,i?l.nodeType===8?l.parentNode.insertBefore(n,i):l.insertBefore(n,i):(l.nodeType===8?(i=l.parentNode,i.insertBefore(n,l)):(i=l,i.appendChild(n)),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=Na));else if(d!==4&&(n=n.child,n!==null))for(Tc(n,i,l),n=n.sibling;n!==null;)Tc(n,i,l),n=n.sibling}function Pc(n,i,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,i?l.insertBefore(n,i):l.appendChild(n);else if(d!==4&&(n=n.child,n!==null))for(Pc(n,i,l),n=n.sibling;n!==null;)Pc(n,i,l),n=n.sibling}var zt=null,Hn=!1;function ei(n,i,l){for(l=l.child;l!==null;)Vf(n,i,l),l=l.sibling}function Vf(n,i,l){if(ut&&typeof ut.onCommitFiberUnmount=="function")try{ut.onCommitFiberUnmount(xi,l)}catch{}switch(l.tag){case 5:Vt||Rs(l,i);case 6:var d=zt,p=Hn;zt=null,ei(n,i,l),zt=d,Hn=p,zt!==null&&(Hn?(n=zt,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):zt.removeChild(l.stateNode));break;case 18:zt!==null&&(Hn?(n=zt,l=l.stateNode,n.nodeType===8?Nu(n.parentNode,l):n.nodeType===1&&Nu(n,l),Ci(n)):Nu(zt,l.stateNode));break;case 4:d=zt,p=Hn,zt=l.stateNode.containerInfo,Hn=!0,ei(n,i,l),zt=d,Hn=p;break;case 0:case 11:case 14:case 15:if(!Vt&&(d=l.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){p=d=d.next;do{var g=p,_=g.destroy;g=g.tag,_!==void 0&&((g&2)!==0||(g&4)!==0)&&Cc(l,i,_),p=p.next}while(p!==d)}ei(n,i,l);break;case 1:if(!Vt&&(Rs(l,i),d=l.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=l.memoizedProps,d.state=l.memoizedState,d.componentWillUnmount()}catch(T){gt(l,i,T)}ei(n,i,l);break;case 21:ei(n,i,l);break;case 22:l.mode&1?(Vt=(d=Vt)||l.memoizedState!==null,ei(n,i,l),Vt=d):ei(n,i,l);break;default:ei(n,i,l)}}function Yf(n){var i=n.updateQueue;if(i!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new cg),i.forEach(function(d){var p=_g.bind(null,n,d);l.has(d)||(l.add(d),d.then(p,p))})}}function Un(n,i){var l=i.deletions;if(l!==null)for(var d=0;d<l.length;d++){var p=l[d];try{var g=n,_=i,T=_;e:for(;T!==null;){switch(T.tag){case 5:zt=T.stateNode,Hn=!1;break e;case 3:zt=T.stateNode.containerInfo,Hn=!0;break e;case 4:zt=T.stateNode.containerInfo,Hn=!0;break e}T=T.return}if(zt===null)throw Error(t(160));Vf(g,_,p),zt=null,Hn=!1;var R=p.alternate;R!==null&&(R.return=null),p.return=null}catch(N){gt(p,i,N)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Xf(i,n),i=i.sibling}function Xf(n,i){var l=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Un(i,n),or(n),d&4){try{$o(3,n,n.return),cl(3,n)}catch(fe){gt(n,n.return,fe)}try{$o(5,n,n.return)}catch(fe){gt(n,n.return,fe)}}break;case 1:Un(i,n),or(n),d&512&&l!==null&&Rs(l,l.return);break;case 5:if(Un(i,n),or(n),d&512&&l!==null&&Rs(l,l.return),n.flags&32){var p=n.stateNode;try{$r(p,"")}catch(fe){gt(n,n.return,fe)}}if(d&4&&(p=n.stateNode,p!=null)){var g=n.memoizedProps,_=l!==null?l.memoizedProps:g,T=n.type,R=n.updateQueue;if(n.updateQueue=null,R!==null)try{T==="input"&&g.type==="radio"&&g.name!=null&&Ki(p,g),fi(T,_);var N=fi(T,g);for(_=0;_<R.length;_+=2){var q=R[_],Q=R[_+1];q==="style"?ga(p,Q):q==="dangerouslySetInnerHTML"?ns(p,Q):q==="children"?$r(p,Q):P(p,q,Q,N)}switch(T){case"input":Ir(p,g);break;case"textarea":Ji(p,g);break;case"select":var X=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!g.multiple;var oe=g.value;oe!=null?Lr(p,!!g.multiple,oe,!1):X!==!!g.multiple&&(g.defaultValue!=null?Lr(p,!!g.multiple,g.defaultValue,!0):Lr(p,!!g.multiple,g.multiple?[]:"",!1))}p[So]=g}catch(fe){gt(n,n.return,fe)}}break;case 6:if(Un(i,n),or(n),d&4){if(n.stateNode===null)throw Error(t(162));p=n.stateNode,g=n.memoizedProps;try{p.nodeValue=g}catch(fe){gt(n,n.return,fe)}}break;case 3:if(Un(i,n),or(n),d&4&&l!==null&&l.memoizedState.isDehydrated)try{Ci(i.containerInfo)}catch(fe){gt(n,n.return,fe)}break;case 4:Un(i,n),or(n);break;case 13:Un(i,n),or(n),p=n.child,p.flags&8192&&(g=p.memoizedState!==null,p.stateNode.isHidden=g,!g||p.alternate!==null&&p.alternate.memoizedState!==null||(Rc=lt())),d&4&&Yf(n);break;case 22:if(q=l!==null&&l.memoizedState!==null,n.mode&1?(Vt=(N=Vt)||q,Un(i,n),Vt=N):Un(i,n),or(n),d&8192){if(N=n.memoizedState!==null,(n.stateNode.isHidden=N)&&!q&&(n.mode&1)!==0)for(ue=n,q=n.child;q!==null;){for(Q=ue=q;ue!==null;){switch(X=ue,oe=X.child,X.tag){case 0:case 11:case 14:case 15:$o(4,X,X.return);break;case 1:Rs(X,X.return);var ce=X.stateNode;if(typeof ce.componentWillUnmount=="function"){d=X,l=X.return;try{i=d,ce.props=i.memoizedProps,ce.state=i.memoizedState,ce.componentWillUnmount()}catch(fe){gt(d,l,fe)}}break;case 5:Rs(X,X.return);break;case 22:if(X.memoizedState!==null){Qf(Q);continue}}oe!==null?(oe.return=X,ue=oe):Qf(Q)}q=q.sibling}e:for(q=null,Q=n;;){if(Q.tag===5){if(q===null){q=Q;try{p=Q.stateNode,N?(g=p.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(T=Q.stateNode,R=Q.memoizedProps.style,_=R!=null&&R.hasOwnProperty("display")?R.display:null,T.style.display=ma("display",_))}catch(fe){gt(n,n.return,fe)}}}else if(Q.tag===6){if(q===null)try{Q.stateNode.nodeValue=N?"":Q.memoizedProps}catch(fe){gt(n,n.return,fe)}}else if((Q.tag!==22&&Q.tag!==23||Q.memoizedState===null||Q===n)&&Q.child!==null){Q.child.return=Q,Q=Q.child;continue}if(Q===n)break e;for(;Q.sibling===null;){if(Q.return===null||Q.return===n)break e;q===Q&&(q=null),Q=Q.return}q===Q&&(q=null),Q.sibling.return=Q.return,Q=Q.sibling}}break;case 19:Un(i,n),or(n),d&4&&Yf(n);break;case 21:break;default:Un(i,n),or(n)}}function or(n){var i=n.flags;if(i&2){try{e:{for(var l=n.return;l!==null;){if(Uf(l)){var d=l;break e}l=l.return}throw Error(t(160))}switch(d.tag){case 5:var p=d.stateNode;d.flags&32&&($r(p,""),d.flags&=-33);var g=Gf(n);Pc(n,g,p);break;case 3:case 4:var _=d.stateNode.containerInfo,T=Gf(n);Tc(n,T,_);break;default:throw Error(t(161))}}catch(R){gt(n,n.return,R)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function hg(n,i,l){ue=n,qf(n)}function qf(n,i,l){for(var d=(n.mode&1)!==0;ue!==null;){var p=ue,g=p.child;if(p.tag===22&&d){var _=p.memoizedState!==null||ul;if(!_){var T=p.alternate,R=T!==null&&T.memoizedState!==null||Vt;T=ul;var N=Vt;if(ul=_,(Vt=R)&&!N)for(ue=p;ue!==null;)_=ue,R=_.child,_.tag===22&&_.memoizedState!==null?Zf(p):R!==null?(R.return=_,ue=R):Zf(p);for(;g!==null;)ue=g,qf(g),g=g.sibling;ue=p,ul=T,Vt=N}Kf(n)}else(p.subtreeFlags&8772)!==0&&g!==null?(g.return=p,ue=g):Kf(n)}}function Kf(n){for(;ue!==null;){var i=ue;if((i.flags&8772)!==0){var l=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Vt||cl(5,i);break;case 1:var d=i.stateNode;if(i.flags&4&&!Vt)if(l===null)d.componentDidMount();else{var p=i.elementType===i.type?l.memoizedProps:Wn(i.type,l.memoizedProps);d.componentDidUpdate(p,l.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var g=i.updateQueue;g!==null&&Kh(i,g,d);break;case 3:var _=i.updateQueue;if(_!==null){if(l=null,i.child!==null)switch(i.child.tag){case 5:l=i.child.stateNode;break;case 1:l=i.child.stateNode}Kh(i,_,l)}break;case 5:var T=i.stateNode;if(l===null&&i.flags&4){l=T;var R=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&l.focus();break;case"img":R.src&&(l.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var N=i.alternate;if(N!==null){var q=N.memoizedState;if(q!==null){var Q=q.dehydrated;Q!==null&&Ci(Q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Vt||i.flags&512&&Ac(i)}catch(X){gt(i,i.return,X)}}if(i===n){ue=null;break}if(l=i.sibling,l!==null){l.return=i.return,ue=l;break}ue=i.return}}function Qf(n){for(;ue!==null;){var i=ue;if(i===n){ue=null;break}var l=i.sibling;if(l!==null){l.return=i.return,ue=l;break}ue=i.return}}function Zf(n){for(;ue!==null;){var i=ue;try{switch(i.tag){case 0:case 11:case 15:var l=i.return;try{cl(4,i)}catch(R){gt(i,l,R)}break;case 1:var d=i.stateNode;if(typeof d.componentDidMount=="function"){var p=i.return;try{d.componentDidMount()}catch(R){gt(i,p,R)}}var g=i.return;try{Ac(i)}catch(R){gt(i,g,R)}break;case 5:var _=i.return;try{Ac(i)}catch(R){gt(i,_,R)}}}catch(R){gt(i,i.return,R)}if(i===n){ue=null;break}var T=i.sibling;if(T!==null){T.return=i.return,ue=T;break}ue=i.return}}var fg=Math.ceil,dl=M.ReactCurrentDispatcher,Mc=M.ReactCurrentOwner,zn=M.ReactCurrentBatchConfig,He=0,Et=null,bt=null,jt=0,vn=0,Is=qr(0),At=0,zo=null,ji=0,hl=0,Ec=0,jo=null,un=null,Rc=0,Ls=1/0,Sr=null,fl=!1,Ic=null,ti=null,pl=!1,ni=null,ml=0,Fo=0,Lc=null,gl=-1,yl=0;function Zt(){return(He&6)!==0?lt():gl!==-1?gl:gl=lt()}function ri(n){return(n.mode&1)===0?1:(He&2)!==0&&jt!==0?jt&-jt:Km.transition!==null?(yl===0&&(yl=ka()),yl):(n=Ge,n!==0||(n=window.event,n=n===void 0?16:Ur(n.type)),n)}function Gn(n,i,l,d){if(50<Fo)throw Fo=0,Lc=null,Error(t(185));Or(n,l,d),((He&2)===0||n!==Et)&&(n===Et&&((He&2)===0&&(hl|=l),At===4&&ii(n,jt)),cn(n,d),l===1&&He===0&&(i.mode&1)===0&&(Ls=lt()+500,Ga&&Qr()))}function cn(n,i){var l=n.callbackNode;cs(n,i);var d=ae(n,n===Et?jt:0);if(d===0)l!==null&&as(l),n.callbackNode=null,n.callbackPriority=0;else if(i=d&-d,n.callbackPriority!==i){if(l!=null&&as(l),i===1)n.tag===0?qm(e1.bind(null,n)):Bh(e1.bind(null,n)),Gm(function(){(He&6)===0&&Qr()}),l=null;else{switch(Nr(d)){case 1:l=fr;break;case 4:l=Nt;break;case 16:l=ls;break;case 536870912:l=qt;break;default:l=ls}l=l1(l,Jf.bind(null,n))}n.callbackPriority=i,n.callbackNode=l}}function Jf(n,i){if(gl=-1,yl=0,(He&6)!==0)throw Error(t(327));var l=n.callbackNode;if($s()&&n.callbackNode!==l)return null;var d=ae(n,n===Et?jt:0);if(d===0)return null;if((d&30)!==0||(d&n.expiredLanes)!==0||i)i=xl(n,d);else{i=d;var p=He;He|=2;var g=n1();(Et!==n||jt!==i)&&(Sr=null,Ls=lt()+500,Bi(n,i));do try{gg();break}catch(T){t1(n,T)}while(!0);Qu(),dl.current=g,He=p,bt!==null?i=0:(Et=null,jt=0,i=At)}if(i!==0){if(i===2&&(p=ro(n),p!==0&&(d=p,i=$c(n,p))),i===1)throw l=zo,Bi(n,0),ii(n,d),cn(n,lt()),l;if(i===6)ii(n,d);else{if(p=n.current.alternate,(d&30)===0&&!pg(p)&&(i=xl(n,d),i===2&&(g=ro(n),g!==0&&(d=g,i=$c(n,g))),i===1))throw l=zo,Bi(n,0),ii(n,d),cn(n,lt()),l;switch(n.finishedWork=p,n.finishedLanes=d,i){case 0:case 1:throw Error(t(345));case 2:Di(n,un,Sr);break;case 3:if(ii(n,d),(d&130023424)===d&&(i=Rc+500-lt(),10<i)){if(ae(n,0)!==0)break;if(p=n.suspendedLanes,(p&d)!==d){Zt(),n.pingedLanes|=n.suspendedLanes&p;break}n.timeoutHandle=Ou(Di.bind(null,n,un,Sr),i);break}Di(n,un,Sr);break;case 4:if(ii(n,d),(d&4194240)===d)break;for(i=n.eventTimes,p=-1;0<d;){var _=31-rn(d);g=1<<_,_=i[_],_>p&&(p=_),d&=~g}if(d=p,d=lt()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*fg(d/1960))-d,10<d){n.timeoutHandle=Ou(Di.bind(null,n,un,Sr),d);break}Di(n,un,Sr);break;case 5:Di(n,un,Sr);break;default:throw Error(t(329))}}}return cn(n,lt()),n.callbackNode===l?Jf.bind(null,n):null}function $c(n,i){var l=jo;return n.current.memoizedState.isDehydrated&&(Bi(n,i).flags|=256),n=xl(n,i),n!==2&&(i=un,un=l,i!==null&&zc(i)),n}function zc(n){un===null?un=n:un.push.apply(un,n)}function pg(n){for(var i=n;;){if(i.flags&16384){var l=i.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var d=0;d<l.length;d++){var p=l[d],g=p.getSnapshot;p=p.value;try{if(!On(g(),p))return!1}catch{return!1}}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ii(n,i){for(i&=~Ec,i&=~hl,n.suspendedLanes|=i,n.pingedLanes&=~i,n=n.expirationTimes;0<i;){var l=31-rn(i),d=1<<l;n[l]=-1,i&=~d}}function e1(n){if((He&6)!==0)throw Error(t(327));$s();var i=ae(n,0);if((i&1)===0)return cn(n,lt()),null;var l=xl(n,i);if(n.tag!==0&&l===2){var d=ro(n);d!==0&&(i=d,l=$c(n,d))}if(l===1)throw l=zo,Bi(n,0),ii(n,i),cn(n,lt()),l;if(l===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=i,Di(n,un,Sr),cn(n,lt()),null}function jc(n,i){var l=He;He|=1;try{return n(i)}finally{He=l,He===0&&(Ls=lt()+500,Ga&&Qr())}}function Fi(n){ni!==null&&ni.tag===0&&(He&6)===0&&$s();var i=He;He|=1;var l=zn.transition,d=Ge;try{if(zn.transition=null,Ge=1,n)return n()}finally{Ge=d,zn.transition=l,He=i,(He&6)===0&&Qr()}}function Fc(){vn=Is.current,it(Is)}function Bi(n,i){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,Um(l)),bt!==null)for(l=bt.return;l!==null;){var d=l;switch(Vu(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&Ha();break;case 3:Ms(),it(on),it(Ht),sc();break;case 5:rc(d);break;case 4:Ms();break;case 13:it(ft);break;case 19:it(ft);break;case 10:Zu(d.type._context);break;case 22:case 23:Fc()}l=l.return}if(Et=n,bt=n=si(n.current,null),jt=vn=i,At=0,zo=null,Ec=hl=ji=0,un=jo=null,Li!==null){for(i=0;i<Li.length;i++)if(l=Li[i],d=l.interleaved,d!==null){l.interleaved=null;var p=d.next,g=l.pending;if(g!==null){var _=g.next;g.next=p,d.next=_}l.pending=d}Li=null}return n}function t1(n,i){do{var l=bt;try{if(Qu(),tl.current=sl,nl){for(var d=pt.memoizedState;d!==null;){var p=d.queue;p!==null&&(p.pending=null),d=d.next}nl=!1}if(zi=0,Mt=Ct=pt=null,Mo=!1,Eo=0,Mc.current=null,l===null||l.return===null){At=1,zo=i,bt=null;break}e:{var g=n,_=l.return,T=l,R=i;if(i=jt,T.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var N=R,q=T,Q=q.tag;if((q.mode&1)===0&&(Q===0||Q===11||Q===15)){var X=q.alternate;X?(q.updateQueue=X.updateQueue,q.memoizedState=X.memoizedState,q.lanes=X.lanes):(q.updateQueue=null,q.memoizedState=null)}var oe=Af(_);if(oe!==null){oe.flags&=-257,Tf(oe,_,T,g,i),oe.mode&1&&Cf(g,N,i),i=oe,R=N;var ce=i.updateQueue;if(ce===null){var fe=new Set;fe.add(R),i.updateQueue=fe}else ce.add(R);break e}else{if((i&1)===0){Cf(g,N,i),Bc();break e}R=Error(t(426))}}else if(dt&&T.mode&1){var _t=Af(_);if(_t!==null){(_t.flags&65536)===0&&(_t.flags|=256),Tf(_t,_,T,g,i),qu(Es(R,T));break e}}g=R=Es(R,T),At!==4&&(At=2),jo===null?jo=[g]:jo.push(g),g=_;do{switch(g.tag){case 3:g.flags|=65536,i&=-i,g.lanes|=i;var F=Sf(g,R,i);qh(g,F);break e;case 1:T=R;var I=g.type,O=g.stateNode;if((g.flags&128)===0&&(typeof I.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(ti===null||!ti.has(O)))){g.flags|=65536,i&=-i,g.lanes|=i;var J=kf(g,T,i);qh(g,J);break e}}g=g.return}while(g!==null)}i1(l)}catch(pe){i=pe,bt===l&&l!==null&&(bt=l=l.return);continue}break}while(!0)}function n1(){var n=dl.current;return dl.current=sl,n===null?sl:n}function Bc(){(At===0||At===3||At===2)&&(At=4),Et===null||(ji&268435455)===0&&(hl&268435455)===0||ii(Et,jt)}function xl(n,i){var l=He;He|=2;var d=n1();(Et!==n||jt!==i)&&(Sr=null,Bi(n,i));do try{mg();break}catch(p){t1(n,p)}while(!0);if(Qu(),He=l,dl.current=d,bt!==null)throw Error(t(261));return Et=null,jt=0,At}function mg(){for(;bt!==null;)r1(bt)}function gg(){for(;bt!==null&&!_a();)r1(bt)}function r1(n){var i=a1(n.alternate,n,vn);n.memoizedProps=n.pendingProps,i===null?i1(n):bt=i,Mc.current=null}function i1(n){var i=n;do{var l=i.alternate;if(n=i.return,(i.flags&32768)===0){if(l=lg(l,i,vn),l!==null){bt=l;return}}else{if(l=ug(l,i),l!==null){l.flags&=32767,bt=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{At=6,bt=null;return}}if(i=i.sibling,i!==null){bt=i;return}bt=i=n}while(i!==null);At===0&&(At=5)}function Di(n,i,l){var d=Ge,p=zn.transition;try{zn.transition=null,Ge=1,yg(n,i,l,d)}finally{zn.transition=p,Ge=d}return null}function yg(n,i,l,d){do $s();while(ni!==null);if((He&6)!==0)throw Error(t(327));l=n.finishedWork;var p=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var g=l.lanes|l.childLanes;if(_u(n,g),n===Et&&(bt=Et=null,jt=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||pl||(pl=!0,l1(ls,function(){return $s(),null})),g=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||g){g=zn.transition,zn.transition=null;var _=Ge;Ge=1;var T=He;He|=4,Mc.current=null,dg(n,l),Xf(l,n),Fm(Bu),hs=!!Fu,Bu=Fu=null,n.current=l,hg(l),yu(),He=T,Ge=_,zn.transition=g}else n.current=l;if(pl&&(pl=!1,ni=n,ml=p),g=n.pendingLanes,g===0&&(ti=null),ba(l.stateNode),cn(n,lt()),i!==null)for(d=n.onRecoverableError,l=0;l<i.length;l++)p=i[l],d(p.value,{componentStack:p.stack,digest:p.digest});if(fl)throw fl=!1,n=Ic,Ic=null,n;return(ml&1)!==0&&n.tag!==0&&$s(),g=n.pendingLanes,(g&1)!==0?n===Lc?Fo++:(Fo=0,Lc=n):Fo=0,Qr(),null}function $s(){if(ni!==null){var n=Nr(ml),i=zn.transition,l=Ge;try{if(zn.transition=null,Ge=16>n?16:n,ni===null)var d=!1;else{if(n=ni,ni=null,ml=0,(He&6)!==0)throw Error(t(331));var p=He;for(He|=4,ue=n.current;ue!==null;){var g=ue,_=g.child;if((ue.flags&16)!==0){var T=g.deletions;if(T!==null){for(var R=0;R<T.length;R++){var N=T[R];for(ue=N;ue!==null;){var q=ue;switch(q.tag){case 0:case 11:case 15:$o(8,q,g)}var Q=q.child;if(Q!==null)Q.return=q,ue=Q;else for(;ue!==null;){q=ue;var X=q.sibling,oe=q.return;if(Hf(q),q===N){ue=null;break}if(X!==null){X.return=oe,ue=X;break}ue=oe}}}var ce=g.alternate;if(ce!==null){var fe=ce.child;if(fe!==null){ce.child=null;do{var _t=fe.sibling;fe.sibling=null,fe=_t}while(fe!==null)}}ue=g}}if((g.subtreeFlags&2064)!==0&&_!==null)_.return=g,ue=_;else e:for(;ue!==null;){if(g=ue,(g.flags&2048)!==0)switch(g.tag){case 0:case 11:case 15:$o(9,g,g.return)}var F=g.sibling;if(F!==null){F.return=g.return,ue=F;break e}ue=g.return}}var I=n.current;for(ue=I;ue!==null;){_=ue;var O=_.child;if((_.subtreeFlags&2064)!==0&&O!==null)O.return=_,ue=O;else e:for(_=I;ue!==null;){if(T=ue,(T.flags&2048)!==0)try{switch(T.tag){case 0:case 11:case 15:cl(9,T)}}catch(pe){gt(T,T.return,pe)}if(T===_){ue=null;break e}var J=T.sibling;if(J!==null){J.return=T.return,ue=J;break e}ue=T.return}}if(He=p,Qr(),ut&&typeof ut.onPostCommitFiberRoot=="function")try{ut.onPostCommitFiberRoot(xi,n)}catch{}d=!0}return d}finally{Ge=l,zn.transition=i}}return!1}function s1(n,i,l){i=Es(l,i),i=Sf(n,i,1),n=Jr(n,i,1),i=Zt(),n!==null&&(Or(n,1,i),cn(n,i))}function gt(n,i,l){if(n.tag===3)s1(n,n,l);else for(;i!==null;){if(i.tag===3){s1(i,n,l);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(ti===null||!ti.has(d))){n=Es(l,n),n=kf(i,n,1),i=Jr(i,n,1),n=Zt(),i!==null&&(Or(i,1,n),cn(i,n));break}}i=i.return}}function xg(n,i,l){var d=n.pingCache;d!==null&&d.delete(i),i=Zt(),n.pingedLanes|=n.suspendedLanes&l,Et===n&&(jt&l)===l&&(At===4||At===3&&(jt&130023424)===jt&&500>lt()-Rc?Bi(n,0):Ec|=l),cn(n,i)}function o1(n,i){i===0&&((n.mode&1)===0?i=1:(i=Dr,Dr<<=1,(Dr&130023424)===0&&(Dr=4194304)));var l=Zt();n=_r(n,i),n!==null&&(Or(n,i,l),cn(n,l))}function vg(n){var i=n.memoizedState,l=0;i!==null&&(l=i.retryLane),o1(n,l)}function _g(n,i){var l=0;switch(n.tag){case 13:var d=n.stateNode,p=n.memoizedState;p!==null&&(l=p.retryLane);break;case 19:d=n.stateNode;break;default:throw Error(t(314))}d!==null&&d.delete(i),o1(n,l)}var a1;a1=function(n,i,l){if(n!==null)if(n.memoizedProps!==i.pendingProps||on.current)ln=!0;else{if((n.lanes&l)===0&&(i.flags&128)===0)return ln=!1,ag(n,i,l);ln=(n.flags&131072)!==0}else ln=!1,dt&&(i.flags&1048576)!==0&&Dh(i,Ya,i.index);switch(i.lanes=0,i.tag){case 2:var d=i.type;ll(n,i),n=i.pendingProps;var p=bs(i,Ht.current);Ps(i,l),p=lc(null,i,d,n,p,l);var g=uc();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,an(d)?(g=!0,Ua(i)):g=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,tc(i),p.updater=ol,i.stateNode=p,p._reactInternals=i,mc(i,d,n,l),i=vc(null,i,d,!0,g,l)):(i.tag=0,dt&&g&&Gu(i),Qt(null,i,p,l),i=i.child),i;case 16:d=i.elementType;e:{switch(ll(n,i),n=i.pendingProps,p=d._init,d=p(d._payload),i.type=d,p=i.tag=bg(d),n=Wn(d,n),p){case 0:i=xc(null,i,d,n,l);break e;case 1:i=Lf(null,i,d,n,l);break e;case 11:i=Pf(null,i,d,n,l);break e;case 14:i=Mf(null,i,d,Wn(d.type,n),l);break e}throw Error(t(306,d,""))}return i;case 0:return d=i.type,p=i.pendingProps,p=i.elementType===d?p:Wn(d,p),xc(n,i,d,p,l);case 1:return d=i.type,p=i.pendingProps,p=i.elementType===d?p:Wn(d,p),Lf(n,i,d,p,l);case 3:e:{if($f(i),n===null)throw Error(t(387));d=i.pendingProps,g=i.memoizedState,p=g.element,Xh(n,i),Ja(i,d,null,l);var _=i.memoizedState;if(d=_.element,g.isDehydrated)if(g={element:d,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){p=Es(Error(t(423)),i),i=zf(n,i,d,l,p);break e}else if(d!==p){p=Es(Error(t(424)),i),i=zf(n,i,d,l,p);break e}else for(xn=Xr(i.stateNode.containerInfo.firstChild),yn=i,dt=!0,Nn=null,l=Vh(i,null,d,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Cs(),d===p){i=br(n,i,l);break e}Qt(n,i,d,l)}i=i.child}return i;case 5:return Qh(i),n===null&&Xu(i),d=i.type,p=i.pendingProps,g=n!==null?n.memoizedProps:null,_=p.children,Du(d,p)?_=null:g!==null&&Du(d,g)&&(i.flags|=32),If(n,i),Qt(n,i,_,l),i.child;case 6:return n===null&&Xu(i),null;case 13:return jf(n,i,l);case 4:return nc(i,i.stateNode.containerInfo),d=i.pendingProps,n===null?i.child=As(i,null,d,l):Qt(n,i,d,l),i.child;case 11:return d=i.type,p=i.pendingProps,p=i.elementType===d?p:Wn(d,p),Pf(n,i,d,p,l);case 7:return Qt(n,i,i.pendingProps,l),i.child;case 8:return Qt(n,i,i.pendingProps.children,l),i.child;case 12:return Qt(n,i,i.pendingProps.children,l),i.child;case 10:e:{if(d=i.type._context,p=i.pendingProps,g=i.memoizedProps,_=p.value,Je(Ka,d._currentValue),d._currentValue=_,g!==null)if(On(g.value,_)){if(g.children===p.children&&!on.current){i=br(n,i,l);break e}}else for(g=i.child,g!==null&&(g.return=i);g!==null;){var T=g.dependencies;if(T!==null){_=g.child;for(var R=T.firstContext;R!==null;){if(R.context===d){if(g.tag===1){R=wr(-1,l&-l),R.tag=2;var N=g.updateQueue;if(N!==null){N=N.shared;var q=N.pending;q===null?R.next=R:(R.next=q.next,q.next=R),N.pending=R}}g.lanes|=l,R=g.alternate,R!==null&&(R.lanes|=l),Ju(g.return,l,i),T.lanes|=l;break}R=R.next}}else if(g.tag===10)_=g.type===i.type?null:g.child;else if(g.tag===18){if(_=g.return,_===null)throw Error(t(341));_.lanes|=l,T=_.alternate,T!==null&&(T.lanes|=l),Ju(_,l,i),_=g.sibling}else _=g.child;if(_!==null)_.return=g;else for(_=g;_!==null;){if(_===i){_=null;break}if(g=_.sibling,g!==null){g.return=_.return,_=g;break}_=_.return}g=_}Qt(n,i,p.children,l),i=i.child}return i;case 9:return p=i.type,d=i.pendingProps.children,Ps(i,l),p=Ln(p),d=d(p),i.flags|=1,Qt(n,i,d,l),i.child;case 14:return d=i.type,p=Wn(d,i.pendingProps),p=Wn(d.type,p),Mf(n,i,d,p,l);case 15:return Ef(n,i,i.type,i.pendingProps,l);case 17:return d=i.type,p=i.pendingProps,p=i.elementType===d?p:Wn(d,p),ll(n,i),i.tag=1,an(d)?(n=!0,Ua(i)):n=!1,Ps(i,l),wf(i,d,p),mc(i,d,p,l),vc(null,i,d,!0,n,l);case 19:return Bf(n,i,l);case 22:return Rf(n,i,l)}throw Error(t(156,i.tag))};function l1(n,i){return gu(n,i)}function wg(n,i,l,d){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jn(n,i,l,d){return new wg(n,i,l,d)}function Dc(n){return n=n.prototype,!(!n||!n.isReactComponent)}function bg(n){if(typeof n=="function")return Dc(n)?1:0;if(n!=null){if(n=n.$$typeof,n===ge)return 11;if(n===Be)return 14}return 2}function si(n,i){var l=n.alternate;return l===null?(l=jn(n.tag,i,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=i,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,i=n.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function vl(n,i,l,d,p,g){var _=2;if(d=n,typeof n=="function")Dc(n)&&(_=1);else if(typeof n=="string")_=5;else e:switch(n){case L:return Oi(l.children,p,g,i);case G:_=8,p|=8;break;case H:return n=jn(12,l,i,p|2),n.elementType=H,n.lanes=g,n;case K:return n=jn(13,l,i,p),n.elementType=K,n.lanes=g,n;case xe:return n=jn(19,l,i,p),n.elementType=xe,n.lanes=g,n;case te:return _l(l,p,g,i);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case W:_=10;break e;case Y:_=9;break e;case ge:_=11;break e;case Be:_=14;break e;case ee:_=16,d=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return i=jn(_,l,i,p),i.elementType=n,i.type=d,i.lanes=g,i}function Oi(n,i,l,d){return n=jn(7,n,d,i),n.lanes=l,n}function _l(n,i,l,d){return n=jn(22,n,d,i),n.elementType=te,n.lanes=l,n.stateNode={isHidden:!1},n}function Oc(n,i,l){return n=jn(6,n,null,i),n.lanes=l,n}function Nc(n,i,l){return i=jn(4,n.children!==null?n.children:[],n.key,i),i.lanes=l,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}function Sg(n,i,l,d,p){this.tag=i,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_i(0),this.expirationTimes=_i(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_i(0),this.identifierPrefix=d,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Wc(n,i,l,d,p,g,_,T,R){return n=new Sg(n,i,l,T,R),i===1?(i=1,g===!0&&(i|=8)):i=0,g=jn(3,null,null,i),n.current=g,g.stateNode=n,g.memoizedState={element:d,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},tc(g),n}function kg(n,i,l){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:d==null?null:""+d,children:n,containerInfo:i,implementation:l}}function u1(n){if(!n)return Kr;n=n._reactInternals;e:{if(Ot(n)!==n||n.tag!==1)throw Error(t(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(an(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(n.tag===1){var l=n.type;if(an(l))return jh(n,l,i)}return i}function c1(n,i,l,d,p,g,_,T,R){return n=Wc(l,d,!0,n,p,g,_,T,R),n.context=u1(null),l=n.current,d=Zt(),p=ri(l),g=wr(d,p),g.callback=i??null,Jr(l,g,p),n.current.lanes=p,Or(n,p,d),cn(n,d),n}function wl(n,i,l,d){var p=i.current,g=Zt(),_=ri(p);return l=u1(l),i.context===null?i.context=l:i.pendingContext=l,i=wr(g,_),i.payload={element:n},d=d===void 0?null:d,d!==null&&(i.callback=d),n=Jr(p,i,_),n!==null&&(Gn(n,p,_,g),Za(n,p,_)),_}function bl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function d1(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<i?l:i}}function Hc(n,i){d1(n,i),(n=n.alternate)&&d1(n,i)}function Cg(){return null}var h1=typeof reportError=="function"?reportError:function(n){console.error(n)};function Uc(n){this._internalRoot=n}Sl.prototype.render=Uc.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(t(409));wl(n,i,null,null)},Sl.prototype.unmount=Uc.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Fi(function(){wl(null,n,null,null)}),i[gr]=null}};function Sl(n){this._internalRoot=n}Sl.prototype.unstable_scheduleHydration=function(n){if(n){var i=Ta();n={blockedOn:null,target:n,priority:i};for(var l=0;l<tr.length&&i!==0&&i<tr[l].priority;l++);tr.splice(l,0,n),l===0&&Ea(n)}};function Gc(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function kl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function f1(){}function Ag(n,i,l,d,p){if(p){if(typeof d=="function"){var g=d;d=function(){var N=bl(_);g.call(N)}}var _=c1(i,d,n,0,null,!1,!1,"",f1);return n._reactRootContainer=_,n[gr]=_.current,wo(n.nodeType===8?n.parentNode:n),Fi(),_}for(;p=n.lastChild;)n.removeChild(p);if(typeof d=="function"){var T=d;d=function(){var N=bl(R);T.call(N)}}var R=Wc(n,0,!1,null,null,!1,!1,"",f1);return n._reactRootContainer=R,n[gr]=R.current,wo(n.nodeType===8?n.parentNode:n),Fi(function(){wl(i,R,l,d)}),R}function Cl(n,i,l,d,p){var g=l._reactRootContainer;if(g){var _=g;if(typeof p=="function"){var T=p;p=function(){var R=bl(_);T.call(R)}}wl(i,_,n,p)}else _=Ag(l,i,n,p,d);return bl(_)}Ca=function(n){switch(n.tag){case 3:var i=n.stateNode;if(i.current.memoizedState.isDehydrated){var l=vi(i.pendingLanes);l!==0&&(wi(i,l|1),cn(i,lt()),(He&6)===0&&(Ls=lt()+500,Qr()))}break;case 13:Fi(function(){var d=_r(n,1);if(d!==null){var p=Zt();Gn(d,n,1,p)}}),Hc(n,1)}},io=function(n){if(n.tag===13){var i=_r(n,134217728);if(i!==null){var l=Zt();Gn(i,n,134217728,l)}Hc(n,134217728)}},Aa=function(n){if(n.tag===13){var i=ri(n),l=_r(n,i);if(l!==null){var d=Zt();Gn(l,n,i,d)}Hc(n,i)}},Ta=function(){return Ge},Pa=function(n,i){var l=Ge;try{return Ge=n,i()}finally{Ge=l}},rs=function(n,i,l){switch(i){case"input":if(Ir(n,l),i=l.name,l.type==="radio"&&i!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<l.length;i++){var d=l[i];if(d!==n&&d.form===n.form){var p=Wa(d);if(!p)throw Error(t(90));Dt(d),Ir(d,p)}}}break;case"textarea":Ji(n,l);break;case"select":i=l.value,i!=null&&Lr(n,!!l.multiple,i,!1)}},kt=jc,Fr=Fi;var Tg={usingClientEntryPoint:!1,Events:[ko,_s,Wa,Lt,mi,jc]},Bo={findFiberByHostInstance:Mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Pg={bundleType:Bo.bundleType,version:Bo.version,rendererPackageName:Bo.rendererPackageName,rendererConfig:Bo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=va(n),n===null?null:n.stateNode},findFiberByHostInstance:Bo.findFiberByHostInstance||Cg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Al.isDisabled&&Al.supportsFiber)try{xi=Al.inject(Pg),ut=Al}catch{}}return dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Tg,dn.createPortal=function(n,i){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gc(i))throw Error(t(200));return kg(n,i,null,l)},dn.createRoot=function(n,i){if(!Gc(n))throw Error(t(299));var l=!1,d="",p=h1;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=Wc(n,1,!1,null,null,l,!1,d,p),n[gr]=i.current,wo(n.nodeType===8?n.parentNode:n),new Uc(i)},dn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=va(i),n=n===null?null:n.stateNode,n},dn.flushSync=function(n){return Fi(n)},dn.hydrate=function(n,i,l){if(!kl(i))throw Error(t(200));return Cl(null,n,i,!0,l)},dn.hydrateRoot=function(n,i,l){if(!Gc(n))throw Error(t(405));var d=l!=null&&l.hydratedSources||null,p=!1,g="",_=h1;if(l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onRecoverableError!==void 0&&(_=l.onRecoverableError)),i=c1(i,null,n,1,l??null,p,!1,g,_),n[gr]=i.current,wo(n),d)for(n=0;n<d.length;n++)l=d[n],p=l._getVersion,p=p(l._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[l,p]:i.mutableSourceEagerHydrationData.push(l,p);return new Sl(i)},dn.render=function(n,i,l){if(!kl(i))throw Error(t(200));return Cl(null,n,i,!1,l)},dn.unmountComponentAtNode=function(n){if(!kl(n))throw Error(t(40));return n._reactRootContainer?(Fi(function(){Cl(null,null,n,!1,function(){n._reactRootContainer=null,n[gr]=null})}),!0):!1},dn.unstable_batchedUpdates=jc,dn.unstable_renderSubtreeIntoContainer=function(n,i,l,d){if(!kl(l))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return Cl(n,i,l,!1,d)},dn.version="18.3.1-next-f1338f8080-20240426",dn}var w1;function jg(){if(w1)return Xc.exports;w1=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Xc.exports=zg(),Xc.exports}var b1;function Fg(){if(b1)return Tl;b1=1;var r=jg();return Tl.createRoot=r.createRoot,Tl.hydrateRoot=r.hydrateRoot,Tl}var Bg=Fg();const Dg=Gd(Bg);var Z=Vd();const kr={id:"pj-1",nom:{nomcomplet:"Test Hero",prenom:"Aryn",surnom:"the Blue"},age:25,sexe:"H",taille:175,poids:70,vitesse:9,langues:"Common",alignement:"Neutral Good",raceId:"human",backgroundId:"adventurer",niveauGlobal:1,classe:{1:{classeId:"fighter",subclasseId:"champion",niveau:1}},xp:0,dv:10,maitriseBonus:2,pvActuels:12,pvMax:12,pvTmp:0,calculPvMax:{classe1:{niveauGlobal_1:"10 + modCON",par_niveau_apres_1:"1d10 + modCON"},classe2:{par_niveau_apres_1:""}},CA:16,CalculCA:{base:"10 + modDEX",bonusArmure:"+ armor proficiency + shield"},nivFatigueActuel:0,nivFatigueMax:3,initiative:"modDEX",besoin:[],caracs:{force:{FOR:16,modFOR:3},dexterite:{DEX:14,modDEX:2},constitution:{CON:14,modCON:2},intelligence:{INT:10,modINT:0},sagesse:{SAG:12,modSAG:1},charisme:{CHA:10,modCHA:0}},competences:{},percPassive:11,proficiencies:{},savingThrows:["force","constitution"],inspiration:!1,traits:["Veteran soldier","Brave"],features:[],compteur:{},ressources:{},etats:[],historique:[],notes:"",argent:{cuivre:0,argent:0,or:10,platine:0},materielSlots:{Ceinture_gauche:null,Ceinture_droite:null,Dos_gauche:null,Dos_droit:null,Armure:null,Vetement:null,paquetage:null,accessoire:null},armesDefaut:{main_droite:null,main_gauche:null,mains:null},Inventaire:{id:"",idUnique:"",quantite:0,mod:null,conteneur:null},capaMax:120,capaAvantMalus:60,capaActuel:0,StatEncombrement:"Not encumbered",descriptionPersonnage:{bio:"Test hero for the mini-game.",physique:"Athletic human in light armor.",personnalite:"Calm and determined.",objectifs:"Explore the test dungeon.",relations:"",defauts:"Too reckless."},uiClasse:{ui_template1:"fighter_base",ui_template2:null},SpellcastingSpec:{ability:null,spellSaveDc:null,spellAttackMod:null,slots:{},focusId:null,description:null,spellIds:[]}},Tr=12,ur=8,st=64,Qo=Tr*st,Yl=ur*st,Vp=st,Yd=st*.5,Yp=Qo/2,Xp=Yd*2,Og=1841961;function Er(r,e){return r>=0&&r<Tr&&e>=0&&e<ur}function bn(r,e){const t=Vp/2,s=Yd/2,o=(r-e)*t+Yp,a=(r+e)*s+Xp;return{x:o,y:a}}function Ng(r,e){const t=Vp/2,s=Yd/2,o=r-Yp,a=e-Xp,u=o/t,c=a/s,h=(u+c)/2,f=(c-u)/2,m=Math.round(h),y=Math.round(f);return{x:m,y}}function qp(r,e,t,s){const o=[];for(let a=-s;a<=s;a++)for(let u=-s;u<=s;u++){const c=e+u,h=t+a;if(!Er(c,h))continue;Math.sqrt(u*u+a*a)<=s+.01&&o.push({x:c,y:h})}return{id:r,type:"circle",cells:o}}function Wg(r,e,t,s,o){const a=[],u=Math.floor(s/2),c=Math.floor(o/2);for(let h=t-c;h<=t+c;h++)for(let f=e-u;f<=e+u;f++)Er(f,h)&&a.push({x:f,y:h});return{id:r,type:"rectangle",cells:a}}function Kp(r,e,t,s,o,a){const u=[],h=typeof a=="number"&&a>0&&a<180?a*Math.PI/360:null;for(let f=1;f<=s;f++){let m=f;if(h!==null){const y=Math.tan(h)*f;m=Math.floor(y),m<0&&(m=0),m>f&&(m=f)}for(let y=-m;y<=m;y++){let v=e,x=t;switch(o){case"right":v=e+f,x=t+y;break;case"left":v=e-f,x=t+y;break;case"down":v=e+y,x=t+f;break;case"up":v=e+y,x=t-f;break}Er(v,x)&&u.push({x:v,y:x})}}return{id:r,type:"cone",cells:u}}function Hg(r,e){return`${r},${e}`}function Ug(r,e){const t=[];let s=Math.round(r.x),o=Math.round(r.y);const a=Math.round(e.x),u=Math.round(e.y),c=Math.abs(a-s),h=Math.abs(u-o),f=s<a?1:-1,m=o<u?1:-1;let y=c-h;for(;t.push({x:s,y:o}),!(s===a&&o===u);){const v=2*y;v>-h&&(y-=h,s+=f),v<c&&(y+=c,o+=m)}return t}function ia(r,e,t){if(!t||t.size===0)return!0;const s=Ug(r,e);for(let o=1;o<s.length-1;o++){const a=s[o];if(t.has(Hg(a.x,a.y)))return!1}return!0}const Gg=30,Vg={shape:"cone",range:Gg};function Yg(r){return r.facing?r.facing:r.type==="player"?"right":"left"}function Xg(r){return r.visionProfile?r.visionProfile:Vg}function Xd(r){const e=Xg(r),t=Yg(r),s=`vision-${r.id}`;return e.range<=0?{id:s,type:e.shape==="circle"?"circle":"cone",cells:[]}:e.shape==="circle"?qp(s,r.x,r.y,e.range):Kp(s,r.x,r.y,e.range,t,e.apertureDeg)}function Jl(r){return`${r.x},${r.y}`}function qg(r,e,t){const s=Xd(r);if(!s.cells.length)return!1;const o=Jl(e);for(const a of s.cells)if(Jl(a)===o)return t&&t.size>0?ia({x:r.x,y:r.y},{x:e.x,y:e.y},t):!0;return!1}function Qp(r,e,t){const s=Xd(r);if(!s.cells.length)return[];const o=new Set;for(const u of s.cells)o.add(Jl(u));const a=e.filter(u=>u.id!==r.id&&u.hp>0&&o.has(Jl({x:u.x,y:u.y})));return!t||t.size===0?a:a.filter(u=>ia({x:r.x,y:r.y},{x:u.x,y:u.y},t))}function eu(r,e,t,s){return!(e.hp<=0||!Qp(r,t,s).some(u=>u.id===e.id))}function tu(r,e,t){return Math.max(e,Math.min(t,r))}function ai(r,e){return Math.abs(r.x-e.x)+Math.abs(r.y-e.y)}function Yt(r){return r.hp<=0}function S1(r,e,t,s){return Yt(r)||Yt(e)?!1:eu(r,e,t,s)}function Kg(r,e){const t=e.x-r.x,s=e.y-r.y;return Math.abs(t)>=Math.abs(s)?t>=0?"right":"left":s>=0?"down":"up"}const Qg=["./brute.json","./archer.json","./assassin.json","./ghost.json"],k1={types:Qg},Zg="brute",Jg="Brute",e2="Frontliner robuste qui avance pour engager le joueur.",t2="brute",n2=["enemy-move","enemy-melee-strike"],r2={preferredRangeMin:1,preferredRangeMax:1,panicRange:0},i2={raceOrOrigin:"Brute mercenaire",register:"familier",tone:["agressif","direct","impatient"],vocabulary:["charge","ecrase","avance","finissons-en"],quirks:["phrases courtes","menaces simples"],taboos:["pas de modernisme","pas de meta-jeu"]},s2={hp:10,moveRange:3,attackDamage:2,armorClass:14,attackRange:1,maxAttacksPerTurn:2},o2={type:"ground",speed:3,canPassThroughWalls:!1,canPassThroughEntities:!1,canStopOnOccupiedTile:!1},a2={shape:"cone",range:4,apertureDeg:90,canSeeInDark:!1},l2={id:Zg,label:Jg,description:e2,aiRole:t2,actions:n2,behavior:r2,speechProfile:i2,baseStats:s2,movement:o2,vision:a2},u2="archer",c2="Archer",d2="Tireur qui prefere garder une distance de securite avant de frapper.",h2="archer",f2=["enemy-move","enemy-bow-shot","enemy-melee-strike"],p2={preferredRangeMin:3,preferredRangeMax:6,panicRange:2},m2={raceOrOrigin:"Archer de bande",register:"neutre",tone:["tactique","moqueur","vigilant"],vocabulary:["a couvert","recule","je l'ai en vue","distance"],quirks:["annonce ce qu'il voit","donne des consignes courtes"],taboos:["pas de modernisme","pas de meta-jeu"]},g2={hp:7,moveRange:2,attackDamage:2,armorClass:13,attackRange:6,maxAttacksPerTurn:1},y2={type:"ground",speed:2,canPassThroughWalls:!1,canPassThroughEntities:!1,canStopOnOccupiedTile:!1},x2={shape:"cone",range:15,apertureDeg:60,canSeeInDark:!1},v2={id:u2,label:c2,description:d2,aiRole:h2,actions:f2,behavior:p2,speechProfile:m2,baseStats:g2,movement:y2,vision:x2},_2="assassin",w2="Assassin",b2="Frappeur rapide qui cherche a se rapprocher pour porter un coup decisif.",S2="assassin",k2=["enemy-move","enemy-melee-strike"],C2={preferredRangeMin:1,preferredRangeMax:1,panicRange:0},A2={raceOrOrigin:"Assassin",register:"soutenu",tone:["froid","tranchant","calme"],vocabulary:["silence","cible","dans l'ombre","fin"],quirks:["parle peu","phrases courtes et precises"],taboos:["pas de modernisme","pas de meta-jeu"]},T2={hp:6,moveRange:3,attackDamage:3,armorClass:15},P2={type:"ground",speed:3,canPassThroughWalls:!1,canPassThroughEntities:!0,canStopOnOccupiedTile:!1},M2={shape:"cone",range:6,apertureDeg:80,canSeeInDark:!1},E2={id:_2,label:w2,description:b2,aiRole:S2,actions:k2,behavior:C2,speechProfile:A2,baseStats:T2,movement:P2,vision:M2},R2="ghost",I2="Fantome",L2="Esprit intangible capable de traverser les autres creatures.",$2="ghost",z2=["enemy-move","enemy-melee-strike"],j2={preferredRangeMin:1,preferredRangeMax:1,panicRange:0},F2={raceOrOrigin:"Esprit vengeur",register:"soutenu",tone:["cryptique","menaant","surnaturel"],vocabulary:["je te sens","au-dela","froideur","souffle"],quirks:["parle en images","phrases etranges mais courtes"],taboos:["pas de modernisme","pas de meta-jeu"]},B2={hp:8,moveRange:4,attackDamage:3,armorClass:12},D2={type:"ghost",speed:4,canPassThroughWalls:!0,canPassThroughEntities:!0,canStopOnOccupiedTile:!1},O2={shape:"circle",range:6,canSeeInDark:!0},N2={id:R2,label:I2,description:L2,aiRole:$2,actions:z2,behavior:j2,speechProfile:F2,baseStats:B2,movement:D2,vision:O2},W2=["./wall-stone.json","./low-wall-stone.json","./tree-oak.json","./barrel-wood.json","./pillar-stone.json"],C1={types:W2},H2="wall-stone",U2="Mur de pierre",G2="wall",V2=["wall","stone"],Y2={movement:!0,vision:!0,attacks:!0},X2={destructible:!0,maxHp:35,ac:15},q2=[{id:"1",label:"Segment 1",footprint:[{x:0,y:0}],rotatable:!1},{id:"2",label:"Segment 2",footprint:[{x:0,y:0},{x:1,y:0}],rotatable:!0},{id:"3",label:"Segment 3",footprint:[{x:0,y:0},{x:1,y:0},{x:2,y:0}],rotatable:!0}],K2={spriteKey:"obstacle:wall-stone",tint:16777215,heightClass:"tall"},Q2={weight:5,cluster:{min:2,max:8},shapeHint:"line",avoidNearTokens:!0},Z2={id:H2,label:U2,category:G2,tags:V2,blocking:Y2,durability:X2,variants:q2,appearance:K2,spawnRules:Q2},J2="low-wall-stone",ey="Muret de pierre",ty="wall",ny=["wall","stone","low"],ry={movement:!0,vision:!1,attacks:!1},iy={destructible:!0,maxHp:18,ac:13},sy=[{id:"1",label:"Segment 1",footprint:[{x:0,y:0}],rotatable:!1},{id:"2",label:"Segment 2",footprint:[{x:0,y:0},{x:1,y:0}],rotatable:!0}],oy={cover:"half"},ay={spriteKey:"obstacle:low-wall-stone",tint:16777215,heightClass:"low"},ly={weight:3,cluster:{min:1,max:6},shapeHint:"line",avoidNearTokens:!0},uy={id:J2,label:ey,category:ty,tags:ny,blocking:ry,durability:iy,variants:sy,combat:oy,appearance:ay,spawnRules:ly},cy="tree-oak",dy="Chne",hy="vegetation",fy=["tree","vegetation","wood"],py={movement:!0,vision:!0,attacks:!0},my={destructible:!0,maxHp:22,ac:12},gy=[{id:"base",label:"Tronc",footprint:[{x:0,y:0}],rotatable:!1}],yy={spriteKey:"obstacle:tree-oak",tint:16777215,heightClass:"tall",variantWeights:{summer:6,autumn:3,dead:1}},xy={weight:6,cluster:{min:1,max:5},shapeHint:"scatter",avoidNearTokens:!0},vy={id:cy,label:dy,category:hy,tags:fy,blocking:py,durability:my,variants:gy,appearance:yy,spawnRules:xy},_y="barrel-wood",wy="Tonneau",by="prop",Sy=["barrel","wood","prop"],ky={movement:!0,vision:!1,attacks:!1},Cy={destructible:!0,maxHp:8,ac:10},Ay=[{id:"base",label:"Tonneau",footprint:[{x:0,y:0}],rotatable:!1}],Ty={spriteKey:"obstacle:barrel-wood",tint:16777215,heightClass:"medium"},Py={weight:4,cluster:{min:1,max:3},shapeHint:"scatter",avoidNearTokens:!0},My={id:_y,label:wy,category:by,tags:Sy,blocking:ky,durability:Cy,variants:Ay,appearance:Ty,spawnRules:Py},Ey="pillar-stone",Ry="Pilier de pierre",Iy="structure",Ly=["pillar","stone","structure"],$y={movement:!0,vision:!0,attacks:!0},zy={destructible:!0,maxHp:28,ac:14},jy=[{id:"base",label:"Pilier",footprint:[{x:0,y:0}],rotatable:!1}],Fy={spriteKey:"obstacle:pillar-stone",tint:16777215,heightClass:"tall"},By={weight:2,cluster:{min:1,max:2},shapeHint:"scatter",avoidNearTokens:!0},Dy={id:Ey,label:Ry,category:Iy,tags:Ly,blocking:$y,durability:zy,variants:jy,appearance:Fy,spawnRules:By},Oy={"./wall-stone.json":Z2,"./low-wall-stone.json":uy,"./tree-oak.json":vy,"./barrel-wood.json":My,"./pillar-stone.json":Dy};function Ny(){const r=Array.isArray(C1.types)?C1.types:[],e=[];for(const t of r){const s=Oy[t];s?e.push(s):console.warn("[obstacle-types] Type path missing in bundle:",t)}return e.length===0&&console.warn("[obstacle-types] No obstacle types loaded from index.json"),e}function Wy(r){let e=r>>>0;return()=>{e+=1831565813;let t=Math.imul(e^e>>>15,1|e);return t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296}}function Hy(r){const e=String(r??"");let t=2166136261;for(let s=0;s<e.length;s++)t^=e.charCodeAt(s),t=Math.imul(t,16777619);return t>>>0}function Sd(r,e){return`${r},${e}`}function hn(r,e,t){return Math.max(e,Math.min(t,r))}function Uy(r,e){var o,a;const t=r.reduce((u,c)=>u+Math.max(0,c.weight),0);if(t<=0)return((o=r[0])==null?void 0:o.item)??null;let s=e()*t;for(const u of r){const c=Math.max(0,u.weight);if(s<c)return u.item;s-=c}return((a=r[r.length-1])==null?void 0:a.item)??null}function Gy(r,e){return r.length===0?null:r[Math.floor(e()*r.length)]??r[0]}function Pl(r,e){return r.find(t=>t.id===e)??null}function A1(r,e,t){return{x:hn(r.x,0,e-1),y:hn(r.y,0,t-1)}}function li(r,e,t,s,o,a){var f,m,y;if(!t)return;const u=Sd(s,o);if(e.has(u))return;const c=((m=(f=t.variants)==null?void 0:f[0])==null?void 0:m.id)??"base",h=Math.max(1,Number(((y=t.durability)==null?void 0:y.maxHp)??1));r.push({id:a(),typeId:t.id,variantId:c,x:s,y:o,rotation:0,hp:h,maxHp:h}),e.add(u)}function Vy(r){const{rect:e,door:t,wallType:s,obstacles:o,occupied:a,nextId:u}=r;for(let c=e.x1;c<=e.x2;c++){const h={x:c,y:e.y1},f={x:c,y:e.y2};(!t||!(t.x===h.x&&t.y===h.y))&&li(o,a,s,h.x,h.y,u),(!t||!(t.x===f.x&&t.y===f.y))&&li(o,a,s,f.x,f.y,u)}for(let c=e.y1;c<=e.y2;c++){const h={x:e.x1,y:c},f={x:e.x2,y:c};(!t||!(t.x===h.x&&t.y===h.y))&&li(o,a,s,h.x,h.y,u),(!t||!(t.x===f.x&&t.y===f.y))&&li(o,a,s,f.x,f.y,u)}}function Yy(r){const e=Math.max(1,r.grid.cols),t=Math.max(1,r.grid.rows),s=String(r.prompt??"").trim(),o=s.toLowerCase(),a=Wy(Hy(s||"default")),u=[],c=new Set;let h=1;const f=()=>`obs-${h++}`,m=Pl(r.obstacleTypes,"wall-stone")??r.obstacleTypes.find(z=>z.category==="wall")??r.obstacleTypes[0]??null,y=Pl(r.obstacleTypes,"tree-oak")??r.obstacleTypes.find(z=>(z.tags??[]).includes("tree"))??null,v=Pl(r.obstacleTypes,"pillar-stone")??r.obstacleTypes.find(z=>(z.tags??[]).includes("pillar"))??null,x=Pl(r.obstacleTypes,"barrel-wood")??r.obstacleTypes.find(z=>(z.tags??[]).includes("barrel"))??null,b=/donjon|dungeon|salle|couloir|corridor|porte|ruine|catacombe/.test(o),S=/foret|fort|bois|arbres|arbre|clairiere|clairire/.test(o),w=A1({x:1,y:Math.floor(t/2)},e,t);if(b&&m){const z={x1:hn(Math.floor(e*.55),0,e-1),y1:hn(1,0,t-1),x2:hn(e-2,0,e-1),y2:hn(t-2,0,t-1)},L=A1({x:z.x1,y:hn(Math.floor(t/2),z.y1,z.y2)},e,t);Vy({rect:z,door:L,wallType:m,obstacles:u,occupied:c,nextId:f});const H=Uy([{type:v,weight:3},{type:x,weight:2}].filter(W=>!!W.type).map(W=>({item:W.type,weight:W.weight})),a);if(H)for(let Y=0;Y<20;Y++){const ge=hn(z.x1+1+Math.floor(a()*Math.max(1,z.x2-z.x1-1)),0,e-1),K=hn(z.y1+1+Math.floor(a()*Math.max(1,z.y2-z.y1-1)),0,t-1);if(!(ge===L.x&&K===L.y)&&!c.has(Sd(ge,K))){if(li(u,c,H,ge,K,f),a()<.5&&x&&H.id!==x.id){const xe=hn(ge+(a()<.5?1:-1),0,e-1),Be=hn(K+(a()<.5?1:-1),0,t-1);li(u,c,x,xe,Be,f)}break}}}else if(S&&y){const z=w.y,L=hn(Math.floor(e*t/8),3,12);for(let G=0;G<L;G++){const H=Math.floor(a()*e),W=Math.floor(a()*t);W===z&&H<=e-2||H===w.x&&W===w.y||li(u,c,y,H,W,f)}}else{const z=x??v??m,L=hn(Math.floor(e*t/18),1,6);for(let G=0;G<L;G++){const H=Math.floor(a()*e),W=Math.floor(a()*t);H===w.x&&W===w.y||li(u,c,z,H,W,f)}}const A=[],E=hn(r.enemyCount,1,20),P=(z,L)=>Math.abs(z-w.x)+Math.abs(L-w.y)+a()*.25,M=[];for(let z=0;z<t;z++)for(let L=0;L<e;L++)c.has(Sd(L,z))||L===w.x&&z===w.y||M.push({x:L,y:z});M.sort((z,L)=>P(L.x,L.y)-P(z.x,z.y));for(let z=0;z<E;z++){const L=Gy(r.enemyTypes,a);if(!L)break;const G=M.find(H=>!A.some(W=>W.position.x===H.x&&W.position.y===H.y));if(!G)break;A.push({enemyType:L,position:G})}const D=[];return s&&D.push(`Prompt: ${s}`),D.push(b?"Layout: donjon (salle + murs).":S?"Layout: foret (arbres disperses).":"Layout: basique (props disperses)."),D.push(`Obstacles: ${u.length}. Ennemis: ${A.length}.`),{summary:D.join(" "),playerStart:w,enemySpawns:A,obstacles:u}}function Xy(r,e){return`${r},${e}`}function qy(r,e){switch(e){case 90:return{x:-r.y,y:r.x};case 180:return{x:-r.x,y:-r.y};case 270:return{x:r.y,y:-r.x};default:return{x:r.x,y:r.y}}}function Ky(r,e){var s;return r?(r.variants||[]).find(o=>o.id===e)??((s=r.variants)==null?void 0:s[0])??null:null}function Qy(r,e){const t=Ky(e,r.variantId),s=Array.isArray(t==null?void 0:t.footprint)&&t.footprint.length?t.footprint:[{x:0,y:0}],o=r.rotation??0;return s.map(a=>{const u=qy(a,o);return{x:r.x+u.x,y:r.y+u.y}})}function Zy(r,e){var c,h,f;const t=new Map;for(const m of r)t.set(m.id,m);const s=new Set,o=new Set,a=new Set,u=new Set;for(const m of e){if(m.hp<=0)continue;const y=t.get(m.typeId),v=Qy(m,y);for(const x of v){const b=Xy(x.x,x.y);u.add(b),(c=y==null?void 0:y.blocking)!=null&&c.movement&&s.add(b),(h=y==null?void 0:y.blocking)!=null&&h.vision&&o.add(b),(f=y==null?void 0:y.blocking)!=null&&f.attacks&&a.add(b)}}return{movement:s,vision:o,attacks:a,occupied:u}}const Jy=["./melee-strike.json","./dash.json","./second-wind.json","./throw-dagger.json","./enemy-move.json","./enemy-melee-strike.json","./enemy-bow-shot.json"],T1={actions:Jy},e3="melee-strike",t3="Frappe basique",n3="Attaque de melee simple contre une cible a 1 case.",r3="attack",i3={actionType:"action",movementCost:0},s3={target:"enemy",range:{min:0,max:1,shape:"single"},maxTargets:1,requiresLos:!0},o3={perTurn:1,perEncounter:null,resource:null},a3=[{type:"phase",mustBe:"player",reason:"Tour joueur requis."},{type:"distance_max",target:"primary",max:1,reason:"Portee de melee uniquement."},{type:"target_alive",target:"primary",reason:"La cible doit avoir des PV restants."}],l3={bonus:5,critRange:20},u3={formula:"1d6+3",critRule:"double-dice",damageType:"slashing"},c3=[{type:"damage",target:"primary",formula:"1d6 + modFOR",damageType:"slashing"},{type:"log",message:"Frappe basique inflige 1d6+FOR a la cible."}],d3={priority:"finish_low_hp_target",successLog:"Attaque de melee effectuee.",failureLog:"Cible hors portee ou deja a terre."},h3=["martial","arme","starter"],f3={id:e3,name:t3,summary:n3,category:r3,actionCost:i3,targeting:s3,usage:o3,conditions:a3,attack:l3,damage:u3,effects:c3,aiHints:d3,tags:h3},p3="dash",m3="Course",g3="Transforme l'action en 3 cases de mouvement en plus.",y3="movement",x3={actionType:"action",movementCost:0},v3={target:"self",range:{min:0,max:0,shape:"self"},maxTargets:1,requiresLos:!1},_3={perTurn:1,perEncounter:null,resource:null},w3=[{type:"phase",mustBe:"player",reason:"Tour joueur requis."}],b3=[{type:"modify_path_limit",target:"self",delta:3,duration:"this_turn"},{type:"log",message:"Course: +3 cases de mouvement pour ce tour."}],S3={priority:"close_gap",successLog:"Course utilisee pour approcher.",failureLog:"Deja a portee, course ignoree."},k3=["mobilite","deplacement"],C3={id:p3,name:m3,summary:g3,category:y3,actionCost:x3,targeting:v3,usage:_3,conditions:w3,effects:b3,aiHints:S3,tags:k3},A3="second-wind",T3="Second souffle",P3="Restaure une partie des PV en bonus action.",M3="support",E3={actionType:"bonus",movementCost:0},R3={target:"self",range:{min:0,max:0,shape:"self"},maxTargets:1,requiresLos:!1},I3={perTurn:null,perEncounter:1,resource:null},L3=[{type:"phase",mustBe:"player",reason:"Tour joueur requis."},{type:"stat_below_percent",who:"self",stat:"hp",percentMax:.75,reason:"Economiser tant que les PV sont hauts."}],$3=[{type:"heal",target:"self",formula:"1d10 + niveau",min:1},{type:"temp_hp",target:"self",amount:2,duration:"end_of_turn"},{type:"log",message:"Second souffle: soigne 1d10 + niveau."}],z3={priority:"survive",successLog:"Second souffle declenche.",failureLog:"PV trop hauts ou tour non joueur."},j3=["soin","defense","survie"],F3={id:A3,name:T3,summary:P3,category:M3,actionCost:E3,targeting:R3,usage:I3,conditions:L3,effects:$3,aiHints:z3,tags:j3},B3="throw-dagger",D3="Lancer de dague",O3="Attaque a distance courte avec une dague a lancer.",N3="attack",W3={actionType:"action",movementCost:0},H3={target:"enemy",range:{min:1,max:4,shape:"single"},maxTargets:1,requiresLos:!0},U3={perTurn:1,perEncounter:null,resource:{name:"dagger",pool:"bandolier",min:1}},G3=[{type:"phase",mustBe:"player",reason:"Tour joueur requis."},{type:"distance_between",target:"primary",min:1,max:4,reason:"Hors de melee mais a portee de lancer."},{type:"resource_at_least",resource:"dagger",pool:"bandolier",value:1,reason:"Besoin d'une dague a lancer."}],V3={bonus:4,critRange:20},Y3={formula:"1d4+2",critRule:"double-dice",damageType:"piercing"},X3=[{type:"damage",target:"primary",formula:"1d4 + modDEX",damageType:"piercing"},{type:"resource_spend",resource:"dagger",pool:"bandolier",amount:1},{type:"log",message:"Dague lancee: 1d4+DEX degats perforants."}],q3={priority:"poke_from_range",successLog:"Dague lancee.",failureLog:"Pas de dague ou cible hors portee."},K3=["distance","arme","jet"],Q3={id:B3,name:D3,summary:O3,category:N3,actionCost:W3,targeting:H3,usage:U3,conditions:G3,attack:V3,damage:Y3,effects:X3,aiHints:q3,tags:K3},Z3="enemy-move",J3="Deplacement (ennemi)",ex="Deplacement tactique vers une case cible (portee base: moveRange).",tx="movement",nx={actionType:"action",movementCost:0},rx={target:"emptyCell",range:{min:1,max:3,shape:"single"},maxTargets:1,requiresLos:!1},ix={perTurn:1,perEncounter:null,resource:null},sx=[],ox=[{type:"move_to",target:"self",maxSteps:"moveRange"},{type:"log",message:"L'ennemi se deplace."}],ax={priority:"positioning",successLog:"Deplacement.",failureLog:"Aucun chemin valide."},lx=["enemy","movement"],ux={id:Z3,name:J3,summary:ex,category:tx,actionCost:nx,targeting:rx,usage:ix,conditions:sx,effects:ox,aiHints:ax,tags:lx},cx="enemy-melee-strike",dx="Frappe (ennemi)",hx="Attaque de melee simple contre le joueur a 1 case.",fx="attack",px={actionType:"action",movementCost:0},mx={target:"player",range:{min:0,max:1,shape:"single"},maxTargets:1,requiresLos:!0},gx={perTurn:1,perEncounter:null,resource:null},yx=[{type:"target_alive",target:"primary",reason:"Le joueur doit etre en vie."}],xx={bonus:4,critRange:20},vx={formula:"attackDamage",critRule:"double-dice",damageType:"slashing"},_x=[{type:"damage",target:"primary",formula:"attackDamage",damageType:"slashing"},{type:"log",message:"L'ennemi frappe au contact."}],wx={priority:"finish_low_hp_target",successLog:"Frappe au contact.",failureLog:"Joueur hors portee ou non visible."},bx=["enemy","melee"],Sx={id:cx,name:dx,summary:hx,category:fx,actionCost:px,targeting:mx,usage:gx,conditions:yx,attack:xx,damage:vx,effects:_x,aiHints:wx,tags:bx},kx="enemy-bow-shot",Cx="Tir a l'arc (ennemi)",Ax="Tir a distance contre le joueur, prefere eviter la melee.",Tx="attack",Px={actionType:"action",movementCost:0},Mx={target:"player",range:{min:2,max:6,shape:"single"},maxTargets:1,requiresLos:!0},Ex={perTurn:1,perEncounter:null,resource:null},Rx=[{type:"target_alive",target:"primary",reason:"Le joueur doit etre en vie."}],Ix={bonus:5,critRange:20},Lx={formula:"attackDamage",critRule:"double-dice",damageType:"piercing"},$x=[{type:"damage",target:"primary",formula:"attackDamage",damageType:"piercing"},{type:"log",message:"Une fleche siffle dans l'air."}],zx={priority:"poke_from_range",successLog:"Tir a l'arc.",failureLog:"Joueur hors portee/ligne de vue ou trop proche."},jx=["enemy","distance","bow"],Fx={id:kx,name:Cx,summary:Ax,category:Tx,actionCost:Px,targeting:Mx,usage:Ex,conditions:Rx,attack:Ix,damage:Lx,effects:$x,aiHints:zx,tags:jx};function Fs(r,e=1){const t=[];for(let o=0;o<e;o++)t.push(1+Math.floor(Math.random()*r));const s=t.reduce((o,a)=>o+a,0);return{rolls:t,total:s}}function Zp(r,e="normal",t=20){if(e==="advantage"){const o=Fs(20),a=Fs(20),u=Math.max(o.total,a.total);return{d20:{rolls:[o.total,a.total],total:u},bonus:r,total:u+r,mode:e,isCrit:u>=t}}if(e==="disadvantage"){const o=Fs(20),a=Fs(20),u=Math.min(o.total,a.total);return{d20:{rolls:[o.total,a.total],total:u},bonus:r,total:u+r,mode:e,isCrit:u>=t}}const s=Fs(20);return{d20:s,bonus:r,total:s.total+r,mode:e,isCrit:s.total>=t}}function Bx(r){const e=[],s=r.replace(/\s+/g,"").split(/(?=[+-])/);for(const o of s){if(!o)continue;const a=o.startsWith("-")?-1:1,u=o.replace(/^[+-]/,""),c=u.match(/^(\d*)d(\d+)$/i);if(c){const f=c[1]?parseInt(c[1],10):1,m=parseInt(c[2],10);e.push({diceCount:a*f,diceSides:m,modifier:0});continue}const h=parseInt(u,10);Number.isNaN(h)||e.push({diceCount:0,diceSides:0,modifier:a*h})}return e}function kd(r,e){const t=!!(e!=null&&e.isCrit),s=(e==null?void 0:e.critRule)??"double-dice",o=Bx(r),a=[];let u=0;for(const f of o)if(f.diceCount!==0&&f.diceSides>0){const m=Math.abs(f.diceCount),y=t&&s==="double-dice"?m*2:m,v=Fs(f.diceSides,y);a.push(f.diceCount<0?{rolls:v.rolls,total:-v.total}:v)}else u+=f.modifier;let h=a.reduce((f,m)=>f+m.total,0)+u;return t&&s==="double-total"&&(h*=2),{dice:a,flatModifier:u,total:h,formula:r,isCrit:t}}function Xl(r,e){return`${r},${e}`}function Dx(r){return r.movementProfile?r.movementProfile:typeof r.moveRange=="number"?{type:"ground",speed:r.moveRange,canPassThroughWalls:!1,canPassThroughEntities:!1,canStopOnOccupiedTile:!1}:null}function Ox(r,e,t,s,o,a,u,c){if(t<0||s<0||t>=Tr||s>=ur||!Er(t,s))return!1;const h=t===u.x&&s===u.y,f=Xl(t,s);return c!=null&&c.has(f)&&!(e!=null&&e.canPassThroughWalls)?!1:!o.some(y=>y.id!==r.id&&y.hp>0&&y.x===t&&y.y===s)||h&&a?!0:e&&e.canPassThroughEntities?!(h&&e.canStopOnOccupiedTile===!1):!1}function ql(r,e,t,s){const o=Dx(r),a=o&&o.speed>0?Math.min(s.maxDistance,o.speed):s.maxDistance,u={x:r.x,y:r.y};if(u.x===e.x&&u.y===e.y)return[];const c=new Set,h=new Map,f=new Map,m=[],y=Xl(u.x,u.y);c.add(y),h.set(y,null),f.set(y,0),m.push(u);let v=null;const x=[{x:1,y:0},{x:-1,y:0},{x:0,y:1},{x:0,y:-1}];for(;m.length>0;){const P=m.shift(),M=Xl(P.x,P.y),D=f.get(M)??0;if(!(D>=a))for(const z of x){const L=P.x+z.x,G=P.y+z.y,H=Xl(L,G);if(c.has(H)||!Ox(r,o,L,G,t,s.allowTargetOccupied??!1,e,s.blockedCells??null))continue;c.add(H),h.set(H,M),f.set(H,D+1);const W={x:L,y:G};if(m.push(W),L===e.x&&G===e.y){v=H,m.length=0;break}}}let b=v;if(!b){let P=null,M=Number.POSITIVE_INFINITY;for(const D of c){const[z,L]=D.split(",").map(Number),G=Math.abs(z-e.x)+Math.abs(L-e.y),H=f.get(D)??0;H!==0&&(H>a||G<M&&(M=G,P=D))}if(!P)return[];b=P}const S=[];let w=b;for(;w;){const[P,M]=w.split(",").map(Number);if(S.push({x:P,y:M}),w===y)break;w=h.get(w)??null}const A=S.reverse(),E=a+1;return A.length>E?A.slice(0,E):A}function Nx(r,e){var s,o,a,u,c,h,f,m,y,v;const t=e.actor;if(r.toLowerCase()==="attackdamage")return typeof t.attackDamage=="number"?t.attackDamage:0;if(r.toLowerCase()==="moverange")return typeof t.moveRange=="number"?t.moveRange:0;if(r.toLowerCase()==="attackrange")return typeof t.attackRange=="number"?t.attackRange:1;if(r.toLowerCase()==="niveau"){const x=Number(((s=e.sampleCharacter)==null?void 0:s.niveauGlobal)??1);return Number.isFinite(x)?x:1}if(r.toLowerCase()==="modfor"){const x=Number(((u=(a=(o=e.sampleCharacter)==null?void 0:o.caracs)==null?void 0:a.force)==null?void 0:u.modFOR)??0);return Number.isFinite(x)?x:0}if(r.toLowerCase()==="moddex"){const x=Number(((f=(h=(c=e.sampleCharacter)==null?void 0:c.caracs)==null?void 0:h.dexterite)==null?void 0:f.modDEX)??0);return Number.isFinite(x)?x:0}if(r.toLowerCase()==="modcon"){const x=Number(((v=(y=(m=e.sampleCharacter)==null?void 0:m.caracs)==null?void 0:y.constitution)==null?void 0:v.modCON)??0);return Number.isFinite(x)?x:0}return null}function P1(r,e){const t=String(r??"");return t.trim()?t.replace(/[A-Za-z_][A-Za-z0-9_]*/g,s=>{const o=Nx(s,e);return o===null?s:String(o)}):"0"}function Wx(r,e,t){var s,o;return t.kind==="token"?t.token:((s=r.targeting)==null?void 0:s.target)==="player"?e.player:(((o=r.targeting)==null?void 0:o.target)==="enemy",null)}function Hx(r,e,t){const s=e.actor,o=[e.player,...e.enemies],a=r.targeting;if(!a)return{ok:!1,reason:"Action sans ciblage."};if(a.target==="self")return{ok:!0};if(a.target==="enemy"){if(t.kind!=="token"||t.token.type!=="enemy")return{ok:!1,reason:"Cible ennemi manquante."};const u=t.token;if(u.hp<=0)return{ok:!1,reason:"La cible est deja a terre."};const c=ai(s,u),h=a.range;if(h){if(typeof h.min=="number"&&c<h.min)return{ok:!1,reason:`Cible trop proche pour ${r.name} (distance ${c}, min ${h.min}).`};if(typeof h.max=="number"&&c>h.max)return{ok:!1,reason:`Cible hors portee pour ${r.name} (distance ${c}, max ${h.max}).`}}for(const f of r.conditions||[]){if(f.type==="target_alive"&&u.hp<=0)return{ok:!1,reason:f.reason||"La cible doit avoir des PV restants."};if(f.type==="distance_max"&&typeof f.max=="number"&&c>f.max)return{ok:!1,reason:f.reason||`Distance cible > ${f.max}.`};if(f.type==="distance_between"){const m=typeof f.min=="number"?f.min:(h==null?void 0:h.min)??null,y=typeof f.max=="number"?f.max:(h==null?void 0:h.max)??null;if(m!==null&&c<m)return{ok:!1,reason:f.reason||`Distance cible < ${m}.`};if(y!==null&&c>y)return{ok:!1,reason:f.reason||`Distance cible > ${y}.`}}}if(a.requiresLos){if(!eu(s,u,o,e.blockedVisionCells??null))return{ok:!1,reason:"Cible hors vision (ligne de vue requise)."};if(!ia({x:s.x,y:s.y},{x:u.x,y:u.y},e.blockedAttackCells??null))return{ok:!1,reason:"Trajectoire bloquee (obstacle entre l'attaquant et la cible)."}}return{ok:!0}}if(a.target==="player"){const u=e.player;if(u.hp<=0)return{ok:!1,reason:"Le joueur est deja a terre."};const c=ai(s,u),h=a.range;if(h){if(typeof h.min=="number"&&c<h.min)return{ok:!1,reason:`Cible trop proche pour ${r.name} (distance ${c}, min ${h.min}).`};if(typeof h.max=="number"&&c>h.max)return{ok:!1,reason:`Cible hors portee pour ${r.name} (distance ${c}, max ${h.max}).`}}for(const f of r.conditions||[]){if(f.type==="target_alive"&&u.hp<=0)return{ok:!1,reason:f.reason||"La cible doit avoir des PV restants."};if(f.type==="distance_max"&&typeof f.max=="number"&&c>f.max)return{ok:!1,reason:f.reason||`Distance cible > ${f.max}.`};if(f.type==="distance_between"){const m=typeof f.min=="number"?f.min:(h==null?void 0:h.min)??null,y=typeof f.max=="number"?f.max:(h==null?void 0:h.max)??null;if(m!==null&&c<m)return{ok:!1,reason:f.reason||`Distance cible < ${m}.`};if(y!==null&&c>y)return{ok:!1,reason:f.reason||`Distance cible > ${y}.`}}}if(a.requiresLos){if(!eu(s,u,o,e.blockedVisionCells??null))return{ok:!1,reason:"Cible hors vision (ligne de vue requise)."};if(!ia({x:s.x,y:s.y},{x:u.x,y:u.y},e.blockedAttackCells??null))return{ok:!1,reason:"Trajectoire bloquee (obstacle entre l'attaquant et la cible)."}}return{ok:!0}}return a.target==="emptyCell"||a.target==="cell"?t.kind!=="cell"?{ok:!1,reason:"Cible de case manquante."}:Er(t.x,t.y)?{ok:!0}:{ok:!1,reason:"Case hors plateau."}:{ok:!1,reason:"Type de ciblage non supporte."}}function Ux(r,e){var a;const t=[],s=[];for(const u of r.conditions||[])u.type==="phase"&&u.mustBe&&u.mustBe!==e.phase&&t.push(u.reason||"Phase incorrecte.");const o=(a=r.usage)==null?void 0:a.resource;if(e.getResourceAmount&&(o!=null&&o.name)&&typeof o.min=="number"){const u=e.getResourceAmount(o.name,o.pool??null);if(u<o.min){const c=o.pool?` (${o.pool})`:"";t.push(`Ressource insuffisante: ${o.name}${c} (${u}/${o.min}).`)}}return{enabled:t.length===0,reasons:t,details:s}}function Gx(r,e,t,s){var x,b;const o=[],a=S=>{var w;o.push(S),(w=e.onLog)==null||w.call(e,S)},u=Ux(r,e);if(!u.enabled)return{ok:!1,reason:u.reasons.join(" | "),logs:o};const c=Hx(r,e,t);if(!c.ok)return{ok:!1,reason:c.reason,logs:o};const h={...e.actor};let f={...e.player};const m=e.enemies.map(S=>({...S})),y=S=>{var w;(w=e.emitEvent)==null||w.call(e,S)},v=()=>{if(h.type!=="enemy")return;const S=m.findIndex(w=>w.id===h.id);S>=0&&(m[S]=h)};for(const S of r.effects||[]){if(S.type==="log"&&typeof S.message=="string"){a(S.message);continue}if(S.type==="resource_spend"&&S.resource&&e.spendResource){const w=typeof S.pool=="string"?S.pool:null,A=typeof S.amount=="number"?S.amount:1;e.spendResource(String(S.resource),w,A);continue}if(S.type==="damage"&&S.target==="primary"){const w=Wx(r,e,t);if(!w)continue;const A=(s==null?void 0:s.advantageMode)??"normal",E=((x=r.damage)==null?void 0:x.critRule)??"double-dice",P=P1(S.formula??((b=r.damage)==null?void 0:b.formula)??"0",e);let M=!0,D=!1,z=null,L=null;const G=typeof w.armorClass=="number"?w.armorClass:null;if(L=G,r.attack){const K=Zp(r.attack.bonus,A,r.attack.critRange??20);D=K.isCrit,z=K.total,G!==null&&(M=K.total>=G||K.isCrit);const xe=K.mode==="normal"?`${K.d20.total}`:`${K.d20.rolls.join(" / ")} -> ${K.d20.total}`;a(`Jet de touche (${r.name}) : ${xe} + ${K.bonus} = ${K.total}`+(G!==null?` vs CA ${G}`:"")+(K.isCrit?" (critique!)":""))}if(!M){a(`L'attaque (${r.name}) rate sa cible. Pas de degats.`);const K=h.type==="enemy"?"enemy_attack":"player_attack";y({kind:K,actorId:h.id,actorKind:h.type,targetId:w.id,targetKind:w.type,summary:`${h.id} rate ${w.id} avec ${r.name}.`,data:{actionId:r.id,actionName:r.name,isHit:!1,isCrit:!1,damage:0,attackRollTotal:z,targetArmorClass:L}});continue}const H=kd(P,{isCrit:D,critRule:E}),W=w.hp,Y=Math.max(0,W-H.total);if(w.type==="player")f={...f,hp:Y},a(`${r.name} inflige ${H.total} degats au joueur (PV ${W} -> ${Y}).`);else{const K=m.findIndex(xe=>xe.id===w.id);K>=0&&(m[K]={...m[K],hp:Y},a(`${r.name} inflige ${H.total} degats a ${w.id} (PV ${W} -> ${Y}).`))}const ge=h.type==="enemy"?"enemy_attack":"player_attack";y({kind:ge,actorId:h.id,actorKind:h.type,targetId:w.id,targetKind:w.type,summary:H.total>0?`${h.id} touche ${w.id} avec ${r.name} et inflige ${H.total} degats (PV ${W} -> ${Y}).`:`${h.id} touche ${w.id} avec ${r.name} (pas de degats).`,data:{actionId:r.id,actionName:r.name,isHit:!0,isCrit:D,damage:H.total,damageFormula:H.formula,attackRollTotal:z,targetArmorClass:L,targetHpBefore:W,targetHpAfter:Y}}),y({kind:"damage",actorId:h.id,actorKind:h.type,targetId:w.id,targetKind:w.type,summary:`${w.id} subit ${H.total} degats (${r.name}).`,data:{sourceActionId:r.id,sourceActionName:r.name,damage:H.total,isCrit:D,targetHpBefore:W,targetHpAfter:Y}});continue}if(S.type==="move_to"&&S.target==="self"){if(t.kind!=="cell")return{ok:!1,reason:"Move: cible de case manquante.",logs:o};const w=S.maxSteps;let A=null;if(typeof w=="number")A=w;else if(typeof w=="string"){const G=P1(w,e),H=Number.parseInt(G,10);A=Number.isFinite(H)?H:null}A===null&&(A=typeof h.moveRange=="number"?h.moveRange:3);const E=tu(t.x,0,Tr-1),P=tu(t.y,0,ur-1);if(!Er(E,P))return{ok:!1,reason:"Move: case hors plateau.",logs:o};const M=[f,...m],D=ql(h,{x:E,y:P},M,{maxDistance:Math.max(0,A),allowTargetOccupied:!1,blockedCells:e.blockedMovementCells??null});if(h.plannedPath=D,D.length===0)return{ok:!1,reason:"Move: aucun chemin valide.",logs:o};const z={x:h.x,y:h.y},L=D[D.length-1];h.x=L.x,h.y=L.y,v(),a(`${h.id} se deplace vers (${L.x}, ${L.y}).`),y({kind:"move",actorId:h.id,actorKind:h.type,summary:`${h.id} se deplace de (${z.x}, ${z.y}) vers (${L.x}, ${L.y}).`,data:{actionId:r.id,actionName:r.name,from:z,to:L,path:D}});continue}}return v(),{ok:!0,logs:o,actorAfter:h,playerAfter:f,enemiesAfter:m}}function Ml(r,e){return e.find(t=>t.hp>0&&t.x===r.x&&t.y===r.y)??null}const qe={active:!1,round:null,stateStart:null,events:[],enemySpeeches:[],lastSpeechByEnemyThisRound:new Map};let Vx=0;const Jp=new Map;function Yx(r,e){qe.active=!0,qe.round=r,qe.stateStart=e,qe.events=[],qe.enemySpeeches=[],qe.lastSpeechByEnemyThisRound=new Map}function _n(r){if(!qe.active||qe.round!==null&&r.round!==qe.round)return;const e={id:`evt-${Date.now()}-${Vx++}`,round:r.round,phase:r.phase,kind:r.kind,actorId:r.actorId,actorKind:r.actorKind,targetId:r.targetId??null,targetKind:r.targetKind??null,summary:r.summary,data:r.data??{},timestamp:Date.now()};qe.events.push(e)}function Xx(r,e){if(!qe.active)return;const t=(e??"").trim();t&&(qe.enemySpeeches.push({enemyId:r,line:t}),qe.lastSpeechByEnemyThisRound.set(r,t),Jp.set(r,t),qe.round!==null&&_n({round:qe.round,phase:"enemies",kind:"speech",actorId:r,actorKind:"enemy",summary:`${r} dit: "${t}"`,data:{line:t}}))}function qx(){return qe.enemySpeeches.slice()}function Kx(r){return Jp.get(r)??null}function Qx(r){return!Number.isFinite(r)||r<=0?qe.events.slice():qe.events.slice(-Math.floor(r))}function Zx(r){return!qe.active||!qe.stateStart||qe.round===null?null:{language:"fr",focusSide:"player",focusActorId:r.focusActorId,stateStart:qe.stateStart,stateEnd:r.stateEnd,events:qe.events.slice(),enemySpeeches:qe.enemySpeeches.slice()}}function Jx(){qe.active=!1,qe.round=null,qe.stateStart=null,qe.events=[],qe.enemySpeeches=[],qe.lastSpeechByEnemyThisRound=new Map}async function e5(r){const e=await fetch("/api/narration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)return{summary:"",error:"IA non fonctionnel."};const t=await e.json();return!t||typeof t.summary!="string"?{summary:"",error:"IA non fonctionnel."}:t.error&&typeof t.error=="string"?{summary:"",error:t.error}:{summary:t.summary}}async function t5(r){const e=await fetch("/api/enemy-speech",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok)return{line:""};const t=await e.json();return!t||typeof t.line!="string"?{line:""}:{line:t.line}}const n5="modulepreload",r5=function(r){return"/"+r},M1={},nu=function(e,t,s){let o=Promise.resolve();if(t&&t.length>0){let u=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),h=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));o=u(t.map(f=>{if(f=r5(f),f in M1)return;M1[f]=!0;const m=f.endsWith(".css"),y=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${y}`))return;const v=document.createElement("link");if(v.rel=m?"stylesheet":n5,m||(v.as="script"),v.crossOrigin="",v.href=f,h&&v.setAttribute("nonce",h),document.head.appendChild(v),m)return new Promise((x,b)=>{v.addEventListener("load",x),v.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return o.then(u=>{for(const c of u||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};var ve=(r=>(r.Application="application",r.WebGLPipes="webgl-pipes",r.WebGLPipesAdaptor="webgl-pipes-adaptor",r.WebGLSystem="webgl-system",r.WebGPUPipes="webgpu-pipes",r.WebGPUPipesAdaptor="webgpu-pipes-adaptor",r.WebGPUSystem="webgpu-system",r.CanvasSystem="canvas-system",r.CanvasPipesAdaptor="canvas-pipes-adaptor",r.CanvasPipes="canvas-pipes",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r.MaskEffect="mask-effect",r.BlendMode="blend-mode",r.TextureSource="texture-source",r.Environment="environment",r.ShapeBuilder="shape-builder",r.Batcher="batcher",r))(ve||{});const Cd=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},El=(r,e)=>Cd(r).priority??e,Bt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(Cd).forEach(e=>{e.type.forEach(t=>{var s,o;return(o=(s=this._removeHandlers)[t])==null?void 0:o.call(s,e)})}),this},add(...r){return r.map(Cd).forEach(e=>{e.type.forEach(t=>{var a,u;const s=this._addHandlers,o=this._queue;s[t]?(u=s[t])==null||u.call(s,e):(o[t]=o[t]||[],(a=o[t])==null||a.push(e))})}),this},handle(r,e,t){var u;const s=this._addHandlers,o=this._removeHandlers;if(s[r]||o[r])throw new Error(`Extension type ${r} already has a handler`);s[r]=e,o[r]=t;const a=this._queue;return a[r]&&((u=a[r])==null||u.forEach(c=>e(c)),delete a[r]),this},handleByMap(r,e){return this.handle(r,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByNamedList(r,e,t=-1){return this.handle(r,s=>{e.findIndex(a=>a.name===s.name)>=0||(e.push({name:s.name,value:s.ref}),e.sort((a,u)=>El(u.value,t)-El(a.value,t)))},s=>{const o=e.findIndex(a=>a.name===s.name);o!==-1&&e.splice(o,1)})},handleByList(r,e,t=-1){return this.handle(r,s=>{e.includes(s.ref)||(e.push(s.ref),e.sort((o,a)=>El(a,t)-El(o,t)))},s=>{const o=e.indexOf(s.ref);o!==-1&&e.splice(o,1)})},mixin(r,...e){for(const t of e)Object.defineProperties(r.prototype,Object.getOwnPropertyDescriptors(t))}},i5={extension:{type:ve.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await nu(()=>import("./browserAll-qb7aV80Q.js"),__vite__mapDeps([0,1,2]))}},s5={extension:{type:ve.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await nu(()=>import("./webworkerAll-qfLSi89H.js"),__vite__mapDeps([1,2]))}};class Ft{constructor(e,t,s){this._x=t||0,this._y=s||0,this._observer=e}clone(e){return new Ft(e??this._observer,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this._observer._onUpdate(this)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}var Qc={exports:{}},E1;function o5(){return E1||(E1=1,(function(r){var e=Object.prototype.hasOwnProperty,t="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(t=!1));function o(h,f,m){this.fn=h,this.context=f,this.once=m||!1}function a(h,f,m,y,v){if(typeof m!="function")throw new TypeError("The listener must be a function");var x=new o(m,y||h,v),b=t?t+f:f;return h._events[b]?h._events[b].fn?h._events[b]=[h._events[b],x]:h._events[b].push(x):(h._events[b]=x,h._eventsCount++),h}function u(h,f){--h._eventsCount===0?h._events=new s:delete h._events[f]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var f=[],m,y;if(this._eventsCount===0)return f;for(y in m=this._events)e.call(m,y)&&f.push(t?y.slice(1):y);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(m)):f},c.prototype.listeners=function(f){var m=t?t+f:f,y=this._events[m];if(!y)return[];if(y.fn)return[y.fn];for(var v=0,x=y.length,b=new Array(x);v<x;v++)b[v]=y[v].fn;return b},c.prototype.listenerCount=function(f){var m=t?t+f:f,y=this._events[m];return y?y.fn?1:y.length:0},c.prototype.emit=function(f,m,y,v,x,b){var S=t?t+f:f;if(!this._events[S])return!1;var w=this._events[S],A=arguments.length,E,P;if(w.fn){switch(w.once&&this.removeListener(f,w.fn,void 0,!0),A){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,m),!0;case 3:return w.fn.call(w.context,m,y),!0;case 4:return w.fn.call(w.context,m,y,v),!0;case 5:return w.fn.call(w.context,m,y,v,x),!0;case 6:return w.fn.call(w.context,m,y,v,x,b),!0}for(P=1,E=new Array(A-1);P<A;P++)E[P-1]=arguments[P];w.fn.apply(w.context,E)}else{var M=w.length,D;for(P=0;P<M;P++)switch(w[P].once&&this.removeListener(f,w[P].fn,void 0,!0),A){case 1:w[P].fn.call(w[P].context);break;case 2:w[P].fn.call(w[P].context,m);break;case 3:w[P].fn.call(w[P].context,m,y);break;case 4:w[P].fn.call(w[P].context,m,y,v);break;default:if(!E)for(D=1,E=new Array(A-1);D<A;D++)E[D-1]=arguments[D];w[P].fn.apply(w[P].context,E)}}return!0},c.prototype.on=function(f,m,y){return a(this,f,m,y,!1)},c.prototype.once=function(f,m,y){return a(this,f,m,y,!0)},c.prototype.removeListener=function(f,m,y,v){var x=t?t+f:f;if(!this._events[x])return this;if(!m)return u(this,x),this;var b=this._events[x];if(b.fn)b.fn===m&&(!v||b.once)&&(!y||b.context===y)&&u(this,x);else{for(var S=0,w=[],A=b.length;S<A;S++)(b[S].fn!==m||v&&!b[S].once||y&&b[S].context!==y)&&w.push(b[S]);w.length?this._events[x]=w.length===1?w[0]:w:u(this,x)}return this},c.prototype.removeAllListeners=function(f){var m;return f?(m=t?t+f:f,this._events[m]&&u(this,m)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,r.exports=c})(Qc)),Qc.exports}var a5=o5();const qn=Gd(a5),l5=Math.PI*2,u5=180/Math.PI,c5=Math.PI/180;class Xt{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new Xt(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Zc.x=0,Zc.y=0,Zc}}const Zc=new Xt;class je{constructor(e=1,t=0,s=0,o=1,a=0,u=0){this.array=null,this.a=e,this.b=t,this.c=s,this.d=o,this.tx=a,this.ty=u}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,s,o,a,u){return this.a=e,this.b=t,this.c=s,this.d=o,this.tx=a,this.ty=u,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const s=t||this.array;return e?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(e,t){t=t||new Xt;const s=e.x,o=e.y;return t.x=this.a*s+this.c*o+this.tx,t.y=this.b*s+this.d*o+this.ty,t}applyInverse(e,t){t=t||new Xt;const s=this.a,o=this.b,a=this.c,u=this.d,c=this.tx,h=this.ty,f=1/(s*u+a*-o),m=e.x,y=e.y;return t.x=u*f*m+-a*f*y+(h*a-c*u)*f,t.y=s*f*y+-o*f*m+(-h*s+c*o)*f,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),s=Math.sin(e),o=this.a,a=this.c,u=this.tx;return this.a=o*t-this.b*s,this.b=o*s+this.b*t,this.c=a*t-this.d*s,this.d=a*s+this.d*t,this.tx=u*t-this.ty*s,this.ty=u*s+this.ty*t,this}append(e){const t=this.a,s=this.b,o=this.c,a=this.d;return this.a=e.a*t+e.b*o,this.b=e.a*s+e.b*a,this.c=e.c*t+e.d*o,this.d=e.c*s+e.d*a,this.tx=e.tx*t+e.ty*o+this.tx,this.ty=e.tx*s+e.ty*a+this.ty,this}appendFrom(e,t){const s=e.a,o=e.b,a=e.c,u=e.d,c=e.tx,h=e.ty,f=t.a,m=t.b,y=t.c,v=t.d;return this.a=s*f+o*y,this.b=s*m+o*v,this.c=a*f+u*y,this.d=a*m+u*v,this.tx=c*f+h*y+t.tx,this.ty=c*m+h*v+t.ty,this}setTransform(e,t,s,o,a,u,c,h,f){return this.a=Math.cos(c+f)*a,this.b=Math.sin(c+f)*a,this.c=-Math.sin(c-h)*u,this.d=Math.cos(c-h)*u,this.tx=e-(s*this.a+o*this.c),this.ty=t-(s*this.b+o*this.d),this}prepend(e){const t=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,o=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=o*e.a+this.d*e.c,this.d=o*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,s=this.b,o=this.c,a=this.d,u=e.pivot,c=-Math.atan2(-o,a),h=Math.atan2(s,t),f=Math.abs(c+h);return f<1e-5||Math.abs(l5-f)<1e-5?(e.rotation=h,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=c,e.skew.y=h),e.scale.x=Math.sqrt(t*t+s*s),e.scale.y=Math.sqrt(o*o+a*a),e.position.x=this.tx+(u.x*t+u.y*o),e.position.y=this.ty+(u.x*s+u.y*a),e}invert(){const e=this.a,t=this.b,s=this.c,o=this.d,a=this.tx,u=e*o-t*s;return this.a=o/u,this.b=-t/u,this.c=-s/u,this.d=e/u,this.tx=(s*this.ty-o*a)/u,this.ty=-(e*this.ty-t*a)/u,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new je;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return h5.identity()}static get shared(){return d5.identity()}}const d5=new je,h5=new je,Hi=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ui=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Gi=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Vi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ad=[],e0=[],Rl=Math.sign;function f5(){for(let r=0;r<16;r++){const e=[];Ad.push(e);for(let t=0;t<16;t++){const s=Rl(Hi[r]*Hi[t]+Gi[r]*Ui[t]),o=Rl(Ui[r]*Hi[t]+Vi[r]*Ui[t]),a=Rl(Hi[r]*Gi[t]+Gi[r]*Vi[t]),u=Rl(Ui[r]*Gi[t]+Vi[r]*Vi[t]);for(let c=0;c<16;c++)if(Hi[c]===s&&Ui[c]===o&&Gi[c]===a&&Vi[c]===u){e.push(c);break}}}for(let r=0;r<16;r++){const e=new je;e.set(Hi[r],Ui[r],Gi[r],Vi[r],0,0),e0.push(e)}}f5();const Ze={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>Hi[r],uY:r=>Ui[r],vX:r=>Gi[r],vY:r=>Vi[r],inv:r=>r&8?r&15:-r&7,add:(r,e)=>Ad[r][e],sub:(r,e)=>Ad[r][Ze.inv(e)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,e)=>Math.abs(r)*2<=Math.abs(e)?e>=0?Ze.S:Ze.N:Math.abs(e)*2<=Math.abs(r)?r>0?Ze.E:Ze.W:e>0?r>0?Ze.SE:Ze.SW:r>0?Ze.NE:Ze.NW,matrixAppendRotationInv:(r,e,t=0,s=0)=>{const o=e0[Ze.inv(e)];o.tx=t,o.ty=s,r.append(o)},transformRectCoords:(r,e,t,s)=>{const{x:o,y:a,width:u,height:c}=r,{x:h,y:f,width:m,height:y}=e;return t===Ze.E?(s.set(o+h,a+f,u,c),s):t===Ze.S?s.set(m-a-c+h,o+f,c,u):t===Ze.W?s.set(m-o-u+h,y-a-c+f,u,c):t===Ze.N?s.set(a+h,y-o-u+f,c,u):s.set(o+h,a+f,u,c)}},Il=[new Xt,new Xt,new Xt,new Xt];class ht{constructor(e=0,t=0,s=0,o=0){this.type="rectangle",this.x=Number(e),this.y=Number(t),this.width=Number(s),this.height=Number(o)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new ht(0,0,0,0)}clone(){return new ht(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){return this.width<=0||this.height<=0?!1:e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}strokeContains(e,t,s,o=.5){const{width:a,height:u}=this;if(a<=0||u<=0)return!1;const c=this.x,h=this.y,f=s*(1-o),m=s-f,y=c-f,v=c+a+f,x=h-f,b=h+u+f,S=c+m,w=c+a-m,A=h+m,E=h+u-m;return e>=y&&e<=v&&t>=x&&t<=b&&!(e>S&&e<w&&t>A&&t<E)}intersects(e,t){if(!t){const G=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=G)return!1;const W=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>W}const s=this.left,o=this.right,a=this.top,u=this.bottom;if(o<=s||u<=a)return!1;const c=Il[0].set(e.left,e.top),h=Il[1].set(e.left,e.bottom),f=Il[2].set(e.right,e.top),m=Il[3].set(e.right,e.bottom);if(f.x<=c.x||h.y<=c.y)return!1;const y=Math.sign(t.a*t.d-t.b*t.c);if(y===0||(t.apply(c,c),t.apply(h,h),t.apply(f,f),t.apply(m,m),Math.max(c.x,h.x,f.x,m.x)<=s||Math.min(c.x,h.x,f.x,m.x)>=o||Math.max(c.y,h.y,f.y,m.y)<=a||Math.min(c.y,h.y,f.y,m.y)>=u))return!1;const v=y*(h.y-c.y),x=y*(c.x-h.x),b=v*s+x*a,S=v*o+x*a,w=v*s+x*u,A=v*o+x*u;if(Math.max(b,S,w,A)<=v*c.x+x*c.y||Math.min(b,S,w,A)>=v*m.x+x*m.y)return!1;const E=y*(c.y-f.y),P=y*(f.x-c.x),M=E*s+P*a,D=E*o+P*a,z=E*s+P*u,L=E*o+P*u;return!(Math.max(M,D,z,L)<=E*c.x+P*c.y||Math.min(M,D,z,L)>=E*m.x+P*m.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=e*2,this.height+=t*2,this}fit(e){const t=Math.max(this.x,e.x),s=Math.min(this.x+this.width,e.x+e.width),o=Math.max(this.y,e.y),a=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(s-t,0),this.y=o,this.height=Math.max(a-o,0),this}ceil(e=1,t=.001){const s=Math.ceil((this.x+this.width-t)*e)/e,o=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=s-this.x,this.height=o-this.y,this}scale(e,t=e){return this.x*=e,this.y*=t,this.width*=e,this.height*=t,this}enlarge(e){const t=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),o=Math.min(this.y,e.y),a=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=s-t,this.y=o,this.height=a-o,this}getBounds(e){return e||(e=new ht),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const t=e.x,s=e.y,o=e.x+e.width,a=e.y+e.height;return t>=this.x&&t<this.x+this.width&&s>=this.y&&s<this.y+this.height&&o>=this.x&&o<this.x+this.width&&a>=this.y&&a<this.y+this.height}set(e,t,s,o){return this.x=e,this.y=t,this.width=s,this.height=o,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Jc={default:-1};function xt(r="default"){return Jc[r]===void 0&&(Jc[r]=-1),++Jc[r]}const R1=new Set,Ke="8.0.0",p5="8.3.4",Ds={quiet:!1,noColor:!1},$e=(r,e,t=3)=>{if(Ds.quiet||R1.has(e))return;let s=new Error().stack;const o=`${e}
Deprecated since v${r}`,a=typeof console.groupCollapsed=="function"&&!Ds.noColor;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",o):(s=s.split(`
`).splice(t).join(`
`),a?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",o),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",o),console.warn(s))),R1.add(e)};Object.defineProperties($e,{quiet:{get:()=>Ds.quiet,set:r=>{Ds.quiet=r},enumerable:!0,configurable:!1},noColor:{get:()=>Ds.noColor,set:r=>{Ds.noColor=r},enumerable:!0,configurable:!1}});const t0=()=>{};function Hs(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function I1(r){return!(r&r-1)&&!!r}function n0(r){const e={};for(const t in r)r[t]!==void 0&&(e[t]=r[t]);return e}const L1=Object.create(null);function m5(r){const e=L1[r];return e===void 0&&(L1[r]=xt("resource")),e}const r0=class i0 extends qn{constructor(e={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,e={...i0.defaultOptions,...e},this.addressMode=e.addressMode,this.addressModeU=e.addressModeU??this.addressModeU,this.addressModeV=e.addressModeV??this.addressModeV,this.addressModeW=e.addressModeW??this.addressModeW,this.scaleMode=e.scaleMode,this.magFilter=e.magFilter??this.magFilter,this.minFilter=e.minFilter??this.minFilter,this.mipmapFilter=e.mipmapFilter??this.mipmapFilter,this.lodMinClamp=e.lodMinClamp,this.lodMaxClamp=e.lodMaxClamp,this.compare=e.compare,this.maxAnisotropy=e.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){$e(Ke,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=m5(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};r0.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Us=r0;const s0=class o0 extends qn{constructor(e={}){super(),this.options=e,this.uid=xt("textureSource"),this._resourceType="textureSource",this._resourceId=xt("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,e={...o0.defaultOptions,...e},this.label=e.label??"",this.resource=e.resource,this.autoGarbageCollect=e.autoGarbageCollect,this._resolution=e.resolution,e.width?this.pixelWidth=e.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,e.height?this.pixelHeight=e.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=e.format,this.dimension=e.dimensions,this.mipLevelCount=e.mipLevelCount,this.autoGenerateMipmaps=e.autoGenerateMipmaps,this.sampleCount=e.sampleCount,this.antialias=e.antialias,this.alphaMode=e.alphaMode,this.style=new Us(n0(e)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){var t,s;this.style!==e&&((t=this._style)==null||t.off("change",this._onStyleChange,this),this._style=e,(s=this._style)==null||s.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(e){this._style.maxAnisotropy=e}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=xt("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,t,s){s||(s=this._resolution),e||(e=this.width),t||(t=this.height);const o=Math.round(e*s),a=Math.round(t*s);return this.width=o/s,this.height=a/s,this._resolution=s,this.pixelWidth===o&&this.pixelHeight===a?!1:(this._refreshPOT(),this.pixelWidth=o,this.pixelHeight=a,this.emit("resize",this),this._resourceId=xt("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=I1(this.pixelWidth)&&I1(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};s0.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Kn=s0;class qd extends Kn{constructor(e){const t=e.resource||new Float32Array(e.width*e.height*4);let s=e.format;s||(t instanceof Float32Array?s="rgba32float":t instanceof Int32Array||t instanceof Uint32Array?s="rgba32uint":t instanceof Int16Array||t instanceof Uint16Array?s="rgba16uint":(t instanceof Int8Array,s="bgra8unorm")),super({...e,resource:t,format:s}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}qd.extension=ve.TextureSource;const $1=new je;class g5{constructor(e,t){this.mapCoord=new je,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof t>"u"?this.clampMargin=e.width<10?0:.5:this.clampMargin=t,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){var t;this.texture!==e&&((t=this._texture)==null||t.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,t){t===void 0&&(t=e);const s=this.mapCoord;for(let o=0;o<e.length;o+=2){const a=e[o],u=e[o+1];t[o]=a*s.a+u*s.c+s.tx,t[o+1]=a*s.b+u*s.d+s.ty}return t}update(){const e=this._texture;this._updateID++;const t=e.uvs;this.mapCoord.set(t.x1-t.x0,t.y1-t.y0,t.x3-t.x0,t.y3-t.y0,t.x0,t.y0);const s=e.orig,o=e.trim;o&&($1.set(s.width/o.width,0,0,s.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append($1));const a=e.source,u=this.uClampFrame,c=this.clampMargin/a._resolution,h=this.clampOffset/a._resolution;return u[0]=(e.frame.x+c+h)/a.width,u[1]=(e.frame.y+c+h)/a.height,u[2]=(e.frame.x+e.frame.width-c+h)/a.width,u[3]=(e.frame.y+e.frame.height-c+h)/a.height,this.uClampOffset[0]=this.clampOffset/a.pixelWidth,this.uClampOffset[1]=this.clampOffset/a.pixelHeight,this.isSimple=e.frame.width===a.width&&e.frame.height===a.height&&e.rotate===0,!0}}class Ne extends qn{constructor({source:e,label:t,frame:s,orig:o,trim:a,defaultAnchor:u,defaultBorders:c,rotate:h,dynamic:f}={}){if(super(),this.uid=xt("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new ht,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=t,this.source=(e==null?void 0:e.source)??new Kn,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:m,height:y}=this._source;this.frame.width=m,this.frame.height=y}this.orig=o||this.frame,this.trim=a,this.rotate=h??0,this.defaultAnchor=u,this.defaultBorders=c,this.destroyed=!1,this.dynamic=f||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new g5(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:t}=this,{width:s,height:o}=this._source,a=t.x/s,u=t.y/o,c=t.width/s,h=t.height/o;let f=this.rotate;if(f){const m=c/2,y=h/2,v=a+m,x=u+y;f=Ze.add(f,Ze.NW),e.x0=v+m*Ze.uX(f),e.y0=x+y*Ze.uY(f),f=Ze.add(f,2),e.x1=v+m*Ze.uX(f),e.y1=x+y*Ze.uY(f),f=Ze.add(f,2),e.x2=v+m*Ze.uX(f),e.y2=x+y*Ze.uY(f),f=Ze.add(f,2),e.x3=v+m*Ze.uX(f),e.y3=x+y*Ze.uY(f)}else e.x0=a,e.y0=u,e.x1=a+c,e.y1=u,e.x2=a+c,e.y2=u+h,e.x3=a,e.y3=u+h}destroy(e=!1){this._source&&(this._source.off("resize",this.update,this),e&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return $e(Ke,"Texture.baseTexture is now Texture.source"),this._source}}Ne.EMPTY=new Ne({label:"EMPTY",source:new Kn({label:"EMPTY"})});Ne.EMPTY.destroy=t0;Ne.WHITE=new Ne({source:new qd({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});Ne.WHITE.destroy=t0;function y5(r,e,t){const{width:s,height:o}=t.orig,a=t.trim;if(a){const u=a.width,c=a.height;r.minX=a.x-e._x*s,r.maxX=r.minX+u,r.minY=a.y-e._y*o,r.maxY=r.minY+c}else r.minX=-e._x*s,r.maxX=r.minX+s,r.minY=-e._y*o,r.maxY=r.minY+o}const z1=new je;class Xn{constructor(e=1/0,t=1/0,s=-1/0,o=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=z1,this.minX=e,this.minY=t,this.maxX=s,this.maxY=o}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new ht);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=z1,this}set(e,t,s,o){this.minX=e,this.minY=t,this.maxX=s,this.maxY=o}addFrame(e,t,s,o,a){a||(a=this.matrix);const u=a.a,c=a.b,h=a.c,f=a.d,m=a.tx,y=a.ty;let v=this.minX,x=this.minY,b=this.maxX,S=this.maxY,w=u*e+h*t+m,A=c*e+f*t+y;w<v&&(v=w),A<x&&(x=A),w>b&&(b=w),A>S&&(S=A),w=u*s+h*t+m,A=c*s+f*t+y,w<v&&(v=w),A<x&&(x=A),w>b&&(b=w),A>S&&(S=A),w=u*e+h*o+m,A=c*e+f*o+y,w<v&&(v=w),A<x&&(x=A),w>b&&(b=w),A>S&&(S=A),w=u*s+h*o+m,A=c*s+f*o+y,w<v&&(v=w),A<x&&(x=A),w>b&&(b=w),A>S&&(S=A),this.minX=v,this.minY=x,this.maxX=b,this.maxY=S}addRect(e,t){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,t)}addBounds(e,t){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,t)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const t=this.minX,s=this.minY,o=this.maxX,a=this.maxY,{a:u,b:c,c:h,d:f,tx:m,ty:y}=e;let v=u*t+h*s+m,x=c*t+f*s+y;this.minX=v,this.minY=x,this.maxX=v,this.maxY=x,v=u*o+h*s+m,x=c*o+f*s+y,this.minX=v<this.minX?v:this.minX,this.minY=x<this.minY?x:this.minY,this.maxX=v>this.maxX?v:this.maxX,this.maxY=x>this.maxY?x:this.maxY,v=u*t+h*a+m,x=c*t+f*a+y,this.minX=v<this.minX?v:this.minX,this.minY=x<this.minY?x:this.minY,this.maxX=v>this.maxX?v:this.maxX,this.maxY=x>this.maxY?x:this.maxY,v=u*o+h*a+m,x=c*o+f*a+y,this.minX=v<this.minX?v:this.minX,this.minY=x<this.minY?x:this.minY,this.maxX=v>this.maxX?v:this.maxX,this.maxY=x>this.maxY?x:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,t,s,o){return this.minX<e&&(this.minX=e),this.maxX>t&&(this.maxX=t),this.minY<s&&(this.minY=s),this.maxY>o&&(this.maxY=o),this}pad(e,t=e){return this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Xn(this.minX,this.minY,this.maxX,this.maxY)}scale(e,t=e){return this.minX*=e,this.minY*=t,this.maxX*=e,this.maxY*=t,this}get x(){return this.minX}set x(e){const t=this.maxX-this.minX;this.minX=e,this.maxX=e+t}get y(){return this.minY}set y(e){const t=this.maxY-this.minY;this.minY=e,this.maxY=e+t}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,t,s,o){let a=this.minX,u=this.minY,c=this.maxX,h=this.maxY;o||(o=this.matrix);const f=o.a,m=o.b,y=o.c,v=o.d,x=o.tx,b=o.ty;for(let S=t;S<s;S+=2){const w=e[S],A=e[S+1],E=f*w+y*A+x,P=m*w+v*A+b;a=E<a?E:a,u=P<u?P:u,c=E>c?E:c,h=P>h?P:h}this.minX=a,this.minY=u,this.maxX=c,this.maxY=h}containsPoint(e,t){return this.minX<=e&&this.minY<=t&&this.maxX>=e&&this.maxY>=t}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}var x5={grad:.9,turn:360,rad:360/(2*Math.PI)},Cr=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},It=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*r)/t+0},Bn=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),r>t?t:r>e?r:e},a0=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},j1=function(r){return{r:Bn(r.r,0,255),g:Bn(r.g,0,255),b:Bn(r.b,0,255),a:Bn(r.a)}},ed=function(r){return{r:It(r.r),g:It(r.g),b:It(r.b),a:It(r.a,3)}},v5=/^#([0-9a-f]{3,8})$/i,Ll=function(r){var e=r.toString(16);return e.length<2?"0"+e:e},l0=function(r){var e=r.r,t=r.g,s=r.b,o=r.a,a=Math.max(e,t,s),u=a-Math.min(e,t,s),c=u?a===e?(t-s)/u:a===t?2+(s-e)/u:4+(e-t)/u:0;return{h:60*(c<0?c+6:c),s:a?u/a*100:0,v:a/255*100,a:o}},u0=function(r){var e=r.h,t=r.s,s=r.v,o=r.a;e=e/360*6,t/=100,s/=100;var a=Math.floor(e),u=s*(1-t),c=s*(1-(e-a)*t),h=s*(1-(1-e+a)*t),f=a%6;return{r:255*[s,c,u,u,h,s][f],g:255*[h,s,s,c,u,u][f],b:255*[u,u,h,s,s,c][f],a:o}},F1=function(r){return{h:a0(r.h),s:Bn(r.s,0,100),l:Bn(r.l,0,100),a:Bn(r.a)}},B1=function(r){return{h:It(r.h),s:It(r.s),l:It(r.l),a:It(r.a,3)}},D1=function(r){return u0((t=(e=r).s,{h:e.h,s:(t*=((s=e.l)<50?s:100-s)/100)>0?2*t/(s+t)*100:0,v:s+t,a:e.a}));var e,t,s},Zo=function(r){return{h:(e=l0(r)).h,s:(o=(200-(t=e.s))*(s=e.v)/100)>0&&o<200?t*s/100/(o<=100?o:200-o)*100:0,l:o/2,a:e.a};var e,t,s,o},_5=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,w5=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,b5=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,S5=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Td={string:[[function(r){var e=v5.exec(r);return e?(r=e[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?It(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?It(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var e=b5.exec(r)||S5.exec(r);return e?e[2]!==e[4]||e[4]!==e[6]?null:j1({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(r){var e=_5.exec(r)||w5.exec(r);if(!e)return null;var t,s,o=F1({h:(t=e[1],s=e[2],s===void 0&&(s="deg"),Number(t)*(x5[s]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return D1(o)},"hsl"]],object:[[function(r){var e=r.r,t=r.g,s=r.b,o=r.a,a=o===void 0?1:o;return Cr(e)&&Cr(t)&&Cr(s)?j1({r:Number(e),g:Number(t),b:Number(s),a:Number(a)}):null},"rgb"],[function(r){var e=r.h,t=r.s,s=r.l,o=r.a,a=o===void 0?1:o;if(!Cr(e)||!Cr(t)||!Cr(s))return null;var u=F1({h:Number(e),s:Number(t),l:Number(s),a:Number(a)});return D1(u)},"hsl"],[function(r){var e=r.h,t=r.s,s=r.v,o=r.a,a=o===void 0?1:o;if(!Cr(e)||!Cr(t)||!Cr(s))return null;var u=(function(c){return{h:a0(c.h),s:Bn(c.s,0,100),v:Bn(c.v,0,100),a:Bn(c.a)}})({h:Number(e),s:Number(t),v:Number(s),a:Number(a)});return u0(u)},"hsv"]]},O1=function(r,e){for(var t=0;t<e.length;t++){var s=e[t][0](r);if(s)return[s,e[t][1]]}return[null,void 0]},k5=function(r){return typeof r=="string"?O1(r.trim(),Td.string):typeof r=="object"&&r!==null?O1(r,Td.object):[null,void 0]},td=function(r,e){var t=Zo(r);return{h:t.h,s:Bn(t.s+100*e,0,100),l:t.l,a:t.a}},nd=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},N1=function(r,e){var t=Zo(r);return{h:t.h,s:t.s,l:Bn(t.l+100*e,0,100),a:t.a}},Pd=(function(){function r(e){this.parsed=k5(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return It(nd(this.rgba),2)},r.prototype.isDark=function(){return nd(this.rgba)<.5},r.prototype.isLight=function(){return nd(this.rgba)>=.5},r.prototype.toHex=function(){return e=ed(this.rgba),t=e.r,s=e.g,o=e.b,u=(a=e.a)<1?Ll(It(255*a)):"","#"+Ll(t)+Ll(s)+Ll(o)+u;var e,t,s,o,a,u},r.prototype.toRgb=function(){return ed(this.rgba)},r.prototype.toRgbString=function(){return e=ed(this.rgba),t=e.r,s=e.g,o=e.b,(a=e.a)<1?"rgba("+t+", "+s+", "+o+", "+a+")":"rgb("+t+", "+s+", "+o+")";var e,t,s,o,a},r.prototype.toHsl=function(){return B1(Zo(this.rgba))},r.prototype.toHslString=function(){return e=B1(Zo(this.rgba)),t=e.h,s=e.s,o=e.l,(a=e.a)<1?"hsla("+t+", "+s+"%, "+o+"%, "+a+")":"hsl("+t+", "+s+"%, "+o+"%)";var e,t,s,o,a},r.prototype.toHsv=function(){return e=l0(this.rgba),{h:It(e.h),s:It(e.s),v:It(e.v),a:It(e.a,3)};var e},r.prototype.invert=function(){return ar({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},r.prototype.saturate=function(e){return e===void 0&&(e=.1),ar(td(this.rgba,e))},r.prototype.desaturate=function(e){return e===void 0&&(e=.1),ar(td(this.rgba,-e))},r.prototype.grayscale=function(){return ar(td(this.rgba,-1))},r.prototype.lighten=function(e){return e===void 0&&(e=.1),ar(N1(this.rgba,e))},r.prototype.darken=function(e){return e===void 0&&(e=.1),ar(N1(this.rgba,-e))},r.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},r.prototype.alpha=function(e){return typeof e=="number"?ar({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):It(this.rgba.a,3);var t},r.prototype.hue=function(e){var t=Zo(this.rgba);return typeof e=="number"?ar({h:e,s:t.s,l:t.l,a:t.a}):It(t.h)},r.prototype.isEqual=function(e){return this.toHex()===ar(e).toHex()},r})(),ar=function(r){return r instanceof Pd?r:new Pd(r)},W1=[],C5=function(r){r.forEach(function(e){W1.indexOf(e)<0&&(e(Pd,Td),W1.push(e))})};function A5(r,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var o in t)s[t[o]]=o;var a={};r.prototype.toName=function(u){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var c,h,f=s[this.toHex()];if(f)return f;if(u!=null&&u.closest){var m=this.toRgb(),y=1/0,v="black";if(!a.length)for(var x in t)a[x]=new r(t[x]).toRgb();for(var b in t){var S=(c=m,h=a[b],Math.pow(c.r-h.r,2)+Math.pow(c.g-h.g,2)+Math.pow(c.b-h.b,2));S<y&&(y=S,v=b)}return v}},e.string.push([function(u){var c=u.toLowerCase(),h=c==="transparent"?"#0000":t[c];return h?new r(h).toRgb():null},"name"])}C5([A5]);const Gs=class Yo{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(e){if(e instanceof Yo)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(e===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,e))&&(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return typeof e=="string"||typeof e=="number"||e instanceof Number||e===null?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):typeof e=="object"&&e!==null?{...e}:e}_isSourceEqual(e,t){const s=typeof e;if(s!==typeof t)return!1;if(s==="number"||s==="string"||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length!==t.length?!1:e.every((a,u)=>a===t[u]);if(e!==null&&t!==null){const a=Object.keys(e),u=Object.keys(t);return a.length!==u.length?!1:a.every(c=>e[c]===t[c])}return e===t}toRgba(){const[e,t,s,o]=this._components;return{r:e,g:t,b:s,a:o}}toRgb(){const[e,t,s]=this._components;return{r:e,g:t,b:s}}toRgbaString(){const[e,t,s]=this.toUint8RgbArray();return`rgba(${e},${t},${s},${this.alpha})`}toUint8RgbArray(e){const[t,s,o]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(t*255),e[1]=Math.round(s*255),e[2]=Math.round(o*255),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[t,s,o,a]=this._components;return e[0]=t,e[1]=s,e[2]=o,e[3]=a,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[t,s,o]=this._components;return e[0]=t,e[1]=s,e[2]=o,e}toNumber(){return this._int}toBgrNumber(){const[e,t,s]=this.toUint8RgbArray();return(s<<16)+(t<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(e&65280)+((e&255)<<16)}multiply(e){const[t,s,o,a]=Yo._temp.setValue(e)._components;return this._components[0]*=t,this._components[1]*=s,this._components[2]*=o,this._components[3]*=a,this._refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(e===1)return(255<<24)+this._int;if(e===0)return t?0:this._int;let s=this._int>>16&255,o=this._int>>8&255,a=this._int&255;return t&&(s=s*e+.5|0,o=o*e+.5|0,a=a*e+.5|0),(e*255<<24)+(s<<16)+(o<<8)+a}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(e){let t,s,o,a;if((typeof e=="number"||e instanceof Number)&&e>=0&&e<=16777215){const u=e;t=(u>>16&255)/255,s=(u>>8&255)/255,o=(u&255)/255,a=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[t,s,o,a=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[t,s,o,a=255]=e,t/=255,s/=255,o/=255,a/=255;else if(typeof e=="string"||typeof e=="object"){if(typeof e=="string"){const c=Yo.HEX_PATTERN.exec(e);c&&(e=`#${c[2]}`)}const u=ar(e);u.isValid()&&({r:t,g:s,b:o,a}=u.rgba,t/=255,s/=255,o/=255)}if(t!==void 0)this._components[0]=t,this._components[1]=s,this._components[2]=o,this._components[3]=a,this._refreshInt();else throw new Error(`Unable to convert color ${e}`)}_refreshInt(){this._clamp(this._components);const[e,t,s]=this._components;this._int=(e*255<<16)+(t*255<<8)+(s*255|0)}_clamp(e,t=0,s=1){return typeof e=="number"?Math.min(Math.max(e,t),s):(e.forEach((o,a)=>{e[a]=Math.min(Math.max(o,t),s)}),e)}static isColorLike(e){return typeof e=="number"||typeof e=="string"||e instanceof Number||e instanceof Yo||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e.r!==void 0&&e.g!==void 0&&e.b!==void 0||e.r!==void 0&&e.g!==void 0&&e.b!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0||e.h!==void 0&&e.s!==void 0&&e.l!==void 0&&e.a!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0||e.h!==void 0&&e.s!==void 0&&e.v!==void 0&&e.a!==void 0}};Gs.shared=new Gs;Gs._temp=new Gs;Gs.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let St=Gs;const T5={cullArea:null,cullable:!1,cullableChildren:!0};let rd=0;const H1=500;function at(...r){rd!==H1&&(rd++,rd===H1?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...r))}const ha={_registeredResources:new Set,register(r){this._registeredResources.add(r)},unregister(r){this._registeredResources.delete(r)},release(){this._registeredResources.forEach(r=>r.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(r){return this._registeredResources.has(r)},reset(){this._registeredResources.clear()}};class P5{constructor(e,t){this._pool=[],this._count=0,this._index=0,this._classType=e,t&&this.prepopulate(t)}prepopulate(e){for(let t=0;t<e;t++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){var s;let t;return this._index>0?t=this._pool[--this._index]:(t=new this._classType,this._count++),(s=t.init)==null||s.call(t,e),t}return(e){var t;(t=e.reset)==null||t.call(e),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let e=0;e<this._index;e++)this._pool[e].destroy();this._pool.length=0,this._count=0,this._index=0}}class M5{constructor(){this._poolsByClass=new Map}prepopulate(e,t){this.getPool(e).prepopulate(t)}get(e,t){return this.getPool(e).get(t)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new P5(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(t=>{const s=e[t._classType.name]?t._classType.name+t._classType.ID:t._classType.name;e[s]={free:t.totalFree,used:t.totalUsed,size:t.totalSize}}),e}clear(){this._poolsByClass.forEach(e=>e.clear()),this._poolsByClass.clear()}}const Dn=new M5;ha.register(Dn);const E5={get isCachedAsTexture(){var r;return!!((r=this.renderGroup)!=null&&r.isCachedAsTexture)},cacheAsTexture(r){typeof r=="boolean"&&r===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(r===!0?{}:r))},updateCacheTexture(){var r;(r=this.renderGroup)==null||r.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(r){$e("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(r)}};function R5(r,e,t){const s=r.length;let o;if(e>=s||t===0)return;t=e+t>s?s-e:t;const a=s-t;for(o=e;o<a;++o)r[o]=r[o+t];r.length=a}const I5={allowChildren:!0,removeChildren(r=0,e){var a;const t=e??this.children.length,s=t-r,o=[];if(s>0&&s<=t){for(let c=t-1;c>=r;c--){const h=this.children[c];h&&(o.push(h),h.parent=null)}R5(this.children,r,t);const u=this.renderGroup||this.parentRenderGroup;u&&u.removeChildren(o);for(let c=0;c<o.length;++c){const h=o[c];(a=h.parentRenderLayer)==null||a.detach(h),this.emit("childRemoved",h,this,c),o[c].emit("removed",this)}return o.length>0&&this._didViewChangeTick++,o}else if(s===0&&this.children.length===0)return o;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(r){const e=this.getChildAt(r);return this.removeChild(e)},getChildAt(r){if(r<0||r>=this.children.length)throw new Error(`getChildAt: Index (${r}) does not exist.`);return this.children[r]},setChildIndex(r,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);this.getChildIndex(r),this.addChildAt(r,e)},getChildIndex(r){const e=this.children.indexOf(r);if(e===-1)throw new Error("The supplied Container must be a child of the caller");return e},addChildAt(r,e){this.allowChildren||$e(Ke,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:t}=this;if(e<0||e>t.length)throw new Error(`${r}addChildAt: The index ${e} supplied is out of bounds ${t.length}`);if(r.parent){const o=r.parent.children.indexOf(r);if(r.parent===this&&o===e)return r;o!==-1&&r.parent.children.splice(o,1)}e===t.length?t.push(r):t.splice(e,0,r),r.parent=this,r.didChange=!0,r._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(r),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",r,this,e),r.emit("added",this),r},swapChildren(r,e){if(r===e)return;const t=this.getChildIndex(r),s=this.getChildIndex(e);this.children[t]=e,this.children[s]=r;const o=this.renderGroup||this.parentRenderGroup;o&&(o.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var r;(r=this.parent)==null||r.removeChild(this)},reparentChild(...r){return r.length===1?this.reparentChildAt(r[0],this.children.length):(r.forEach(e=>this.reparentChildAt(e,this.children.length)),r[0])},reparentChildAt(r,e){if(r.parent===this)return this.setChildIndex(r,e),r;const t=r.worldTransform.clone();r.removeFromParent(),this.addChildAt(r,e);const s=this.worldTransform.clone();return s.invert(),t.prepend(s),r.setFromMatrix(t),r},replaceChild(r,e){r.updateLocalTransform(),this.addChildAt(e,this.getChildIndex(r)),e.setFromMatrix(r.localTransform),e.updateLocalTransform(),this.removeChild(r)}},L5={collectRenderables(r,e,t){this.parentRenderLayer&&this.parentRenderLayer!==t||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(r,e,t):this.renderGroup?e.renderPipes.renderGroup.addRenderGroup(this.renderGroup,r):this.collectRenderablesWithEffects(r,e,t))},collectRenderablesSimple(r,e,t){const s=this.children,o=s.length;for(let a=0;a<o;a++)s[a].collectRenderables(r,e,t)},collectRenderablesWithEffects(r,e,t){const{renderPipes:s}=e;for(let o=0;o<this.effects.length;o++){const a=this.effects[o];s[a.pipe].push(a,this,r)}this.collectRenderablesSimple(r,e,t);for(let o=this.effects.length-1;o>=0;o--){const a=this.effects[o];s[a.pipe].pop(a,this,r)}}};class U1{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}class $5{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let t=0;t<this._tests.length;t++){const s=this._tests[t];if(s.test(e))return Dn.get(s.maskClass,e)}return e}returnMaskEffect(e){Dn.return(e)}}const Md=new $5;Bt.handleByList(ve.MaskEffect,Md._effectClasses);const z5={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0)},addEffect(r){this.effects.indexOf(r)===-1&&(this.effects.push(r),this.effects.sort((t,s)=>t.priority-s.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(r){const e=this.effects.indexOf(r);e!==-1&&(this.effects.splice(e,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(r){const e=this._maskEffect;(e==null?void 0:e.mask)!==r&&(e&&(this.removeEffect(e),Md.returnMaskEffect(e),this._maskEffect=null),r!=null&&(this._maskEffect=Md.getMaskEffect(r),this.addEffect(this._maskEffect)))},get mask(){var r;return(r=this._maskEffect)==null?void 0:r.mask},setMask(r){this._maskOptions={...this._maskOptions,...r},r.mask&&(this.mask=r.mask),this._markStructureAsChanged()},set filters(r){var a;!Array.isArray(r)&&r&&(r=[r]);const e=this._filterEffect||(this._filterEffect=new U1);r=r;const t=(r==null?void 0:r.length)>0,s=((a=e.filters)==null?void 0:a.length)>0,o=t!==s;r=Array.isArray(r)?r.slice(0):r,e.filters=Object.freeze(r),o&&(t?this.addEffect(e):(this.removeEffect(e),e.filters=r??null))},get filters(){var r;return(r=this._filterEffect)==null?void 0:r.filters},set filterArea(r){this._filterEffect||(this._filterEffect=new U1),this._filterEffect.filterArea=r},get filterArea(){var r;return(r=this._filterEffect)==null?void 0:r.filterArea}},j5={label:null,get name(){return $e(Ke,"Container.name property has been removed, use Container.label instead"),this.label},set name(r){$e(Ke,"Container.name property has been removed, use Container.label instead"),this.label=r},getChildByName(r,e=!1){return this.getChildByLabel(r,e)},getChildByLabel(r,e=!1){const t=this.children;for(let s=0;s<t.length;s++){const o=t[s];if(o.label===r||r instanceof RegExp&&r.test(o.label))return o}if(e)for(let s=0;s<t.length;s++){const a=t[s].getChildByLabel(r,!0);if(a)return a}return null},getChildrenByLabel(r,e=!1,t=[]){const s=this.children;for(let o=0;o<s.length;o++){const a=s[o];(a.label===r||r instanceof RegExp&&r.test(a.label))&&t.push(a)}if(e)for(let o=0;o<s.length;o++)s[o].getChildrenByLabel(r,!0,t);return t}},Jt=Dn.getPool(je),Pr=Dn.getPool(Xn),F5=new je,B5={getFastGlobalBounds(r,e){e||(e=new Xn),e.clear(),this._getGlobalBoundsRecursive(!!r,e,this.parentRenderLayer),e.isValid||e.set(0,0,0,0);const t=this.renderGroup||this.parentRenderGroup;return e.applyMatrix(t.worldTransform),e},_getGlobalBoundsRecursive(r,e,t){let s=e;if(r&&this.parentRenderLayer&&this.parentRenderLayer!==t||this.localDisplayStatus!==7||!this.measurable)return;const o=!!this.effects.length;if((this.renderGroup||o)&&(s=Pr.get().clear()),this.boundsArea)e.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const u=this.bounds;s.addFrame(u.minX,u.minY,u.maxX,u.maxY,this.groupTransform)}const a=this.children;for(let u=0;u<a.length;u++)a[u]._getGlobalBoundsRecursive(r,s,t)}if(o){let a=!1;const u=this.renderGroup||this.parentRenderGroup;for(let c=0;c<this.effects.length;c++)this.effects[c].addBounds&&(a||(a=!0,s.applyMatrix(u.worldTransform)),this.effects[c].addBounds(s,!0));a&&s.applyMatrix(u.worldTransform.copyTo(F5).invert()),e.addBounds(s),Pr.return(s)}else this.renderGroup&&(e.addBounds(s,this.relativeGroupTransform),Pr.return(s))}};function c0(r,e,t){t.clear();let s,o;return r.parent?e?s=r.parent.worldTransform:(o=Jt.get().identity(),s=Kd(r,o)):s=je.IDENTITY,d0(r,t,s,e),o&&Jt.return(o),t.isValid||t.set(0,0,0,0),t}function d0(r,e,t,s){var c,h;if(!r.visible||!r.measurable)return;let o;s?o=r.worldTransform:(r.updateLocalTransform(),o=Jt.get(),o.appendFrom(r.localTransform,t));const a=e,u=!!r.effects.length;if(u&&(e=Pr.get().clear()),r.boundsArea)e.addRect(r.boundsArea,o);else{const f=r.bounds;f&&!f.isEmpty()&&(e.matrix=o,e.addBounds(f));for(let m=0;m<r.children.length;m++)d0(r.children[m],e,o,s)}if(u){for(let f=0;f<r.effects.length;f++)(h=(c=r.effects[f]).addBounds)==null||h.call(c,e);a.addBounds(e,je.IDENTITY),Pr.return(e)}s||Jt.return(o)}function Kd(r,e){const t=r.parent;return t&&(Kd(t,e),t.updateLocalTransform(),e.append(t.localTransform)),e}function h0(r,e){if(r===16777215||!e)return e;if(e===16777215||!r)return r;const t=r>>16&255,s=r>>8&255,o=r&255,a=e>>16&255,u=e>>8&255,c=e&255,h=t*a/255|0,f=s*u/255|0,m=o*c/255|0;return(h<<16)+(f<<8)+m}const G1=16777215;function V1(r,e){return r===G1?e:e===G1?r:h0(r,e)}function Kl(r){return((r&255)<<16)+(r&65280)+(r>>16&255)}const D5={getGlobalAlpha(r){if(r)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let e=this.alpha,t=this.parent;for(;t;)e*=t.alpha,t=t.parent;return e},getGlobalTransform(r=new je,e){if(e)return r.copyFrom(this.worldTransform);this.updateLocalTransform();const t=Kd(this,Jt.get().identity());return r.appendFrom(this.localTransform,t),Jt.return(t),r},getGlobalTint(r){if(r)return this.renderGroup?Kl(this.renderGroup.worldColor):this.parentRenderGroup?Kl(V1(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let e=this.localColor,t=this.parent;for(;t;)e=V1(e,t.localColor),t=t.parent;return Kl(e)}};function f0(r,e,t){return e.clear(),t||(t=je.IDENTITY),p0(r,e,t,r,!0),e.isValid||e.set(0,0,0,0),e}function p0(r,e,t,s,o){var h,f;let a;if(o)a=Jt.get(),a=t.copyTo(a);else{if(!r.visible||!r.measurable)return;r.updateLocalTransform();const m=r.localTransform;a=Jt.get(),a.appendFrom(m,t)}const u=e,c=!!r.effects.length;if(c&&(e=Pr.get().clear()),r.boundsArea)e.addRect(r.boundsArea,a);else{r.renderPipeId&&(e.matrix=a,e.addBounds(r.bounds));const m=r.children;for(let y=0;y<m.length;y++)p0(m[y],e,a,s,!1)}if(c){for(let m=0;m<r.effects.length;m++)(f=(h=r.effects[m]).addLocalBounds)==null||f.call(h,e,s);u.addBounds(e,je.IDENTITY),Pr.return(e)}Jt.return(a)}function m0(r,e){const t=r.children;for(let s=0;s<t.length;s++){const o=t[s],a=o.uid,u=(o._didViewChangeTick&65535)<<16|o._didContainerChangeTick&65535,c=e.index;(e.data[c]!==a||e.data[c+1]!==u)&&(e.data[e.index]=a,e.data[e.index+1]=u,e.didChange=!0),e.index=c+2,o.children.length&&m0(o,e)}return e.didChange}const O5=new je,N5={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(r,e){const t=Math.sign(this.scale.x)||1;e!==0?this.scale.x=r/e*t:this.scale.x=t},_setHeight(r,e){const t=Math.sign(this.scale.y)||1;e!==0?this.scale.y=r/e*t:this.scale.y=t},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Xn});const r=this._localBoundsCacheData;return r.index=1,r.didChange=!1,r.data[0]!==this._didViewChangeTick&&(r.didChange=!0,r.data[0]=this._didViewChangeTick),m0(this,r),r.didChange&&f0(this,r.localBounds,O5),r.localBounds},getBounds(r,e){return c0(this,r,e||new Xn)}},W5={_onRender:null,set onRender(r){const e=this.renderGroup||this.parentRenderGroup;if(!r){this._onRender&&(e==null||e.removeOnRender(this)),this._onRender=null;return}this._onRender||e==null||e.addOnRender(this),this._onRender=r},get onRender(){return this._onRender}},H5={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(r){this._zIndex!==r&&(this._zIndex=r,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(U5))}};function U5(r,e){return r._zIndex-e._zIndex}const G5={getGlobalPosition(r=new Xt,e=!1){return this.parent?this.parent.toGlobal(this._position,r,e):(r.x=this._position.x,r.y=this._position.y),r},toGlobal(r,e,t=!1){const s=this.getGlobalTransform(Jt.get(),t);return e=s.apply(r,e),Jt.return(s),e},toLocal(r,e,t,s){e&&(r=e.toGlobal(r,t,s));const o=this.getGlobalTransform(Jt.get(),s);return t=o.applyInverse(r,t),Jt.return(o),t}};class g0{constructor(){this.uid=xt("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let V5=0;class Y5{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this.textureStyle=new Us(this.textureOptions)}createTexture(e,t,s){const o=new Kn({...this.textureOptions,width:e,height:t,resolution:1,antialias:s,autoGarbageCollect:!1});return new Ne({source:o,label:`texturePool_${V5++}`})}getOptimalTexture(e,t,s=1,o){let a=Math.ceil(e*s-1e-6),u=Math.ceil(t*s-1e-6);a=Hs(a),u=Hs(u);const c=(a<<17)+(u<<1)+(o?1:0);this._texturePool[c]||(this._texturePool[c]=[]);let h=this._texturePool[c].pop();return h||(h=this.createTexture(a,u,o)),h.source._resolution=s,h.source.width=a/s,h.source.height=u/s,h.source.pixelWidth=a,h.source.pixelHeight=u,h.frame.x=0,h.frame.y=0,h.frame.width=e,h.frame.height=t,h.updateUvs(),this._poolKeyHash[h.uid]=c,h}getSameSizeTexture(e,t=!1){const s=e.source;return this.getOptimalTexture(e.width,e.height,s._resolution,t)}returnTexture(e,t=!1){const s=this._poolKeyHash[e.uid];t&&(e.source.style=this.textureStyle),this._texturePool[s].push(e)}clear(e){if(e=e!==!1,e)for(const t in this._texturePool){const s=this._texturePool[t];if(s)for(let o=0;o<s.length;o++)s[o].destroy(!0)}this._texturePool={}}}const y0=new Y5;ha.register(y0);class X5{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new je,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new g0,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const t=e.children;for(let s=0;s<t.length;s++){const o=t[s];o._updateFlags=15,this.addChild(o)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(y0.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const e=this._parentCacheAsTextureRenderGroup;e&&!e.textureNeedsUpdate&&e.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const t=this.childrenToUpdate[e];t.list.fill(null),t.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const t=this.renderGroupChildren.indexOf(e);t>-1&&this.renderGroupChildren.splice(t,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup){this.addRenderGroupChild(e.renderGroup);return}e._onRender&&this.addOnRender(e);const t=e.children;for(let s=0;s<t.length;s++)this.addChild(t[s])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup){this._removeRenderGroupChild(e.renderGroup);return}const t=e.children;for(let s=0;s<t.length;s++)this.removeChild(t[s])}removeChildren(e){for(let t=0;t<e.length;t++)this.removeChild(e[t])}onChildUpdate(e){let t=this.childrenToUpdate[e.relativeRenderGroupDepth];t||(t=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),t.list[t.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const t=this.root.children;for(let s=0;s<t.length;s++)this._getChildren(t[s],e);return e}_getChildren(e,t=[]){if(t.push(e),e.renderGroup)return t;const s=e.children;for(let o=0;o<s.length;o++)this._getChildren(s[o],t);return t}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new je),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new je),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new je),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function q5(r,e,t={}){for(const s in e)!t[s]&&e[s]!==void 0&&(r[s]=e[s])}const id=new Ft(null),$l=new Ft(null),sd=new Ft(null,1,1),zl=new Ft(null),Y1=1,K5=2,od=4;class pn extends qn{constructor(e={}){var t,s;super(),this.uid=xt("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new je,this.relativeGroupTransform=new je,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new Ft(this,0,0),this._scale=sd,this._pivot=$l,this._origin=zl,this._skew=id,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],q5(this,e,{children:!0,parent:!0,effects:!0}),(t=e.children)==null||t.forEach(o=>this.addChild(o)),(s=e.parent)==null||s.addChild(this)}static mixin(e){$e("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Bt.mixin(pn,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=e&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...e){if(this.allowChildren||$e(Ke,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let o=0;o<e.length;o++)this.addChild(e[o]);return e[0]}const t=e[0],s=this.renderGroup||this.parentRenderGroup;return t.parent===this?(this.children.splice(this.children.indexOf(t),1),this.children.push(t),s&&(s.structureDidChange=!0),t):(t.parent&&t.parent.removeChild(t),this.children.push(t),this.sortableChildren&&(this.sortDirty=!0),t.parent=this,t.didChange=!0,t._updateFlags=15,s&&s.addChild(t),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this),this._didViewChangeTick++,t._zIndex!==0&&t.depthOfChildModified(),t)}removeChild(...e){if(e.length>1){for(let o=0;o<e.length;o++)this.removeChild(e[o]);return e[0]}const t=e[0],s=this.children.indexOf(t);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(t):this.parentRenderGroup&&this.parentRenderGroup.removeChild(t),t.parentRenderLayer&&t.parentRenderLayer.detach(t),t.parent=null,this.emit("childRemoved",t,this,s),t.emit("removed",this)),t}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e==null||e.removeChild(this),this.renderGroup=Dn.get(X5,this),this.groupTransform=je.IDENTITY,e==null||e.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e==null||e.removeChild(this),Dn.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e==null||e.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new je),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*u5}set angle(e){this.rotation=e*c5}get pivot(){return this._pivot===$l&&(this._pivot=new Ft(this,0,0)),this._pivot}set pivot(e){this._pivot===$l&&(this._pivot=new Ft(this,0,0),this._origin!==zl&&at("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===id&&(this._skew=new Ft(this,0,0)),this._skew}set skew(e){this._skew===id&&(this._skew=new Ft(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===sd&&(this._scale=new Ft(this,1,1)),this._scale}set scale(e){this._scale===sd&&(this._scale=new Ft(this,0,0)),typeof e=="string"&&(e=parseFloat(e)),typeof e=="number"?this._scale.set(e):this._scale.copyFrom(e)}get origin(){return this._origin===zl&&(this._origin=new Ft(this,0,0)),this._origin}set origin(e){this._origin===zl&&(this._origin=new Ft(this,0,0),this._pivot!==$l&&at("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof e=="number"?this._origin.set(e):this._origin.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const t=this.getLocalBounds().width;this._setWidth(e,t)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const t=this.getLocalBounds().height;this._setHeight(e,t)}getSize(e){e||(e={});const t=this.getLocalBounds();return e.width=Math.abs(this.scale.x*t.width),e.height=Math.abs(this.scale.y*t.height),e}setSize(e,t){const s=this.getLocalBounds();typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,s.width),t!==void 0&&this._setHeight(t,s.height)}_updateSkew(){const e=this._rotation,t=this._skew;this._cx=Math.cos(e+t._y),this._sx=Math.sin(e+t._y),this._cy=-Math.sin(e-t._x),this._sy=Math.cos(e-t._x)}updateTransform(e){return this.position.set(typeof e.x=="number"?e.x:this.position.x,typeof e.y=="number"?e.y:this.position.y),this.scale.set(typeof e.scaleX=="number"?e.scaleX||1:this.scale.x,typeof e.scaleY=="number"?e.scaleY||1:this.scale.y),this.rotation=typeof e.rotation=="number"?e.rotation:this.rotation,this.skew.set(typeof e.skewX=="number"?e.skewX:this.skew.x,typeof e.skewY=="number"?e.skewY:this.skew.y),this.pivot.set(typeof e.pivotX=="number"?e.pivotX:this.pivot.x,typeof e.pivotY=="number"?e.pivotY:this.pivot.y),this.origin.set(typeof e.originX=="number"?e.originX:this.origin.x,typeof e.originY=="number"?e.originY:this.origin.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const t=this.localTransform,s=this._scale,o=this._pivot,a=this._origin,u=this._position,c=s._x,h=s._y,f=o._x,m=o._y,y=-a._x,v=-a._y;t.a=this._cx*c,t.b=this._sx*c,t.c=this._cy*h,t.d=this._sy*h,t.tx=u._x-(f*t.a+m*t.c)+(y*t.a+v*t.c)-y,t.ty=u._y-(f*t.b+m*t.d)+(y*t.b+v*t.d)-v}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=Y1,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const s=St.shared.setValue(e??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=Y1,this._onUpdate())}get tint(){return Kl(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=K5,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(e){const t=e?2:0;(this.localDisplayStatus&2)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=od,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(e){const t=e?0:4;(this.localDisplayStatus&4)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=od,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(e){const t=e?1:0;(this.localDisplayStatus&1)!==t&&(this._updateFlags|=od,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(e=!1){var o;if(this.destroyed)return;this.destroyed=!0;let t;if(this.children.length&&(t=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof e=="boolean"?e:e==null?void 0:e.children)&&t)for(let a=0;a<t.length;++a)t[a].destroy(e);(o=this.renderGroup)==null||o.destroy(),this.renderGroup=null}}Bt.mixin(pn,I5,B5,G5,W5,N5,z5,j5,H5,T5,E5,D5,L5);class Qd extends pn{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new Xn(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const t=this.bounds,{x:s,y:o}=e;return s>=t.minX&&s<=t.maxX&&o>=t.minY&&o<=t.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){var t,s;super.destroy(e),this._bounds=null;for(const o in this._gpuData)(s=(t=this._gpuData[o]).destroy)==null||s.call(t);this._gpuData=null}collectRenderablesSimple(e,t,s){const{renderPipes:o}=t;o.blendMode.pushBlendMode(this,this.groupBlendMode,e),o[this.renderPipeId].addRenderable(this,e),this.didViewUpdate=!1;const u=this.children,c=u.length;for(let h=0;h<c;h++)u[h].collectRenderables(e,t,s);o.blendMode.popBlendMode(e)}}class Vs extends Qd{constructor(e=Ne.EMPTY){e instanceof Ne&&(e={texture:e});const{texture:t=Ne.EMPTY,anchor:s,roundPixels:o,width:a,height:u,...c}=e;super({label:"Sprite",...c}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new Ft({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:t.defaultAnchor&&(this.anchor=t.defaultAnchor),this.texture=t,this.allowChildren=!1,this.roundPixels=o??!1,a!==void 0&&(this.width=a),u!==void 0&&(this.height=u)}static from(e,t=!1){return e instanceof Ne?new Vs(e):new Vs(Ne.from(e,t))}set texture(e){e||(e=Ne.EMPTY);const t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return y5(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return $e("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,t=this._texture,s=this._bounds,{width:o,height:a}=t.orig;s.minX=-e._x*o,s.maxX=s.minX+o,s.minY=-e._y*a,s.maxY=s.minY+a}destroy(e=!1){if(super.destroy(e),typeof e=="boolean"?e:e==null?void 0:e.texture){const s=typeof e=="boolean"?e:e==null?void 0:e.textureSource;this._texture.destroy(s)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this._texture.orig.width),t!==void 0&&this._setHeight(t,this._texture.orig.height)}}const Q5=new Xn;function x0(r,e,t){const s=Q5;r.measurable=!0,c0(r,t,s),e.addBoundsMask(s),r.measurable=!1}function v0(r,e,t){const s=Pr.get();r.measurable=!0;const o=Jt.get().identity(),a=_0(r,t,o);f0(r,s,a),r.measurable=!1,e.addBoundsMask(s),Jt.return(o),Pr.return(s)}function _0(r,e,t){return r?(r!==e&&(_0(r.parent,e,t),r.updateLocalTransform(),t.append(r.localTransform)),t):(at("Mask bounds, renderable is not inside the root container"),t)}class w0{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e!=null&&e.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof Vs),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(e,t){this.inverse||x0(this.mask,e,t)}addLocalBounds(e,t){v0(this.mask,e,t)}containsPoint(e,t){const s=this.mask;return t(s,e)}destroy(){this.reset()}static test(e){return e instanceof Vs}}w0.extension=ve.MaskEffect;class b0{constructor(e){this.priority=0,this.pipe="colorMask",e!=null&&e.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return typeof e=="number"}}b0.extension=ve.MaskEffect;class S0{constructor(e){this.priority=0,this.pipe="stencilMask",e!=null&&e.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(e,t){x0(this.mask,e,t)}addLocalBounds(e,t){v0(this.mask,e,t)}containsPoint(e,t){const s=this.mask;return t(s,e)}destroy(){this.reset()}static test(e){return e instanceof pn}}S0.extension=ve.MaskEffect;const Z5={createCanvas:(r,e)=>{const t=document.createElement("canvas");return t.width=r,t.height=e,t},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,e)=>fetch(r,e),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")};let X1=Z5;const et={get(){return X1},set(r){X1=r}};class k0 extends Kn{constructor(e){e.resource||(e.resource=et.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,t=this.height,s=this._resolution){const o=super.resize(e,t,s);return o&&this.resizeCanvas(),o}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}k0.extension=ve.TextureSource;class Xi extends Kn{constructor(e){super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}Xi.extension=ve.TextureSource;var Ed=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(Ed||{});class ad{constructor(e,t=null,s=0,o=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=t,this.priority=s,this._once=o}match(e,t=null){return this._fn===e&&this._context===t}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const t=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const C0=class wn{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ad(null,null,1/0),this.deltaMS=1/wn.targetFPMS,this.elapsedMS=1/wn.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,s=Ed.NORMAL){return this._addListener(new ad(e,t,s))}addOnce(e,t,s=Ed.NORMAL){return this._addListener(new ad(e,t,s,!0))}_addListener(e){let t=this._head.next,s=this._head;if(!t)e.connect(s);else{for(;t;){if(e.priority>t.priority){e.connect(s);break}s=t,t=t.next}e.previous||e.connect(s)}return this._startIfPossible(),this}remove(e,t){let s=this._head.next;for(;s;)s.match(e,t)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let t;if(e>this.lastTime){if(t=this.elapsedMS=e-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const a=e-this._lastFrame|0;if(a<this._minElapsedMS)return;this._lastFrame=e-a%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*wn.targetFPMS;const s=this._head;let o=s.next;for(;o;)o=o.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const t=Math.min(this.maxFPS,e),s=Math.min(Math.max(0,t)/1e3,wn.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(e===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!wn._shared){const e=wn._shared=new wn;e.autoStart=!0,e._protected=!0}return wn._shared}static get system(){if(!wn._system){const e=wn._system=new wn;e.autoStart=!0,e._protected=!0}return wn._system}};C0.targetFPMS=.06;let jl=C0,ld;async function A0(){return ld??(ld=(async()=>{var u;const e=et.get().createCanvas(1,1).getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const t=await new Promise(c=>{const h=document.createElement("video");h.onloadeddata=()=>c(h),h.onerror=()=>c(null),h.autoplay=!1,h.crossOrigin="anonymous",h.preload="auto",h.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",h.load()});if(!t)return"premultiply-alpha-on-upload";const s=e.createTexture();e.bindTexture(e.TEXTURE_2D,s);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const a=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,a),e.deleteFramebuffer(o),e.deleteTexture(s),(u=e.getExtension("WEBGL_lose_context"))==null||u.loseContext(),a[0]<=a[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),ld}const lu=class T0 extends Kn{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...T0.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=jl.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,t=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(t.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await A0(),this._load=new Promise((s,o)=>{this.isValid?s(this):(this._resolve=s,this._reject=o,t.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${t.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(jl.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(jl.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(jl.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};lu.extension=ve.TextureSource;lu.defaultOptions={...Kn.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};lu.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Jo=lu;const Yn=(r,e,t=!1)=>(Array.isArray(r)||(r=[r]),e?r.map(s=>typeof s=="string"||t?e(s):s):r);class J5{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||at(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const s=Yn(e);let o;for(let h=0;h<this.parsers.length;h++){const f=this.parsers[h];if(f.test(t)){o=f.getCacheableAssets(s,t);break}}const a=new Map(Object.entries(o||{}));o||s.forEach(h=>{a.set(h,t)});const u=[...a.keys()],c={cacheKeys:u,keys:s};s.forEach(h=>{this._cacheMap.set(h,c)}),u.forEach(h=>{const f=o?o[h]:t;this._cache.has(h)&&this._cache.get(h)!==f&&at("[Cache] already has key:",h),this._cache.set(h,a.get(h))})}remove(e){if(!this._cacheMap.has(e)){at(`[Assets] Asset id ${e} was not found in the Cache`);return}const t=this._cacheMap.get(e);t.cacheKeys.forEach(o=>{this._cache.delete(o)}),t.keys.forEach(o=>{this._cacheMap.delete(o)})}get parsers(){return this._parsers}}const ot=new J5,Rd=[];Bt.handleByList(ve.TextureSource,Rd);function P0(r={}){const e=r&&r.resource,t=e?r.resource:r,s=e?r:{resource:r};for(let o=0;o<Rd.length;o++){const a=Rd[o];if(a.test(t))return new a(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function e8(r={},e=!1){const t=r&&r.resource,s=t?r.resource:r,o=t?r:{resource:r};if(!e&&ot.has(s))return ot.get(s);const a=new Ne({source:P0(o)});return a.on("destroy",()=>{ot.has(s)&&ot.remove(s)}),e||ot.set(s,a),a}function t8(r,e=!1){return typeof r=="string"?ot.get(r):r instanceof Kn?new Ne({source:r}):e8(r,e)}Ne.from=t8;Kn.from=P0;Bt.add(w0,b0,S0,Jo,Xi,k0,qd);var di=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(di||{});function Vn(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function Oo(r){return r.split("?")[0].split("#")[0]}function n8(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function r8(r,e,t){return r.replace(new RegExp(n8(e),"g"),t)}function i8(r,e){let t="",s=0,o=-1,a=0,u=-1;for(let c=0;c<=r.length;++c){if(c<r.length)u=r.charCodeAt(c);else{if(u===47)break;u=47}if(u===47){if(!(o===c-1||a===1))if(o!==c-1&&a===2){if(t.length<2||s!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){const h=t.lastIndexOf("/");if(h!==t.length-1){h===-1?(t="",s=0):(t=t.slice(0,h),s=t.length-1-t.lastIndexOf("/")),o=c,a=0;continue}}else if(t.length===2||t.length===1){t="",s=0,o=c,a=0;continue}}}else t.length>0?t+=`/${r.slice(o+1,c)}`:t=r.slice(o+1,c),s=c-o-1;o=c,a=0}else u===46&&a!==-1?++a:a=-1}return t}const Sn={toPosix(r){return r8(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){Vn(r),r=this.toPosix(r);const e=/^file:\/\/\//.exec(r);if(e)return e[0];const t=/^[^/:]+:\/{0,2}/.exec(r);return t?t[0]:""},toAbsolute(r,e,t){if(Vn(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const s=Oo(this.toPosix(e??et.get().getBaseUrl())),o=Oo(this.toPosix(t??this.rootname(s)));return r=this.toPosix(r),r.startsWith("/")?Sn.join(o,r.slice(1)):this.isAbsolute(r)?r:this.join(s,r)},normalize(r){if(Vn(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let e="";const t=r.startsWith("/");this.hasProtocol(r)&&(e=this.rootname(r),r=r.slice(e.length));const s=r.endsWith("/");return r=i8(r),r.length>0&&s&&(r+="/"),t?`/${r}`:e+r},isAbsolute(r){return Vn(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){const s=r[t];if(Vn(s),s.length>0)if(e===void 0)e=s;else{const o=r[t-1]??"";this.joinExtensions.includes(this.extname(o).toLowerCase())?e+=`/../${s}`:e+=`/${s}`}}return e===void 0?".":this.normalize(e)},dirname(r){if(Vn(r),r.length===0)return".";r=this.toPosix(r);let e=r.charCodeAt(0);const t=e===47;let s=-1,o=!0;const a=this.getProtocol(r),u=r;r=r.slice(a.length);for(let c=r.length-1;c>=1;--c)if(e=r.charCodeAt(c),e===47){if(!o){s=c;break}}else o=!1;return s===-1?t?"/":this.isUrl(u)?a+r:a:t&&s===1?"//":a+r.slice(0,s)},rootname(r){Vn(r),r=this.toPosix(r);let e="";if(r.startsWith("/")?e="/":e=this.getProtocol(r),this.isUrl(r)){const t=r.indexOf("/",e.length);t!==-1?e=r.slice(0,t):e=r,e.endsWith("/")||(e+="/")}return e},basename(r,e){Vn(r),e&&Vn(e),r=Oo(this.toPosix(r));let t=0,s=-1,o=!0,a;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e.length===r.length&&e===r)return"";let u=e.length-1,c=-1;for(a=r.length-1;a>=0;--a){const h=r.charCodeAt(a);if(h===47){if(!o){t=a+1;break}}else c===-1&&(o=!1,c=a+1),u>=0&&(h===e.charCodeAt(u)?--u===-1&&(s=a):(u=-1,s=c))}return t===s?s=c:s===-1&&(s=r.length),r.slice(t,s)}for(a=r.length-1;a>=0;--a)if(r.charCodeAt(a)===47){if(!o){t=a+1;break}}else s===-1&&(o=!1,s=a+1);return s===-1?"":r.slice(t,s)},extname(r){Vn(r),r=Oo(this.toPosix(r));let e=-1,t=0,s=-1,o=!0,a=0;for(let u=r.length-1;u>=0;--u){const c=r.charCodeAt(u);if(c===47){if(!o){t=u+1;break}continue}s===-1&&(o=!1,s=u+1),c===46?e===-1?e=u:a!==1&&(a=1):e!==-1&&(a=-1)}return e===-1||s===-1||a===0||a===1&&e===s-1&&e===t+1?"":r.slice(e,s)},parse(r){Vn(r);const e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;r=Oo(this.toPosix(r));let t=r.charCodeAt(0);const s=this.isAbsolute(r);let o;e.root=this.rootname(r),s||this.hasProtocol(r)?o=1:o=0;let a=-1,u=0,c=-1,h=!0,f=r.length-1,m=0;for(;f>=o;--f){if(t=r.charCodeAt(f),t===47){if(!h){u=f+1;break}continue}c===-1&&(h=!1,c=f+1),t===46?a===-1?a=f:m!==1&&(m=1):a!==-1&&(m=-1)}return a===-1||c===-1||m===0||m===1&&a===c-1&&a===u+1?c!==-1&&(u===0&&s?e.base=e.name=r.slice(1,c):e.base=e.name=r.slice(u,c)):(u===0&&s?(e.name=r.slice(1,a),e.base=r.slice(1,c)):(e.name=r.slice(u,a),e.base=r.slice(u,c)),e.ext=r.slice(a,c)),e.dir=this.dirname(r),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function M0(r,e,t,s,o){const a=e[t];for(let u=0;u<a.length;u++){const c=a[u];t<e.length-1?M0(r.replace(s[t],c),e,t+1,s,o):o.push(r.replace(s[t],c))}}function s8(r){const e=/\{(.*?)\}/g,t=r.match(e),s=[];if(t){const o=[];t.forEach(a=>{const u=a.substring(1,a.length-1).split(",");o.push(u)}),M0(r,o,0,t,s)}else s.push(r);return s}const ru=r=>!Array.isArray(r);class Xs{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if(typeof e=="string")this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(t[s])}`).join("&")}}getAlias(e){const{alias:t,src:s}=e;return Yn(t||s,a=>typeof a=="string"?a:Array.isArray(a)?a.map(u=>(u==null?void 0:u.src)??u):a!=null&&a.src?a.src:a,!0)}addManifest(e){this._manifest&&at("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(e,t){const s=[];let o=t;Array.isArray(t)||(o=Object.entries(t).map(([a,u])=>typeof u=="string"||Array.isArray(u)?{alias:a,src:u}:{alias:a,...u})),o.forEach(a=>{const u=a.src,c=a.alias;let h;if(typeof c=="string"){const f=this._createBundleAssetId(e,c);s.push(f),h=[c,f]}else{const f=c.map(m=>this._createBundleAssetId(e,m));s.push(...f),h=[...c,...f]}this.add({...a,alias:h,src:u})}),this._bundles[e]=s}add(e){const t=[];Array.isArray(e)?t.push(...e):t.push(e);let s;s=a=>{this.hasKey(a)&&at(`[Resolver] already has key: ${a} overwriting`)},Yn(t).forEach(a=>{const{src:u}=a;let{data:c,format:h,loadParser:f,parser:m}=a;const y=Yn(u).map(S=>typeof S=="string"?s8(S):Array.isArray(S)?S:[S]),v=this.getAlias(a);Array.isArray(v)?v.forEach(s):s(v);const x=[],b=S=>{const w=this._parsers.find(A=>A.test(S));return{...w==null?void 0:w.parse(S),src:S}};y.forEach(S=>{S.forEach(w=>{let A={};if(typeof w!="object"?A=b(w):(c=w.data??c,h=w.format??h,(w.loadParser||w.parser)&&(f=w.loadParser??f,m=w.parser??m),A={...b(w.src),...w}),!v)throw new Error(`[Resolver] alias is undefined for this asset: ${A.src}`);A=this._buildResolvedAsset(A,{aliases:v,data:c,format:h,loadParser:f,parser:m,progressSize:a.progressSize}),x.push(A)})}),v.forEach(S=>{this._assetMap[S]=x})})}resolveBundle(e){const t=ru(e);e=Yn(e);const s={};return e.forEach(o=>{const a=this._bundles[o];if(a){const u=this.resolve(a),c={};for(const h in u){const f=u[h];c[this._extractAssetIdFromBundle(o,h)]=f}s[o]=c}}),t?s[e[0]]:s}resolveUrl(e){const t=this.resolve(e);if(typeof e!="string"){const s={};for(const o in t)s[o]=t[o].src;return s}return t.src}resolve(e){const t=ru(e);e=Yn(e);const s={};return e.forEach(o=>{if(!this._resolverHash[o])if(this._assetMap[o]){let a=this._assetMap[o];const u=this._getPreferredOrder(a);u==null||u.priority.forEach(c=>{u.params[c].forEach(h=>{const f=a.filter(m=>m[c]?m[c]===h:!1);f.length&&(a=f)})}),this._resolverHash[o]=a[0]}else this._resolverHash[o]=this._buildResolvedAsset({alias:[o],src:o},{});s[o]=this._resolverHash[o]}),t?s[e[0]]:s}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const s=e[t],o=this._preferredOrder.find(a=>a.params.format.includes(s.format));if(o)return o}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;const t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}_buildResolvedAsset(e,t){const{aliases:s,data:o,loadParser:a,parser:u,format:c,progressSize:h}=t;return(this._basePath||this._rootPath)&&(e.src=Sn.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=s??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...o||{},...e.data},e.loadParser=a??e.loadParser,e.parser=u??e.parser,e.format=c??e.format??o8(e.src),h!==void 0&&(e.progressSize=h),e}}Xs.RETINA_PREFIX=/@([0-9\.]+)x/;function o8(r){return r.split(".").pop().split("?").shift().split("#").shift()}const Id=(r,e)=>{const t=e.split("?")[1];return t&&(r+=`?${t}`),r},E0=class Xo{constructor(e,t){this.linkedSheets=[];let s=e;(e==null?void 0:e.source)instanceof Kn&&(s={texture:e,data:t});const{texture:o,data:a,cachePrefix:u=""}=s;this.cachePrefix=u,this._texture=o instanceof Ne?o:null,this.textureSource=o.source,this.textures={},this.animations={},this.data=a;const c=parseFloat(a.meta.scale);c?(this.resolution=c,o.source.resolution=this.resolution):this.resolution=o.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=Xo.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let t=e;const s=Xo.BATCH_SIZE;for(;t-e<s&&t<this._frameKeys.length;){const o=this._frameKeys[t],a=this._frames[o],u=a.frame;if(u){let c=null,h=null;const f=a.trimmed!==!1&&a.sourceSize?a.sourceSize:a.frame,m=new ht(0,0,Math.floor(f.w)/this.resolution,Math.floor(f.h)/this.resolution);a.rotated?c=new ht(Math.floor(u.x)/this.resolution,Math.floor(u.y)/this.resolution,Math.floor(u.h)/this.resolution,Math.floor(u.w)/this.resolution):c=new ht(Math.floor(u.x)/this.resolution,Math.floor(u.y)/this.resolution,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution),a.trimmed!==!1&&a.spriteSourceSize&&(h=new ht(Math.floor(a.spriteSourceSize.x)/this.resolution,Math.floor(a.spriteSourceSize.y)/this.resolution,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution)),this.textures[o]=new Ne({source:this.textureSource,frame:c,orig:m,trim:h,rotate:a.rotated?2:0,defaultAnchor:a.anchor,defaultBorders:a.borders,label:o.toString()})}t++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let s=0;s<e[t].length;s++){const o=e[t][s];this.animations[t].push(this.textures[o])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Xo.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Xo.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){var t;for(const s in this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&((t=this._texture)==null||t.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};E0.BATCH_SIZE=1e3;let q1=E0;const a8=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function R0(r,e,t){const s={};if(r.forEach(o=>{s[o]=e}),Object.keys(e.textures).forEach(o=>{s[`${e.cachePrefix}${o}`]=e.textures[o]}),!t){const o=Sn.dirname(r[0]);e.linkedSheets.forEach((a,u)=>{const c=R0([`${o}/${e.data.meta.related_multi_packs[u]}`],a,!0);Object.assign(s,c)})}return s}const l8={extension:ve.Asset,cache:{test:r=>r instanceof q1,getCacheableAssets:(r,e)=>R0(r,e,!1)},resolver:{extension:{type:ve.ResolveParser,name:"resolveSpritesheet"},test:r=>{const t=r.split("?")[0].split("."),s=t.pop(),o=t.pop();return s==="json"&&a8.includes(o)},parse:r=>{var t;const e=r.split(".");return{resolution:parseFloat(((t=Xs.RETINA_PREFIX.exec(r))==null?void 0:t[1])??"1"),format:e[e.length-2],src:r}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:ve.LoadParser,priority:di.Normal,name:"spritesheetLoader"},async testParse(r,e){return Sn.extname(e.src).toLowerCase()===".json"&&!!r.frames},async parse(r,e,t){var y,v;const{texture:s,imageFilename:o,textureOptions:a,cachePrefix:u}=(e==null?void 0:e.data)??{};let c=Sn.dirname(e.src);c&&c.lastIndexOf("/")!==c.length-1&&(c+="/");let h;if(s instanceof Ne)h=s;else{const x=Id(c+(o??r.meta.image),e.src);h=(await t.load([{src:x,data:a}]))[x]}const f=new q1({texture:h.source,data:r,cachePrefix:u});await f.parse();const m=(y=r==null?void 0:r.meta)==null?void 0:y.related_multi_packs;if(Array.isArray(m)){const x=[];for(const S of m){if(typeof S!="string")continue;let w=c+S;(v=e.data)!=null&&v.ignoreMultiPack||(w=Id(w,e.src),x.push(t.load({src:w,data:{textureOptions:a,ignoreMultiPack:!0}})))}const b=await Promise.all(x);f.linkedSheets=b,b.forEach(S=>{S.linkedSheets=[f].concat(f.linkedSheets.filter(w=>w!==S))})}return f},async unload(r,e,t){await t.unload(r.textureSource._sourceOrigin),r.destroy(!1)}}};Bt.add(l8);const ud=Object.create(null),K1=Object.create(null);function Zd(r,e){let t=K1[r];return t===void 0&&(ud[e]===void 0&&(ud[e]=1),K1[r]=t=ud[e]++),t}let zs;function I0(){return(!zs||zs!=null&&zs.isContextLost())&&(zs=et.get().createCanvas().getContext("webgl",{})),zs}let Fl;function u8(){if(!Fl){Fl="mediump";const r=I0();r&&r.getShaderPrecisionFormat&&(Fl=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision?"highp":"mediump")}return Fl}function c8(r,e,t){return e?r:t?(r=r.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${r}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${r}
        `}function d8(r,e,t){const s=t?e.maxSupportedFragmentPrecision:e.maxSupportedVertexPrecision;if(r.substring(0,9)!=="precision"){let o=t?e.requestedFragmentPrecision:e.requestedVertexPrecision;return o==="highp"&&s!=="highp"&&(o="mediump"),`precision ${o} float;
${r}`}else if(s!=="highp"&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}function h8(r,e){return e?`#version 300 es
${r}`:r}const f8={},p8={};function m8(r,{name:e="pixi-program"},t=!0){e=e.replace(/\s+/g,"-"),e+=t?"-fragment":"-vertex";const s=t?f8:p8;return s[e]?(s[e]++,e+=`-${s[e]}`):s[e]=1,r.indexOf("#define SHADER_NAME")!==-1?r:`${`#define SHADER_NAME ${e}`}
${r}`}function g8(r,e){return e?r.replace("#version 300 es",""):r}const cd={stripVersion:g8,ensurePrecision:d8,addProgramDefines:c8,setProgramName:m8,insertVersion:h8},No=Object.create(null),L0=class Ld{constructor(e){e={...Ld.defaultOptions,...e};const t=e.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:t,ensurePrecision:{requestedFragmentPrecision:e.preferredFragmentPrecision,requestedVertexPrecision:e.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:u8()},setProgramName:{name:e.name},addProgramDefines:t,insertVersion:t};let o=e.fragment,a=e.vertex;Object.keys(cd).forEach(u=>{const c=s[u];o=cd[u](o,c,!0),a=cd[u](a,c,!1)}),this.fragment=o,this.vertex=a,this.transformFeedbackVaryings=e.transformFeedbackVaryings,this._key=Zd(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,No[this._cacheKey]=null}static from(e){const t=`${e.vertex}:${e.fragment}`;return No[t]||(No[t]=new Ld(e),No[t]._cacheKey=t),No[t]}};L0.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let $0=L0;const Q1={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function y8(r){return Q1[r]??Q1.float32}const x8={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function v8({source:r,entryPoint:e}){const t={},s=r.indexOf(`fn ${e}`);if(s!==-1){const o=r.indexOf("->",s);if(o!==-1){const a=r.substring(s,o),u=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let c;for(;(c=u.exec(a))!==null;){const h=x8[c[3]]??"float32";t[c[2]]={location:parseInt(c[1],10),format:h,stride:y8(h).stride,offset:0,instance:!1,start:0}}}}return t}function dd(r){var y,v;const e=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,t=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,o=/var(<[^>]+>)? (\w+)/,a=/:\s*(\w+)/,u=/struct\s+(\w+)\s*{([^}]+)}/g,c=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,f=(y=r.match(e))==null?void 0:y.map(x=>({group:parseInt(x.match(t)[1],10),binding:parseInt(x.match(s)[1],10),name:x.match(o)[2],isUniform:x.match(o)[1]==="<uniform>",type:x.match(a)[1]}));if(!f)return{groups:[],structs:[]};const m=((v=r.match(u))==null?void 0:v.map(x=>{const b=x.match(h)[1],S=x.match(c).reduce((w,A)=>{const[E,P]=A.split(":");return w[E.trim()]=P.trim(),w},{});return S?{name:b,members:S}:null}).filter(({name:x})=>f.some(b=>b.type===x)))??[];return{groups:f,structs:m}}var qo=(r=>(r[r.VERTEX=1]="VERTEX",r[r.FRAGMENT=2]="FRAGMENT",r[r.COMPUTE=4]="COMPUTE",r))(qo||{});function _8({groups:r}){const e=[];for(let t=0;t<r.length;t++){const s=r[t];e[s.group]||(e[s.group]=[]),s.isUniform?e[s.group].push({binding:s.binding,visibility:qo.VERTEX|qo.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?e[s.group].push({binding:s.binding,visibility:qo.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&e[s.group].push({binding:s.binding,visibility:qo.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return e}function w8({groups:r}){const e=[];for(let t=0;t<r.length;t++){const s=r[t];e[s.group]||(e[s.group]={}),e[s.group][s.name]=s.binding}return e}function b8(r,e){const t=new Set,s=new Set,o=[...r.structs,...e.structs].filter(u=>t.has(u.name)?!1:(t.add(u.name),!0)),a=[...r.groups,...e.groups].filter(u=>{const c=`${u.name}-${u.binding}`;return s.has(c)?!1:(s.add(c),!0)});return{structs:o,groups:a}}const Wo=Object.create(null);class uu{constructor(e){var c,h;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:t,vertex:s,layout:o,gpuLayout:a,name:u}=e;if(this.name=u,this.fragment=t,this.vertex=s,t.source===s.source){const f=dd(t.source);this.structsAndGroups=f}else{const f=dd(s.source),m=dd(t.source);this.structsAndGroups=b8(f,m)}this.layout=o??w8(this.structsAndGroups),this.gpuLayout=a??_8(this.structsAndGroups),this.autoAssignGlobalUniforms=((c=this.layout[0])==null?void 0:c.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((h=this.layout[1])==null?void 0:h.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:t}=this,s=e.source+t.source+e.entryPoint+t.entryPoint;this._layoutKey=Zd(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=v8(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,Wo[this._cacheKey]=null}static from(e){const t=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return Wo[t]||(Wo[t]=new uu(e),Wo[t]._cacheKey=t),Wo[t]}}const z0=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],S8=z0.reduce((r,e)=>(r[e]=!0,r),{});function k8(r,e){switch(r){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*e);case"vec3<f32>":return new Float32Array(3*e);case"vec4<f32>":return new Float32Array(4*e);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const j0=class F0{constructor(e,t){this._touched=0,this.uid=xt("uniform"),this._resourceType="uniformGroup",this._resourceId=xt("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,t={...F0.defaultOptions,...t},this.uniformStructures=e;const s={};for(const o in e){const a=e[o];if(a.name=o,a.size=a.size??1,!S8[a.type]){const u=a.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(u){const[,c,h]=u;throw new Error(`Uniform type ${a.type} is not supported. Use type: '${c}', size: ${h} instead.`)}throw new Error(`Uniform type ${a.type} is not supported. Supported uniform types are: ${z0.join(", ")}`)}a.value??(a.value=k8(a.type,a.size)),s[o]=a.value}this.uniforms=s,this._dirtyId=1,this.ubo=t.ubo,this.isStatic=t.isStatic,this._signature=Zd(Object.keys(s).map(o=>`${o}-${e[o].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};j0.defaultOptions={ubo:!1,isStatic:!1};let B0=j0;class Ql{constructor(e){this.resources=Object.create(null),this._dirty=!0;let t=0;for(const s in e){const o=e[s];this.setResource(o,t++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let t=0;for(const s in this.resources)e[t++]=this.resources[s]._resourceId;this._key=e.join("|")}setResource(e,t){var o,a;const s=this.resources[t];e!==s&&(s&&((o=e.off)==null||o.call(e,"change",this.onResourceChange,this)),(a=e.on)==null||a.call(e,"change",this.onResourceChange,this),this.resources[t]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const t=this.resources;for(const s in t)t[s]._touched=e}destroy(){var t;const e=this.resources;for(const s in e){const o=e[s];(t=o==null?void 0:o.off)==null||t.call(o,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const t=this.resources;for(const s in t)t[s]===e&&(t[s]=null)}else this._updateKey()}}var $d=(r=>(r[r.WEBGL=1]="WEBGL",r[r.WEBGPU=2]="WEBGPU",r[r.BOTH=3]="BOTH",r))($d||{});class Jd extends qn{constructor(e){super(),this.uid=xt("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:t,glProgram:s,groups:o,resources:a,compatibleRenderers:u,groupMap:c}=e;this.gpuProgram=t,this.glProgram=s,u===void 0&&(u=0,t&&(u|=$d.WEBGPU),s&&(u|=$d.WEBGL)),this.compatibleRenderers=u;const h={};if(!a&&!o&&(a={}),a&&o)throw new Error("[Shader] Cannot have both resources and groups");if(!t&&o&&!c)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!t&&o&&c)for(const f in c)for(const m in c[f]){const y=c[f][m];h[y]={group:f,binding:m,name:y}}else if(t&&o&&!c){const f=t.structsAndGroups.groups;c={},f.forEach(m=>{c[m.group]=c[m.group]||{},c[m.group][m.binding]=m.name,h[m.name]=m})}else if(a){o={},c={},t&&t.structsAndGroups.groups.forEach(y=>{c[y.group]=c[y.group]||{},c[y.group][y.binding]=y.name,h[y.name]=y});let f=0;for(const m in a)h[m]||(o[99]||(o[99]=new Ql,this._ownedBindGroups.push(o[99])),h[m]={group:99,binding:f,name:m},c[99]=c[99]||{},c[99][f]=m,f++);for(const m in a){const y=m;let v=a[m];!v.source&&!v._resourceType&&(v=new B0(v));const x=h[y];x&&(o[x.group]||(o[x.group]=new Ql,this._ownedBindGroups.push(o[x.group])),o[x.group].setResource(v,x.binding))}}this.groups=o,this._uniformBindMap=c,this.resources=this._buildResourceAccessor(o,h)}addResource(e,t,s){var o,a;(o=this._uniformBindMap)[t]||(o[t]={}),(a=this._uniformBindMap[t])[s]||(a[s]=e),this.groups[t]||(this.groups[t]=new Ql,this._ownedBindGroups.push(this.groups[t]))}_buildResourceAccessor(e,t){const s={};for(const o in t){const a=t[o];Object.defineProperty(s,a.name,{get(){return e[a.group].getResource(a.binding)},set(u){e[a.group].setResource(u,a.binding)}})}return s}destroy(e=!1){var t,s;this._destroyed||(this._destroyed=!0,this.emit("destroy",this),e&&((t=this.gpuProgram)==null||t.destroy(),(s=this.glProgram)==null||s.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(o=>{o.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(e){const{gpu:t,gl:s,...o}=e;let a,u;return t&&(a=uu.from(t)),s&&(u=$0.from(s)),new Jd({gpuProgram:a,glProgram:u,...o})}}const zd=[];Bt.handleByNamedList(ve.Environment,zd);async function C8(r){if(!r)for(let e=0;e<zd.length;e++){const t=zd[e];if(t.value.test()){await t.value.load();return}}}let Ho;function A8(){if(typeof Ho=="boolean")return Ho;try{Ho=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Ho=!1}return Ho}function Z1(r,e,t=2){const s=e&&e.length,o=s?e[0]*t:r.length;let a=D0(r,0,o,t,!0);const u=[];if(!a||a.next===a.prev)return u;let c,h,f;if(s&&(a=R8(r,e,a,t)),r.length>80*t){c=r[0],h=r[1];let m=c,y=h;for(let v=t;v<o;v+=t){const x=r[v],b=r[v+1];x<c&&(c=x),b<h&&(h=b),x>m&&(m=x),b>y&&(y=b)}f=Math.max(m-c,y-h),f=f!==0?32767/f:0}return sa(a,u,t,c,h,f,0),u}function D0(r,e,t,s,o){let a;if(o===W8(r,e,t,s)>0)for(let u=e;u<t;u+=s)a=J1(u/s|0,r[u],r[u+1],a);else for(let u=t-s;u>=e;u-=s)a=J1(u/s|0,r[u],r[u+1],a);return a&&Ys(a,a.next)&&(aa(a),a=a.next),a}function qi(r,e){if(!r)return r;e||(e=r);let t=r,s;do if(s=!1,!t.steiner&&(Ys(t,t.next)||mt(t.prev,t,t.next)===0)){if(aa(t),t=e=t.prev,t===t.next)break;s=!0}else t=t.next;while(s||t!==e);return e}function sa(r,e,t,s,o,a,u){if(!r)return;!u&&a&&j8(r,s,o,a);let c=r;for(;r.prev!==r.next;){const h=r.prev,f=r.next;if(a?P8(r,s,o,a):T8(r)){e.push(h.i,r.i,f.i),aa(r),r=f.next,c=f.next;continue}if(r=f,r===c){u?u===1?(r=M8(qi(r),e),sa(r,e,t,s,o,a,2)):u===2&&E8(r,e,t,s,o,a):sa(qi(r),e,t,s,o,a,1);break}}}function T8(r){const e=r.prev,t=r,s=r.next;if(mt(e,t,s)>=0)return!1;const o=e.x,a=t.x,u=s.x,c=e.y,h=t.y,f=s.y,m=Math.min(o,a,u),y=Math.min(c,h,f),v=Math.max(o,a,u),x=Math.max(c,h,f);let b=s.next;for(;b!==e;){if(b.x>=m&&b.x<=v&&b.y>=y&&b.y<=x&&Ko(o,c,a,h,u,f,b.x,b.y)&&mt(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function P8(r,e,t,s){const o=r.prev,a=r,u=r.next;if(mt(o,a,u)>=0)return!1;const c=o.x,h=a.x,f=u.x,m=o.y,y=a.y,v=u.y,x=Math.min(c,h,f),b=Math.min(m,y,v),S=Math.max(c,h,f),w=Math.max(m,y,v),A=jd(x,b,e,t,s),E=jd(S,w,e,t,s);let P=r.prevZ,M=r.nextZ;for(;P&&P.z>=A&&M&&M.z<=E;){if(P.x>=x&&P.x<=S&&P.y>=b&&P.y<=w&&P!==o&&P!==u&&Ko(c,m,h,y,f,v,P.x,P.y)&&mt(P.prev,P,P.next)>=0||(P=P.prevZ,M.x>=x&&M.x<=S&&M.y>=b&&M.y<=w&&M!==o&&M!==u&&Ko(c,m,h,y,f,v,M.x,M.y)&&mt(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;P&&P.z>=A;){if(P.x>=x&&P.x<=S&&P.y>=b&&P.y<=w&&P!==o&&P!==u&&Ko(c,m,h,y,f,v,P.x,P.y)&&mt(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;M&&M.z<=E;){if(M.x>=x&&M.x<=S&&M.y>=b&&M.y<=w&&M!==o&&M!==u&&Ko(c,m,h,y,f,v,M.x,M.y)&&mt(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function M8(r,e){let t=r;do{const s=t.prev,o=t.next.next;!Ys(s,o)&&N0(s,t,t.next,o)&&oa(s,o)&&oa(o,s)&&(e.push(s.i,t.i,o.i),aa(t),aa(t.next),t=r=o),t=t.next}while(t!==r);return qi(t)}function E8(r,e,t,s,o,a){let u=r;do{let c=u.next.next;for(;c!==u.prev;){if(u.i!==c.i&&D8(u,c)){let h=W0(u,c);u=qi(u,u.next),h=qi(h,h.next),sa(u,e,t,s,o,a,0),sa(h,e,t,s,o,a,0);return}c=c.next}u=u.next}while(u!==r)}function R8(r,e,t,s){const o=[];for(let a=0,u=e.length;a<u;a++){const c=e[a]*s,h=a<u-1?e[a+1]*s:r.length,f=D0(r,c,h,s,!1);f===f.next&&(f.steiner=!0),o.push(B8(f))}o.sort(I8);for(let a=0;a<o.length;a++)t=L8(o[a],t);return t}function I8(r,e){let t=r.x-e.x;if(t===0&&(t=r.y-e.y,t===0)){const s=(r.next.y-r.y)/(r.next.x-r.x),o=(e.next.y-e.y)/(e.next.x-e.x);t=s-o}return t}function L8(r,e){const t=$8(r,e);if(!t)return e;const s=W0(t,r);return qi(s,s.next),qi(t,t.next)}function $8(r,e){let t=e;const s=r.x,o=r.y;let a=-1/0,u;if(Ys(r,t))return t;do{if(Ys(r,t.next))return t.next;if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const y=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(y<=s&&y>a&&(a=y,u=t.x<t.next.x?t:t.next,y===s))return u}t=t.next}while(t!==e);if(!u)return null;const c=u,h=u.x,f=u.y;let m=1/0;t=u;do{if(s>=t.x&&t.x>=h&&s!==t.x&&O0(o<f?s:a,o,h,f,o<f?a:s,o,t.x,t.y)){const y=Math.abs(o-t.y)/(s-t.x);oa(t,r)&&(y<m||y===m&&(t.x>u.x||t.x===u.x&&z8(u,t)))&&(u=t,m=y)}t=t.next}while(t!==c);return u}function z8(r,e){return mt(r.prev,r,e.prev)<0&&mt(e.next,r,r.next)<0}function j8(r,e,t,s){let o=r;do o.z===0&&(o.z=jd(o.x,o.y,e,t,s)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==r);o.prevZ.nextZ=null,o.prevZ=null,F8(o)}function F8(r){let e,t=1;do{let s=r,o;r=null;let a=null;for(e=0;s;){e++;let u=s,c=0;for(let f=0;f<t&&(c++,u=u.nextZ,!!u);f++);let h=t;for(;c>0||h>0&&u;)c!==0&&(h===0||!u||s.z<=u.z)?(o=s,s=s.nextZ,c--):(o=u,u=u.nextZ,h--),a?a.nextZ=o:r=o,o.prevZ=a,a=o;s=u}a.nextZ=null,t*=2}while(e>1);return r}function jd(r,e,t,s,o){return r=(r-t)*o|0,e=(e-s)*o|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function B8(r){let e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function O0(r,e,t,s,o,a,u,c){return(o-u)*(e-c)>=(r-u)*(a-c)&&(r-u)*(s-c)>=(t-u)*(e-c)&&(t-u)*(a-c)>=(o-u)*(s-c)}function Ko(r,e,t,s,o,a,u,c){return!(r===u&&e===c)&&O0(r,e,t,s,o,a,u,c)}function D8(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!O8(r,e)&&(oa(r,e)&&oa(e,r)&&N8(r,e)&&(mt(r.prev,r,e.prev)||mt(r,e.prev,e))||Ys(r,e)&&mt(r.prev,r,r.next)>0&&mt(e.prev,e,e.next)>0)}function mt(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function Ys(r,e){return r.x===e.x&&r.y===e.y}function N0(r,e,t,s){const o=Dl(mt(r,e,t)),a=Dl(mt(r,e,s)),u=Dl(mt(t,s,r)),c=Dl(mt(t,s,e));return!!(o!==a&&u!==c||o===0&&Bl(r,t,e)||a===0&&Bl(r,s,e)||u===0&&Bl(t,r,s)||c===0&&Bl(t,e,s))}function Bl(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function Dl(r){return r>0?1:r<0?-1:0}function O8(r,e){let t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&N0(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function oa(r,e){return mt(r.prev,r,r.next)<0?mt(r,e,r.next)>=0&&mt(r,r.prev,e)>=0:mt(r,e,r.prev)<0||mt(r,r.next,e)<0}function N8(r,e){let t=r,s=!1;const o=(r.x+e.x)/2,a=(r.y+e.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&o<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(s=!s),t=t.next;while(t!==r);return s}function W0(r,e){const t=Fd(r.i,r.x,r.y),s=Fd(e.i,e.x,e.y),o=r.next,a=e.prev;return r.next=e,e.prev=r,t.next=o,o.prev=t,s.next=t,t.prev=s,a.next=s,s.prev=a,s}function J1(r,e,t,s){const o=Fd(r,e,t);return s?(o.next=s.next,o.prev=s,s.next.prev=o,s.next=o):(o.prev=o,o.next=o),o}function aa(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Fd(r,e,t){return{i:r,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function W8(r,e,t,s){let o=0;for(let a=e,u=t-s;a<t;a+=s)o+=(r[u]-r[a])*(r[a+1]+r[u+1]),u=a;return o}const H8=Z1.default||Z1;var H0=(r=>(r[r.NONE=0]="NONE",r[r.COLOR=16384]="COLOR",r[r.STENCIL=1024]="STENCIL",r[r.DEPTH=256]="DEPTH",r[r.COLOR_DEPTH=16640]="COLOR_DEPTH",r[r.COLOR_STENCIL=17408]="COLOR_STENCIL",r[r.DEPTH_STENCIL=1280]="DEPTH_STENCIL",r[r.ALL=17664]="ALL",r))(H0||{});class U8{constructor(e){this.items=[],this._name=e}emit(e,t,s,o,a,u,c,h){const{name:f,items:m}=this;for(let y=0,v=m.length;y<v;y++)m[y][f](e,t,s,o,a,u,c,h);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return t!==-1&&this.items.splice(t,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const G8=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],U0=class G0 extends qn{constructor(e){super(),this.uid=xt("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const t=[...G8,...this.config.runners??[]];this._addRunners(...t),this._unsafeEvalCheck()}async init(e={}){const t=e.skipExtensionImports===!0?!0:e.manageImports===!1;await C8(t),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const s in this._systemsHash)e={...this._systemsHash[s].constructor.defaultOptions,...e};e={...G0.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let s=0;s<this.runners.init.items.length;s++)await this.runners.init.items[s].init(e);this._initOptions=e}render(e,t){let s=e;if(s instanceof pn&&(s={container:s},t&&($e(Ke,"passing a second argument is deprecated, please use render options instead"),s.target=t.renderTexture)),s.target||(s.target=this.view.renderTarget),s.target===this.view.renderTarget&&(this._lastObjectRendered=s.container,s.clearColor??(s.clearColor=this.background.colorRgba),s.clear??(s.clear=this.background.clearBeforeRender)),s.clearColor){const o=Array.isArray(s.clearColor)&&s.clearColor.length===4;s.clearColor=o?s.clearColor:St.shared.setValue(s.clearColor).toArray()}s.transform||(s.container.updateLocalTransform(),s.transform=s.container.localTransform),s.container.visible&&(s.container.enableRenderGroup(),this.runners.prerender.emit(s),this.runners.renderStart.emit(s),this.runners.render.emit(s),this.runners.renderEnd.emit(s),this.runners.postrender.emit(s))}resize(e,t,s){const o=this.view.resolution;this.view.resize(e,t,s),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),s!==void 0&&s!==o&&this.runners.resolutionChange.emit(s)}clear(e={}){const t=this;e.target||(e.target=t.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=H0.ALL);const{clear:s,clearColor:o,target:a}=e;St.shared.setValue(o??this.background.colorRgba),t.renderTarget.clear(a,s,St.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(t=>{this.runners[t]=new U8(t)})}_addSystems(e){let t;for(t in e){const s=e[t];this._addSystem(s.value,s.name)}}_addSystem(e,t){const s=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=s,this._systemsHash[t]=s;for(const o in this.runners)this.runners[o].add(s);return this}_addPipes(e,t){const s=t.reduce((o,a)=>(o[a.name]=a.value,o),{});e.forEach(o=>{const a=o.value,u=o.name,c=s[u];this.renderPipes[u]=new a(this,c?new c:null),this.runners.destroy.add(this.renderPipes[u])})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),(e===!0||typeof e=="object"&&e.releaseGlobalResources)&&ha.release(),Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!A8())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};U0.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let V0=U0,Ol;function V8(r){return Ol!==void 0||(Ol=(()=>{var t;const e={stencil:!0,failIfMajorPerformanceCaveat:r??V0.defaultOptions.failIfMajorPerformanceCaveat};try{if(!et.get().getWebGLRenderingContext())return!1;let o=et.get().createCanvas().getContext("webgl",e);const a=!!((t=o==null?void 0:o.getContextAttributes())!=null&&t.stencil);if(o){const u=o.getExtension("WEBGL_lose_context");u&&u.loseContext()}return o=null,a}catch{return!1}})()),Ol}let Nl;async function Y8(r={}){return Nl!==void 0||(Nl=await(async()=>{const e=et.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(r)).requestDevice(),!0}catch{return!1}})()),Nl}const ep=["webgl","webgpu","canvas"];async function X8(r){let e=[];r.preference?(e.push(r.preference),ep.forEach(a=>{a!==r.preference&&e.push(a)})):e=ep.slice();let t,s={};for(let a=0;a<e.length;a++){const u=e[a];if(u==="webgpu"&&await Y8()){const{WebGPURenderer:c}=await nu(async()=>{const{WebGPURenderer:h}=await import("./WebGPURenderer-BUggpxeh.js");return{WebGPURenderer:h}},__vite__mapDeps([3,2,4]));t=c,s={...r,...r.webgpu};break}else if(u==="webgl"&&V8(r.failIfMajorPerformanceCaveat??V0.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:c}=await nu(async()=>{const{WebGLRenderer:h}=await import("./WebGLRenderer-B0og6Ac3.js");return{WebGLRenderer:h}},__vite__mapDeps([5,2,4]));t=c,s={...r,...r.webgl};break}else if(u==="canvas")throw s={...r},new Error("CanvasRenderer is not yet implemented")}if(delete s.webgpu,delete s.webgl,!t)throw new Error("No available renderer for the current environment");const o=new t;return await o.init(s),o}const Y0="8.14.3";class X0{static init(){var e;(e=globalThis.__PIXI_APP_INIT__)==null||e.call(globalThis,this,Y0)}static destroy(){}}X0.extension=ve.Application;class q8{constructor(e){this._renderer=e}init(){var e;(e=globalThis.__PIXI_RENDERER_INIT__)==null||e.call(globalThis,this._renderer,Y0)}destroy(){this._renderer=null}}q8.extension={type:[ve.WebGLSystem,ve.WebGPUSystem],name:"initHook",priority:-10};const q0=class Bd{constructor(...e){this.stage=new pn,e[0]!==void 0&&$e(Ke,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.stage||(this.stage=new pn),this.renderer=await X8(e),Bd._plugins.forEach(t=>{t.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return $e(Ke,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,t=!1){const s=Bd._plugins.slice(0);s.reverse(),s.forEach(o=>{o.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(e),this.renderer=null}};q0._plugins=[];let K0=q0;Bt.handleByList(ve.Application,K0._plugins);Bt.add(X0);class Q0 extends qn{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return $e(Ke,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return $e(Ke,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return $e(Ke,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return $e(Ke,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return $e(Ke,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){var t;this.emit("destroy",this),this.removeAllListeners();for(const s in this.chars)(t=this.chars[s].texture)==null||t.destroy();this.chars=null,e&&(this.pages.forEach(s=>s.texture.destroy(!0)),this.pages=null)}}/**
 * tiny-lru
 *
 * @copyright 2025 Jason Mulligan <jason.mulligan@avoidwork.com>
 * @license BSD-3-Clause
 * @version 11.4.5
 */class K8{constructor(e=0,t=0,s=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=s,this.size=0,this.ttl=t}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){const t=this.items[e];delete this.items[e],this.size--,t.prev!==null&&(t.prev.next=t.next),t.next!==null&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}return this}entries(e=this.keys()){return e.map(t=>[t,this.get(t)])}evict(e=!1){if(e||this.size>0){const t=this.first;delete this.items[t.key],--this.size===0?(this.first=null,this.last=null):(this.first=t.next,this.first.prev=null)}return this}expiresAt(e){let t;return this.has(e)&&(t=this.items[e].expiry),t}get(e){const t=this.items[e];if(t!==void 0){if(this.ttl>0&&t.expiry<=Date.now()){this.delete(e);return}return this.moveToEnd(t),t.value}}has(e){return e in this.items}moveToEnd(e){this.last!==e&&(e.prev!==null&&(e.prev.next=e.next),e.next!==null&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),e.prev=this.last,e.next=null,this.last!==null&&(this.last.next=e),this.last=e,this.first===null&&(this.first=e))}keys(){const e=[];let t=this.first;for(;t!==null;)e.push(t.key),t=t.next;return e}setWithEvicted(e,t,s=this.resetTtl){let o=null;if(this.has(e))this.set(e,t,!0,s);else{this.max>0&&this.size===this.max&&(o={...this.first},this.evict(!0));let a=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t};++this.size===1?this.first=a:this.last.next=a,this.last=a}return o}set(e,t,s=!1,o=this.resetTtl){let a=this.items[e];return s||a!==void 0?(a.value=t,s===!1&&o&&(a.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(a)):(this.max>0&&this.size===this.max&&this.evict(!0),a=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t},++this.size===1?this.first=a:this.last.next=a,this.last=a),this}values(e=this.keys()){return e.map(t=>this.get(t))}}function Z0(r=1e3,e=0,t=!1){if(isNaN(r)||r<0)throw new TypeError("Invalid max value");if(isNaN(e)||e<0)throw new TypeError("Invalid ttl value");if(typeof t!="boolean")throw new TypeError("Invalid resetTtl value");return new K8(r,e,t)}const Q8=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function iu(r){const e=typeof r.fontSize=="number"?`${r.fontSize}px`:r.fontSize;let t=r.fontFamily;Array.isArray(r.fontFamily)||(t=r.fontFamily.split(","));for(let s=t.length-1;s>=0;s--){let o=t[s].trim();!/([\"\'])[^\'\"]+\1/.test(o)&&!Q8.includes(o)&&(o=`"${o}"`),t[s]=o}return`${r.fontStyle} ${r.fontVariant} ${r.fontWeight} ${e} ${t.join(",")}`}const hd={willReadFrequently:!0},Qn=class me{static get experimentalLetterSpacingSupported(){let e=me._experimentalLetterSpacingSupported;if(e===void 0){const t=et.get().getCanvasRenderingContext2D().prototype;e=me._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return e}constructor(e,t,s,o,a,u,c,h,f){this.text=e,this.style=t,this.width=s,this.height=o,this.lines=a,this.lineWidths=u,this.lineHeight=c,this.maxLineWidth=h,this.fontProperties=f}static measureText(e=" ",t,s=me._canvas,o=t.wordWrap){var E;const a=`${e}-${t.styleKey}-wordWrap-${o}`;if(me._measurementCache.has(a))return me._measurementCache.get(a);const u=iu(t),c=me.measureFont(u);c.fontSize===0&&(c.fontSize=t.fontSize,c.ascent=t.fontSize);const h=me.__context;h.font=u;const m=(o?me._wordWrap(e,t,s):e).split(/(?:\r\n|\r|\n)/),y=new Array(m.length);let v=0;for(let P=0;P<m.length;P++){const M=me._measureText(m[P],t.letterSpacing,h);y[P]=M,v=Math.max(v,M)}const x=((E=t._stroke)==null?void 0:E.width)||0;let b=v+x;t.dropShadow&&(b+=t.dropShadow.distance);const S=t.lineHeight||c.fontSize;let w=Math.max(S,c.fontSize+x)+(m.length-1)*(S+t.leading);t.dropShadow&&(w+=t.dropShadow.distance);const A=new me(e,t,b,w,m,y,S+t.leading,v,c);return me._measurementCache.set(a,A),A}static _measureText(e,t,s){let o=!1;me.experimentalLetterSpacingSupported&&(me.experimentalLetterSpacing?(s.letterSpacing=`${t}px`,s.textLetterSpacing=`${t}px`,o=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));const a=s.measureText(e);let u=a.width;const c=-a.actualBoundingBoxLeft;let f=a.actualBoundingBoxRight-c;if(u>0)if(o)u-=t,f-=t;else{const m=(me.graphemeSegmenter(e).length-1)*t;u+=m,f+=m}return Math.max(u,f)}static _wordWrap(e,t,s=me._canvas){const o=s.getContext("2d",hd);let a=0,u="",c="";const h=Object.create(null),{letterSpacing:f,whiteSpace:m}=t,y=me._collapseSpaces(m),v=me._collapseNewlines(m);let x=!y;const b=t.wordWrapWidth+f,S=me._tokenize(e);for(let w=0;w<S.length;w++){let A=S[w];if(me._isNewline(A)){if(!v){c+=me._addLine(u),x=!y,u="",a=0;continue}A=" "}if(y){const P=me.isBreakingSpace(A),M=me.isBreakingSpace(u[u.length-1]);if(P&&M)continue}const E=me._getFromCache(A,f,h,o);if(E>b)if(u!==""&&(c+=me._addLine(u),u="",a=0),me.canBreakWords(A,t.breakWords)){const P=me.wordWrapSplit(A);for(let M=0;M<P.length;M++){let D=P[M],z=D,L=1;for(;P[M+L];){const H=P[M+L];if(!me.canBreakChars(z,H,A,M,t.breakWords))D+=H;else break;z=H,L++}M+=L-1;const G=me._getFromCache(D,f,h,o);G+a>b&&(c+=me._addLine(u),x=!1,u="",a=0),u+=D,a+=G}}else{u.length>0&&(c+=me._addLine(u),u="",a=0);const P=w===S.length-1;c+=me._addLine(A,!P),x=!1,u="",a=0}else E+a>b&&(x=!1,c+=me._addLine(u),u="",a=0),(u.length>0||!me.isBreakingSpace(A)||x)&&(u+=A,a+=E)}return c+=me._addLine(u,!1),c}static _addLine(e,t=!0){return e=me._trimRight(e),e=t?`${e}
`:e,e}static _getFromCache(e,t,s,o){let a=s[e];return typeof a!="number"&&(a=me._measureText(e,t,o)+t,s[e]=a),a}static _collapseSpaces(e){return e==="normal"||e==="pre-line"}static _collapseNewlines(e){return e==="normal"}static _trimRight(e){if(typeof e!="string")return"";for(let t=e.length-1;t>=0;t--){const s=e[t];if(!me.isBreakingSpace(s))break;e=e.slice(0,-1)}return e}static _isNewline(e){return typeof e!="string"?!1:me._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,t){return typeof e!="string"?!1:me._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const t=[];let s="";if(typeof e!="string")return t;for(let o=0;o<e.length;o++){const a=e[o],u=e[o+1];if(me.isBreakingSpace(a,u)||me._isNewline(a)){s!==""&&(t.push(s),s=""),a==="\r"&&u===`
`?(t.push(`\r
`),o++):t.push(a);continue}s+=a}return s!==""&&t.push(s),t}static canBreakWords(e,t){return t}static canBreakChars(e,t,s,o,a){return!0}static wordWrapSplit(e){return me.graphemeSegmenter(e)}static measureFont(e){if(me._fonts[e])return me._fonts[e];const t=me._context;t.font=e;const s=t.measureText(me.METRICS_STRING+me.BASELINE_SYMBOL),o={ascent:s.actualBoundingBoxAscent,descent:s.actualBoundingBoxDescent,fontSize:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent};return me._fonts[e]=o,o}static clearMetrics(e=""){e?delete me._fonts[e]:me._fonts={}}static get _canvas(){if(!me.__canvas){let e;try{const t=new OffscreenCanvas(0,0),s=t.getContext("2d",hd);if(s!=null&&s.measureText)return me.__canvas=t,t;e=et.get().createCanvas()}catch{e=et.get().createCanvas()}e.width=e.height=10,me.__canvas=e}return me.__canvas}static get _context(){return me.__context||(me.__context=me._canvas.getContext("2d",hd)),me.__context}};Qn.METRICS_STRING="|q";Qn.BASELINE_SYMBOL="M";Qn.BASELINE_MULTIPLIER=1.4;Qn.HEIGHT_MULTIPLIER=2;Qn.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const r=new Intl.Segmenter;return e=>{const t=r.segment(e),s=[];let o=0;for(const a of t)s[o++]=a.segment;return s}}return r=>[...r]})();Qn.experimentalLetterSpacing=!1;Qn._fonts={};Qn._newlines=[10,13];Qn._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];Qn._measurementCache=Z0(1e3);let cr=Qn;const tp=[{offset:0,color:"white"},{offset:1,color:"black"}],eh=class Dd{constructor(...e){this.uid=xt("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let t=Z8(e);t={...t.type==="radial"?Dd.defaultRadialOptions:Dd.defaultLinearOptions,...n0(t)},this._textureSize=t.textureSize,this._wrapMode=t.wrapMode,t.type==="radial"?(this.center=t.center,this.outerCenter=t.outerCenter??this.center,this.innerRadius=t.innerRadius,this.outerRadius=t.outerRadius,this.scale=t.scale,this.rotation=t.rotation):(this.start=t.start,this.end=t.end),this.textureSpace=t.textureSpace,this.type=t.type,t.colorStops.forEach(o=>{this.addColorStop(o.offset,o.color)})}addColorStop(e,t){return this.colorStops.push({offset:e,color:St.shared.setValue(t).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:e,y:t}=this.start,{x:s,y:o}=this.end,a=s-e,u=o-t;const c=a<0||u<0;if(this._wrapMode==="clamp-to-edge"){if(a<0){const w=e;e=s,s=w,a*=-1}if(u<0){const w=t;t=o,o=w,u*=-1}}const h=this.colorStops.length?this.colorStops:tp,f=this._textureSize,{canvas:m,context:y}=rp(f,1),v=c?y.createLinearGradient(this._textureSize,0,0,0):y.createLinearGradient(0,0,this._textureSize,0);np(v,h),y.fillStyle=v,y.fillRect(0,0,f,1),this.texture=new Ne({source:new Xi({resource:m,addressMode:this._wrapMode})});const x=Math.sqrt(a*a+u*u),b=Math.atan2(u,a),S=new je;S.scale(x/f,1),S.rotate(b),S.translate(e,t),this.textureSpace==="local"&&S.scale(f,f),this.transform=S}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:tp,t=this._textureSize,{canvas:s,context:o}=rp(t,t),{x:a,y:u}=this.center,{x:c,y:h}=this.outerCenter,f=this.innerRadius,m=this.outerRadius,y=c-m,v=h-m,x=t/(m*2),b=(a-y)*x,S=(u-v)*x,w=o.createRadialGradient(b,S,f*x,(c-y)*x,(h-v)*x,m*x);np(w,e),o.fillStyle=e[e.length-1].color,o.fillRect(0,0,t,t),o.fillStyle=w,o.translate(b,S),o.rotate(this.rotation),o.scale(1,this.scale),o.translate(-b,-S),o.fillRect(0,0,t,t),this.texture=new Ne({source:new Xi({resource:s,addressMode:this._wrapMode})});const A=new je;A.scale(1/x,1/x),A.translate(y,v),this.textureSpace==="local"&&A.scale(t,t),this.transform=A}destroy(){var e;(e=this.texture)==null||e.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};eh.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};eh.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let Rr=eh;function np(r,e){for(let t=0;t<e.length;t++){const s=e[t];r.addColorStop(s.offset,s.color)}}function rp(r,e){const t=et.get().createCanvas(r,e),s=t.getContext("2d");return{canvas:t,context:s}}function Z8(r){let e=r[0]??{};return(typeof e=="number"||r[1])&&($e("8.5.2","use options object instead"),e={type:"linear",start:{x:r[0],y:r[1]},end:{x:r[2],y:r[3]},textureSpace:r[4],textureSize:r[5]??Rr.defaultLinearOptions.textureSize}),e}const ip={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class cu{constructor(e,t){this.uid=xt("fillPattern"),this._tick=0,this.transform=new je,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),t&&(e.source.style.addressModeU=ip[t].addressModeU,e.source.style.addressModeV=ip[t].addressModeV)}setTransform(e){const t=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/t.frame.width,1/t.frame.height),this._tick++}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture=e,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}var fd,sp;function J8(){if(sp)return fd;sp=1,fd=t;var r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},e=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function t(a){var u=[];return a.replace(e,function(c,h,f){var m=h.toLowerCase();for(f=o(f),m=="m"&&f.length>2&&(u.push([h].concat(f.splice(0,2))),m="l",h=h=="m"?"l":"L");;){if(f.length==r[m])return f.unshift(h),u.push(f);if(f.length<r[m])throw new Error("malformed path data");u.push([h].concat(f.splice(0,r[m])))}}),u}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function o(a){var u=a.match(s);return u?u.map(Number):[]}return fd}var e6=J8();const t6=Gd(e6);function n6(r,e){const t=t6(r),s=[];let o=null,a=0,u=0;for(let c=0;c<t.length;c++){const h=t[c],f=h[0],m=h;switch(f){case"M":a=m[1],u=m[2],e.moveTo(a,u);break;case"m":a+=m[1],u+=m[2],e.moveTo(a,u);break;case"H":a=m[1],e.lineTo(a,u);break;case"h":a+=m[1],e.lineTo(a,u);break;case"V":u=m[1],e.lineTo(a,u);break;case"v":u+=m[1],e.lineTo(a,u);break;case"L":a=m[1],u=m[2],e.lineTo(a,u);break;case"l":a+=m[1],u+=m[2],e.lineTo(a,u);break;case"C":a=m[5],u=m[6],e.bezierCurveTo(m[1],m[2],m[3],m[4],a,u);break;case"c":e.bezierCurveTo(a+m[1],u+m[2],a+m[3],u+m[4],a+m[5],u+m[6]),a+=m[5],u+=m[6];break;case"S":a=m[3],u=m[4],e.bezierCurveToShort(m[1],m[2],a,u);break;case"s":e.bezierCurveToShort(a+m[1],u+m[2],a+m[3],u+m[4]),a+=m[3],u+=m[4];break;case"Q":a=m[3],u=m[4],e.quadraticCurveTo(m[1],m[2],a,u);break;case"q":e.quadraticCurveTo(a+m[1],u+m[2],a+m[3],u+m[4]),a+=m[3],u+=m[4];break;case"T":a=m[1],u=m[2],e.quadraticCurveToShort(a,u);break;case"t":a+=m[1],u+=m[2],e.quadraticCurveToShort(a,u);break;case"A":a=m[6],u=m[7],e.arcToSvg(m[1],m[2],m[3],m[4],m[5],a,u);break;case"a":a+=m[6],u+=m[7],e.arcToSvg(m[1],m[2],m[3],m[4],m[5],a,u);break;case"Z":case"z":e.closePath(),s.length>0&&(o=s.pop(),o?(a=o.startX,u=o.startY):(a=0,u=0)),o=null;break;default:at(`Unknown SVG path command: ${f}`)}f!=="Z"&&f!=="z"&&o===null&&(o={startX:a,startY:u},s.push(o))}return e}class th{constructor(e=0,t=0,s=0){this.type="circle",this.x=e,this.y=t,this.radius=s}clone(){return new th(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const s=this.radius*this.radius;let o=this.x-e,a=this.y-t;return o*=o,a*=a,o+a<=s}strokeContains(e,t,s,o=.5){if(this.radius===0)return!1;const a=this.x-e,u=this.y-t,c=this.radius,h=(1-o)*s,f=Math.sqrt(a*a+u*u);return f<=c+h&&f>c-(s-h)}getBounds(e){return e||(e=new ht),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=this.radius*2,e.height=this.radius*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class nh{constructor(e=0,t=0,s=0,o=0){this.type="ellipse",this.x=e,this.y=t,this.halfWidth=s,this.halfHeight=o}clone(){return new nh(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,t){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(e-this.x)/this.halfWidth,o=(t-this.y)/this.halfHeight;return s*=s,o*=o,s+o<=1}strokeContains(e,t,s,o=.5){const{halfWidth:a,halfHeight:u}=this;if(a<=0||u<=0)return!1;const c=s*(1-o),h=s-c,f=a-h,m=u-h,y=a+c,v=u+c,x=e-this.x,b=t-this.y,S=x*x/(f*f)+b*b/(m*m),w=x*x/(y*y)+b*b/(v*v);return S>1&&w<=1}getBounds(e){return e||(e=new ht),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=this.halfWidth*2,e.height=this.halfHeight*2,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function r6(r,e,t,s,o,a){const u=r-t,c=e-s,h=o-t,f=a-s,m=u*h+c*f,y=h*h+f*f;let v=-1;y!==0&&(v=m/y);let x,b;v<0?(x=t,b=s):v>1?(x=o,b=a):(x=t+v*h,b=s+v*f);const S=r-x,w=e-b;return S*S+w*w}let i6,s6;class ea{constructor(...e){this.type="polygon";let t=Array.isArray(e[0])?e[0]:e;if(typeof t[0]!="number"){const s=[];for(let o=0,a=t.length;o<a;o++)s.push(t[o].x,t[o].y);t=s}this.points=t,this.closePath=!0}isClockwise(){let e=0;const t=this.points,s=t.length;for(let o=0;o<s;o+=2){const a=t[o],u=t[o+1],c=t[(o+2)%s],h=t[(o+3)%s];e+=(c-a)*(h+u)}return e<0}containsPolygon(e){const t=this.getBounds(i6),s=e.getBounds(s6);if(!t.containsRect(s))return!1;const o=e.points;for(let a=0;a<o.length;a+=2){const u=o[a],c=o[a+1];if(!this.contains(u,c))return!1}return!0}clone(){const e=this.points.slice(),t=new ea(e);return t.closePath=this.closePath,t}contains(e,t){let s=!1;const o=this.points.length/2;for(let a=0,u=o-1;a<o;u=a++){const c=this.points[a*2],h=this.points[a*2+1],f=this.points[u*2],m=this.points[u*2+1];h>t!=m>t&&e<(f-c)*((t-h)/(m-h))+c&&(s=!s)}return s}strokeContains(e,t,s,o=.5){const a=s*s,u=a*(1-o),c=a-u,{points:h}=this,f=h.length-(this.closePath?0:2);for(let m=0;m<f;m+=2){const y=h[m],v=h[m+1],x=h[(m+2)%h.length],b=h[(m+3)%h.length],S=r6(e,t,y,v,x,b),w=Math.sign((x-y)*(t-v)-(b-v)*(e-y));if(S<=(w<0?c:u))return!0}return!1}getBounds(e){e||(e=new ht);const t=this.points;let s=1/0,o=-1/0,a=1/0,u=-1/0;for(let c=0,h=t.length;c<h;c+=2){const f=t[c],m=t[c+1];s=f<s?f:s,o=f>o?f:o,a=m<a?m:a,u=m>u?m:u}return e.x=s,e.width=o-s,e.y=a,e.height=u-a,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,t)=>`${e}, ${t}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return $e("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return $e("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const Wl=(r,e,t,s,o,a,u)=>{const c=r-t,h=e-s,f=Math.sqrt(c*c+h*h);return f>=o-a&&f<=o+u};class rh{constructor(e=0,t=0,s=0,o=0,a=20){this.type="roundedRectangle",this.x=e,this.y=t,this.width=s,this.height=o,this.radius=a}getBounds(e){return e||(e=new ht),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new rh(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+s&&t<=this.y+this.height-s||e>=this.x+s&&e<=this.x+this.width-s)return!0;let o=e-(this.x+s),a=t-(this.y+s);const u=s*s;if(o*o+a*a<=u||(o=e-(this.x+this.width-s),o*o+a*a<=u)||(a=t-(this.y+this.height-s),o*o+a*a<=u)||(o=e-(this.x+s),o*o+a*a<=u))return!0}return!1}strokeContains(e,t,s,o=.5){const{x:a,y:u,width:c,height:h,radius:f}=this,m=s*(1-o),y=s-m,v=a+f,x=u+f,b=c-f*2,S=h-f*2,w=a+c,A=u+h;return(e>=a-m&&e<=a+y||e>=w-y&&e<=w+m)&&t>=x&&t<=x+S||(t>=u-m&&t<=u+y||t>=A-y&&t<=A+m)&&e>=v&&e<=v+b?!0:e<v&&t<x&&Wl(e,t,v,x,f,y,m)||e>w-f&&t<x&&Wl(e,t,w-f,x,f,y,m)||e>w-f&&t>A-f&&Wl(e,t,w-f,A-f,f,y,m)||e<v&&t>A-f&&Wl(e,t,v,A-f,f,y,m)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const J0={};function o6(r,e,t){let s=2166136261;for(let o=0;o<e;o++)s^=r[o].uid,s=Math.imul(s,16777619),s>>>=0;return J0[s]||a6(r,e,s,t)}function a6(r,e,t,s){const o={};let a=0;for(let c=0;c<s;c++){const h=c<e?r[c]:Ne.EMPTY.source;o[a++]=h.source,o[a++]=h.style}const u=new Ql(o);return J0[t]=u,u}class op{constructor(e){typeof e=="number"?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}function ap(r,e){const t=r.byteLength/8|0,s=new Float64Array(r,0,t);new Float64Array(e,0,t).set(s);const a=r.byteLength-t*8;if(a>0){const u=new Uint8Array(r,t*8,a);new Uint8Array(e,t*8,a).set(u)}}const l6={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var u6=(r=>(r[r.DISABLED=0]="DISABLED",r[r.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",r[r.MASK_ACTIVE=2]="MASK_ACTIVE",r[r.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",r[r.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",r[r.NONE=5]="NONE",r))(u6||{});function lp(r,e){return e.alphaMode==="no-premultiply-alpha"&&l6[r]||r}const c6=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function d6(r){let e="";for(let t=0;t<r;++t)t>0&&(e+=`
else `),t<r-1&&(e+=`if(test == ${t}.0){}`);return e}function h6(r,e){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const t=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const s=c6.replace(/%forloop%/gi,d6(r));if(e.shaderSource(t,s),e.compileShader(t),!e.getShaderParameter(t,e.COMPILE_STATUS))r=r/2|0;else break}}finally{e.deleteShader(t)}return r}let js=null;function f6(){var e;if(js)return js;const r=I0();return js=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),js=h6(js,r),(e=r.getExtension("WEBGL_lose_context"))==null||e.loseContext(),js}class p6{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const t=this.textures[e];this.textures[e]=null,this.ids[t.uid]=null}this.count=0}}class m6{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new p6,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const ta=[];let su=0;ha.register({clear:()=>{if(ta.length>0)for(const r of ta)r&&r.destroy();ta.length=0,su=0}});function up(){return su>0?ta[--su]:new m6}function cp(r){ta[su++]=r}let Uo=0;const em=class tm{constructor(e){this.uid=xt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],e={...tm.defaultOptions,...e},e.maxTextures||($e("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),e.maxTextures=f6());const{maxTextures:t,attributesInitialSize:s,indicesInitialSize:o}=e;this.attributeBuffer=new op(s*4),this.indexBuffer=new Uint16Array(o),this.maxTextures=t}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)cp(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,t){const s=e._batch.textures.ids[t._source.uid];return!s&&s!==0?!1:(e._textureId=s,e.texture=t,!0)}updateElement(e){this.dirty=!0;const t=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId)}break(e){const t=this._elements;if(!t[this.elementStart])return;let s=up(),o=s.textures;o.clear();const a=t[this.elementStart];let u=lp(a.blendMode,a.texture._source),c=a.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const h=this.attributeBuffer.float32View,f=this.attributeBuffer.uint32View,m=this.indexBuffer;let y=this._batchIndexSize,v=this._batchIndexStart,x="startBatch";const b=this.maxTextures;for(let S=this.elementStart;S<this.elementSize;++S){const w=t[S];t[S]=null;const E=w.texture._source,P=lp(w.blendMode,E),M=u!==P||c!==w.topology;if(E._batchTick===Uo&&!M){w._textureId=E._textureBindLocation,y+=w.indexSize,w.packAsQuad?(this.packQuadAttributes(w,h,f,w._attributeStart,w._textureId),this.packQuadIndex(m,w._indexStart,w._attributeStart/this.vertexSize)):(this.packAttributes(w,h,f,w._attributeStart,w._textureId),this.packIndex(w,m,w._indexStart,w._attributeStart/this.vertexSize)),w._batch=s;continue}E._batchTick=Uo,(o.count>=b||M)&&(this._finishBatch(s,v,y-v,o,u,c,e,x),x="renderBatch",v=y,u=P,c=w.topology,s=up(),o=s.textures,o.clear(),++Uo),w._textureId=E._textureBindLocation=o.count,o.ids[E.uid]=o.count,o.textures[o.count++]=E,w._batch=s,y+=w.indexSize,w.packAsQuad?(this.packQuadAttributes(w,h,f,w._attributeStart,w._textureId),this.packQuadIndex(m,w._indexStart,w._attributeStart/this.vertexSize)):(this.packAttributes(w,h,f,w._attributeStart,w._textureId),this.packIndex(w,m,w._indexStart,w._attributeStart/this.vertexSize))}o.count>0&&(this._finishBatch(s,v,y-v,o,u,c,e,x),v=y,++Uo),this.elementStart=this.elementSize,this._batchIndexStart=v,this._batchIndexSize=y}_finishBatch(e,t,s,o,a,u,c,h){e.gpuBindGroup=null,e.bindGroup=null,e.action=h,e.batcher=this,e.textures=o,e.blendMode=a,e.topology=u,e.start=t,e.size=s,++Uo,this.batches[this.batchIndex++]=e,c.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){e*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(e*4)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const t=Math.max(e,this.attributeBuffer.size*2),s=new op(t);ap(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(e){const t=this.indexBuffer;let s=Math.max(e,t.length*1.5);s+=s%2;const o=s>65535?new Uint32Array(s):new Uint16Array(s);if(o.BYTES_PER_ELEMENT!==t.BYTES_PER_ELEMENT)for(let a=0;a<t.length;a++)o[a]=t[a];else ap(t.buffer,o.buffer);this.indexBuffer=o}packQuadIndex(e,t,s){e[t]=s+0,e[t+1]=s+1,e[t+2]=s+2,e[t+3]=s+0,e[t+4]=s+2,e[t+5]=s+3}packIndex(e,t,s,o){const a=e.indices,u=e.indexSize,c=e.indexOffset,h=e.attributeOffset;for(let f=0;f<u;f++)t[s++]=o+a[f+c]-h}destroy(e={}){var t;if(this.batches!==null){for(let s=0;s<this.batches.length;s++)cp(this.batches[s]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,e.shader&&((t=this.shader)==null||t.destroy(),this.shader=null);for(let s=0;s<this._elements.length;s++)this._elements[s]&&(this._elements[s]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};em.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let g6=em;var fn=(r=>(r[r.MAP_READ=1]="MAP_READ",r[r.MAP_WRITE=2]="MAP_WRITE",r[r.COPY_SRC=4]="COPY_SRC",r[r.COPY_DST=8]="COPY_DST",r[r.INDEX=16]="INDEX",r[r.VERTEX=32]="VERTEX",r[r.UNIFORM=64]="UNIFORM",r[r.STORAGE=128]="STORAGE",r[r.INDIRECT=256]="INDIRECT",r[r.QUERY_RESOLVE=512]="QUERY_RESOLVE",r[r.STATIC=1024]="STATIC",r))(fn||{});class la extends qn{constructor(e){let{data:t,size:s}=e;const{usage:o,label:a,shrinkToFit:u}=e;super(),this.uid=xt("buffer"),this._resourceType="buffer",this._resourceId=xt("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,s??(s=t==null?void 0:t.byteLength);const c=!!t;this.descriptor={size:s,usage:o,mappedAtCreation:c,label:a},this.shrinkToFit=u??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&fn.STATIC)}set static(e){e?this.descriptor.usage|=fn.STATIC:this.descriptor.usage&=~fn.STATIC}setDataWithSize(e,t,s){if(this._updateID++,this._updateSize=t*e.BYTES_PER_ELEMENT,this._data===e){s&&this.emit("update",this);return}const o=this._data;if(this._data=e,this._dataInt32=null,!o||o.length!==e.length){!this.shrinkToFit&&o&&e.byteLength<o.byteLength?s&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=xt("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function nm(r,e){if(!(r instanceof la)){let t=e?fn.INDEX:fn.VERTEX;r instanceof Array&&(e?(r=new Uint32Array(r),t=fn.INDEX|fn.COPY_DST):(r=new Float32Array(r),t=fn.VERTEX|fn.COPY_DST)),r=new la({data:r,label:e?"index-mesh-buffer":"vertex-mesh-buffer",usage:t})}return r}function y6(r,e,t){const s=r.getAttribute(e);if(!s)return t.minX=0,t.minY=0,t.maxX=0,t.maxY=0,t;const o=s.buffer.data;let a=1/0,u=1/0,c=-1/0,h=-1/0;const f=o.BYTES_PER_ELEMENT,m=(s.offset||0)/f,y=(s.stride||8)/f;for(let v=m;v<o.length;v+=y){const x=o[v],b=o[v+1];x>c&&(c=x),b>h&&(h=b),x<a&&(a=x),b<u&&(u=b)}return t.minX=a,t.minY=u,t.maxX=c,t.maxY=h,t}function x6(r){return(r instanceof la||Array.isArray(r)||r.BYTES_PER_ELEMENT)&&(r={buffer:r}),r.buffer=nm(r.buffer,!1),r}class v6 extends qn{constructor(e={}){super(),this.uid=xt("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Xn,this._boundsDirty=!0;const{attributes:t,indexBuffer:s,topology:o}=e;if(this.buffers=[],this.attributes={},t)for(const a in t)this.addAttribute(a,t[a]);this.instanceCount=e.instanceCount??1,s&&this.addIndex(s),this.topology=o||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}addAttribute(e,t){const s=x6(t);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=s}addIndex(e){this.indexBuffer=nm(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,y6(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){var t;this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(s=>s.destroy()),(t=this.indexBuffer)==null||t.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const _6=new Float32Array(1),w6=new Uint32Array(1);class b6 extends v6{constructor(){const t=new la({data:_6,label:"attribute-batch-buffer",usage:fn.VERTEX|fn.COPY_DST,shrinkToFit:!1}),s=new la({data:w6,label:"index-batch-buffer",usage:fn.INDEX|fn.COPY_DST,shrinkToFit:!1}),o=24;super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:o,offset:0},aUV:{buffer:t,format:"float32x2",stride:o,offset:8},aColor:{buffer:t,format:"unorm8x4",stride:o,offset:16},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:o,offset:20}},indexBuffer:s})}}function dp(r,e,t){if(r)for(const s in r){const o=s.toLocaleLowerCase(),a=e[o];if(a){let u=r[s];s==="header"&&(u=u.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),t&&a.push(`//----${t}----//`),a.push(u)}else at(`${s} placement hook does not exist in shader`)}}const S6=/\{\{(.*?)\}\}/g;function hp(r){var s;const e={};return(((s=r.match(S6))==null?void 0:s.map(o=>o.replace(/[{()}]/g,"")))??[]).forEach(o=>{e[o]=[]}),e}function fp(r,e){let t;const s=/@in\s+([^;]+);/g;for(;(t=s.exec(r))!==null;)e.push(t[1])}function pp(r,e,t=!1){const s=[];fp(e,s),r.forEach(c=>{c.header&&fp(c.header,s)});const o=s;t&&o.sort();const a=o.map((c,h)=>`       @location(${h}) ${c},`).join(`
`);let u=e.replace(/@in\s+[^;]+;\s*/g,"");return u=u.replace("{{in}}",`
${a}
`),u}function mp(r,e){let t;const s=/@out\s+([^;]+);/g;for(;(t=s.exec(r))!==null;)e.push(t[1])}function k6(r){const t=/\b(\w+)\s*:/g.exec(r);return t?t[1]:""}function C6(r){const e=/@.*?\s+/g;return r.replace(e,"")}function A6(r,e){const t=[];mp(e,t),r.forEach(h=>{h.header&&mp(h.header,t)});let s=0;const o=t.sort().map(h=>h.indexOf("builtin")>-1?h:`@location(${s++}) ${h}`).join(`,
`),a=t.sort().map(h=>`       var ${C6(h)};`).join(`
`),u=`return VSOutput(
            ${t.sort().map(h=>` ${k6(h)}`).join(`,
`)});`;let c=e.replace(/@out\s+[^;]+;\s*/g,"");return c=c.replace("{{struct}}",`
${o}
`),c=c.replace("{{start}}",`
${a}
`),c=c.replace("{{return}}",`
${u}
`),c}function gp(r,e){let t=r;for(const s in e){const o=e[s];o.join(`
`).length?t=t.replace(`{{${s}}}`,`//-----${s} START-----//
${o.join(`
`)}
//----${s} FINISH----//`):t=t.replace(`{{${s}}}`,"")}return t}const ui=Object.create(null),pd=new Map;let T6=0;function P6({template:r,bits:e}){const t=rm(r,e);if(ui[t])return ui[t];const{vertex:s,fragment:o}=E6(r,e);return ui[t]=im(s,o,e),ui[t]}function M6({template:r,bits:e}){const t=rm(r,e);return ui[t]||(ui[t]=im(r.vertex,r.fragment,e)),ui[t]}function E6(r,e){const t=e.map(u=>u.vertex).filter(u=>!!u),s=e.map(u=>u.fragment).filter(u=>!!u);let o=pp(t,r.vertex,!0);o=A6(t,o);const a=pp(s,r.fragment,!0);return{vertex:o,fragment:a}}function rm(r,e){return e.map(t=>(pd.has(t)||pd.set(t,T6++),pd.get(t))).sort((t,s)=>t-s).join("-")+r.vertex+r.fragment}function im(r,e,t){const s=hp(r),o=hp(e);return t.forEach(a=>{dp(a.vertex,s,a.name),dp(a.fragment,o,a.name)}),{vertex:gp(r,s),fragment:gp(e,o)}}const R6=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,I6=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,L6=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,$6=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,z6={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},j6={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function F6({bits:r,name:e}){const t=P6({template:{fragment:I6,vertex:R6},bits:[z6,...r]});return uu.from({name:e,vertex:{source:t.vertex,entryPoint:"main"},fragment:{source:t.fragment,entryPoint:"main"}})}function B6({bits:r,name:e}){return new $0({name:e,...M6({template:{vertex:L6,fragment:$6},bits:[j6,...r]})})}const D6={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},O6={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},md={};function N6(r){const e=[];if(r===1)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let t=0;for(let s=0;s<r;s++)e.push(`@group(1) @binding(${t++}) var textureSource${s+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${t++}) var textureSampler${s+1}: sampler;`)}return e.join(`
`)}function W6(r){const e=[];if(r===1)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let t=0;t<r;t++)t===r-1?e.push("  default:{"):e.push(`  case ${t}:{`),e.push(`      outColor = textureSampleGrad(textureSource${t+1}, textureSampler${t+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join(`
`)}function H6(r){return md[r]||(md[r]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${N6(r)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${W6(r)}
            `}}),md[r]}const gd={};function U6(r){const e=[];for(let t=0;t<r;t++)t>0&&e.push("else"),t<r-1&&e.push(`if(vTextureId < ${t}.5)`),e.push("{"),e.push(`	outColor = texture(uTextures[${t}], vUV);`),e.push("}");return e.join(`
`)}function G6(r){return gd[r]||(gd[r]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${r}];

            `,main:`

                ${U6(r)}
            `}}),gd[r]}const V6={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Y6={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},yp={};function X6(r){let e=yp[r];if(e)return e;const t=new Int32Array(r);for(let s=0;s<r;s++)t[s]=s;return e=yp[r]=new B0({uTextures:{value:t,type:"i32",size:r}},{isStatic:!0}),e}class xp extends Jd{constructor(e){const t=B6({name:"batch",bits:[O6,G6(e),Y6]}),s=F6({name:"batch",bits:[D6,H6(e),V6]});super({glProgram:t,gpuProgram:s,resources:{batchSamplers:X6(e)}}),this.maxTextures=e}}let Go=null;const sm=class om extends g6{constructor(e){super(e),this.geometry=new b6,this.name=om.extension.name,this.vertexSize=6,Go??(Go=new xp(e.maxTextures)),this.shader=Go}packAttributes(e,t,s,o,a){const u=a<<16|e.roundPixels&65535,c=e.transform,h=c.a,f=c.b,m=c.c,y=c.d,v=c.tx,x=c.ty,{positions:b,uvs:S}=e,w=e.color,A=e.attributeOffset,E=A+e.attributeSize;for(let P=A;P<E;P++){const M=P*2,D=b[M],z=b[M+1];t[o++]=h*D+m*z+v,t[o++]=y*z+f*D+x,t[o++]=S[M],t[o++]=S[M+1],s[o++]=w,s[o++]=u}}packQuadAttributes(e,t,s,o,a){const u=e.texture,c=e.transform,h=c.a,f=c.b,m=c.c,y=c.d,v=c.tx,x=c.ty,b=e.bounds,S=b.maxX,w=b.minX,A=b.maxY,E=b.minY,P=u.uvs,M=e.color,D=a<<16|e.roundPixels&65535;t[o+0]=h*w+m*E+v,t[o+1]=y*E+f*w+x,t[o+2]=P.x0,t[o+3]=P.y0,s[o+4]=M,s[o+5]=D,t[o+6]=h*S+m*E+v,t[o+7]=y*E+f*S+x,t[o+8]=P.x1,t[o+9]=P.y1,s[o+10]=M,s[o+11]=D,t[o+12]=h*S+m*A+v,t[o+13]=y*A+f*S+x,t[o+14]=P.x2,t[o+15]=P.y2,s[o+16]=M,s[o+17]=D,t[o+18]=h*w+m*A+v,t[o+19]=y*A+f*w+x,t[o+20]=P.x3,t[o+21]=P.y3,s[o+22]=M,s[o+23]=D}_updateMaxTextures(e){this.shader.maxTextures!==e&&(Go=new xp(e),this.shader=Go)}destroy(){this.shader=null,super.destroy()}};sm.extension={type:[ve.Batcher],name:"default"};let q6=sm;function K6(r,e,t,s,o,a,u,c=null){let h=0;t*=e,o*=a;const f=c.a,m=c.b,y=c.c,v=c.d,x=c.tx,b=c.ty;for(;h<u;){const S=r[t],w=r[t+1];s[o]=f*S+y*w+x,s[o+1]=m*S+v*w+b,o+=a,t+=e,h++}}function Q6(r,e,t,s){let o=0;for(e*=t;o<s;)r[e]=0,r[e+1]=0,e+=t,o++}function am(r,e,t,s,o){const a=e.a,u=e.b,c=e.c,h=e.d,f=e.tx,m=e.ty;t||(t=0),s||(s=2),o||(o=r.length/s-t);let y=t*s;for(let v=0;v<o;v++){const x=r[y],b=r[y+1];r[y]=a*x+c*b+f,r[y+1]=u*x+h*b+m,y+=s}}const Z6=new je;class lm{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,t=e>>16|e&65280|(e&255)<<16,s=this.renderable;return s?h0(t,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):t+(this.alpha*255<<24)}get transform(){var e;return((e=this.renderable)==null?void 0:e.groupTransform)||Z6}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const ua={extension:{type:ve.ShapeBuilder,name:"circle"},build(r,e){let t,s,o,a,u,c;if(r.type==="circle"){const M=r;if(u=c=M.radius,u<=0)return!1;t=M.x,s=M.y,o=a=0}else if(r.type==="ellipse"){const M=r;if(u=M.halfWidth,c=M.halfHeight,u<=0||c<=0)return!1;t=M.x,s=M.y,o=a=0}else{const M=r,D=M.width/2,z=M.height/2;t=M.x+D,s=M.y+z,u=c=Math.max(0,Math.min(M.radius,Math.min(D,z))),o=D-u,a=z-c}if(o<0||a<0)return!1;const h=Math.ceil(2.3*Math.sqrt(u+c)),f=h*8+(o?4:0)+(a?4:0);if(f===0)return!1;if(h===0)return e[0]=e[6]=t+o,e[1]=e[3]=s+a,e[2]=e[4]=t-o,e[5]=e[7]=s-a,!0;let m=0,y=h*4+(o?2:0)+2,v=y,x=f,b=o+u,S=a,w=t+b,A=t-b,E=s+S;if(e[m++]=w,e[m++]=E,e[--y]=E,e[--y]=A,a){const M=s-S;e[v++]=A,e[v++]=M,e[--x]=M,e[--x]=w}for(let M=1;M<h;M++){const D=Math.PI/2*(M/h),z=o+Math.cos(D)*u,L=a+Math.sin(D)*c,G=t+z,H=t-z,W=s+L,Y=s-L;e[m++]=G,e[m++]=W,e[--y]=W,e[--y]=H,e[v++]=H,e[v++]=Y,e[--x]=Y,e[--x]=G}b=o,S=a+c,w=t+b,A=t-b,E=s+S;const P=s-S;return e[m++]=w,e[m++]=E,e[--x]=P,e[--x]=w,o&&(e[m++]=A,e[m++]=E,e[--x]=P,e[--x]=A),!0},triangulate(r,e,t,s,o,a){if(r.length===0)return;let u=0,c=0;for(let m=0;m<r.length;m+=2)u+=r[m],c+=r[m+1];u/=r.length/2,c/=r.length/2;let h=s;e[h*t]=u,e[h*t+1]=c;const f=h++;for(let m=0;m<r.length;m+=2)e[h*t]=r[m],e[h*t+1]=r[m+1],m>0&&(o[a++]=h,o[a++]=f,o[a++]=h-1),h++;o[a++]=f+1,o[a++]=f,o[a++]=h-1}},J6={...ua,extension:{...ua.extension,name:"ellipse"}},e4={...ua,extension:{...ua.extension,name:"roundedRectangle"}},um=1e-4,vp=1e-4;function t4(r){const e=r.length;if(e<6)return 1;let t=0;for(let s=0,o=r[e-2],a=r[e-1];s<e;s+=2){const u=r[s],c=r[s+1];t+=(u-o)*(c+a),o=u,a=c}return t<0?-1:1}function _p(r,e,t,s,o,a,u,c){const h=r-t*o,f=e-s*o,m=r+t*a,y=e+s*a;let v,x;u?(v=s,x=-t):(v=-s,x=t);const b=h+v,S=f+x,w=m+v,A=y+x;return c.push(b,S),c.push(w,A),2}function Ni(r,e,t,s,o,a,u,c){const h=t-r,f=s-e;let m=Math.atan2(h,f),y=Math.atan2(o-r,a-e);c&&m<y?m+=Math.PI*2:!c&&m>y&&(y+=Math.PI*2);let v=m;const x=y-m,b=Math.abs(x),S=Math.sqrt(h*h+f*f),w=(15*b*Math.sqrt(S)/Math.PI>>0)+1,A=x/w;if(v+=A,c){u.push(r,e),u.push(t,s);for(let E=1,P=v;E<w;E++,P+=A)u.push(r,e),u.push(r+Math.sin(P)*S,e+Math.cos(P)*S);u.push(r,e),u.push(o,a)}else{u.push(t,s),u.push(r,e);for(let E=1,P=v;E<w;E++,P+=A)u.push(r+Math.sin(P)*S,e+Math.cos(P)*S),u.push(r,e);u.push(o,a),u.push(r,e)}return w*2}function n4(r,e,t,s,o,a){const u=um;if(r.length===0)return;const c=e;let h=c.alignment;if(e.alignment!==.5){let ne=t4(r);h=(h-.5)*ne+.5}const f=new Xt(r[0],r[1]),m=new Xt(r[r.length-2],r[r.length-1]),y=s,v=Math.abs(f.x-m.x)<u&&Math.abs(f.y-m.y)<u;if(y){r=r.slice(),v&&(r.pop(),r.pop(),m.set(r[r.length-2],r[r.length-1]));const ne=(f.x+m.x)*.5,ie=(m.y+f.y)*.5;r.unshift(ne,ie),r.push(ne,ie)}const x=o,b=r.length/2;let S=r.length;const w=x.length/2,A=c.width/2,E=A*A,P=c.miterLimit*c.miterLimit;let M=r[0],D=r[1],z=r[2],L=r[3],G=0,H=0,W=-(D-L),Y=M-z,ge=0,K=0,xe=Math.sqrt(W*W+Y*Y);W/=xe,Y/=xe,W*=A,Y*=A;const Be=h,ee=(1-Be)*2,te=Be*2;y||(c.cap==="round"?S+=Ni(M-W*(ee-te)*.5,D-Y*(ee-te)*.5,M-W*ee,D-Y*ee,M+W*te,D+Y*te,x,!0)+2:c.cap==="square"&&(S+=_p(M,D,W,Y,ee,te,!0,x))),x.push(M-W*ee,D-Y*ee),x.push(M+W*te,D+Y*te);for(let ne=1;ne<b-1;++ne){M=r[(ne-1)*2],D=r[(ne-1)*2+1],z=r[ne*2],L=r[ne*2+1],G=r[(ne+1)*2],H=r[(ne+1)*2+1],W=-(D-L),Y=M-z,xe=Math.sqrt(W*W+Y*Y),W/=xe,Y/=xe,W*=A,Y*=A,ge=-(L-H),K=z-G,xe=Math.sqrt(ge*ge+K*K),ge/=xe,K/=xe,ge*=A,K*=A;const ie=z-M,j=D-L,V=z-G,Se=H-L,Pe=ie*V+j*Se,Re=j*V-Se*ie,ke=Re<0;if(Math.abs(Re)<.001*Math.abs(Pe)){x.push(z-W*ee,L-Y*ee),x.push(z+W*te,L+Y*te),Pe>=0&&(c.join==="round"?S+=Ni(z,L,z-W*ee,L-Y*ee,z-ge*ee,L-K*ee,x,!1)+4:S+=2,x.push(z-ge*te,L-K*te),x.push(z+ge*ee,L+K*ee));continue}const We=(-W+M)*(-Y+L)-(-W+z)*(-Y+D),Fe=(-ge+G)*(-K+L)-(-ge+z)*(-K+H),Xe=(ie*Fe-V*We)/Re,vt=(Se*We-j*Fe)/Re,kn=(Xe-z)*(Xe-z)+(vt-L)*(vt-L),Dt=z+(Xe-z)*ee,en=L+(vt-L)*ee,mn=z-(Xe-z)*te,Cn=L-(vt-L)*te,Ki=Math.min(ie*ie+j*j,V*V+Se*Se),Ir=ke?ee:te,hi=Ki+Ir*Ir*E;kn<=hi?c.join==="bevel"||kn/E>P?(ke?(x.push(Dt,en),x.push(z+W*te,L+Y*te),x.push(Dt,en),x.push(z+ge*te,L+K*te)):(x.push(z-W*ee,L-Y*ee),x.push(mn,Cn),x.push(z-ge*ee,L-K*ee),x.push(mn,Cn)),S+=2):c.join==="round"?ke?(x.push(Dt,en),x.push(z+W*te,L+Y*te),S+=Ni(z,L,z+W*te,L+Y*te,z+ge*te,L+K*te,x,!0)+4,x.push(Dt,en),x.push(z+ge*te,L+K*te)):(x.push(z-W*ee,L-Y*ee),x.push(mn,Cn),S+=Ni(z,L,z-W*ee,L-Y*ee,z-ge*ee,L-K*ee,x,!1)+4,x.push(z-ge*ee,L-K*ee),x.push(mn,Cn)):(x.push(Dt,en),x.push(mn,Cn)):(x.push(z-W*ee,L-Y*ee),x.push(z+W*te,L+Y*te),c.join==="round"?ke?S+=Ni(z,L,z+W*te,L+Y*te,z+ge*te,L+K*te,x,!0)+2:S+=Ni(z,L,z-W*ee,L-Y*ee,z-ge*ee,L-K*ee,x,!1)+2:c.join==="miter"&&kn/E<=P&&(ke?(x.push(mn,Cn),x.push(mn,Cn)):(x.push(Dt,en),x.push(Dt,en)),S+=2),x.push(z-ge*ee,L-K*ee),x.push(z+ge*te,L+K*te),S+=2)}M=r[(b-2)*2],D=r[(b-2)*2+1],z=r[(b-1)*2],L=r[(b-1)*2+1],W=-(D-L),Y=M-z,xe=Math.sqrt(W*W+Y*Y),W/=xe,Y/=xe,W*=A,Y*=A,x.push(z-W*ee,L-Y*ee),x.push(z+W*te,L+Y*te),y||(c.cap==="round"?S+=Ni(z-W*(ee-te)*.5,L-Y*(ee-te)*.5,z-W*ee,L-Y*ee,z+W*te,L+Y*te,x,!1)+2:c.cap==="square"&&(S+=_p(z,L,W,Y,ee,te,!1,x)));const re=vp*vp;for(let ne=w;ne<S+w-2;++ne)M=x[ne*2],D=x[ne*2+1],z=x[(ne+1)*2],L=x[(ne+1)*2+1],G=x[(ne+2)*2],H=x[(ne+2)*2+1],!(Math.abs(M*(L-H)+z*(H-D)+G*(D-L))<re)&&a.push(ne,ne+1,ne+2)}function r4(r,e,t,s){const o=um;if(r.length===0)return;const a=r[0],u=r[1],c=r[r.length-2],h=r[r.length-1],f=e||Math.abs(a-c)<o&&Math.abs(u-h)<o,m=t,y=r.length/2,v=m.length/2;for(let x=0;x<y;x++)m.push(r[x*2]),m.push(r[x*2+1]);for(let x=0;x<y-1;x++)s.push(v+x,v+x+1);f&&s.push(v+y-1,v)}function cm(r,e,t,s,o,a,u){const c=H8(r,e,2);if(!c)return;for(let f=0;f<c.length;f+=3)a[u++]=c[f]+o,a[u++]=c[f+1]+o,a[u++]=c[f+2]+o;let h=o*s;for(let f=0;f<r.length;f+=2)t[h]=r[f],t[h+1]=r[f+1],h+=s}const i4=[],s4={extension:{type:ve.ShapeBuilder,name:"polygon"},build(r,e){for(let t=0;t<r.points.length;t++)e[t]=r.points[t];return!0},triangulate(r,e,t,s,o,a){cm(r,i4,e,t,s,o,a)}},o4={extension:{type:ve.ShapeBuilder,name:"rectangle"},build(r,e){const t=r,s=t.x,o=t.y,a=t.width,u=t.height;return a>0&&u>0?(e[0]=s,e[1]=o,e[2]=s+a,e[3]=o,e[4]=s+a,e[5]=o+u,e[6]=s,e[7]=o+u,!0):!1},triangulate(r,e,t,s,o,a){let u=0;s*=t,e[s+u]=r[0],e[s+u+1]=r[1],u+=t,e[s+u]=r[2],e[s+u+1]=r[3],u+=t,e[s+u]=r[6],e[s+u+1]=r[7],u+=t,e[s+u]=r[4],e[s+u+1]=r[5],u+=t;const c=s/t;o[a++]=c,o[a++]=c+1,o[a++]=c+2,o[a++]=c+1,o[a++]=c+3,o[a++]=c+2}},a4={extension:{type:ve.ShapeBuilder,name:"triangle"},build(r,e){return e[0]=r.x,e[1]=r.y,e[2]=r.x2,e[3]=r.y2,e[4]=r.x3,e[5]=r.y3,!0},triangulate(r,e,t,s,o,a){let u=0;s*=t,e[s+u]=r[0],e[s+u+1]=r[1],u+=t,e[s+u]=r[2],e[s+u+1]=r[3],u+=t,e[s+u]=r[4],e[s+u+1]=r[5];const c=s/t;o[a++]=c,o[a++]=c+1,o[a++]=c+2}},l4=new je,u4=new ht;function c4(r,e,t,s){const o=e.matrix?r.copyFrom(e.matrix).invert():r.identity();if(e.textureSpace==="local"){const u=t.getBounds(u4);e.width&&u.pad(e.width);const{x:c,y:h}=u,f=1/u.width,m=1/u.height,y=-c*f,v=-h*m,x=o.a,b=o.b,S=o.c,w=o.d;o.a*=f,o.b*=f,o.c*=m,o.d*=m,o.tx=y*x+v*S+o.tx,o.ty=y*b+v*w+o.ty}else o.translate(e.texture.frame.x,e.texture.frame.y),o.scale(1/e.texture.source.width,1/e.texture.source.height);const a=e.texture.source.style;return!(e.fill instanceof Rr)&&a.addressMode==="clamp-to-edge"&&(a.addressMode="repeat",a.update()),s&&o.append(l4.copyFrom(s).invert()),o}const du={};Bt.handleByMap(ve.ShapeBuilder,du);Bt.add(o4,s4,a4,ua,J6,e4);const d4=new ht,h4=new je;function f4(r,e){const{geometryData:t,batches:s}=e;s.length=0,t.indices.length=0,t.vertices.length=0,t.uvs.length=0;for(let o=0;o<r.instructions.length;o++){const a=r.instructions[o];if(a.action==="texture")p4(a.data,s,t);else if(a.action==="fill"||a.action==="stroke"){const u=a.action==="stroke",c=a.data.path.shapePath,h=a.data.style,f=a.data.hole;u&&f&&wp(f.shapePath,h,!0,s,t),f&&(c.shapePrimitives[c.shapePrimitives.length-1].holes=f.shapePath.shapePrimitives),wp(c,h,u,s,t)}}}function p4(r,e,t){const s=[],o=du.rectangle,a=d4;a.x=r.dx,a.y=r.dy,a.width=r.dw,a.height=r.dh;const u=r.transform;if(!o.build(a,s))return;const{vertices:c,uvs:h,indices:f}=t,m=f.length,y=c.length/2;u&&am(s,u),o.triangulate(s,c,2,y,f,m);const v=r.image,x=v.uvs;h.push(x.x0,x.y0,x.x1,x.y1,x.x3,x.y3,x.x2,x.y2);const b=Dn.get(lm);b.indexOffset=m,b.indexSize=f.length-m,b.attributeOffset=y,b.attributeSize=c.length/2-y,b.baseColor=r.style,b.alpha=r.alpha,b.texture=v,b.geometryData=t,e.push(b)}function wp(r,e,t,s,o){const{vertices:a,uvs:u,indices:c}=o;r.shapePrimitives.forEach(({shape:h,transform:f,holes:m})=>{const y=[],v=du[h.type];if(!v.build(h,y))return;const x=c.length,b=a.length/2;let S="triangle-list";if(f&&am(y,f),t){const P=h.closePath??!0,M=e;M.pixelLine?(r4(y,P,a,c),S="line-list"):n4(y,M,!1,P,a,c)}else if(m){const P=[],M=y.slice();m4(m).forEach(z=>{P.push(M.length/2),M.push(...z)}),cm(M,P,a,2,b,c,x)}else v.triangulate(y,a,2,b,c,x);const w=u.length/2,A=e.texture;if(A!==Ne.WHITE){const P=c4(h4,e,h,f);K6(a,2,b,u,w,2,a.length/2-b,P)}else Q6(u,w,2,a.length/2-b);const E=Dn.get(lm);E.indexOffset=x,E.indexSize=c.length-x,E.attributeOffset=b,E.attributeSize=a.length/2-b,E.baseColor=e.color,E.alpha=e.alpha,E.texture=A,E.geometryData=o,E.topology=S,s.push(E)})}function m4(r){const e=[];for(let t=0;t<r.length;t++){const s=r[t].shape,o=[];du[s.type].build(s,o)&&e.push(o)}return e}class g4{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class y4{constructor(){this.instructions=new g0}init(e){const t=e.maxTextures;this.batcher?this.batcher._updateMaxTextures(t):this.batcher=new q6({maxTextures:t}),this.instructions.reset()}get geometry(){return $e(p5,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const ih=class Od{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(e){Od.defaultOptions.bezierSmoothness=(e==null?void 0:e.bezierSmoothness)??Od.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let t=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){t?this._cleanGraphicsContextData(e):t=this._initContext(e),f4(e,t);const s=e.batchMode;e.customShader||s==="no-batch"?t.isBatchable=!1:s==="auto"?t.isBatchable=t.geometryData.vertices.length<400:t.isBatchable=!0,e.dirty=!1}return t}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const t=Dn.get(y4,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:s,geometryData:o}=this._gpuContextHash[e.uid],a=o.vertices.length,u=o.indices.length;for(let m=0;m<s.length;m++)s[m].applyTransform=!1;const c=t.batcher;c.ensureAttributeBuffer(a),c.ensureIndexBuffer(u),c.begin();for(let m=0;m<s.length;m++){const y=s[m];c.add(y)}c.finish(t.instructions);const h=c.geometry;h.indexBuffer.setDataWithSize(c.indexBuffer,c.indexSize,!0),h.buffers[0].setDataWithSize(c.attributeBuffer.float32View,c.attributeSize,!0);const f=c.batches;for(let m=0;m<f.length;m++){const y=f[m];y.bindGroup=o6(y.textures.textures,y.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[e.uid]=t,t}_initContext(e){const t=new g4;return t.context=e,this._gpuContextHash[e.uid]=t,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const t=this._gpuContextHash[e.uid];t.isBatchable||this._graphicsDataContextHash[e.uid]&&(Dn.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),t.batches&&t.batches.forEach(s=>{Dn.return(s)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context);this._gpuContextHash={},this._graphicsDataContextHash={},this._renderer=null}};ih.extension={type:[ve.WebGLSystem,ve.WebGPUSystem,ve.CanvasSystem],name:"graphicsContext"};ih.defaultOptions={bezierSmoothness:.5};let dm=ih;const x4=8,Hl=11920929e-14,v4=1;function hm(r,e,t,s,o,a,u,c,h,f){const y=Math.min(.99,Math.max(0,f??dm.defaultOptions.bezierSmoothness));let v=(v4-y)/1;return v*=v,_4(e,t,s,o,a,u,c,h,r,v),r}function _4(r,e,t,s,o,a,u,c,h,f){Nd(r,e,t,s,o,a,u,c,h,f,0),h.push(u,c)}function Nd(r,e,t,s,o,a,u,c,h,f,m){if(m>x4)return;const y=(r+t)/2,v=(e+s)/2,x=(t+o)/2,b=(s+a)/2,S=(o+u)/2,w=(a+c)/2,A=(y+x)/2,E=(v+b)/2,P=(x+S)/2,M=(b+w)/2,D=(A+P)/2,z=(E+M)/2;if(m>0){let L=u-r,G=c-e;const H=Math.abs((t-u)*G-(s-c)*L),W=Math.abs((o-u)*G-(a-c)*L);if(H>Hl&&W>Hl){if((H+W)*(H+W)<=f*(L*L+G*G)){h.push(D,z);return}}else if(H>Hl){if(H*H<=f*(L*L+G*G)){h.push(D,z);return}}else if(W>Hl){if(W*W<=f*(L*L+G*G)){h.push(D,z);return}}else if(L=D-(r+u)/2,G=z-(e+c)/2,L*L+G*G<=f){h.push(D,z);return}}Nd(r,e,y,v,A,E,D,z,h,f,m+1),Nd(D,z,P,M,S,w,u,c,h,f,m+1)}const w4=8,b4=11920929e-14,S4=1;function k4(r,e,t,s,o,a,u,c){const f=Math.min(.99,Math.max(0,c??dm.defaultOptions.bezierSmoothness));let m=(S4-f)/1;return m*=m,C4(e,t,s,o,a,u,r,m),r}function C4(r,e,t,s,o,a,u,c){Wd(u,r,e,t,s,o,a,c,0),u.push(o,a)}function Wd(r,e,t,s,o,a,u,c,h){if(h>w4)return;const f=(e+s)/2,m=(t+o)/2,y=(s+a)/2,v=(o+u)/2,x=(f+y)/2,b=(m+v)/2;let S=a-e,w=u-t;const A=Math.abs((s-a)*w-(o-u)*S);if(A>b4){if(A*A<=c*(S*S+w*w)){r.push(x,b);return}}else if(S=x-(e+a)/2,w=b-(t+u)/2,S*S+w*w<=c){r.push(x,b);return}Wd(r,e,t,f,m,x,b,c,h+1),Wd(r,x,b,y,v,a,u,c,h+1)}function fm(r,e,t,s,o,a,u,c){let h=Math.abs(o-a);(!u&&o>a||u&&a>o)&&(h=2*Math.PI-h),c||(c=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(h/Math.PI)))),c=Math.max(c,3);let f=h/c,m=o;f*=u?-1:1;for(let y=0;y<c+1;y++){const v=Math.cos(m),x=Math.sin(m),b=e+v*s,S=t+x*s;r.push(b,S),m+=f}}function A4(r,e,t,s,o,a){const u=r[r.length-2],h=r[r.length-1]-t,f=u-e,m=o-t,y=s-e,v=Math.abs(h*y-f*m);if(v<1e-8||a===0){(r[r.length-2]!==e||r[r.length-1]!==t)&&r.push(e,t);return}const x=h*h+f*f,b=m*m+y*y,S=h*m+f*y,w=a*Math.sqrt(x)/v,A=a*Math.sqrt(b)/v,E=w*S/x,P=A*S/b,M=w*y+A*f,D=w*m+A*h,z=f*(A+E),L=h*(A+E),G=y*(w+P),H=m*(w+P),W=Math.atan2(L-D,z-M),Y=Math.atan2(H-D,G-M);fm(r,M+e,D+t,a,W,Y,f*m>y*h)}const na=Math.PI*2,yd={centerX:0,centerY:0,ang1:0,ang2:0},xd=({x:r,y:e},t,s,o,a,u,c,h)=>{r*=t,e*=s;const f=o*r-a*e,m=a*r+o*e;return h.x=f+u,h.y=m+c,h};function T4(r,e){const t=e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),s=e===1.5707963267948966?.551915024494:t,o=Math.cos(r),a=Math.sin(r),u=Math.cos(r+e),c=Math.sin(r+e);return[{x:o-a*s,y:a+o*s},{x:u+c*s,y:c-u*s},{x:u,y:c}]}const bp=(r,e,t,s)=>{const o=r*s-e*t<0?-1:1;let a=r*t+e*s;return a>1&&(a=1),a<-1&&(a=-1),o*Math.acos(a)},P4=(r,e,t,s,o,a,u,c,h,f,m,y,v)=>{const x=Math.pow(o,2),b=Math.pow(a,2),S=Math.pow(m,2),w=Math.pow(y,2);let A=x*b-x*w-b*S;A<0&&(A=0),A/=x*w+b*S,A=Math.sqrt(A)*(u===c?-1:1);const E=A*o/a*y,P=A*-a/o*m,M=f*E-h*P+(r+t)/2,D=h*E+f*P+(e+s)/2,z=(m-E)/o,L=(y-P)/a,G=(-m-E)/o,H=(-y-P)/a,W=bp(1,0,z,L);let Y=bp(z,L,G,H);c===0&&Y>0&&(Y-=na),c===1&&Y<0&&(Y+=na),v.centerX=M,v.centerY=D,v.ang1=W,v.ang2=Y};function M4(r,e,t,s,o,a,u,c=0,h=0,f=0){if(a===0||u===0)return;const m=Math.sin(c*na/360),y=Math.cos(c*na/360),v=y*(e-s)/2+m*(t-o)/2,x=-m*(e-s)/2+y*(t-o)/2;if(v===0&&x===0)return;a=Math.abs(a),u=Math.abs(u);const b=Math.pow(v,2)/Math.pow(a,2)+Math.pow(x,2)/Math.pow(u,2);b>1&&(a*=Math.sqrt(b),u*=Math.sqrt(b)),P4(e,t,s,o,a,u,h,f,m,y,v,x,yd);let{ang1:S,ang2:w}=yd;const{centerX:A,centerY:E}=yd;let P=Math.abs(w)/(na/4);Math.abs(1-P)<1e-7&&(P=1);const M=Math.max(Math.ceil(P),1);w/=M;let D=r[r.length-2],z=r[r.length-1];const L={x:0,y:0};for(let G=0;G<M;G++){const H=T4(S,w),{x:W,y:Y}=xd(H[0],a,u,y,m,A,E,L),{x:ge,y:K}=xd(H[1],a,u,y,m,A,E,L),{x:xe,y:Be}=xd(H[2],a,u,y,m,A,E,L);hm(r,D,z,W,Y,ge,K,xe,Be),D=xe,z=Be,S+=w}}function E4(r,e,t){const s=(u,c)=>{const h=c.x-u.x,f=c.y-u.y,m=Math.sqrt(h*h+f*f),y=h/m,v=f/m;return{len:m,nx:y,ny:v}},o=(u,c)=>{u===0?r.moveTo(c.x,c.y):r.lineTo(c.x,c.y)};let a=e[e.length-1];for(let u=0;u<e.length;u++){const c=e[u%e.length],h=c.radius??t;if(h<=0){o(u,c),a=c;continue}const f=e[(u+1)%e.length],m=s(c,a),y=s(c,f);if(m.len<1e-4||y.len<1e-4){o(u,c),a=c;continue}let v=Math.asin(m.nx*y.ny-m.ny*y.nx),x=1,b=!1;m.nx*y.nx-m.ny*-y.ny<0?v<0?v=Math.PI+v:(v=Math.PI-v,x=-1,b=!0):v>0&&(x=-1,b=!0);const S=v/2;let w,A=Math.abs(Math.cos(S)*h/Math.sin(S));A>Math.min(m.len/2,y.len/2)?(A=Math.min(m.len/2,y.len/2),w=Math.abs(A*Math.sin(S)/Math.cos(S))):w=h;const E=c.x+y.nx*A+-y.ny*w*x,P=c.y+y.ny*A+y.nx*w*x,M=Math.atan2(m.ny,m.nx)+Math.PI/2*x,D=Math.atan2(y.ny,y.nx)-Math.PI/2*x;u===0&&r.moveTo(E+Math.cos(M)*w,P+Math.sin(M)*w),r.arc(E,P,w,M,D,b),a=c}}function R4(r,e,t,s){const o=(c,h)=>Math.sqrt((c.x-h.x)**2+(c.y-h.y)**2),a=(c,h,f)=>({x:c.x+(h.x-c.x)*f,y:c.y+(h.y-c.y)*f}),u=e.length;for(let c=0;c<u;c++){const h=e[(c+1)%u],f=h.radius??t;if(f<=0){c===0?r.moveTo(h.x,h.y):r.lineTo(h.x,h.y);continue}const m=e[c],y=e[(c+2)%u],v=o(m,h);let x;if(v<1e-4)x=h;else{const w=Math.min(v/2,f);x=a(h,m,w/v)}const b=o(y,h);let S;if(b<1e-4)S=h;else{const w=Math.min(b/2,f);S=a(h,y,w/b)}c===0?r.moveTo(x.x,x.y):r.lineTo(x.x,x.y),r.quadraticCurveTo(h.x,h.y,S.x,S.y,s)}}const I4=new ht;class L4{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Xn,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,t){return this.startPoly(e,t),this}lineTo(e,t){this._ensurePoly();const s=this._currentPoly.points,o=s[s.length-2],a=s[s.length-1];return(o!==e||a!==t)&&s.push(e,t),this}arc(e,t,s,o,a,u){this._ensurePoly(!1);const c=this._currentPoly.points;return fm(c,e,t,s,o,a,u),this}arcTo(e,t,s,o,a){this._ensurePoly();const u=this._currentPoly.points;return A4(u,e,t,s,o,a),this}arcToSvg(e,t,s,o,a,u,c){const h=this._currentPoly.points;return M4(h,this._currentPoly.lastX,this._currentPoly.lastY,u,c,e,t,s,o,a),this}bezierCurveTo(e,t,s,o,a,u,c){this._ensurePoly();const h=this._currentPoly;return hm(this._currentPoly.points,h.lastX,h.lastY,e,t,s,o,a,u,c),this}quadraticCurveTo(e,t,s,o,a){this._ensurePoly();const u=this._currentPoly;return k4(this._currentPoly.points,u.lastX,u.lastY,e,t,s,o,a),this}closePath(){return this.endPoly(!0),this}addPath(e,t){this.endPoly(),t&&!t.isIdentity()&&(e=e.clone(!0),e.transform(t));const s=this.shapePrimitives,o=s.length;for(let a=0;a<e.instructions.length;a++){const u=e.instructions[a];this[u.action](...u.data)}if(e.checkForHoles&&s.length-o>1){let a=null;for(let u=o;u<s.length;u++){const c=s[u];if(c.shape.type==="polygon"){const h=c.shape,f=a==null?void 0:a.shape;f&&f.containsPolygon(h)?(a.holes||(a.holes=[]),a.holes.push(c),s.copyWithin(u,u+1),s.length--,u--):a=c}}}return this}finish(e=!1){this.endPoly(e)}rect(e,t,s,o,a){return this.drawShape(new ht(e,t,s,o),a),this}circle(e,t,s,o){return this.drawShape(new th(e,t,s),o),this}poly(e,t,s){const o=new ea(e);return o.closePath=t,this.drawShape(o,s),this}regularPoly(e,t,s,o,a=0,u){o=Math.max(o|0,3);const c=-1*Math.PI/2+a,h=Math.PI*2/o,f=[];for(let m=0;m<o;m++){const y=c-m*h;f.push(e+s*Math.cos(y),t+s*Math.sin(y))}return this.poly(f,!0,u),this}roundPoly(e,t,s,o,a,u=0,c){if(o=Math.max(o|0,3),a<=0)return this.regularPoly(e,t,s,o,u);const h=s*Math.sin(Math.PI/o)-.001;a=Math.min(a,h);const f=-1*Math.PI/2+u,m=Math.PI*2/o,y=(o-2)*Math.PI/o/2;for(let v=0;v<o;v++){const x=v*m+f,b=e+s*Math.cos(x),S=t+s*Math.sin(x),w=x+Math.PI+y,A=x-Math.PI-y,E=b+a*Math.cos(w),P=S+a*Math.sin(w),M=b+a*Math.cos(A),D=S+a*Math.sin(A);v===0?this.moveTo(E,P):this.lineTo(E,P),this.quadraticCurveTo(b,S,M,D,c)}return this.closePath()}roundShape(e,t,s=!1,o){return e.length<3?this:(s?R4(this,e,t,o):E4(this,e,t),this.closePath())}filletRect(e,t,s,o,a){if(a===0)return this.rect(e,t,s,o);const u=Math.min(s,o)/2,c=Math.min(u,Math.max(-u,a)),h=e+s,f=t+o,m=c<0?-c:0,y=Math.abs(c);return this.moveTo(e,t+y).arcTo(e+m,t+m,e+y,t,y).lineTo(h-y,t).arcTo(h-m,t+m,h,t+y,y).lineTo(h,f-y).arcTo(h-m,f-m,e+s-y,f,y).lineTo(e+y,f).arcTo(e+m,f-m,e,f-y,y).closePath()}chamferRect(e,t,s,o,a,u){if(a<=0)return this.rect(e,t,s,o);const c=Math.min(a,Math.min(s,o)/2),h=e+s,f=t+o,m=[e+c,t,h-c,t,h,t+c,h,f-c,h-c,f,e+c,f,e,f-c,e,t+c];for(let y=m.length-1;y>=2;y-=2)m[y]===m[y-2]&&m[y-1]===m[y-3]&&m.splice(y-1,2);return this.poly(m,!0,u)}ellipse(e,t,s,o,a){return this.drawShape(new nh(e,t,s,o),a),this}roundRect(e,t,s,o,a,u){return this.drawShape(new rh(e,t,s,o,a),u),this}drawShape(e,t){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:t}),this}startPoly(e,t){let s=this._currentPoly;return s&&this.endPoly(),s=new ea,s.points.push(e,t),this._currentPoly=s,this}endPoly(e=!1){const t=this._currentPoly;return t&&t.points.length>2&&(t.closePath=e,this.shapePrimitives.push({shape:t})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new ea,e)){const t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let s=t.shape.x,o=t.shape.y;if(t.transform&&!t.transform.isIdentity()){const a=t.transform,u=s;s=a.a*s+a.c*o+a.tx,o=a.b*u+a.d*o+a.ty}this._currentPoly.points.push(s,o)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let t=0;t<e.instructions.length;t++){const s=e.instructions[t];this[s.action](...s.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const t=this.shapePrimitives;for(let s=0;s<t.length;s++){const o=t[s],a=o.shape.getBounds(I4);o.transform?e.addRect(a,o.transform):e.addRect(a)}return e}}class Mr{constructor(e,t=!1){this.instructions=[],this.uid=xt("graphicsPath"),this._dirty=!0,this.checkForHoles=t,typeof e=="string"?n6(e,this):this.instructions=(e==null?void 0:e.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new L4(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,t){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,t]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,t,s,o,a){const u=this.instructions[this.instructions.length-1],c=this.getLastPoint(Xt.shared);let h=0,f=0;if(!u||u.action!=="bezierCurveTo")h=c.x,f=c.y;else{h=u.data[2],f=u.data[3];const m=c.x,y=c.y;h=m+(m-h),f=y+(y-f)}return this.instructions.push({action:"bezierCurveTo",data:[h,f,e,t,s,o,a]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,t,s){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(Xt.shared);let u=0,c=0;if(!o||o.action!=="quadraticCurveTo")u=a.x,c=a.y;else{u=o.data[0],c=o.data[1];const h=a.x,f=a.y;u=h+(h-u),c=f+(f-c)}return this.instructions.push({action:"quadraticCurveTo",data:[u,c,e,t,s]}),this._dirty=!0,this}rect(e,t,s,o,a){return this.instructions.push({action:"rect",data:[e,t,s,o,a]}),this._dirty=!0,this}circle(e,t,s,o){return this.instructions.push({action:"circle",data:[e,t,s,o]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,t,s,o,a,u,c){a||(a=o/2);const h=-1*Math.PI/2+u,f=s*2,m=Math.PI*2/f,y=[];for(let v=0;v<f;v++){const x=v%2?a:o,b=v*m+h;y.push(e+x*Math.cos(b),t+x*Math.sin(b))}return this.poly(y,!0,c),this}clone(e=!1){const t=new Mr;if(t.checkForHoles=this.checkForHoles,!e)t.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const o=this.instructions[s];t.instructions.push({action:o.action,data:o.data.slice()})}return t}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const t=e.a,s=e.b,o=e.c,a=e.d,u=e.tx,c=e.ty;let h=0,f=0,m=0,y=0,v=0,x=0,b=0,S=0;for(let w=0;w<this.instructions.length;w++){const A=this.instructions[w],E=A.data;switch(A.action){case"moveTo":case"lineTo":h=E[0],f=E[1],E[0]=t*h+o*f+u,E[1]=s*h+a*f+c;break;case"bezierCurveTo":m=E[0],y=E[1],v=E[2],x=E[3],h=E[4],f=E[5],E[0]=t*m+o*y+u,E[1]=s*m+a*y+c,E[2]=t*v+o*x+u,E[3]=s*v+a*x+c,E[4]=t*h+o*f+u,E[5]=s*h+a*f+c;break;case"quadraticCurveTo":m=E[0],y=E[1],h=E[2],f=E[3],E[0]=t*m+o*y+u,E[1]=s*m+a*y+c,E[2]=t*h+o*f+u,E[3]=s*h+a*f+c;break;case"arcToSvg":h=E[5],f=E[6],b=E[0],S=E[1],E[0]=t*b+o*S,E[1]=s*b+a*S,E[5]=t*h+o*f+u,E[6]=s*h+a*f+c;break;case"circle":E[4]=Vo(E[3],e);break;case"rect":E[4]=Vo(E[4],e);break;case"ellipse":E[8]=Vo(E[8],e);break;case"roundRect":E[5]=Vo(E[5],e);break;case"addPath":E[0].transform(e);break;case"poly":E[2]=Vo(E[2],e);break;default:at("unknown transform action",A.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let t=this.instructions.length-1,s=this.instructions[t];if(!s)return e.x=0,e.y=0,e;for(;s.action==="closePath";){if(t--,t<0)return e.x=0,e.y=0,e;s=this.instructions[t]}switch(s.action){case"moveTo":case"lineTo":e.x=s.data[0],e.y=s.data[1];break;case"quadraticCurveTo":e.x=s.data[2],e.y=s.data[3];break;case"bezierCurveTo":e.x=s.data[4],e.y=s.data[5];break;case"arc":case"arcToSvg":e.x=s.data[5],e.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(e);break}return e}}function Vo(r,e){return r?r.prepend(e):e.clone()}function yt(r,e,t){const s=r.getAttribute(e);return s?Number(s):t}function $4(r,e){const t=r.querySelectorAll("defs");for(let s=0;s<t.length;s++){const o=t[s];for(let a=0;a<o.children.length;a++){const u=o.children[a];switch(u.nodeName.toLowerCase()){case"lineargradient":e.defs[u.id]=z4(u);break;case"radialgradient":e.defs[u.id]=j4();break}}}}function z4(r){const e=yt(r,"x1",0),t=yt(r,"y1",0),s=yt(r,"x2",1),o=yt(r,"y2",0),a=r.getAttribute("gradientUnits")||"objectBoundingBox",u=new Rr(e,t,s,o,a==="objectBoundingBox"?"local":"global");for(let c=0;c<r.children.length;c++){const h=r.children[c],f=yt(h,"offset",0),m=St.shared.setValue(h.getAttribute("stop-color")).toNumber();u.addColorStop(f,m)}return u}function j4(r){return at("[SVG Parser] Radial gradients are not yet supported"),new Rr(0,0,1,0)}function Sp(r){const e=r.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}const kp={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function pm(r,e){const t=r.getAttribute("style"),s={},o={},a={strokeStyle:s,fillStyle:o,useFill:!1,useStroke:!1};for(const u in kp){const c=r.getAttribute(u);c&&Cp(e,a,u,c.trim())}if(t){const u=t.split(";");for(let c=0;c<u.length;c++){const h=u[c].trim(),[f,m]=h.split(":");kp[f]&&Cp(e,a,f,m.trim())}}return{strokeStyle:a.useStroke?s:null,fillStyle:a.useFill?o:null,useFill:a.useFill,useStroke:a.useStroke}}function Cp(r,e,t,s){switch(t){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const o=Sp(s);e.strokeStyle.fill=r.defs[o]}else e.strokeStyle.color=St.shared.setValue(s).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const o=Sp(s);e.fillStyle.fill=r.defs[o]}else e.fillStyle.color=St.shared.setValue(s).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(s);break;case"stroke-opacity":e.strokeStyle.alpha=Number(s);break;case"opacity":e.fillStyle.alpha=Number(s),e.strokeStyle.alpha=Number(s);break}}function F4(r){if(r.length<=2)return!0;const e=r.map(c=>c.area).sort((c,h)=>h-c),[t,s]=e,o=e[e.length-1],a=t/s,u=s/o;return!(a>3&&u<2)}function B4(r){return r.split(/(?=[Mm])/).filter(s=>s.trim().length>0)}function D4(r){const e=r.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!e||e.length<4)return 0;const t=e.map(Number),s=[],o=[];for(let m=0;m<t.length;m+=2)m+1<t.length&&(s.push(t[m]),o.push(t[m+1]));if(s.length===0||o.length===0)return 0;const a=Math.min(...s),u=Math.max(...s),c=Math.min(...o),h=Math.max(...o);return(u-a)*(h-c)}function Ap(r,e){const t=new Mr(r,!1);for(const s of t.instructions)e.instructions.push(s)}function O4(r,e){if(typeof r=="string"){const u=document.createElement("div");u.innerHTML=r.trim(),r=u.querySelector("svg")}const t={context:e,defs:{},path:new Mr};$4(r,t);const s=r.children,{fillStyle:o,strokeStyle:a}=pm(r,t);for(let u=0;u<s.length;u++){const c=s[u];c.nodeName.toLowerCase()!=="defs"&&mm(c,t,o,a)}return e}function mm(r,e,t,s){const o=r.children,{fillStyle:a,strokeStyle:u}=pm(r,e);a&&t?t={...t,...a}:a&&(t=a),u&&s?s={...s,...u}:u&&(s=u);const c=!t&&!s;c&&(t={color:0});let h,f,m,y,v,x,b,S,w,A,E,P,M,D,z,L,G;switch(r.nodeName.toLowerCase()){case"path":{D=r.getAttribute("d");const H=r.getAttribute("fill-rule"),W=B4(D),Y=H==="evenodd",ge=W.length>1;if(Y&&ge){const xe=W.map(ee=>({path:ee,area:D4(ee)}));if(xe.sort((ee,te)=>te.area-ee.area),W.length>3||!F4(xe))for(let ee=0;ee<xe.length;ee++){const te=xe[ee],re=ee===0;e.context.beginPath();const ne=new Mr(void 0,!0);Ap(te.path,ne),e.context.path(ne),re?(t&&e.context.fill(t),s&&e.context.stroke(s)):e.context.cut()}else for(let ee=0;ee<xe.length;ee++){const te=xe[ee],re=ee%2===1;e.context.beginPath();const ne=new Mr(void 0,!0);Ap(te.path,ne),e.context.path(ne),re?e.context.cut():(t&&e.context.fill(t),s&&e.context.stroke(s))}}else{const xe=H?H==="evenodd":!0;z=new Mr(D,xe),e.context.path(z),t&&e.context.fill(t),s&&e.context.stroke(s)}break}case"circle":b=yt(r,"cx",0),S=yt(r,"cy",0),w=yt(r,"r",0),e.context.ellipse(b,S,w,w),t&&e.context.fill(t),s&&e.context.stroke(s);break;case"rect":h=yt(r,"x",0),f=yt(r,"y",0),L=yt(r,"width",0),G=yt(r,"height",0),A=yt(r,"rx",0),E=yt(r,"ry",0),A||E?e.context.roundRect(h,f,L,G,A||E):e.context.rect(h,f,L,G),t&&e.context.fill(t),s&&e.context.stroke(s);break;case"ellipse":b=yt(r,"cx",0),S=yt(r,"cy",0),A=yt(r,"rx",0),E=yt(r,"ry",0),e.context.beginPath(),e.context.ellipse(b,S,A,E),t&&e.context.fill(t),s&&e.context.stroke(s);break;case"line":m=yt(r,"x1",0),y=yt(r,"y1",0),v=yt(r,"x2",0),x=yt(r,"y2",0),e.context.beginPath(),e.context.moveTo(m,y),e.context.lineTo(v,x),s&&e.context.stroke(s);break;case"polygon":M=r.getAttribute("points"),P=M.match(/\d+/g).map(H=>parseInt(H,10)),e.context.poly(P,!0),t&&e.context.fill(t),s&&e.context.stroke(s);break;case"polyline":M=r.getAttribute("points"),P=M.match(/\d+/g).map(H=>parseInt(H,10)),e.context.poly(P,!1),s&&e.context.stroke(s);break;case"g":case"svg":break;default:{at(`[SVG parser] <${r.nodeName}> elements unsupported`);break}}c&&(t=null);for(let H=0;H<o.length;H++)mm(o[H],e,t,s)}function N4(r){return St.isColorLike(r)}function Tp(r){return r instanceof cu}function Pp(r){return r instanceof Rr}function W4(r){return r instanceof Ne}function H4(r,e,t){const s=St.shared.setValue(e??0);return r.color=s.toNumber(),r.alpha=s.alpha===1?t.alpha:s.alpha,r.texture=Ne.WHITE,{...t,...r}}function U4(r,e,t){return r.texture=e,{...t,...r}}function Mp(r,e,t){return r.fill=e,r.color=16777215,r.texture=e.texture,r.matrix=e.transform,{...t,...r}}function Ep(r,e,t){return e.buildGradient(),r.fill=e,r.color=16777215,r.texture=e.texture,r.matrix=e.transform,r.textureSpace=e.textureSpace,{...t,...r}}function G4(r,e){const t={...e,...r},s=St.shared.setValue(t.color);return t.alpha*=s.alpha,t.color=s.toNumber(),t}function Yi(r,e){if(r==null)return null;const t={},s=r;return N4(r)?H4(t,r,e):W4(r)?U4(t,r,e):Tp(r)?Mp(t,r,e):Pp(r)?Ep(t,r,e):s.fill&&Tp(s.fill)?Mp(s,s.fill,e):s.fill&&Pp(s.fill)?Ep(s,s.fill,e):G4(s,e)}function ou(r,e){const{width:t,alignment:s,miterLimit:o,cap:a,join:u,pixelLine:c,...h}=e,f=Yi(r,h);return f?{width:t,alignment:s,miterLimit:o,cap:a,join:u,pixelLine:c,...f}:null}const V4=new Xt,Rp=new je,sh=class lr extends qn{constructor(){super(...arguments),this.uid=xt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Mr,this._transform=new je,this._fillStyle={...lr.defaultFillStyle},this._strokeStyle={...lr.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Xn,this._boundsDirty=!0}clone(){const e=new lr;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Yi(e,lr.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=ou(e,lr.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Yi(e,lr.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Yi(e,lr.defaultStrokeStyle),this}texture(e,t,s,o,a,u){return this.instructions.push({action:"texture",data:{image:e,dx:s||0,dy:o||0,dw:a||e.frame.width,dh:u||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t?St.shared.setValue(t).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Mr,this}fill(e,t){let s;const o=this.instructions[this.instructions.length-1];return this._tick===0&&(o==null?void 0:o.action)==="stroke"?s=o.data.path:s=this._activePath.clone(),s?(e!=null&&(t!==void 0&&typeof e=="number"&&($e(Ke,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:t}),this._fillStyle=Yi(e,lr.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:t}=this._activePath.getLastPoint(Xt.shared);this._activePath.clear(),this._activePath.moveTo(e,t)}stroke(e){let t;const s=this.instructions[this.instructions.length-1];return this._tick===0&&(s==null?void 0:s.action)==="fill"?t=s.data.path:t=this._activePath.clone(),t?(e!=null&&(this._strokeStyle=ou(e,lr.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:t}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const t=this.instructions[this.instructions.length-1-e],s=this._activePath.clone();if(t&&(t.action==="stroke"||t.action==="fill"))if(t.data.hole)t.data.hole.addPath(s);else{t.data.hole=s;break}}return this._initNextPathLocation(),this}arc(e,t,s,o,a,u){this._tick++;const c=this._transform;return this._activePath.arc(c.a*e+c.c*t+c.tx,c.b*e+c.d*t+c.ty,s,o,a,u),this}arcTo(e,t,s,o,a){this._tick++;const u=this._transform;return this._activePath.arcTo(u.a*e+u.c*t+u.tx,u.b*e+u.d*t+u.ty,u.a*s+u.c*o+u.tx,u.b*s+u.d*o+u.ty,a),this}arcToSvg(e,t,s,o,a,u,c){this._tick++;const h=this._transform;return this._activePath.arcToSvg(e,t,s,o,a,h.a*u+h.c*c+h.tx,h.b*u+h.d*c+h.ty),this}bezierCurveTo(e,t,s,o,a,u,c){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*e+h.c*t+h.tx,h.b*e+h.d*t+h.ty,h.a*s+h.c*o+h.tx,h.b*s+h.d*o+h.ty,h.a*a+h.c*u+h.tx,h.b*a+h.d*u+h.ty,c),this}closePath(){var e;return this._tick++,(e=this._activePath)==null||e.closePath(),this}ellipse(e,t,s,o){return this._tick++,this._activePath.ellipse(e,t,s,o,this._transform.clone()),this}circle(e,t,s){return this._tick++,this._activePath.circle(e,t,s,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,t){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*e+s.c*t+s.tx,s.b*e+s.d*t+s.ty),this}moveTo(e,t){this._tick++;const s=this._transform,o=this._activePath.instructions,a=s.a*e+s.c*t+s.tx,u=s.b*e+s.d*t+s.ty;return o.length===1&&o[0].action==="moveTo"?(o[0].data[0]=a,o[0].data[1]=u,this):(this._activePath.moveTo(a,u),this)}quadraticCurveTo(e,t,s,o,a){this._tick++;const u=this._transform;return this._activePath.quadraticCurveTo(u.a*e+u.c*t+u.tx,u.b*e+u.d*t+u.ty,u.a*s+u.c*o+u.tx,u.b*s+u.d*o+u.ty,a),this}rect(e,t,s,o){return this._tick++,this._activePath.rect(e,t,s,o,this._transform.clone()),this}roundRect(e,t,s,o,a){return this._tick++,this._activePath.roundRect(e,t,s,o,a,this._transform.clone()),this}poly(e,t){return this._tick++,this._activePath.poly(e,t,this._transform.clone()),this}regularPoly(e,t,s,o,a=0,u){return this._tick++,this._activePath.regularPoly(e,t,s,o,a,u),this}roundPoly(e,t,s,o,a,u){return this._tick++,this._activePath.roundPoly(e,t,s,o,a,u),this}roundShape(e,t,s,o){return this._tick++,this._activePath.roundShape(e,t,s,o),this}filletRect(e,t,s,o,a){return this._tick++,this._activePath.filletRect(e,t,s,o,a),this}chamferRect(e,t,s,o,a,u){return this._tick++,this._activePath.chamferRect(e,t,s,o,a,u),this}star(e,t,s,o,a=0,u=0){return this._tick++,this._activePath.star(e,t,s,o,a,u,this._transform.clone()),this}svg(e){return this._tick++,O4(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,t=e){return this._transform.scale(e,t),this}setTransform(e,t,s,o,a,u){return e instanceof je?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,t,s,o,a,u),this)}transform(e,t,s,o,a,u){return e instanceof je?(this._transform.append(e),this):(Rp.set(e,t,s,o,a,u),this._transform.append(Rp),this)}translate(e,t=e){return this._transform.translate(e,t),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const e=this._bounds;e.clear();for(let t=0;t<this.instructions.length;t++){const s=this.instructions[t],o=s.action;if(o==="fill"){const a=s.data;e.addBounds(a.path.bounds)}else if(o==="texture"){const a=s.data;e.addFrame(a.dx,a.dy,a.dx+a.dw,a.dy+a.dh,a.transform)}if(o==="stroke"){const a=s.data,u=a.style.alignment,c=a.style.width*(1-u),h=a.path.bounds;e.addFrame(h.minX-c,h.minY-c,h.maxX+c,h.maxY+c)}}return e}containsPoint(e){var o;if(!this.bounds.containsPoint(e.x,e.y))return!1;const t=this.instructions;let s=!1;for(let a=0;a<t.length;a++){const u=t[a],c=u.data,h=c.path;if(!u.action||!h)continue;const f=c.style,m=h.shapePath.shapePrimitives;for(let y=0;y<m.length;y++){const v=m[y].shape;if(!f||!v)continue;const x=m[y].transform,b=x?x.applyInverse(e,V4):e;if(u.action==="fill")s=v.contains(b.x,b.y);else{const w=f;s=v.strokeContains(b.x,b.y,w.width,w.alignment)}const S=c.hole;if(S){const w=(o=S.shapePath)==null?void 0:o.shapePrimitives;if(w)for(let A=0;A<w.length;A++)w[A].shape.contains(b.x,b.y)&&(s=!1)}if(s)return!0}}return s}destroy(e=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof e=="boolean"?e:e==null?void 0:e.texture){const s=typeof e=="boolean"?e:e==null?void 0:e.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(s)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(s))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};sh.defaultFillStyle={color:16777215,alpha:1,texture:Ne.WHITE,matrix:null,fill:null,textureSpace:"local"};sh.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:Ne.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let Fn=sh;const oh=class Bs extends qn{constructor(e={}){super(),this.uid=xt("textStyle"),this._tick=0,Y4(e);const t={...Bs.defaultTextStyle,...e};for(const s in t){const o=s;this[o]=t[s]}this.update(),this._tick=0}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.update())}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(e!==null&&typeof e=="object"?this._dropShadow=this._createProxy({...Bs.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...Bs.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.update())}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(typeof e=="string"?this._fontSize=parseInt(e,10):this._fontSize=e,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.update())}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.update())}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.update())}get filters(){return this._filters}set filters(e){this._filters!==e&&(this._filters=Object.freeze(e),this.update())}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.update())}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...Fn.defaultFillStyle,...e},()=>{this._fill=Yi({...this._originalFill},Fn.defaultFillStyle)})),this._fill=Yi(e===0?"black":e,Fn.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...Fn.defaultStrokeStyle,...e},()=>{this._stroke=ou({...this._originalStroke},Fn.defaultStrokeStyle)})),this._stroke=ou(e,Fn.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){const e=Bs.defaultTextStyle;for(const t in e)this[t]=e[t]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new Bs({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let e=0;if(this._filters)for(let t=0;t<this._filters.length;t++)e+=this._filters[t].padding;return Math.max(this._padding,e)}destroy(e=!1){var s,o,a,u;if(this.removeAllListeners(),typeof e=="boolean"?e:e==null?void 0:e.texture){const c=typeof e=="boolean"?e:e==null?void 0:e.textureSource;(s=this._fill)!=null&&s.texture&&this._fill.texture.destroy(c),(o=this._originalFill)!=null&&o.texture&&this._originalFill.texture.destroy(c),(a=this._stroke)!=null&&a.texture&&this._stroke.texture.destroy(c),(u=this._originalStroke)!=null&&u.texture&&this._originalStroke.texture.destroy(c)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,t){return new Proxy(e,{set:(s,o,a)=>(s[o]===a||(s[o]=a,t==null||t(o,a),this.update()),!0)})}_isFillStyle(e){return(e??null)!==null&&!(St.isColorLike(e)||e instanceof Rr||e instanceof cu)}};oh.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};oh.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let ca=oh;function Y4(r){const e=r;if(typeof e.dropShadow=="boolean"&&e.dropShadow){const t=ca.defaultDropShadow;r.dropShadow={alpha:e.dropShadowAlpha??t.alpha,angle:e.dropShadowAngle??t.angle,blur:e.dropShadowBlur??t.blur,color:e.dropShadowColor??t.color,distance:e.dropShadowDistance??t.distance}}if(e.strokeThickness!==void 0){$e(Ke,"strokeThickness is now a part of stroke");const t=e.stroke;let s={};if(St.isColorLike(t))s.color=t;else if(t instanceof Rr||t instanceof cu)s.fill=t;else if(Object.hasOwnProperty.call(t,"color")||Object.hasOwnProperty.call(t,"fill"))s=t;else throw new Error("Invalid stroke value.");r.stroke={...s,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){if($e(Ke,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(e.fill)||e.fill.length===0)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");e.fill.length!==e.fillGradientStops.length&&at("The number of fill colors must match the number of fill gradient stops.");const t=new Rr({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),s=e.fillGradientStops.slice(),o=e.fill.map(a=>St.shared.setValue(a).toNumber());s.forEach((a,u)=>{t.addColorStop(a,o[u])}),r.fill={fill:t}}}class X4{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){const s=et.get().createCanvas();s.width=e,s.height=t;const o=s.getContext("2d");return{canvas:s,context:o}}getOptimalCanvasAndContext(e,t,s=1){e=Math.ceil(e*s-1e-6),t=Math.ceil(t*s-1e-6),e=Hs(e),t=Hs(t);const o=(e<<17)+(t<<1);this._canvasPool[o]||(this._canvasPool[o]=[]);let a=this._canvasPool[o].pop();return a||(a=this._createCanvasAndContext(e,t)),a}returnCanvasAndContext(e){const t=e.canvas,{width:s,height:o}=t,a=(s<<17)+(o<<1);e.context.resetTransform(),e.context.clearRect(0,0,s,o),this._canvasPool[a].push(e)}clear(){this._canvasPool={}}}const da=new X4;ha.register(da);const Ip=1e5;function au(r,e,t,s=0){if(r.texture===Ne.WHITE&&!r.fill)return St.shared.setValue(r.color).setAlpha(r.alpha??1).toHexa();if(r.fill){if(r.fill instanceof cu){const o=r.fill,a=e.createPattern(o.texture.source.resource,"repeat"),u=o.transform.copyTo(je.shared);return u.scale(o.texture.frame.width,o.texture.frame.height),a.setTransform(u),a}else if(r.fill instanceof Rr){const o=r.fill,a=o.type==="linear",u=o.textureSpace==="local";let c=1,h=1;u&&t&&(c=t.width+s,h=t.height+s);let f,m=!1;if(a){const{start:y,end:v}=o;f=e.createLinearGradient(y.x*c,y.y*h,v.x*c,v.y*h),m=Math.abs(v.x-y.x)<Math.abs((v.y-y.y)*.1)}else{const{center:y,innerRadius:v,outerCenter:x,outerRadius:b}=o;f=e.createRadialGradient(y.x*c,y.y*h,v*c,x.x*c,x.y*h,b*c)}if(m&&u&&t){const y=t.lineHeight/h;for(let v=0;v<t.lines.length;v++){const x=(v*t.lineHeight+s/2)/h;o.colorStops.forEach(b=>{const S=x+b.offset*y;f.addColorStop(Math.floor(S*Ip)/Ip,St.shared.setValue(b.color).toHex())})}}else o.colorStops.forEach(y=>{f.addColorStop(y.offset,St.shared.setValue(y.color).toHex())});return f}}else{const o=e.createPattern(r.texture.source.resource,"repeat"),a=r.matrix.copyTo(je.shared);return a.scale(r.texture.frame.width,r.texture.frame.height),o.setTransform(a),o}return at("FillStyle not recognised",r),"red"}const gm=class ym extends Q0{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const t={...ym.defaultOptions,...e};this._textureSize=t.textureSize,this._mipmap=t.mipmap;const s=t.style.clone();t.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=Ne.WHITE,s._fill.fill=null),this.applyFillAsTint=t.overrideFill;const o=s.fontSize;s.fontSize=this.baseMeasurementFontSize;const a=iu(s);t.overrideSize?s._stroke&&(s._stroke.width*=this.baseRenderedFontSize/o):s.fontSize=this.baseRenderedFontSize=o,this._style=s,this._skipKerning=t.skipKerning??!1,this.resolution=t.resolution??1,this._padding=t.padding??4,t.textureStyle&&(this._textureStyle=t.textureStyle instanceof Us?t.textureStyle:new Us(t.textureStyle)),this.fontMetrics=cr.measureFont(a),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(e){var w,A;const t=cr.graphemeSegmenter(e).filter(E=>!this._currentChars.includes(E)).filter((E,P,M)=>M.indexOf(E)===P);if(!t.length)return;this._currentChars=[...this._currentChars,...t];let s;this._currentPageIndex===-1?s=this._nextPage():s=this.pages[this._currentPageIndex];let{canvas:o,context:a}=s.canvasAndContext,u=s.texture.source;const c=this._style;let h=this._currentX,f=this._currentY,m=this._currentMaxCharHeight;const y=this.baseRenderedFontSize/this.baseMeasurementFontSize,v=this._padding*y;let x=!1;const b=o.width/this.resolution,S=o.height/this.resolution;for(let E=0;E<t.length;E++){const P=t[E],M=cr.measureText(P,c,o,!1);M.lineHeight=M.height;const D=M.width*y,z=Math.ceil((c.fontStyle==="italic"?2:1)*D),L=M.height*y,G=z+v*2,H=L+v*2;if(x=!1,P!==`
`&&P!=="\r"&&P!=="	"&&P!==" "&&(x=!0,m=Math.ceil(Math.max(H,m))),h+G>b&&(f+=m,m=H,h=0,f+m>S)){u.update();const Y=this._nextPage();o=Y.canvasAndContext.canvas,a=Y.canvasAndContext.context,u=Y.texture.source,h=0,f=0,m=0}const W=D/y-(((w=c.dropShadow)==null?void 0:w.distance)??0)-(((A=c._stroke)==null?void 0:A.width)??0);if(this.chars[P]={id:P.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:W,kerning:{}},x){this._drawGlyph(a,M,h+v,f+v,y,c);const Y=u.width*y,ge=u.height*y,K=new ht(h/Y*u.width,f/ge*u.height,G/Y*u.width,H/ge*u.height);this.chars[P].texture=new Ne({source:u,frame:K}),h+=Math.ceil(G)}}u.update(),this._currentX=h,this._currentY=f,this._currentMaxCharHeight=m,this._skipKerning&&this._applyKerning(t,a)}get pageTextures(){return $e(Ke,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,t){const s=this._measureCache;for(let o=0;o<e.length;o++){const a=e[o];for(let u=0;u<this._currentChars.length;u++){const c=this._currentChars[u];let h=s[a];h||(h=s[a]=t.measureText(a).width);let f=s[c];f||(f=s[c]=t.measureText(c).width);let m=t.measureText(a+c).width,y=m-(h+f);y&&(this.chars[a].kerning[c]=y),m=t.measureText(a+c).width,y=m-(h+f),y&&(this.chars[c].kerning[a]=y)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,t=da.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(t.context,this._style,e);const s=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),o=new Ne({source:new Xi({resource:t.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(o.source.style=this._textureStyle);const a={canvasAndContext:t,texture:o};return this.pages[this._currentPageIndex]=a,a}_setupContext(e,t,s){t.fontSize=this.baseRenderedFontSize,e.scale(s,s),e.font=iu(t),t.fontSize=this.baseMeasurementFontSize,e.textBaseline=t.textBaseline;const o=t._stroke,a=(o==null?void 0:o.width)??0;if(o&&(e.lineWidth=a,e.lineJoin=o.join,e.miterLimit=o.miterLimit,e.strokeStyle=au(o,e)),t._fill&&(e.fillStyle=au(t._fill,e)),t.dropShadow){const u=t.dropShadow,c=St.shared.setValue(u.color).toArray(),h=u.blur*s,f=u.distance*s;e.shadowColor=`rgba(${c[0]*255},${c[1]*255},${c[2]*255},${u.alpha})`,e.shadowBlur=h,e.shadowOffsetX=Math.cos(u.angle)*f,e.shadowOffsetY=Math.sin(u.angle)*f}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,t,s,o,a,u){const c=t.text,h=t.fontProperties,f=u._stroke,m=((f==null?void 0:f.width)??0)*a,y=s+m/2,v=o-m/2,x=h.descent*a,b=t.lineHeight*a;let S=!1;u.stroke&&m&&(S=!0,e.strokeText(c,y,v+b-x));const{shadowBlur:w,shadowOffsetX:A,shadowOffsetY:E}=e;u._fill&&(S&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.fillText(c,y,v+b-x)),S&&(e.shadowBlur=w,e.shadowOffsetX=A,e.shadowOffsetY=E)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:t,texture:s}=this.pages[e];da.returnCanvasAndContext(t),s.destroy(!0)}this.pages=null}};gm.defaultOptions={textureSize:512,style:new ca,mipmap:!0};let Lp=gm;function q4(r,e,t,s){const o={width:0,height:0,offsetY:0,scale:e.fontSize/t.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};o.offsetY=t.baseLineOffset;let a=o.lines[0],u=null,c=!0;const h={width:0,start:0,index:0,positions:[],chars:[]},f=t.baseMeasurementFontSize/e.fontSize,m=e.letterSpacing*f,y=e.wordWrapWidth*f,v=e.lineHeight?e.lineHeight*f:t.lineHeight,x=e.wordWrap&&e.breakWords,b=A=>{const E=a.width;for(let P=0;P<h.index;P++){const M=A.positions[P];a.chars.push(A.chars[P]),a.charPositions.push(M+E)}a.width+=A.width,c=!1,h.width=0,h.index=0,h.chars.length=0},S=()=>{let A=a.chars.length-1;if(s){let E=a.chars[A];for(;E===" ";)a.width-=t.chars[E].xAdvance,E=a.chars[--A]}o.width=Math.max(o.width,a.width),a={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},c=!0,o.lines.push(a),o.height+=v},w=A=>A-m>y;for(let A=0;A<r.length+1;A++){let E;const P=A===r.length;P||(E=r[A]);const M=t.chars[E]||t.chars[" "];if(/(?:\s)/.test(E)||E==="\r"||E===`
`||P){if(!c&&e.wordWrap&&w(a.width+h.width)?(S(),b(h),P||a.charPositions.push(0)):(h.start=a.width,b(h),P||a.charPositions.push(0)),E==="\r"||E===`
`)S();else if(!P){const G=M.xAdvance+(M.kerning[u]||0)+m;a.width+=G,a.spaceWidth=G,a.spacesIndex.push(a.charPositions.length),a.chars.push(E)}}else{const L=M.kerning[u]||0,G=M.xAdvance+L+m;x&&w(a.width+h.width+G)&&(b(h),S()),h.positions[h.index++]=h.width+L,h.chars.push(E),h.width+=G}u=E}return S(),e.align==="center"?K4(o):e.align==="right"?Q4(o):e.align==="justify"&&Z4(o),o}function K4(r){for(let e=0;e<r.lines.length;e++){const t=r.lines[e],s=r.width/2-t.width/2;for(let o=0;o<t.charPositions.length;o++)t.charPositions[o]+=s}}function Q4(r){for(let e=0;e<r.lines.length;e++){const t=r.lines[e],s=r.width-t.width;for(let o=0;o<t.charPositions.length;o++)t.charPositions[o]+=s}}function Z4(r){const e=r.width;for(let t=0;t<r.lines.length;t++){const s=r.lines[t];let o=0,a=s.spacesIndex[o++],u=0;const c=s.spacesIndex.length,f=(e-s.width)/c;for(let m=0;m<s.charPositions.length;m++)m===a&&(a=s.spacesIndex[o++],u+=f),s.charPositions[m]+=u}}function J4(r){if(r==="")return[];typeof r=="string"&&(r=[r]);const e=[];for(let t=0,s=r.length;t<s;t++){const o=r[t];if(Array.isArray(o)){if(o.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${o.length}.`);if(o[0].length===0||o[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const a=o[0].charCodeAt(0),u=o[1].charCodeAt(0);if(u<a)throw new Error("[BitmapFont]: Invalid character range.");for(let c=a,h=u;c<=h;c++)e.push(String.fromCharCode(c))}else e.push(...Array.from(o))}if(e.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}let Ul=0;class e9{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=Z0(1e3)}getFont(e,t){var u;let s=`${t.fontFamily}-bitmap`,o=!0;if(t._fill.fill&&!t._stroke?(s+=t._fill.fill.styleKey,o=!1):(t._stroke||t.dropShadow)&&(s=`${t.styleKey}-bitmap`,o=!1),!ot.has(s)){const c=Object.create(t);c.lineHeight=0;const h=new Lp({style:c,overrideFill:o,overrideSize:!0,...this.defaultOptions});Ul++,Ul>50&&at("BitmapText",`You have dynamically created ${Ul} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),h.once("destroy",()=>{Ul--,ot.remove(s)}),ot.set(s,h)}const a=ot.get(s);return(u=a.ensureCharacters)==null||u.call(a,e),a}getLayout(e,t,s=!0){const o=this.getFont(e,t),a=`${e}-${t.styleKey}-${s}`;if(this.measureCache.has(a))return this.measureCache.get(a);const u=cr.graphemeSegmenter(e),c=q4(u,t,o,s);return this.measureCache.set(a,c),c}measureText(e,t,s=!0){return this.getLayout(e,t,s)}install(...e){var f,m,y,v;let t=e[0];typeof t=="string"&&(t={name:t,style:e[1],chars:(f=e[2])==null?void 0:f.chars,resolution:(m=e[2])==null?void 0:m.resolution,padding:(y=e[2])==null?void 0:y.padding,skipKerning:(v=e[2])==null?void 0:v.skipKerning},$e(Ke,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=t==null?void 0:t.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");t={...this.defaultOptions,...t};const o=t.style,a=o instanceof ca?o:new ca(o),u=t.dynamicFill??this._canUseTintForStyle(a),c=new Lp({style:a,overrideFill:u,skipKerning:t.skipKerning,padding:t.padding,resolution:t.resolution,overrideSize:!1,textureStyle:t.textureStyle}),h=J4(t.chars);return c.ensureCharacters(h.join("")),ot.set(`${s}-bitmap`,c),c.once("destroy",()=>ot.remove(`${s}-bitmap`)),c}uninstall(e){const t=`${e}-bitmap`,s=ot.get(t);s&&s.destroy()}_canUseTintForStyle(e){return!e._stroke&&(!e.dropShadow||e.dropShadow.color===0)&&!e._fill.fill&&e._fill.color===16777215}}const $p=new e9;class xm extends Q0{constructor(e,t){super();const{textures:s,data:o}=e;Object.keys(o.pages).forEach(a=>{const u=o.pages[parseInt(a,10)],c=s[u.id];this.pages.push({texture:c})}),Object.keys(o.chars).forEach(a=>{const u=o.chars[a],{frame:c,source:h,rotate:f}=s[u.page],m=Ze.transformRectCoords(u,c,f,new ht),y=new Ne({frame:m,orig:new ht(0,0,u.width,u.height),source:h,rotate:f});this.chars[a]={id:a.codePointAt(0),xOffset:u.xOffset,yOffset:u.yOffset,xAdvance:u.xAdvance,kerning:u.kerning??{},texture:y}}),this.baseRenderedFontSize=o.fontSize,this.baseMeasurementFontSize=o.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:o.fontSize},this.baseLineOffset=o.baseLineOffset,this.lineHeight=o.lineHeight,this.fontFamily=o.fontFamily,this.distanceField=o.distanceField??{type:"none",range:0},this.url=t}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:t}=this.pages[e];t.destroy(!0)}this.pages=null}static install(e){$p.install(e)}static uninstall(e){$p.uninstall(e)}}const vd={test(r){return typeof r=="string"&&r.startsWith("info face=")},parse(r){const e=r.match(/^[a-z]+\s+.+$/gm),t={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const y in e){const v=e[y].match(/^[a-z]+/gm)[0],x=e[y].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),b={};for(const S in x){const w=x[S].split("="),A=w[0],E=w[1].replace(/"/gm,""),P=parseFloat(E),M=isNaN(P)?E:P;b[A]=M}t[v].push(b)}const s={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[o]=t.info,[a]=t.common,[u]=t.distanceField??[];u&&(s.distanceField={range:parseInt(u.distanceRange,10),type:u.fieldType}),s.fontSize=parseInt(o.size,10),s.fontFamily=o.face,s.lineHeight=parseInt(a.lineHeight,10);const c=t.page;for(let y=0;y<c.length;y++)s.pages.push({id:parseInt(c[y].id,10)||0,file:c[y].file});const h={};s.baseLineOffset=s.lineHeight-parseInt(a.base,10);const f=t.char;for(let y=0;y<f.length;y++){const v=f[y],x=parseInt(v.id,10);let b=v.letter??v.char??String.fromCharCode(x);b==="space"&&(b=" "),h[x]=b,s.chars[b]={id:x,page:parseInt(v.page,10)||0,x:parseInt(v.x,10),y:parseInt(v.y,10),width:parseInt(v.width,10),height:parseInt(v.height,10),xOffset:parseInt(v.xoffset,10),yOffset:parseInt(v.yoffset,10),xAdvance:parseInt(v.xadvance,10),kerning:{}}}const m=t.kerning||[];for(let y=0;y<m.length;y++){const v=parseInt(m[y].first,10),x=parseInt(m[y].second,10),b=parseInt(m[y].amount,10);s.chars[h[x]].kerning[h[v]]=b}return s}},zp={test(r){const e=r;return typeof e!="string"&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(r){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},t=r.getElementsByTagName("info")[0],s=r.getElementsByTagName("common")[0],o=r.getElementsByTagName("distanceField")[0];o&&(e.distanceField={type:o.getAttribute("fieldType"),range:parseInt(o.getAttribute("distanceRange"),10)});const a=r.getElementsByTagName("page"),u=r.getElementsByTagName("char"),c=r.getElementsByTagName("kerning");e.fontSize=parseInt(t.getAttribute("size"),10),e.fontFamily=t.getAttribute("face"),e.lineHeight=parseInt(s.getAttribute("lineHeight"),10);for(let f=0;f<a.length;f++)e.pages.push({id:parseInt(a[f].getAttribute("id"),10)||0,file:a[f].getAttribute("file")});const h={};e.baseLineOffset=e.lineHeight-parseInt(s.getAttribute("base"),10);for(let f=0;f<u.length;f++){const m=u[f],y=parseInt(m.getAttribute("id"),10);let v=m.getAttribute("letter")??m.getAttribute("char")??String.fromCharCode(y);v==="space"&&(v=" "),h[y]=v,e.chars[v]={id:y,page:parseInt(m.getAttribute("page"),10)||0,x:parseInt(m.getAttribute("x"),10),y:parseInt(m.getAttribute("y"),10),width:parseInt(m.getAttribute("width"),10),height:parseInt(m.getAttribute("height"),10),xOffset:parseInt(m.getAttribute("xoffset"),10),yOffset:parseInt(m.getAttribute("yoffset"),10),xAdvance:parseInt(m.getAttribute("xadvance"),10),kerning:{}}}for(let f=0;f<c.length;f++){const m=parseInt(c[f].getAttribute("first"),10),y=parseInt(c[f].getAttribute("second"),10),v=parseInt(c[f].getAttribute("amount"),10);e.chars[h[y]].kerning[h[m]]=v}return e}},jp={test(r){return typeof r=="string"&&r.match(/<font(\s|>)/)?zp.test(et.get().parseXML(r)):!1},parse(r){return zp.parse(et.get().parseXML(r))}},t9=[".xml",".fnt"],n9={extension:{type:ve.CacheParser,name:"cacheBitmapFont"},test:r=>r instanceof xm,getCacheableAssets(r,e){const t={};return r.forEach(s=>{t[s]=e,t[`${s}-bitmap`]=e}),t[`${e.fontFamily}-bitmap`]=e,t}},r9={extension:{type:ve.LoadParser,priority:di.Normal},name:"loadBitmapFont",id:"bitmap-font",test(r){return t9.includes(Sn.extname(r).toLowerCase())},async testParse(r){return vd.test(r)||jp.test(r)},async parse(r,e,t){const s=vd.test(r)?vd.parse(r):jp.parse(r),{src:o}=e,{pages:a}=s,u=[],c=s.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let y=0;y<a.length;++y){const v=a[y].file;let x=Sn.join(Sn.dirname(o),v);x=Id(x,o),u.push({src:x,data:c})}const h=await t.load(u),f=u.map(y=>h[y.src]);return new xm({data:s,textures:f},o)},async load(r,e){return await(await et.get().fetch(r)).text()},async unload(r,e,t){await Promise.all(r.pages.map(s=>t.unload(s.texture.source._sourceOrigin))),r.destroy()}};class i9{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<t;s++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const s9={extension:{type:ve.CacheParser,name:"cacheTextureArray"},test:r=>Array.isArray(r)&&r.every(e=>e instanceof Ne),getCacheableAssets:(r,e)=>{const t={};return r.forEach(s=>{e.forEach((o,a)=>{t[s+(a===0?"":a+1)]=o})}),t}};async function vm(r){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(r)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const o9={extension:{type:ve.DetectionParser,priority:1},test:async()=>vm("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(e=>e!=="avif")},Fp=["png","jpg","jpeg"],a9={extension:{type:ve.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...Fp],remove:async r=>r.filter(e=>!Fp.includes(e))},l9="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function hu(r){return l9?!1:document.createElement("video").canPlayType(r)!==""}const u9={extension:{type:ve.DetectionParser,priority:0},test:async()=>hu("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(e=>e!=="mp4"&&e!=="m4v")},c9={extension:{type:ve.DetectionParser,priority:0},test:async()=>hu("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(e=>e!=="ogv")},d9={extension:{type:ve.DetectionParser,priority:0},test:async()=>hu("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(e=>e!=="webm")},h9={extension:{type:ve.DetectionParser,priority:0},test:async()=>vm("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(e=>e!=="webp")},_m=class Zl{constructor(){this.loadOptions={...Zl.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,s)=>(this._parsersValidated=!1,e[t]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const s={promise:null,parser:null};return s.promise=(async()=>{var u,c;let o=null,a=null;if((t.parser||t.loadParser)&&(a=this._parserHash[t.parser||t.loadParser],t.loadParser&&at(`[Assets] "loadParser" is deprecated, use "parser" instead for ${e}`),a||at(`[Assets] specified load parser "${t.parser||t.loadParser}" not found while loading ${e}`)),!a){for(let h=0;h<this.parsers.length;h++){const f=this.parsers[h];if(f.load&&((u=f.test)!=null&&u.call(f,e,t,this))){a=f;break}}if(!a)return at(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}o=await a.load(e,t,this),s.parser=a;for(let h=0;h<this.parsers.length;h++){const f=this.parsers[h];f.parse&&f.parse&&await((c=f.testParse)==null?void 0:c.call(f,o,t,this))&&(o=await f.parse(o,t,this)||o,s.parser=f)}return o})(),s}async load(e,t){this._parsersValidated||this._validateParsers();const s=typeof t=="function"?{...Zl.defaultOptions,...this.loadOptions,onProgress:t}:{...Zl.defaultOptions,...this.loadOptions,...t||{}},{onProgress:o,onError:a,strategy:u,retryCount:c,retryDelay:h}=s;let f=0;const m={},y=ru(e),v=Yn(e,S=>({alias:[S],src:S,data:{}})),x=v.reduce((S,w)=>S+(w.progressSize||1),0),b=v.map(async S=>{const w=Sn.toAbsolute(S.src);m[S.src]||(await this._loadAssetWithRetry(w,S,{onProgress:o,onError:a,strategy:u,retryCount:c,retryDelay:h},m),f+=S.progressSize||1,o&&o(f/x))});return await Promise.all(b),y?m[v[0].src]:m}async unload(e){const s=Yn(e,o=>({alias:[o],src:o})).map(async o=>{var c,h;const a=Sn.toAbsolute(o.src),u=this.promiseCache[a];if(u){const f=await u.promise;delete this.promiseCache[a],await((h=(c=u.parser)==null?void 0:c.unload)==null?void 0:h.call(c,f,o,this))}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name||e.id).reduce((e,t)=>(!t.name&&!t.id?at("[Assets] parser should have an id"):(e[t.name]||e[t.id])&&at(`[Assets] parser id conflict "${t.id}"`),e[t.name]=t,t.id&&(e[t.id]=t),e),{})}async _loadAssetWithRetry(e,t,s,o){let a=0;const{onError:u,strategy:c,retryCount:h,retryDelay:f}=s,m=y=>new Promise(v=>setTimeout(v,y));for(;;)try{this.promiseCache[e]||(this.promiseCache[e]=this._getLoadPromiseAndParser(e,t)),o[t.src]=await this.promiseCache[e].promise;return}catch(y){delete this.promiseCache[e],delete o[t.src],a++;const v=c!=="retry"||a>h;if(c==="retry"&&!v){u&&u(y,t),await m(f);continue}if(c==="skip"){u&&u(y,t);return}throw u&&u(y,t),new Error(`[Loader.load] Failed to load ${e}.
${y}`)}}};_m.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let f9=_m;function qs(r,e){if(Array.isArray(e)){for(const t of e)if(r.startsWith(`data:${t}`))return!0;return!1}return r.startsWith(`data:${e}`)}function Ks(r,e){const t=r.split("?")[0],s=Sn.extname(t).toLowerCase();return Array.isArray(e)?e.includes(s):s===e}const p9=".json",m9="application/json",g9={extension:{type:ve.LoadParser,priority:di.Low},name:"loadJson",id:"json",test(r){return qs(r,m9)||Ks(r,p9)},async load(r){return await(await et.get().fetch(r)).json()}},y9=".txt",x9="text/plain",v9={name:"loadTxt",id:"text",extension:{type:ve.LoadParser,priority:di.Low,name:"loadTxt"},test(r){return qs(r,x9)||Ks(r,y9)},async load(r){return await(await et.get().fetch(r)).text()}},_9=["normal","bold","100","200","300","400","500","600","700","800","900"],w9=[".ttf",".otf",".woff",".woff2"],b9=["font/ttf","font/otf","font/woff","font/woff2"],S9=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function k9(r){const e=Sn.extname(r),o=Sn.basename(r,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1));let a=o.length>0;for(const c of o)if(!c.match(S9)){a=!1;break}let u=o.join(" ");return a||(u=`"${u.replace(/[\\"]/g,"\\$&")}"`),u}const C9=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function A9(r){return C9.test(r)?r:encodeURI(r)}const T9={extension:{type:ve.LoadParser,priority:di.Low},name:"loadWebFont",id:"web-font",test(r){return qs(r,b9)||Ks(r,w9)},async load(r,e){var s,o,a;const t=et.get().getFontFaceSet();if(t){const u=[],c=((s=e.data)==null?void 0:s.family)??k9(r),h=((a=(o=e.data)==null?void 0:o.weights)==null?void 0:a.filter(m=>_9.includes(m)))??["normal"],f=e.data??{};for(let m=0;m<h.length;m++){const y=h[m],v=new FontFace(c,`url(${A9(r)})`,{...f,weight:y});await v.load(),t.add(v),u.push(v)}return ot.has(`${c}-and-url`)?ot.get(`${c}-and-url`).entries.push({url:r,faces:u}):ot.set(`${c}-and-url`,{entries:[{url:r,faces:u}]}),u.length===1?u[0]:u}return at("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){const e=Array.isArray(r)?r:[r],t=e[0].family,s=ot.get(`${t}-and-url`),o=s.entries.find(a=>a.faces.some(u=>e.indexOf(u)!==-1));o.faces=o.faces.filter(a=>e.indexOf(a)===-1),o.faces.length===0&&(s.entries=s.entries.filter(a=>a!==o)),e.forEach(a=>{et.get().getFontFaceSet().delete(a)}),s.entries.length===0&&ot.remove(`${t}-and-url`)}};function ah(r,e=1){var s;const t=(s=Xs.RETINA_PREFIX)==null?void 0:s.exec(r);return t?parseFloat(t[1]):e}function lh(r,e,t){r.label=t,r._sourceOrigin=t;const s=new Ne({source:r,label:t}),o=()=>{delete e.promiseCache[t],ot.has(t)&&ot.remove(t)};return s.source.once("destroy",()=>{e.promiseCache[t]&&(at("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),o())}),s.once("destroy",()=>{r.destroyed||(at("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),o())}),s}const P9=".svg",M9="image/svg+xml",E9={extension:{type:ve.LoadParser,priority:di.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(r){return qs(r,M9)||Ks(r,P9)},async load(r,e,t){var s;return((s=e.data)==null?void 0:s.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?I9(r):R9(r,e,t,this.config.crossOrigin)},unload(r){r.destroy(!0)}};async function R9(r,e,t,s){var w,A,E;const o=await et.get().fetch(r),a=et.get().createImage();a.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await o.text())}`,a.crossOrigin=s,await a.decode();const u=((w=e.data)==null?void 0:w.width)??a.width,c=((A=e.data)==null?void 0:A.height)??a.height,h=((E=e.data)==null?void 0:E.resolution)||ah(r),f=Math.ceil(u*h),m=Math.ceil(c*h),y=et.get().createCanvas(f,m),v=y.getContext("2d");v.imageSmoothingEnabled=!0,v.imageSmoothingQuality="high",v.drawImage(a,0,0,u*h,c*h);const{parseAsGraphicsContext:x,...b}=e.data??{},S=new Xi({resource:y,alphaMode:"premultiply-alpha-on-upload",resolution:h,...b});return lh(S,t,r)}async function I9(r){const t=await(await et.get().fetch(r)).text(),s=new Fn;return s.svg(t),s}const L9=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Ns=null,Hd=class{constructor(){Ns||(Ns=URL.createObjectURL(new Blob([L9],{type:"application/javascript"}))),this.worker=new Worker(Ns)}};Hd.revokeObjectURL=function(){Ns&&(URL.revokeObjectURL(Ns),Ns=null)};const $9=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Ws=null;class wm{constructor(){Ws||(Ws=URL.createObjectURL(new Blob([$9],{type:"application/javascript"}))),this.worker=new Worker(Ws)}}wm.revokeObjectURL=function(){Ws&&(URL.revokeObjectURL(Ws),Ws=null)};let Bp=0,_d;class z9{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:t}=new Hd;t.addEventListener("message",s=>{t.terminate(),Hd.revokeObjectURL(),e(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e,t){var s;return this._run("loadImageBitmap",[e,(s=t==null?void 0:t.data)==null?void 0:s.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){_d===void 0&&(_d=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<_d&&(this._createdWorkers++,e=new wm().worker,e.addEventListener("message",t=>{this._complete(t.data),this._returnWorker(t.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){this._resolveHash[e.uuid]&&(e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),delete this._resolveHash[e.uuid])}async _run(e,t){await this._initWorkers();const s=new Promise((o,a)=>{this._queue.push({id:e,arguments:t,resolve:o,reject:a})});return this._next(),s}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const t=this._queue.pop(),s=t.id;this._resolveHash[Bp]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:Bp++,id:s})}reset(){this._workerPool.forEach(e=>e.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:e})=>{e==null||e(new Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}}const Dp=new z9,j9=[".jpeg",".jpg",".png",".webp",".avif"],F9=["image/jpeg","image/png","image/webp","image/avif"];async function B9(r,e){var o;const t=await et.get().fetch(r);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${t.status} ${t.statusText}`);const s=await t.blob();return((o=e==null?void 0:e.data)==null?void 0:o.alphaMode)==="premultiplied-alpha"?createImageBitmap(s,{premultiplyAlpha:"none"}):createImageBitmap(s)}const bm={name:"loadTextures",id:"texture",extension:{type:ve.LoadParser,priority:di.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return qs(r,F9)||Ks(r,j9)},async load(r,e,t){var a;let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Dp.isImageBitmapSupported()?s=await Dp.loadImageBitmap(r,e):s=await B9(r,e):s=await new Promise((u,c)=>{s=et.get().createImage(),s.crossOrigin=this.config.crossOrigin,s.src=r,s.complete?u(s):(s.onload=()=>{u(s)},s.onerror=c)});const o=new Xi({resource:s,alphaMode:"premultiply-alpha-on-upload",resolution:((a=e.data)==null?void 0:a.resolution)||ah(r),...e.data});return lh(o,t,r)},unload(r){r.destroy(!0)}},D9=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let wd,bd;function O9(r,e,t){t===void 0&&!e.startsWith("data:")?r.crossOrigin=W9(e):t!==!1&&(r.crossOrigin=typeof t=="string"?t:"anonymous")}function N9(r){return new Promise((e,t)=>{r.addEventListener("canplaythrough",s),r.addEventListener("error",o),r.load();function s(){a(),e()}function o(u){a(),t(u)}function a(){r.removeEventListener("canplaythrough",s),r.removeEventListener("error",o)}})}function W9(r,e=globalThis.location){if(r.startsWith("data:"))return"";e||(e=globalThis.location);const t=new URL(r,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}function H9(){const r=[],e=[];for(const t of D9){const s=Jo.MIME_TYPES[t.substring(1)]||`video/${t.substring(1)}`;hu(s)&&(r.push(t),e.includes(s)||e.push(s))}return{validVideoExtensions:r,validVideoMime:e}}const U9={name:"loadVideo",id:"video",extension:{type:ve.LoadParser,name:"loadVideo"},test(r){if(!wd||!bd){const{validVideoExtensions:s,validVideoMime:o}=H9();wd=s,bd=o}const e=qs(r,bd),t=Ks(r,wd);return e||t},async load(r,e,t){var h,f;const s={...Jo.defaultOptions,resolution:((h=e.data)==null?void 0:h.resolution)||ah(r),alphaMode:((f=e.data)==null?void 0:f.alphaMode)||await A0(),...e.data},o=document.createElement("video"),a={preload:s.autoLoad!==!1?"auto":void 0,"webkit-playsinline":s.playsinline!==!1?"":void 0,playsinline:s.playsinline!==!1?"":void 0,muted:s.muted===!0?"":void 0,loop:s.loop===!0?"":void 0,autoplay:s.autoPlay!==!1?"":void 0};Object.keys(a).forEach(m=>{const y=a[m];y!==void 0&&o.setAttribute(m,y)}),s.muted===!0&&(o.muted=!0),O9(o,r,s.crossorigin);const u=document.createElement("source");let c;if(s.mime)c=s.mime;else if(r.startsWith("data:"))c=r.slice(5,r.indexOf(";"));else if(!r.startsWith("blob:")){const m=r.split("?")[0].slice(r.lastIndexOf(".")+1).toLowerCase();c=Jo.MIME_TYPES[m]||`video/${m}`}return u.src=r,c&&(u.type=c),new Promise(m=>{const y=async()=>{const v=new Jo({...s,resource:o});o.removeEventListener("canplay",y),e.data.preload&&await N9(o),m(lh(v,t,r))};s.preload&&!s.autoPlay&&o.load(),o.addEventListener("canplay",y),o.appendChild(u)})},unload(r){r.destroy(!0)}},Sm={extension:{type:ve.ResolveParser,name:"resolveTexture"},test:bm.test,parse:r=>{var e;return{resolution:parseFloat(((e=Xs.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:r.split(".").pop(),src:r}}},G9={extension:{type:ve.ResolveParser,priority:-2,name:"resolveJson"},test:r=>Xs.RETINA_PREFIX.test(r)&&r.endsWith(".json"),parse:Sm.parse};class V9{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Xs,this.loader=new f9,this.cache=ot,this._backgroundLoader=new i9(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var a,u;if(this._initialized){at("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let c=e.manifest;typeof c=="string"&&(c=await this.load(c)),this.resolver.addManifest(c)}const t=((a=e.texturePreference)==null?void 0:a.resolution)??1,s=typeof t=="number"?[t]:t,o=await this._detectFormats({preferredFormats:(u=e.texturePreference)==null?void 0:u.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:o,resolution:s}}),e.preferences&&this.setPreferences(e.preferences),e.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...e.loadOptions})}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();const s=ru(e),o=Yn(e).map(c=>{if(typeof c!="string"){const h=this.resolver.getAlias(c);return h.some(f=>!this.resolver.hasKey(f))&&this.add(c),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(c)||this.add({alias:c,src:c}),c}),a=this.resolver.resolve(o),u=await this._mapLoadToResolve(a,t);return s?u[o[0]]:u}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let s=!1;typeof e=="string"&&(s=!0,e=[e]);const o=this.resolver.resolveBundle(e),a={},u=Object.keys(o);let c=0;const h=[],f=()=>{t==null||t(h.reduce((y,v)=>y+v,0)/c)},m=u.map((y,v)=>{const x=o[y],b=Object.values(x),w=[...new Set(b.flat())].reduce((A,E)=>A+(E.progressSize||1),0);return h.push(0),c+=w,this._mapLoadToResolve(x,A=>{h[v]=A*w,f()}).then(A=>{a[y]=A})});return await Promise.all(m),s?a[e[0]]:a}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return ot.get(e);const t={};for(let s=0;s<e.length;s++)t[s]=ot.get(e[s]);return t}async _mapLoadToResolve(e,t){const s=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const o=await this.loader.load(s,t);this._backgroundLoader.active=!0;const a={};return s.forEach(u=>{const c=o[u.src],h=[u.src];u.alias&&h.push(...u.alias),h.forEach(f=>{a[f]=c}),ot.set(h,c)}),a}async unload(e){this._initialized||await this.init();const t=Yn(e).map(o=>typeof o!="string"?o.src:o),s=this.resolver.resolve(t);await this._unloadFromResolved(s)}async unloadBundle(e){this._initialized||await this.init(),e=Yn(e);const t=this.resolver.resolveBundle(e),s=Object.keys(t).map(o=>this._unloadFromResolved(t[o]));await Promise.all(s)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(s=>{ot.remove(s.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const s of e.detections)e.skipDetections||await s.test()?t=await s.add(t):e.skipDetections||(t=await s.remove(t));return t=t.filter((s,o)=>t.indexOf(s)===o),t}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(s=>s in e).forEach(s=>{t.config[s]=e[s]})})}}const Os=new V9;Bt.handleByList(ve.LoadParser,Os.loader.parsers).handleByList(ve.ResolveParser,Os.resolver.parsers).handleByList(ve.CacheParser,Os.cache.parsers).handleByList(ve.DetectionParser,Os.detections);Bt.add(s9,a9,o9,h9,u9,c9,d9,g9,v9,T9,E9,bm,U9,r9,n9,Sm,G9);const Op={loader:ve.LoadParser,resolver:ve.ResolveParser,cache:ve.CacheParser,detection:ve.DetectionParser};Bt.handle(ve.Asset,r=>{const e=r.ref;Object.entries(Op).filter(([t])=>!!e[t]).forEach(([t,s])=>Bt.add(Object.assign(e[t],{extension:e[t].extension??s})))},r=>{const e=r.ref;Object.keys(Op).filter(t=>!!e[t]).forEach(t=>Bt.remove(e[t]))});class ci extends Qd{constructor(e){e instanceof Fn&&(e={context:e});const{context:t,roundPixels:s,...o}=e||{};super({label:"Graphics",...o}),this.renderPipeId="graphics",t?this._context=t:this._context=this._ownedContext=new Fn,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=s??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(e){return this._context.containsPoint(e)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):(e===!0||(e==null?void 0:e.context)===!0)&&this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,t){return this.context[e](...t),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){return e?new ci(this._context.clone()):(this._ownedContext=null,new ci(this._context))}lineStyle(e,t,s){$e(Ke,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const o={};return e&&(o.width=e),t&&(o.color=t),s&&(o.alpha=s),this.context.strokeStyle=o,this}beginFill(e,t){$e(Ke,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return e!==void 0&&(s.color=e),t!==void 0&&(s.alpha=t),this.context.fillStyle=s,this}endFill(){$e(Ke,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return(e.width!==Fn.defaultStrokeStyle.width||e.color!==Fn.defaultStrokeStyle.color||e.alpha!==Fn.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...e){return $e(Ke,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return $e(Ke,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return $e(Ke,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return $e(Ke,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return $e(Ke,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return $e(Ke,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}class Y9 extends Qd{constructor(e,t){const{text:s,resolution:o,style:a,anchor:u,width:c,height:h,roundPixels:f,...m}=e;super({...m}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=t,this.text=s??"",this.style=a,this.resolution=o??null,this.allowChildren=!1,this._anchor=new Ft({_onUpdate:()=>{this.onViewUpdate()}}),u&&(this.anchor=u),this.roundPixels=f??!1,c!==void 0&&(this.width=c),h!==void 0&&(this.height=h)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=e===null,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){var t;e||(e={}),(t=this._style)==null||t.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){typeof e=="object"?(t=e.height??e.width,e=e.width):t??(t=e),e!==void 0&&this._setWidth(e,this.bounds.width),t!==void 0&&this._setHeight(t,this.bounds.height)}containsPoint(e){const t=this.bounds.width,s=this.bounds.height,o=-t*this.anchor.x;let a=0;return e.x>=o&&e.x<=o+t&&(a=-s*this.anchor.y,e.y>=a&&e.y<=a+s)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e!=null&&e.style)&&this._style.destroy(e),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}}function X9(r,e){let t=r[0]??{};return(typeof t=="string"||r[1])&&($e(Ke,`use new ${e}({ text: "hi!", style }) instead`),t={text:t,style:r[1]}),t}let Wi=null,Ar=null;function q9(r,e){Wi||(Wi=et.get().createCanvas(256,128),Ar=Wi.getContext("2d",{willReadFrequently:!0}),Ar.globalCompositeOperation="copy",Ar.globalAlpha=1),(Wi.width<r||Wi.height<e)&&(Wi.width=Hs(r),Wi.height=Hs(e))}function Np(r,e,t){for(let s=0,o=4*t*e;s<e;++s,o+=4)if(r[o+3]!==0)return!1;return!0}function Wp(r,e,t,s,o){const a=4*e;for(let u=s,c=s*a+4*t;u<=o;++u,c+=a)if(r[c+3]!==0)return!1;return!0}function K9(...r){let e=r[0];e.canvas||(e={canvas:r[0],resolution:r[1]});const{canvas:t}=e,s=Math.min(e.resolution??1,1),o=e.width??t.width,a=e.height??t.height;let u=e.output;if(q9(o,a),!Ar)throw new TypeError("Failed to get canvas 2D context");Ar.drawImage(t,0,0,o,a,0,0,o*s,a*s);const h=Ar.getImageData(0,0,o,a).data;let f=0,m=0,y=o-1,v=a-1;for(;m<a&&Np(h,o,m);)++m;if(m===a)return ht.EMPTY;for(;Np(h,o,v);)--v;for(;Wp(h,o,f,m,v);)++f;for(;Wp(h,o,y,m,v);)--y;return++y,++v,Ar.globalCompositeOperation="source-over",Ar.strokeRect(f,m,y-f,v-m),Ar.globalCompositeOperation="copy",u??(u=new ht),u.set(f/s,m/s,(y-f)/s,(v-m)/s),u}const Hp=new ht;class Q9{getCanvasAndContext(e){const{text:t,style:s,resolution:o=1}=e,a=s._getFinalPadding(),u=cr.measureText(t||" ",s),c=Math.ceil(Math.ceil(Math.max(1,u.width)+a*2)*o),h=Math.ceil(Math.ceil(Math.max(1,u.height)+a*2)*o),f=da.getOptimalCanvasAndContext(c,h);this._renderTextToCanvas(t,s,a,o,f);const m=s.trim?K9({canvas:f.canvas,width:c,height:h,resolution:1,output:Hp}):Hp.set(0,0,c,h);return{canvasAndContext:f,frame:m}}returnCanvasAndContext(e){da.returnCanvasAndContext(e)}_renderTextToCanvas(e,t,s,o,a){var P,M,D,z;const{canvas:u,context:c}=a,h=iu(t),f=cr.measureText(e||" ",t),m=f.lines,y=f.lineHeight,v=f.lineWidths,x=f.maxLineWidth,b=f.fontProperties,S=u.height;if(c.resetTransform(),c.scale(o,o),c.textBaseline=t.textBaseline,(P=t._stroke)!=null&&P.width){const L=t._stroke;c.lineWidth=L.width,c.miterLimit=L.miterLimit,c.lineJoin=L.join,c.lineCap=L.cap}c.font=h;let w,A;const E=t.dropShadow?2:1;for(let L=0;L<E;++L){const G=t.dropShadow&&L===0,H=G?Math.ceil(Math.max(1,S)+s*2):0,W=H*o;if(G){c.fillStyle="black",c.strokeStyle="black";const K=t.dropShadow,xe=K.color,Be=K.alpha;c.shadowColor=St.shared.setValue(xe).setAlpha(Be).toRgbaString();const ee=K.blur*o,te=K.distance*o;c.shadowBlur=ee,c.shadowOffsetX=Math.cos(K.angle)*te,c.shadowOffsetY=Math.sin(K.angle)*te+W}else{if(c.fillStyle=t._fill?au(t._fill,c,f,s*2):null,(M=t._stroke)!=null&&M.width){const K=t._stroke.width*.5+s*2;c.strokeStyle=au(t._stroke,c,f,K)}c.shadowColor="black"}let Y=(y-b.fontSize)/2;y-b.fontSize<0&&(Y=0);const ge=((D=t._stroke)==null?void 0:D.width)??0;for(let K=0;K<m.length;K++)w=ge/2,A=ge/2+K*y+b.ascent+Y,t.align==="right"?w+=x-v[K]:t.align==="center"&&(w+=(x-v[K])/2),(z=t._stroke)!=null&&z.width&&this._drawLetterSpacing(m[K],t,a,w+s,A+s-H,!0),t._fill!==void 0&&this._drawLetterSpacing(m[K],t,a,w+s,A+s-H)}}_drawLetterSpacing(e,t,s,o,a,u=!1){const{context:c}=s,h=t.letterSpacing;let f=!1;if(cr.experimentalLetterSpacingSupported&&(cr.experimentalLetterSpacing?(c.letterSpacing=`${h}px`,c.textLetterSpacing=`${h}px`,f=!0):(c.letterSpacing="0px",c.textLetterSpacing="0px")),h===0||f){u?c.strokeText(e,o,a):c.fillText(e,o,a);return}let m=o;const y=cr.graphemeSegmenter(e);let v=c.measureText(e).width,x=0;for(let b=0;b<y.length;++b){const S=y[b];u?c.strokeText(S,m,a):c.fillText(S,m,a);let w="";for(let A=b+1;A<y.length;++A)w+=y[A];x=c.measureText(w).width,m+=v-x+h,v=x}}}const Up=new Q9;class Z9 extends Y9{constructor(...e){const t=X9(e,"Text");super(t,ca),this.renderPipeId="text",t.textureStyle&&(this.textureStyle=t.textureStyle instanceof Us?t.textureStyle:new Us(t.textureStyle))}updateBounds(){const e=this._bounds,t=this._anchor;let s=0,o=0;if(this._style.trim){const{frame:a,canvasAndContext:u}=Up.getCanvasAndContext({text:this.text,style:this._style,resolution:1});Up.returnCanvasAndContext(u),s=a.width,o=a.height}else{const a=cr.measureText(this._text,this._style);s=a.width,o=a.height}e.minX=-t._x*s,e.maxX=e.minX+s,e.minY=-t._y*o,e.maxY=e.minY+o}}Bt.add(i5,s5);const J9=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>\r
<!-- Created with Inkscape (http://www.inkscape.org/) -->\r
\r
<svg\r
   width="174.61385mm"\r
   height="234.6797mm"\r
   viewBox="0 0 174.61385 234.6797"\r
   version="1.1"\r
   id="svg1"\r
   inkscape:version="1.4.2 (f4327f4, 2025-05-13)"\r
   sodipodi:docname="gentil.svg"\r
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\r
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\r
   xmlns="http://www.w3.org/2000/svg"\r
   xmlns:svg="http://www.w3.org/2000/svg">\r
  <sodipodi:namedview\r
     id="namedview1"\r
     pagecolor="#191919"\r
     bordercolor="#000000"\r
     borderopacity="0.25"\r
     inkscape:showpageshadow="2"\r
     inkscape:pageopacity="0.0"\r
     inkscape:pagecheckerboard="0"\r
     inkscape:deskcolor="#bd2727ff"\r
     inkscape:document-units="mm"\r
     inkscape:zoom="0.72604517"\r
     inkscape:cx="331.24661"\r
     inkscape:cy="485.50698"\r
     inkscape:window-width="1920"\r
     inkscape:window-height="1017"\r
     inkscape:window-x="1912"\r
     inkscape:window-y="-8"\r
     inkscape:window-maximized="1"\r
     inkscape:current-layer="layer1"\r
     showgrid="true">\r
    <inkscape:grid\r
       id="grid1"\r
       units="mm"\r
       originx="-17.307133"\r
       originy="-20.032634"\r
       spacingx="0.99999998"\r
       spacingy="1"\r
       empcolor="#0099e5"\r
       empopacity="0.30196078"\r
       color="#0099e5"\r
       opacity="0.14901961"\r
       empspacing="5"\r
       enabled="true"\r
       visible="true" />\r
  </sodipodi:namedview>\r
  <defs\r
     id="defs1" />\r
  <g\r
     inkscape:label="Calque 1"\r
     inkscape:groupmode="layer"\r
     id="layer1"\r
     transform="translate(-17.307132,-20.032634)">\r
    <path\r
       d="m 69.048457,20.142976 c -0.141111,0.105834 -1.234722,0.282223 -2.434166,0.352778 -2.504723,0.176389 -3.633611,0.740834 -4.445,2.293056 -0.352778,0.599722 -0.9525,1.622778 -1.411111,2.328333 -0.881945,1.340556 -2.046111,4.233334 -2.328334,5.891389 -0.105833,0.564445 -0.599722,2.2225 -1.093611,3.633611 -0.458611,1.446389 -1.093611,4.021667 -1.375833,5.785556 -0.282222,1.763888 -0.740833,3.421944 -1.023056,3.774721 -0.282222,0.3175 -0.599722,0.811389 -0.740833,1.093611 -0.141111,0.282223 0.07056,0.141112 0.458611,-0.352777 0.846667,-1.023056 0.9525,-0.740834 0.211667,0.670277 -0.282222,0.564445 -0.423333,1.093612 -0.282222,1.199445 0.105833,0.105833 -0.176389,0.811389 -0.635,1.516944 -0.740834,1.234722 -0.811389,1.27 -1.128889,0.564445 -0.176389,-0.388056 -0.881945,-0.987778 -1.516945,-1.305278 -1.093611,-0.529167 -1.305277,-0.529167 -2.434166,0.03528 -1.940278,0.917222 -4.233333,3.139722 -5.115278,4.974167 -0.670278,1.411111 -1.27,1.975555 -3.598333,3.457222 -3.033889,1.905 -5.750277,4.797777 -7.161388,7.584722 -0.458612,0.917222 -1.305278,2.116666 -1.869723,2.681111 -1.305277,1.340555 -3.139722,6.0325 -2.575277,6.596944 0.246944,0.246945 1.411111,0.423334 2.892777,0.388056 l 2.434167,-0.03528 -0.176389,1.093611 c -0.105833,0.599722 -0.352778,2.187222 -0.564444,3.563056 -0.176389,1.340555 -0.599723,2.751666 -0.917223,3.069166 -0.423333,0.458611 -0.493888,1.023056 -0.3175,2.257778 0.211667,1.763889 0.705556,2.610555 1.481667,2.610555 0.352778,0 0.423333,0.3175 0.246945,1.093611 -0.105834,0.635 -0.03528,1.199445 0.176388,1.340556 0.246945,0.141111 0.282223,0.987778 0.07056,2.681111 -0.176388,1.375833 -0.211666,2.822222 -0.105833,3.280833 0.246945,1.093611 -0.529167,3.774722 -1.340555,4.515556 -0.388056,0.3175 -0.670278,0.846666 -0.670278,1.199444 0,0.317504 -0.493889,0.740834 -1.234722,1.023054 -1.693334,0.59972 -2.081389,1.44639 -1.799167,4.1275 0.352778,3.35139 -0.282222,6.70278 -1.446389,7.69056 -1.128889,0.98778 -1.234722,2.61055 -0.282222,4.40972 0.3175,0.635 0.635,1.79917 0.705555,2.61056 0.529167,5.53861 0.529167,5.82083 -0.03528,6.0325 -0.3175,0.10583 -0.599722,0.21166 -0.670277,0.21166 -0.03528,0 -0.176389,-0.635 -0.3175,-1.44639 -0.176388,-1.02305 -0.423333,-1.51694 -0.917222,-1.62277 -0.529166,-0.14112 -0.705555,-0.49389 -0.705555,-1.30528 -0.03528,-2.11667 -2.575278,-6.17361 -3.633611,-5.75028 -1.023056,0.38806 -1.093611,2.54 -0.246945,4.86833 0.705556,1.79917 0.740834,2.2225 0.352778,2.96334 -0.246944,0.49389 -0.352778,1.30527 -0.246944,1.905 0.141111,0.70555 0,1.5875 -0.458612,2.57527 -0.388055,0.84667 -0.705555,2.2225 -0.705555,3.06917 0,1.51694 0,1.51694 -0.776111,0.9525 -2.081389,-1.44639 -2.187222,-1.44639 -1.940278,-0.0706 0.105833,0.70556 0.529167,1.72862 0.881945,2.25778 0.846666,1.16417 3.563055,7.51417 4.656666,10.83028 1.305278,3.98639 3.386667,7.83167 5.432778,9.91305 2.786944,2.89278 3.986389,2.46945 5.185833,-1.86972 1.058333,-3.81 0.917222,-5.57389 -0.635,-7.83166 -0.705556,-1.02306 -1.340556,-1.76389 -1.375833,-1.5875 -0.03528,0.17639 -0.176389,0.74083 -0.282223,1.27 -0.3175,1.37583 -0.670277,1.23472 -1.340555,-0.56445 l -0.564444,-1.55222 2.151944,0.17639 c 1.199444,0.0705 3.175,0.28222 4.374444,0.49389 2.434166,0.35278 3.739444,0.0705 4.303889,-1.05834 0.599722,-1.05833 0.458611,-2.08138 -0.3175,-2.8575 -0.881945,-0.88194 -1.305278,-1.94027 -2.010834,-4.7625 -0.246944,-1.16416 -0.846666,-2.75167 -1.305277,-3.52778 -0.705556,-1.16416 -0.811389,-1.69333 -0.564445,-2.99861 0.141111,-0.88194 0.529167,-2.15194 0.881945,-2.82222 1.164166,-2.18722 1.234722,-2.43417 1.234722,-3.52778 0,-1.23472 1.093611,-3.56305 2.116666,-4.58611 0.388056,-0.38805 0.705556,-0.98778 0.705556,-1.34055 0,-0.35278 0.246944,-0.9525 0.529167,-1.37584 0.3175,-0.45861 0.529166,-1.37583 0.458611,-2.11666 -0.03528,-0.74084 0.282222,-2.99862 0.705555,-5.04473 0.423334,-2.04611 0.9525,-4.58611 1.128889,-5.67972 0.246945,-1.19944 0.987778,-2.99861 1.905,-4.550832 0.846667,-1.375834 1.834444,-3.386667 2.187222,-4.445 0.352778,-1.058333 0.776111,-1.905 0.917222,-1.905 0.141112,0 0.529167,0.529167 0.846667,1.128889 0.3175,0.635 1.411111,2.434166 2.363611,3.951111 1.340556,2.046111 1.869722,3.280833 2.046111,4.691942 0.141111,1.05834 0.564445,2.32834 0.917222,2.82222 2.293056,3.24556 2.328334,4.37445 0.352778,7.09084 -0.670278,0.91722 -1.905,2.92805 -2.716389,4.445 -1.552222,2.96333 -1.552222,3.10444 -1.058333,9.03111 0.03528,0.28222 -0.105833,2.64583 -0.3175,5.22111 -0.352778,4.23334 -0.529167,4.97417 -1.658055,7.40834 -1.869723,3.95111 -1.940278,4.19805 -2.293056,7.65527 -0.211667,2.08139 -0.211667,4.09223 0.03528,5.89139 0.352778,2.61056 0.3175,2.92806 -0.917222,7.69056 -1.481667,5.57389 -1.516945,5.32694 1.199444,6.0325 0.881944,0.24694 1.658056,0.70555 1.905,1.12889 0.9525,1.79916 -0.599722,8.5725 -3.457222,14.99305 -1.058334,2.43417 -4.621389,7.16139 -5.185833,6.94972 -0.564445,-0.21166 -1.023056,0.14112 -1.693334,1.37584 -0.529166,0.9525 -1.058333,1.23472 -2.328333,1.34055 -0.246944,0.0353 -0.458611,0.21167 -0.458611,0.38806 0,0.17639 -0.3175,0.74083 -0.670278,1.27 -0.634999,0.88194 -0.634999,1.05833 -0.211666,1.905 0.458611,0.88194 0.352777,1.19944 -1.305278,4.72722 l -1.799166,3.81 -0.07055,5.46806 c -0.07056,7.76111 -0.458612,12.94694 -1.305278,17.85055 l -0.740834,4.30389 -1.552222,0.77611 c -0.846666,0.42333 -1.481666,0.84667 -1.375833,0.9525 0.07056,0.10583 -0.07056,0.81139 -0.352778,1.62278 -0.458611,1.30528 -0.458611,1.51694 0,1.86972 1.093611,0.77611 1.27,2.15195 0.917222,6.42056 -0.211666,2.25777 -0.493888,4.97416 -0.635,5.96194 -0.176388,1.02306 -0.211666,2.01083 -0.105833,2.15195 0.493889,0.74083 9.524999,4.7625 11.429999,5.07999 2.645833,0.45862 9.489722,-0.21166 11.006666,-1.09361 0.917222,-0.49388 1.058334,-0.84666 1.164167,-2.25777 0.07055,-1.19945 -0.105833,-2.01084 -0.599722,-2.82223 -0.776111,-1.27 -6.632222,-7.05555 -8.466667,-8.32555 -1.09361,-0.77611 -1.164165,-0.9525 -0.9525,-2.29306 0.141111,-0.81139 0.529167,-1.69333 0.9525,-1.97555 0.493889,-0.42334 0.776111,-1.19945 1.023056,-2.99861 0.388055,-3.21028 4.7625,-14.78139 8.290277,-21.94278 1.481667,-2.92806 2.822223,-6.17361 2.998611,-7.19667 0.635001,-3.38666 3.598334,-7.3025 6.138334,-8.07861 0.811388,-0.28222 1.552222,-0.81139 1.905,-1.41111 0.493888,-0.88194 0.740833,-0.98778 2.187222,-0.91722 2.081389,0.10583 3.139722,0.70555 6.35,3.56305 1.446388,1.30528 3.069166,2.43417 3.598333,2.54 0.529167,0.10584 1.199444,0.56445 1.516944,1.02306 0.846667,1.30528 3.245556,8.29028 3.527778,10.23055 0.282222,2.04612 1.516944,6.52639 1.940278,6.985 0.141111,0.14112 0.141111,0.74084 0,1.27 -0.176389,0.56445 -0.211667,1.09362 -0.105834,1.19945 0.105834,0.10583 0.03528,0.38805 -0.141111,0.635 -0.529166,0.635 -0.881944,2.99861 -0.529166,3.24555 0.176388,0.10584 0.246944,0.9525 0.176388,1.86973 -0.246944,2.50472 0.493889,7.86694 1.164167,8.60777 0.811389,0.91723 3.280833,1.16417 6.244177,0.67028 4.833056,-0.81139 6.596945,-0.81139 10.583333,-0.0353 2.610561,0.49389 5.185841,0.74084 8.219731,0.74084 3.98639,0 4.445,-0.0706 5.11528,-0.74084 0.56444,-0.56444 0.70555,-0.98777 0.52916,-1.83444 -0.10583,-0.56444 -0.38805,-1.23472 -0.56444,-1.48167 -0.17639,-0.24694 -2.04611,-0.88194 -4.1275,-1.41111 -2.11667,-0.52916 -4.02167,-1.16416 -4.30389,-1.37583 -0.52917,-0.42333 -2.50472,-1.48167 -4.974173,-2.71639 -3.421944,-1.65806 -5.679722,-4.19806 -4.974167,-5.53861 0.246945,-0.42333 0.105834,-1.27 -0.388055,-2.71639 -0.635,-1.905 -0.705556,-2.61056 -0.493889,-7.05556 0.141111,-2.71638 0.3175,-5.43277 0.423333,-5.99722 0.105834,-0.59972 0.3175,-3.38666 0.423334,-6.24416 0.141111,-3.13973 0.423333,-5.36223 0.635,-5.60917 0.599722,-0.56444 1.516944,-0.17639 3.280833,1.44639 1.552222,1.41111 2.504722,1.62278 2.504722,0.52917 0,-0.77612 -1.234722,-3.10445 -1.940278,-3.70417 -1.023055,-0.84667 -1.234722,-1.5875 -0.846666,-2.99861 0.211666,-0.74084 0.599722,-1.5875 0.881944,-1.83445 0.282222,-0.28222 0.493889,-0.81139 0.493889,-1.19944 0,-1.48167 3.139733,-0.59972 8.255003,2.39889 0.84667,0.49389 2.89278,0.59972 3.175,0.17639 0.10584,-0.17639 -1.05833,-1.37584 -2.54,-2.68111 -2.54,-2.29306 -6.84389,-4.79778 -8.255003,-4.79778 -0.3175,0 -0.705556,-0.17639 -0.811389,-0.35278 -0.105834,-0.21167 -0.670278,-0.35278 -1.234723,-0.35278 -0.811389,0 -1.058333,-0.21166 -1.375833,-1.12889 -0.317499,-0.84666 -0.493889,-1.02305 -0.811389,-0.70555 -1.128889,1.12889 -1.199445,0.0353 -0.352778,-4.62139 0.352778,-1.86972 1.128889,-3.06917 1.128889,-1.69333 0,1.5875 0.635,0.35277 0.776111,-1.55223 0.105833,-1.30527 0.423333,-2.29305 0.917222,-2.92805 2.751673,-3.42195 3.245563,-4.72722 3.245563,-8.71361 0,-1.72861 0.17639,-3.03389 0.42333,-3.28084 0.45861,-0.45861 0.49389,-3.56305 0.10584,-10.58333 -0.24695,-4.1275 -0.21167,-4.65667 0.3175,-4.65667 0.59972,0 0.77611,0.56445 1.05833,3.42195 0.24694,2.46944 1.16417,4.1275 3.66889,6.56167 2.18722,2.18722 3.03389,2.2225 1.94028,0.14111 -0.35278,-0.635 -1.02306,-1.905 -1.48167,-2.78695 -0.77611,-1.48166 -0.81139,-1.69333 -0.35278,-2.71639 0.3175,-0.67027 0.74083,-1.09361 1.16417,-1.09361 0.38805,0 1.19944,-0.17639 1.79916,-0.38805 2.01084,-0.74084 10.05417,1.65805 13.22917,3.91583 0.91722,0.635 1.23472,0.70556 2.36361,0.38806 0.74083,-0.21167 1.83444,-0.38806 2.46944,-0.38806 1.5875,0 4.97417,1.12889 6.70278,2.2225 1.34055,0.84667 1.94028,0.98778 5.29167,1.09361 5.78555,0.24695 15.98083,2.25778 19.685,3.91583 0.98777,0.42334 2.8575,0.88195 4.19805,0.98778 1.34056,0.14111 3.10444,0.56445 3.95111,0.9525 1.09361,0.56445 3.73945,1.02306 9.91306,1.76389 9.17222,1.16417 14.9225,1.62278 14.9225,1.30528 0,-0.49389 -3.66889,-2.01084 -10.58334,-4.445 -3.98639,-1.41111 -8.07861,-2.8575 -9.10166,-3.21028 -1.05834,-0.38805 -2.68111,-0.70555 -3.66889,-0.70555 -0.98778,0 -2.68111,-0.35278 -3.91584,-0.84667 -1.23472,-0.45861 -3.35138,-0.91722 -4.83305,-1.05833 -4.55083,-0.35278 -16.05139,-3.59834 -19.93194,-5.60917 -1.12889,-0.59972 -2.08139,-0.74083 -4.93889,-0.77611 -3.73945,0 -6.10306,-0.74084 -7.83167,-2.36361 -0.70556,-0.635 -1.16417,-0.70556 -4.445,-0.67028 -4.65666,0.10583 -11.21833,-1.27 -12.24138,-2.50472 -1.44639,-1.72861 -0.38806,-3.31611 3.31611,-5.00945 1.76389,-0.81139 2.96333,-1.79917 2.61055,-2.18722 -0.10583,-0.0706 -1.55222,0.17639 -3.24555,0.59972 -3.4925,0.88194 -6.49111,2.54 -8.21972,4.51556 -1.37584,1.65805 -2.32834,1.97555 -3.13973,1.05833 -0.49389,-0.56444 -0.52916,-0.84667 -0.21166,-1.5875 0.84666,-1.76389 0.21166,-6.6675 -1.12889,-8.78417 -0.705564,-1.12889 -1.340564,-6.87917 -1.09362,-9.63083 0.246945,-2.2225 0.176389,-2.54 -0.493888,-3.21028 -0.670278,-0.67028 -0.740834,-1.16417 -0.776112,-4.30389 0,-2.46944 -0.246944,-4.23333 -0.705555,-5.67972 C 96.988477,101.5993 96.600422,99.835411 96.45931,98.812356 96.318199,97.7893 95.965422,96.484022 95.683199,95.919578 95.400977,95.319856 94.836533,93.450133 94.483755,91.7568 c -0.599722,-3.033889 -0.599722,-3.139722 0.03528,-3.704166 0.811389,-0.740834 1.622778,-3.316111 1.340555,-4.339167 -0.105833,-0.423333 0.03528,-1.869722 0.282223,-3.210278 0.282222,-1.340555 0.529166,-3.245555 0.529166,-4.233333 0,-1.763889 0,-1.799167 0.705556,-1.164167 0.599722,0.529167 0.811389,0.564445 1.763889,0.176389 1.763896,-0.740833 2.116676,-1.516944 1.587506,-3.4925 -0.49389,-1.905 -1.05834,-3.069166 -1.69334,-3.457222 -1.093611,-0.705555 -1.305278,-2.116666 -0.776111,-4.974166 0.917222,-4.7625 0.599722,-8.149167 -0.846667,-8.748889 -0.3175,-0.105833 -1.904999,-0.3175 -3.563055,-0.458611 l -2.963333,-0.211667 -0.105834,-3.175 c -0.141123,-3.845214 -0.4939,-5.150492 -1.834456,-7.302436 -1.375833,-2.151944 -2.575288,-2.928055 -4.480288,-2.822222 l -1.552222,0.07056 0.07055,-1.340555 c 0.07056,-1.975556 -0.246939,-3.598334 -1.305273,-6.173612 -0.493889,-1.27 -0.987777,-2.610555 -1.058333,-2.963333 -0.282222,-1.375833 -1.058333,-3.175 -1.834444,-4.233333 -0.458611,-0.599722 -0.811389,-1.27 -0.811389,-1.446389 0,-0.388056 -3.139722,-3.351389 -4.092222,-3.845278 -0.811389,-0.458611 -4.550834,-0.881945 -4.833056,-0.564445 z m 26.35251,79.798332 c -0.282222,0.317502 -0.776111,-0.423333 -0.599722,-0.917222 0.211667,-0.529166 0.246944,-0.493889 0.458611,0.105834 0.141111,0.352777 0.211667,0.740833 0.141111,0.811388 z m -20.249454,68.615272 1.5875,0.74084 0.599722,2.99861 c 1.375833,6.73805 1.164166,11.04194 -0.635,12.73528 -0.458611,0.42333 -0.846667,1.02305 -0.846667,1.30527 0,0.28223 -0.3175,0.91723 -0.705555,1.48167 -0.811389,1.16417 -1.023056,4.02167 -0.388056,5.57389 0.246945,0.56444 0.388056,1.79917 0.3175,2.75167 l -0.105833,1.72861 -2.116667,-3.13972 c -1.834444,-2.75167 -5.609166,-6.56167 -6.491111,-6.56167 -0.141111,0 -0.458611,-0.38806 -0.670278,-0.88195 -0.246944,-0.49388 -0.811388,-1.05833 -1.305277,-1.23472 -0.493889,-0.17639 -0.917223,-0.56444 -0.917223,-0.88194 -0.211666,-2.64584 -0.176388,-2.82222 1.128889,-4.23334 2.116667,-2.29305 7.373056,-11.71222 7.373056,-13.22916 0,-0.45861 0.881944,-0.24695 3.175,0.84666 z"\r
       id="path3"\r
       style="fill:currentColor;fill-opacity:1;stroke:none;stroke-width:0.0352778" />\r
  </g>\r
</svg>\r
`,e7=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>\r
<svg\r
   width="2342"\r
   height="3750"\r
   viewBox="0 0 2342 3750"\r
   version="1.1"\r
   id="svg1"\r
   sodipodi:docname="mechant.svg"\r
   inkscape:version="1.4.2 (f4327f4, 2025-05-13)"\r
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\r
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\r
   xmlns="http://www.w3.org/2000/svg"\r
   xmlns:svg="http://www.w3.org/2000/svg">\r
  <defs\r
     id="defs1" />\r
  <sodipodi:namedview\r
     id="namedview1"\r
     pagecolor="#ffffff"\r
     bordercolor="#000000"\r
     borderopacity="0.25"\r
     inkscape:showpageshadow="2"\r
     inkscape:pageopacity="0.0"\r
     inkscape:pagecheckerboard="0"\r
     inkscape:deskcolor="#d1d1d1"\r
     inkscape:zoom="0.21733333"\r
     inkscape:cx="1171.0123"\r
     inkscape:cy="1875"\r
     inkscape:window-width="1920"\r
     inkscape:window-height="1017"\r
     inkscape:window-x="-"\r
     inkscape:window-y="-8"\r
     inkscape:window-maximized="1"\r
     inkscape:current-layer="svg1" />\r
  <path\r
     fill-rule="nonzero"\r
     fill="#000000"\r
     fill-opacity="1"\r
     d="m 1179.4102,3716.9922 c -17.3907,-74.8555 -35.9414,-120.9844 -69.0313,-171.7774 -30.6094,-46.9726 -82.0898,-92.3789 -115.62499,-102 -9.15235,-2.625 -10.1875,-2.039 -14.46875,8.211 -2.53907,6.0703 -9.29688,27.6328 -15.01954,47.9101 -11.40625,40.4102 -25.3125,77.6563 -29,77.6563 -1.29296,0 -4.19531,-12.1133 -6.44921,-26.918 -6.85938,-45.0625 -25.47266,-111.832 -39.1875,-140.5703 -15.55469,-32.5898 -37.56641,-58.125 -60.26954,-69.918 -13.26171,-6.8906 -21.32421,-8.6875 -39.5039,-8.7929 -26.72266,-0.1563 -41.25781,5.8086 -60.45703,24.8164 -14.30469,14.164 -16.1836,14.9531 -16.28516,6.8594 -0.14062,-11.0079 -12.54687,-33.0313 -25.9375,-46.0235 -52.17578,-50.6328 -129.63672,-52.4961 -178.97266,-4.3008 -10.42578,10.1836 -21.48828,22.1836 -24.58203,26.6719 -5.5625,8.0625 -5.60937,7.9258 -4.17187,-11.4219 0.92187,-12.4336 11.65625,-51.1172 29.42578,-106.0351 62.49609,-193.1406 112.14844,-389.7969 155.69141,-616.6485 18.38671,-95.7812 35.44921,-222.3007 35.53125,-263.4609 l 0.0391,-17.1289 h -13.9961 c -32.30859,0 -86.14843,-21.6016 -135.19531,-54.2305 C 451.2891,2202.9102 384.21879,2073.8789 376.1602,1931.6914 l -2.07813,-36.6133 -92.28125,-185.9687 C 231.04687,1606.8203 167.20703,1474.6797 139.93359,1415.4609 76.816406,1278.4102 44.253906,1214.0586 17.546875,1173.6094 1.621094,1149.4805 -2.457031,1141.1289 1.300781,1140.3281 c 9.125,-1.9375 67.613281,12.9532 128.253909,32.6524 63.97656,20.789 114.91015,41.039 149.80859,59.5781 11.91406,6.3203 22.19141,10.9727 22.83203,10.332 0.64453,-0.6406 -6.85156,-34.75 -16.65625,-75.8008 -39.96484,-167.3398 -42.8164,-188.92964 -42.79297,-324.23043 0.0117,-82.66015 1.15625,-109.98046 5.83985,-139.60937 5.70703,-36.10156 23.48047,-112.28125 28.19531,-120.85156 2.13672,-3.87891 46.05469,69.26172 73.13281,121.80078 4.625,8.97265 11.3086,19.98047 14.85938,24.46094 l 6.44922,8.14843 7.98046,-17.9375 C 383.59375,709.01172 394.86328,683.32031 404.25,661.78125 442.76172,573.42969 496.08984,474 550.375,389.35156 c 9.78125,-15.26172 42.82031,-62.97265 73.42187,-106.04297 92.47657,-130.14843 130.32813,-180.25 132.13282,-174.89843 0.52734,1.57031 -3.46485,20.37109 -8.8711,41.78906 C 721.60937,251 718.21094,332 737.92187,367.83984 c 6.26954,11.39844 9.09766,13.5 19.33985,14.35157 15.53515,1.29687 20.58203,-1.5 82.62109,-45.72266 88.19531,-62.85938 122.33594,-82.6875 262.98829,-152.70703 50.1602,-24.97266 103.6289,-53.5 118.8008,-63.40234 40.8789,-26.64063 78.0976,-63.898442 97.6562,-97.757818 18.8321,-32.570312 19.3516,-32.203124 22.7032,16.007813 4.6406,66.839845 14.1093,105.718745 36.3984,149.460935 39.6289,77.75781 131.8516,149.3711 209.5,162.69141 26.8906,4.60937 41.2109,1.53906 61.5508,-13.20313 14.6797,-10.6289 35.6992,-47.6875 45.5781,-80.34765 10.5898,-35.05078 6.3516,-154.75 -7.5391,-212.890628 -0.9687,-4.039062 -0.3476,-7.339843 1.3711,-7.339843 5.0391,0 37.711,72.480471 57.3477,127.238281 9.9805,27.82031 29.4219,85.8125 43.2031,128.88281 29.3477,91.63672 46.9688,137.10938 72.8789,188.08985 19.2891,37.9375 83.0508,148.6289 89,154.48828 2.2188,2.1914 5.0313,0.57031 8.5195,-4.89844 19.4883,-30.47266 67.8711,-61.78125 106.2383,-68.76172 30.1407,-5.46875 31.6211,-2.66016 10.6211,20.03125 -22.9492,24.77734 -41.9375,63.57813 -49.4179,100.9375 -6.1602,30.76172 -5.543,104.87109 1.8984,228.39063 6.1016,101.17189 1.6406,283.24219 -8.4883,346.44139 l -1.9297,12.0078 35.5469,-20.2773 c 63.1797,-36.0625 178.2109,-81.5899 255.332,-101.082 17.0508,-4.3086 31.5782,-7.3204 32.3008,-6.6875 0.7188,0.6289 -6.7226,11.8085 -16.5312,24.8476 -42.1719,56.0508 -67.0704,92.3399 -95.8086,139.6328 -20.2422,33.3086 -84.3907,159.8594 -122.0118,240.6875 -34.7109,74.5703 -100.9687,208.5625 -127.4492,257.7422 l -23.3711,43.3789 8.5899,35.9297 c 16.332,68.2813 18.1992,120.6406 6.5,181.9883 -25.9492,136.0625 -111.0977,238.8125 -220.3477,265.8828 -25.1523,6.2305 -61.0625,6.8594 -84.3633,1.4805 -9.0976,-2.1016 -17.3789,-2.9805 -18.3984,-1.961 -4.8398,4.8282 8.7109,166.6875 23.0195,275.0703 17.5508,132.9375 27.0586,180.9141 70.461,355.5157 28.9687,116.5781 29.8789,119.8476 68.6992,247.1328 18.5117,60.7148 32.0703,110.7187 31.4101,115.8242 l -1.1796,8.9883 -4.2696,-8.5586 c -7.6523,-15.3281 -27.9804,-24.0664 -55.9804,-24.0664 -21.9102,0 -27.3789,1.3554 -49.5,12.2851 -29.7813,14.7227 -53.0586,38.4688 -58.8204,60.0157 -2.0898,7.7851 -4.5898,14.0351 -5.5585,13.8867 -0.9727,-0.1485 -9.1524,-9.2617 -18.1797,-20.2461 -20.6914,-25.1797 -39.4102,-35.2813 -69.2227,-37.336 -60.5976,-4.1835 -103.5703,40.6055 -123.25,128.4571 -9.0703,40.4883 -17.8281,95.0742 -17.8594,111.2929 -0.01,5.8321 -1.3086,10.6016 -2.8906,10.6016 -4.5898,0 -24.7695,-44.2031 -37.9805,-83.1992 -6.6875,-19.7383 -14.9375,-41.3984 -18.3476,-48.1367 l -6.1992,-12.2461 -11.3125,4.7226 c -43.5196,18.1836 -98.4805,81.2813 -124.461,142.8907 -14.9687,35.4882 -28.9883,82.4218 -37.3086,124.8437 -3.8711,19.7422 -8.1406,37.9609 -9.5,40.4883 -1.4882,2.8008 -5.8398,-9.9649 -11.1093,-32.625 z m 252.4492,-526.6289 c 3.8906,-143.336 6.4297,-182.332 19.8515,-305.0625 18.1993,-166.4805 34.3594,-261.8906 58.8282,-347.4727 14.3515,-50.1875 37.332,-110.7578 52.6015,-138.6679 5.3985,-9.8711 7.5391,-15.7383 4.7696,-13.0508 -6.1797,6.0117 -51.3204,90.9023 -63.0313,118.5195 -56.9883,134.5508 -90.5781,340.2422 -97.3281,596.0117 -3.1602,119.4805 5.8008,284.1328 17.1094,314.8203 1.3281,3.6055 2.7382,-17.6718 3.1289,-47.2812 0.3906,-29.6094 2.2304,-109.625 4.0703,-177.8164 z m -476.23831,206.4961 c 0,-2.168 2.36719,-23.0938 5.25782,-46.4922 4.29687,-34.7774 4.93359,-63.4024 3.49218,-156.7422 -1.72656,-111.3477 -5.07812,-159.8398 -20.32031,-293.6406 -22.0625,-193.7344 -77.27344,-378.336 -148.32812,-495.9727 -9.19532,-15.2304 -17.26172,-27.6914 -17.92188,-27.6914 -0.66016,0 3.71484,10.6485 9.72266,23.6602 36.0039,77.9804 83.30859,259.0898 109.29297,418.4375 28.6875,175.9179 46.22265,350.1601 50.98046,506.5312 1.26563,41.7227 3.54688,75.8594 5.06641,75.8594 1.51563,0 2.75781,-1.7773 2.75781,-3.9492 z m 707.76951,-177.1328 c -3.2617,-23.3282 -9.0117,-67.375 -12.789,-97.8789 -12.5821,-101.6602 -23.0625,-175.3789 -37.543,-264.2774 -7.8984,-48.4531 -16.0703,-100.207 -18.168,-115.0117 -9.4101,-66.6992 -7.3203,-3.0469 3.7891,115.0117 8.3789,88.9766 17.1406,155.0156 30.7617,231.7617 16.3399,92.086 35.4883,177.8164 38.8594,173.9766 0.5586,-0.6406 -1.6406,-20.2539 -4.9102,-43.582 z m -949.50779,-83.1953 c 16.32422,-93.6016 27.94922,-209.0079 31.05078,-308.3243 1.99219,-63.6757 -0.17187,-59.7031 -12.4375,22.836 -11.72656,78.9179 -28.77734,273.2695 -27.84375,317.375 0.34766,16.3008 1.54688,12.1523 9.23047,-31.8867 z m 514.98829,-8.211 c 22.2187,-19.0234 25.4883,-43.332 8.8008,-65.5586 -16.1133,-21.4648 -45.2617,-26.3398 -66.6133,-11.1367 -38.3867,27.3398 -18.0898,88.168 29.4414,88.168 12.3984,0 17.2617,-1.9649 28.3711,-11.4727 z m -13.7617,-365.2578 c 18.5625,-10.875 33.1406,-28.2422 45.1797,-53.793 8.6718,-18.3906 10.0625,-24.9882 9.9922,-47.4609 -0.1016,-30.0078 -6.9805,-48.8867 -26.5196,-72.7383 -42.4531,-51.8008 -123.2617,-33.3008 -142.8711,32.6914 -6.3203,21.2891 -6.3906,61.8086 -0.1523,82.8281 16.9101,56.9336 70.3711,84.2618 114.3711,58.4727 z m 110.8203,-103.7031 c 13.6289,-29.9688 22.25,-69.7578 22.4609,-103.5899 0.1602,-26.8281 -0.9687,-33.4804 -8.3906,-49.5078 -18.2109,-39.3125 -52.2109,-64.4336 -90.9414,-67.2031 -21.3672,-1.5273 -22.9492,-1.0977 -49.7695,13.5195 -34.418,18.7617 -47.1289,19.6836 -67.5703,4.8711 -45.0391,-32.6289 -88.5391,-30.6875 -124.0782,5.5196 -7.82419,7.9726 -15.46873,14.5 -16.98826,14.5 -3.83984,0 -17.79687,-31.668 -20.48047,-46.4688 -2.41796,-13.3203 0.16016,-28.5703 4.82422,-28.5703 1.61328,0 6.10938,9.5391 9.99219,21.1992 3.87891,11.6719 7.77344,21.2109 8.65234,21.2109 0.87891,0 8.46878,-5.789 16.85938,-12.8789 21.6719,-18.2617 43.0195,-26.9296 66.3906,-26.9296 16.3203,0 24.3086,2.3906 51.0313,15.1992 l 31.6875,15.1992 24.4297,-10.4688 c 55.5898,-23.8007 110.25,-13.0898 153.3711,30.0274 16.539,16.543 32.2812,44.8125 35.9101,64.4726 1.8594,10.0704 2.5899,10.8594 4.8516,5.3204 30.8398,-75.6719 66.789,-146.0704 97.039,-190.0313 23.0274,-33.4492 56.0079,-63.6211 79.6172,-72.8398 17.2735,-6.7383 24.9414,-7.4883 81.0625,-7.9297 66.7188,-0.5196 81.5196,-2.8907 114.4492,-18.2696 44.629,-20.8515 80.8985,-57.6914 105.6993,-107.3515 26.0507,-52.1797 34.0898,-90.3711 34,-161.5 -0.078,-57.7891 -3.25,-84.5899 -19.6993,-166.3985 -21.1679,-105.3515 -21.4609,-171.0312 -1.289,-290.3593 19.039,-112.6211 19.1992,-140.1211 1.2578,-213.6133 -25.0586,-102.6367 -62.8984,-173.5195 -126.4375,-236.8399 -57.4922,-57.289 -123.7109,-96.88668 -205.8594,-123.07809 C 1489.1992,921 1462.5703,916.85156 1422.0781,918.5 c -38.1992,1.57031 -54.3086,7.64062 -80.7578,30.46094 -25.0586,21.61718 -48.6406,78.78906 -76.5586,185.61716 l -7.6015,29.0703 -13.4297,-22.5898 c -30.0899,-50.6602 -95.6211,-94.6602 -190.2305,-127.7383 -85.77734,-29.99999 -150.83984,-40.78905 -244.69922,-40.62108 -76.19531,0.15234 -114.875,5.90234 -168.39062,25.01953 C 568,1023.6016 519.32422,1062.7109 494.09375,1115.3008 c -26.625,55.4805 -32.33984,108.2773 -29.84375,275.6875 1.03125,69.0898 1.22656,124.1523 0.43359,122.3515 -1.96875,-4.4609 -23.82422,-162.3203 -27.78125,-200.6484 -4.76953,-46.2617 -4.02734,-122.2812 1.50782,-154.0117 5.64453,-32.3594 24.76562,-89.2305 37.05468,-110.1992 11.125,-18.9805 42.41407,-56.30081 60.10157,-71.67191 56.8164,-49.38672 122.34375,-72.59765 223.70312,-79.23828 48.76953,-3.19922 56.28906,-4.39844 54.91016,-8.80859 -0.87891,-2.82031 -8.45703,-21.89063 -16.84375,-42.39063 -16.83985,-41.16015 -28.78516,-89.58984 -34.03516,-137.97265 -4.05859,-37.38672 -4.15625,-96.07813 -0.17578,-105.33985 2.27344,-5.29687 2.84766,-4.29687 3.03516,5.26172 0.32812,16.98828 18.11718,113.19141 27.84375,150.60938 13.96875,53.71093 46.52343,139.12109 53.20312,139.55078 1.30859,0.0898 17.79688,2.10937 36.63672,4.5 18.84375,2.3789 34.63672,4.00781 35.10156,3.62109 0.46485,-0.39062 -3.46875,-11.17187 -8.73828,-23.96094 -19.42969,-47.10937 -42.05859,-133.53906 -50.56641,-193.12109 -9.62109,-67.39062 -15.23828,-183.39844 -9.0664,-187.21094 1.4375,-0.88672 6.70312,25.8125 11.69922,59.35157 23.42968,157.30859 33.05078,203.39843 59.07422,283.01171 22.79296,69.73829 15.39062,61.48829 71.80859,80.06641 68.50395,22.57031 126.62505,52.65234 179.18355,92.76172 15.2188,11.6211 29,21.1211 30.6094,21.1211 1.6602,0 1.8711,-6.7109 0.4805,-15.5 -1.3399,-8.5195 -4.1289,-42.66016 -6.1992,-75.85157 -4.211,-67.67969 -13.3907,-162.50781 -23.0196,-237.94922 -3.5312,-27.6914 -5.8125,-50.96094 -5.0625,-51.71094 2.6329,-2.6289 21.5235,63.10157 27.9414,97.16016 10.8399,57.55078 13.3516,89.08203 15.2188,190.87109 1.582,86.71098 2.4922,99.51958 8.0195,112.32028 3.5235,8.1485 7.4102,13.1289 8.9102,11.418 1.4726,-1.6601 6.0625,-16.2383 10.1914,-32.3906 8.3789,-32.7578 21.4922,-68.63674 43.7187,-119.67971 23.7618,-54.58984 26.293,-68.78906 26.3008,-147.85937 0,-72.57813 -3.4883,-115.6875 -16.6289,-205.55078 -8.9492,-61.12891 -38.0312,-207.4375 -51.8906,-261.00782 -0.9414,-3.62109 0.7617,-2.21093 3.8008,3.16797 27.3593,48.26172 59,171.13282 77.75,301.89063 16.039,111.92969 17.7187,172.16015 6.4609,231.65234 -2.5508,13.45703 -4.6328,24.53906 -4.6328,24.62891 0,0.0781 10.9297,-5.17969 24.293,-11.69922 28.3984,-13.85156 65.2773,-22.72266 94.457,-22.72266 48,0 110.8711,16.92188 167.3633,45.05078 107.2695,53.40235 184.0195,129.41013 239.457,237.17193 23.1524,45 22.8399,41.4101 -4.0781,-47.3125 -30.4492,-100.32818 -36.75,-134.62896 -36.5625,-199.01958 0.1133,-39.21094 1.5117,-57.82031 5.1211,-68.50781 l 4.9609,-14.67188 2.2305,26.08984 c 6.1992,72.40235 17.6484,138.17969 34.539,198.40233 19.6016,69.8867 42.5704,175.5899 48.879,224.8672 3.621,28.2422 6.9531,74.7422 7.4101,103.3399 0.4609,28.6093 1.8399,50.2304 3.0703,48.0507 3.5391,-6.3007 21.5899,-120.7187 25.5508,-161.9414 5.9102,-61.6679 7.8984,-226.61716 3.4492,-287.11716 -7.3398,-99.88282 -29.6797,-190.25 -63.3789,-256.3711 l -14.832,-29.10937 -0.2188,22.83984 c -0.3007,31.21094 -5.9492,82.60938 -9.8007,89.21094 -2.2774,3.89062 -3.1875,-0.53125 -3.2696,-15.80078 -0.2773,-54.83985 -15.8906,-108.83985 -55.6484,-192.5 -28.582,-60.14063 -49.2813,-109.46875 -60.2617,-143.55078 -3.1797,-9.8711 -6.2383,-18.48828 -6.8086,-19.14844 -0.5703,-0.67188 -7.3516,4.20703 -15.0586,10.83984 -17.2422,14.8086 -53.8321,32.5586 -76.9922,37.34766 -24.9688,5.17187 -69.1797,4.40234 -95.8594,-1.66797 -44.8008,-10.19141 -83.2305,-29.62109 -128.289,-64.87109 -62.4219,-48.83985 -93.2305,-93.89063 -108.1211,-158.08985 -2.7305,-11.73828 -5.4883,-21.89062 -6.1485,-22.55078 -0.6523,-0.64844 -13.3906,5.44141 -28.2929,13.53906 -14.8985,8.10157 -59.3985,28.65235 -98.879,45.66016 -174.10152,75.03125 -254.00386,120.72266 -363.22261,207.74219 -27.48047,21.89844 -55.1836,41.98828 -61.56641,44.66015 -29.54687,12.33985 -66.04687,-8.82031 -87.19531,-50.55078 -8.75391,-17.26953 -18.125,-57.89062 -18.33985,-79.48047 l -0.13671,-14.00781 -7.89063,22.83985 c -17.38281,50.32031 -21.99219,78.25 -21.80859,132.13671 0.35937,104.04297 24.70312,220.21094 67.28906,321.10157 18.46875,43.76172 18.64453,44.32031 13.90625,44.32031 -4.48047,0 -25.25391,-32.60938 -41.46875,-65.08984 -23.32422,-46.73047 -51.96094,-131.92969 -66.39844,-197.55079 -7.16797,-32.58984 -12.86328,-95 -10.41406,-114.17968 l 2.08203,-16.32813 -13.63281,22.83985 c -31.75391,53.17968 -63.24219,126.92968 -97.83594,229.16015 -26.28906,77.66797 -34.85547,96.83985 -50.46484,112.91797 -14.48438,14.91016 -27.87891,15.98047 -41.14063,3.26953 l -9.02344,-8.64844 1.48047,11.09766 c 0.81641,6.10156 3.76953,34.58203 6.5625,63.29297 2.79297,28.71875 9.60938,82.30855 15.14844,119.08985 9.47266,62.8789 10.16406,73.918 11.5625,184.3398 0.82031,64.6094 0.75781,116.7305 -0.13281,115.8282 -1.8711,-1.8789 -9.66016,-66.4805 -17.10938,-141.9297 C 367.98047,1046.4102 353.51953,961.58984 326.375,865.69922 317.48437,834.30078 308.64844,802 306.74219,793.92187 c -5.32813,-22.52343 -1.75,137.27735 4.45703,199.01954 6.73047,66.99999 18.66406,146.99999 30.90625,207.17969 11.53125,56.6875 11.94922,58.207 46.29687,167.8281 58.89063,187.9727 70.33594,263.5508 66.24219,437.4102 -1.89844,80.4492 -1.42969,94.2695 4.52344,133.7617 17.55078,116.418 61.64453,200.2383 134.25781,255.2187 45.15234,34.1915 91.67969,50.8711 151.75391,54.4219 49.69922,2.9297 58.85156,6.5196 89.80078,35.168 21.3789,19.8008 68.35547,80.6797 107.24609,138.9805 35.01563,52.5 72.19534,128.8711 92.39454,189.7812 l 17.25,52.0391 1.9375,-28.1211 c 1.4531,-21.0391 4.1211,-32.5899 10.6406,-45.9102 22.8399,-46.6679 83.3594,-77.1679 134.5508,-67.8086 54.8984,10.0313 93.3086,47.8985 105.3203,103.8399 8.9883,41.8789 10.9414,49.7578 12.3399,49.7578 0.8086,0 4.9804,-7.707 9.2695,-17.1289 z m -159.8594,-285.9375 c -29,-7.5508 -63.1211,-34.8516 -80.9414,-64.7617 -8.3594,-14.0196 -11.707,-17.1016 -16.9375,-15.6094 -3.5898,1.0195 -23.7812,3.5195 -44.8711,5.539 -21.082,2.0313 -38.33202,4.9297 -38.33202,6.4493 0,7.6406 -7.60937,1.1523 -13.01953,-11.0977 -23.05078,-52.1719 2.92187,-130.7226 50.54295,-152.8516 18.8594,-8.7617 33.6602,-7.8398 51.0469,3.1915 24.3633,15.4375 35.1211,39.8789 41.832,95.0078 1.8594,15.25 5.6211,34.3398 8.3477,42.4218 6.3515,18.75 24.8828,44.0586 38.3711,52.3907 17.582,10.8593 24.1211,11.1484 38.332,1.75 25.8477,-17.1016 42.2969,-49.3321 48.6172,-95.2032 4.793,-34.75 11.6328,-54.1992 25.4297,-72.2773 l 11.5508,-15.1211 -8.3985,-7.2187 c -16.9101,-14.543 -1.1601,-14.9415 32.7305,-0.8399 41.1484,17.1367 59.3906,41.7969 68.1992,92.2383 5.211,29.7891 1.8594,69.6601 -7.3594,87.4609 -5.0312,9.7383 -5.6992,10.0782 -8.1914,4.0977 -1.5,-3.5664 -5.6211,-13.4492 -9.1601,-21.9375 l -6.4297,-15.4414 -15.6406,6.9219 c -15.9883,7.0781 -45.8203,9.75 -58.1602,5.1992 -5.75,-2.1094 -7.2187,-0.4492 -11.0703,12.5898 -6.1602,20.8711 -22.0469,40.7305 -39.418,49.2578 -16.5,8.1016 -42.4023,11.6602 -57.0703,7.8438 z m 158.2383,-113.9922 c 23.1133,-16.668 24.582,-48.5195 3.2227,-69.8906 -16.211,-16.1993 -26.4297,-16.2188 -41.6524,-0.09 -19.6992,20.8906 -26.3789,49.5 -15.2578,65.3711 9.8594,14.0899 37.2891,16.4414 53.6875,4.6094 z m -255.8789,1.1797 c 8.5508,-3.5781 13.1406,-8.6094 18.1406,-19.9102 7.4688,-16.8789 6.4805,-30.4375 -3.6601,-50.1992 -17.2813,-33.6992 -45.5586,-37.0781 -64.9688,-7.7812 -17.1211,25.8515 -16.2812,46.3203 2.6484,64.4531 7.1993,6.8984 26.3399,16.6562 35.4688,18.0781 0.5,0.078 6.0703,-2.0117 12.3711,-4.6406 z m -385.56251,-65.1289 c -22.03125,-5 -47.78907,-17.0391 -69.1836,-32.3399 -17.65234,-12.6211 -45.46875,-49.0195 -60.24609,-78.832 -17.97656,-36.2695 -17.69922,-41.1367 0.93359,-16.3086 48.14453,64.1406 95.76953,97.1406 167.28125,115.8906 18.02735,4.7188 27.52735,8.6602 25.58594,10.5977 -5.19141,5.1914 -43.3125,5.7812 -64.37109,0.9922 z m 926.86331,-3.4024 c -37.211,-8.0976 -88.6914,-33.207 -105.9492,-51.6797 -5.2305,-5.5976 -8.9727,-10.707 -8.3204,-11.3593 0.6485,-0.6485 14.1602,3.2226 30.0196,8.6015 66.8593,22.6602 132.289,27.9805 175.6679,14.3086 41.6016,-13.1094 92.711,-47.6289 120.6914,-81.5078 13.4493,-16.2812 15.8204,-12.6211 5.3204,8.1797 -44.0704,87.3086 -130.4805,132.3984 -217.4297,113.457 z m -395.0196,-32.7187 c 5.2696,-20.5313 8.2383,-114.668 4.8399,-153.7305 -3.6719,-42.0898 -2.0195,-105.2695 2.9805,-114.1992 1.8085,-3.2383 6.1484,5.9609 13.5703,28.8086 6,18.4609 13.3398,39.3203 16.3203,46.3633 l 5.4062,12.789 7.3711,-11.9218 c 18.8906,-30.5586 127.1602,-124.4883 232.0313,-201.2969 167.7578,-122.8633 214.2695,-150.0508 256.6797,-150.0508 22.6914,0 33.6992,9.3789 33.6992,28.7187 0,17.2813 -12.3008,33.4102 -44.0508,57.7383 -14.0469,10.7735 -30.8086,24.4922 -37.2383,30.5117 -11.1289,10.3907 -11.1914,10.6016 -1.5,4.1407 24.6914,-16.4297 93.0586,-49.3321 102.5078,-49.3321 15.8516,0 10.9922,9.3829 -11.5781,22.3516 -124.8906,71.7813 -165.8711,100.8984 -235.0508,167.0313 -24.0976,23.039 -53.5586,48.8398 -65.4687,57.3398 l -21.6524,15.4492 14.25,4.1992 c 26.711,7.8907 61.711,11.8789 88.2305,10.0586 67.9727,-4.6562 113.3828,-51.289 135.0117,-138.6562 4.1602,-16.7813 9.3086,-32.6133 11.4414,-35.1914 3.9492,-4.7617 35.1172,-15.5117 56.7188,-19.5586 l 11.8984,-2.2305 -1.9375,35.457 c -4.4805,82.4414 -14.3398,131.7618 -34.8125,174.1329 -45.7305,94.6601 -168.3984,138.3593 -277.6992,98.9296 -42.5,-15.332 -90.9688,-54.0898 -113.1797,-90.5312 -6.9883,-11.4688 -8.1602,-12.1914 -11.2617,-6.8984 -26.3164,44.8281 -66.0664,65.5468 -101.8985,53.1093 l -13.5898,-4.7304 0.4883,42.7617 c 0.5312,46.457 -4.6875,72.5078 -17.4883,87.2265 -6,6.9024 -6.5391,7.0313 -5.0391,1.211 z M 1629.5,2047.7383 c 14.4297,-5.1289 33.1094,-13.3399 41.5,-18.2578 19.5117,-11.4414 51.1602,-40.8086 59.2109,-54.9492 5.2696,-9.2696 4.0977,-8.5625 -7.6992,4.6484 -16.4023,18.3789 -46.2109,40.1406 -73.5703,53.7305 -26.3828,13.1093 -37.6016,16.4609 -73.6719,22.0312 l -30.7304,4.7383 29.3593,-1.3086 c 21.461,-0.9609 36.4297,-3.8203 55.6016,-10.6328 z m -896.38281,28.293 c -45.44141,-11.1719 -85.6875,-31.5196 -118.67969,-60 -33.39453,-28.8399 -64.13672,-85.75 -77.66016,-143.793 -6.39843,-27.457 -18.75781,-103.457 -17.09375,-105.1172 2.60938,-2.6094 49.9961,10 59.69532,15.8789 10.66015,6.4688 11.28515,7.7695 28.79296,59.8711 11.84766,35.2695 24.22657,56.1289 44.92188,75.6992 45.03516,42.5899 113.66797,55.7695 180.57031,34.6797 l 17.51953,-5.5195 -16.6914,-9.1289 c -21.45313,-11.7305 -38.53125,-25.7618 -82.77735,-68.0118 -59.21875,-56.5585 -87.95703,-76.1406 -191.6914,-130.6289 -31.85157,-16.7421 -57.91407,-31.6601 -57.91407,-33.1718 0,-1.5078 3.64454,-4.1289 8.10157,-5.8203 11.37109,-4.3282 33.42968,3.3007 85.69922,29.621 23.77734,11.9688 43.23046,21.25 43.23046,20.6094 0,-0.6406 -20.92187,-14.9297 -46.49218,-31.75 -48.83594,-32.1406 -58.57422,-40.5195 -64.14063,-55.2109 -4.17578,-11.0195 -0.77344,-20.8164 11.04688,-31.8086 7.96093,-7.3984 11.40625,-8.1602 37.05078,-8.1602 27.66797,0 29.08984,0.4024 65.80078,18.211 41.65234,20.2109 87.77734,48.4101 182.71094,111.7109 117.4414,78.3203 193.72261,143.1367 237.75391,202.0391 6.3594,8.5078 12.6484,14.3789 13.9687,13.0508 1.3204,-1.3399 7.4805,-17.5821 13.6915,-36.0899 6.1992,-18.5195 12,-34.3906 12.8789,-35.2695 3.8593,-3.8633 5.5898,45.0976 2.3711,67.2969 -5.6602,39.121 -25.5508,61.9609 -53.961,61.9804 -18.6719,0.02 -33.9609,-9.3906 -48.2305,-29.6679 -6.81636,-9.6915 -13.42183,-17.8516 -14.67964,-18.1329 -1.26172,-0.2773 -9.63282,8.0899 -18.60547,18.6016 -29.4961,34.5313 -90.2461,70.5 -135.14844,80.0195 -29.51172,6.2618 -71.875,5.4297 -102.03906,-1.9882 z m 101.98047,-32.9024 c 23.76562,-5.9805 58.53515,-20.0781 58.53515,-23.75 0,-0.6484 -8.82031,2.3711 -19.60156,6.7305 -10.78125,4.3515 -30.85156,10.789 -44.59766,14.3008 -23.10937,5.9101 -32.80468,9.6406 -25.05859,9.6406 1.75,0 15.57812,-3.1094 30.72266,-6.9219 z M 1060.0313,1744.5508 C 999.94531,1685.6406 863.01172,1611.5586 626.08984,1509.7891 l -17.9414,-7.711 13.50781,-0.078 c 43.24219,-0.25 165.47266,47.5 279.54297,109.1914 76.83984,41.5586 139.81248,86.8477 164.99218,118.668 9.5899,12.1211 21.4492,36.6914 17.3281,35.9101 -1.2578,-0.2382 -11.8281,-9.789 -23.4882,-21.2187 z m 159.9375,-3.2813 c 0.2109,-35.8906 25.6015,-61.6797 92.8007,-94.2382 138.8203,-67.25 229.6524,-108.0704 272.2188,-122.3321 34.3125,-11.5 46.6328,-12.7187 28.0117,-2.789 -7.1406,3.8203 -33.5508,18.7695 -58.6797,33.2187 -65.8789,37.9024 -101.832,57.1094 -182.6992,97.6406 -84.543,42.3516 -116.9023,62.3594 -136.9922,84.6993 l -14.7305,16.3906 z m -37.5899,-133.4297 -9.7891,-4.4804 14.9102,-0.1485 c 32.9805,-0.3203 66.8398,-17.4101 106.6289,-53.8125 23.25,-21.2773 27.6211,-17.4101 9,7.9532 -31.1601,42.4375 -87.168,65.8672 -120.75,50.4882 z M 1124.4219,1479 c -18.8633,-4.75 -60.6602,-27.5703 -57.0821,-31.1484 0.6407,-0.6407 10.629,2.707 22.211,7.4375 29.9609,12.2304 72.0078,12.0625 109.1406,-0.461 14.3594,-4.8281 29.5391,-11.0195 33.7305,-13.7383 10.957,-7.1015 12.9375,-2.5507 4.9297,11.3086 -11.1602,19.293 -30.8399,27.4922 -68.961,28.6914 -17.4297,0.5508 -37.2187,-0.3906 -43.9687,-2.0898 z M 432.74609,1028.1016 c 1.48047,-42.71098 8.55469,-119.91019 14.42578,-157.51176 l 4.07813,-26.10156 2.34766,14.69141 c 4.03906,25.23047 3.04296,77.64843 -2.16407,113.76953 -6.52734,45.28128 -14.57812,86.23048 -17.57812,89.41018 -1.3125,1.3906 -1.8125,-14.0196 -1.11328,-34.2578 z m 22.1211,8.8867 c 19.54687,-57.41018 40.63672,-145.94924 56.73437,-238.16799 7.20703,-41.28125 14.07813,-79.85156 15.27735,-85.71875 4.67578,-22.9414 7.85937,-12.38281 7.85937,26.07813 0,91 -20.74219,193.60937 -52.28906,258.66015 -12.03516,24.80856 -32.67578,54.10936 -27.58203,39.14846 z m 685.09371,-71.77736 c -16.6601,-35.24219 -45.4726,-111.69922 -60.8515,-161.5 -19.3594,-62.65235 -88.47659,-329.74219 -85.9844,-332.23047 2.48828,-2.49219 23.8164,47.35937 39.3047,91.84765 21.5703,61.96094 46.4805,146.8125 74.8789,255.0625 13.6523,52.03907 30.7227,111.9375 37.9297,133.09766 7.2109,21.17188 12.4531,40.26172 11.6406,42.42188 -0.8203,2.16015 -8.4297,-10.75 -16.918,-28.69922 z M 593.96875,876.30859 c -8.24609,-15.77734 -17.69922,-78.3789 -10.6875,-70.80859 2.85156,3.07812 19.97266,65.41016 19.97266,72.69922 0,5.76953 -5.90235,4.57031 -9.28516,-1.89063 z m 394.95312,-11.4375 c -9.93359,-11.96093 -25.72656,-69.1914 -20.0664,-72.6914 2.60937,-1.6211 10.59375,17.80078 20.83594,50.67968 3.07421,9.8711 6.16406,19.78125 6.86718,22.01954 1.64844,5.28125 -3.26172,5.26953 -7.63672,0 z M 701.69922,804.51953 C 687.97656,768.75 684.83203,755.64062 685.04687,735.19141 c 0.14844,-14.28125 0.79688,-16.42188 3.1875,-10.46094 2.51954,6.26953 19.28907,73.1289 24.51563,97.73828 3.04687,14.35156 -1.49219,6.98047 -11.05078,-17.94922 z m 833.41018,10.10156 c -1.0781,-6.90234 -4.9805,-47.05078 -8.668,-89.21093 -7.0117,-80.14063 -14.6914,-136.42969 -27.0312,-198.21875 -4.0391,-20.17969 -6.4805,-36.70313 -5.4297,-36.70313 3.8281,0 26.2812,57.90234 34.1601,88.08984 20.3477,77.92188 28.1992,172.8711 18.4883,223.35157 -4.7187,24.4414 -8.9687,29.1289 -11.5195,12.6914 z m -74.8906,-54.14062 c -1.0274,-7.62891 -2.6485,-25.60938 -3.6094,-39.96875 l -1.75,-26.10156 5.3906,11.41796 c 6.2188,13.19141 10.3594,68.51172 5.1211,68.51172 -1.8125,0 -4.1328,-6.23047 -5.1523,-13.85937 z m 254.5195,-97.87891 c -1.8594,-35.38281 -7.5195,-76.32031 -18.3594,-132.58203 -4.6875,-24.34766 -4.2891,-26.26953 3.1406,-15.05859 7.6211,11.5 20.8516,50.78906 26.1524,77.64843 7.039,35.64063 2.707,109.96094 -6.4024,109.96094 -1.3398,0 -3.3789,-17.99219 -4.5312,-39.96875 z m -38.0586,-36.71094 c 0,-33.67187 0.8086,-41.26953 4.0703,-38.01171 2.75,2.74218 4.0781,15.21093 4.0781,38.01171 0,22.78907 -1.3281,35.26954 -4.0781,38.00782 -3.2617,3.26172 -4.0703,-4.32813 -4.0703,-38.00782 z M 417.36719,1744.5586 c -14.4336,-199.7891 -75.11328,-338.3398 -190.38672,-434.668 -39.04688,-32.6406 -130.617189,-91.7304 -135.132814,-87.2187 -1.113281,1.1172 2.4375,6.7695 7.886719,12.5781 28.312495,30.1602 113.593745,153.4102 160.898435,232.5 49.9375,83.5195 125.22656,236.8789 148.55078,302.6211 4.95313,13.9492 9.60938,24.7695 10.34375,24.0273 0.73828,-0.7265 -0.23437,-23.1601 -2.16015,-49.8398 z m 1481.08201,10.2227 c 24.5899,-73 102.6211,-221.3321 167.3594,-318.1094 46.8203,-69.9922 93.2305,-129.211 136.9805,-174.7735 26.1914,-27.2773 31.7812,-35.8086 16.3125,-24.8984 -4.9414,3.4883 -16.6016,10.1797 -25.9219,14.8711 -29.8399,15.0391 -102.8594,66.0195 -132.3008,92.3789 -77.0976,69.0391 -139.5898,174.3906 -166.0898,280.0195 -5.0703,20.1719 -6.9493,41.3203 -8.2891,92.9922 -1.0586,40.6797 -0.5586,65.6094 1.2617,63.6172 1.6485,-1.7891 6.4571,-13.5391 10.6875,-26.0976 z m 0,0"\r
     id="path1"\r
     inkscape:highlight-color="#aaaaaa"\r
     style="fill:#ffffff;fill-opacity:1" />\r
</svg>\r
`,t7="#87CEFA",n7="#FF0000";function km(r){const e=r.match(/viewBox\s*=\s*"([^"]+)"/i),t=r.match(/<path[^>]*\sd="([^"]+)"[^>]*>/i);if(!e||!t)throw new Error("Cannot parse SVG path/viewBox from source.");const s=t[0].match(/transform="([^"]+)"/i);return{d:t[1],transform:s?s[1]:void 0,viewBox:e[1]}}const r7=km(J9),i7=km(e7);function s7(r){return r==="player"?t7:n7}function o7(r){const e=r==="player"?r7:i7,t=s7(r),s=e.transform?` transform="${e.transform}"`:"";return[`<svg viewBox="${e.viewBox}" xmlns="http://www.w3.org/2000/svg" style="background:none">`,"<g>",`<path d="${e.d}"${s} fill="${t}" />`,"</g>","</svg>"].join("")}function Ud(r){const e=o7(r);return`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(e)))}`}const Cm="token-player-svg",Am="token-enemy-svg";let Gl=null;async function a7(){if(Gl)return Gl;const r=[{alias:Cm,src:Ud("player")},{alias:Am,src:Ud("enemy")}];return Gl=(async()=>{for(const e of r)Os.add(e);await Os.load(r.map(e=>e.alias))})(),Gl}function l7(r){const e=Z.useRef(null),t=Z.useRef(null),s=Z.useRef(null),o=Z.useRef(null),a=Z.useRef(null),u=Z.useRef(null),c=Z.useRef(null),h=Z.useRef(typeof r.zoom=="number"?r.zoom:1),f=Z.useRef({x:typeof r.panX=="number"?r.panX:0,y:typeof r.panY=="number"?r.panY:0});return h.current=typeof r.zoom=="number"?r.zoom:1,f.current={x:typeof r.panX=="number"?r.panX:0,y:typeof r.panY=="number"?r.panY:0},Z.useEffect(()=>{var m;(m=c.current)==null||m.call(c)},[r.zoom,r.panX,r.panY]),Z.useEffect(()=>{if(!r.enabled||!r.containerRef.current||e.current)return;const m=new K0;e.current=m;let y=!1,v=null,x=null,b=!1;return(async()=>{if(await m.init({width:Qo,height:Yl,background:Og,antialias:!0}),b=!0,await a7(),y)return;const w=r.containerRef.current;if(!w)return;w.prepend(m.canvas);const A=new pn;m.stage.addChild(A);const E=new ci;A.addChild(E),(()=>{E.clear();for(let H=0;H<ur;H++)for(let W=0;W<Tr;W++){if(!Er(W,H))continue;const Y=bn(W,H),ge=st,K=st*.5,xe=[Y.x,Y.y-K/2,Y.x+ge/2,Y.y,Y.x,Y.y+K/2,Y.x-ge/2,Y.y],Be=(W+H)%2===0;E.poly(xe).fill({color:Be?1381666:1908016,alpha:1})}})();const M=new pn;A.addChild(M),t.current=M;const D=new ci;A.addChild(D),o.current=D;const z=new pn;A.addChild(z),s.current=z;const L=new pn;A.addChild(L),a.current=L;const G=()=>{const H=r.containerRef.current;if(!H)return;const W=Math.max(1,H.clientWidth),Y=Math.max(1,H.clientHeight);m.renderer.resize(W,Y);const ge=Math.min(W/Qo,Y/Yl),K=h.current,xe=ge*K,Be=(W-Qo*xe)/2+f.current.x,ee=(Y-Yl*xe)/2+f.current.y;A.scale.set(xe),A.position.set(Be,ee),u.current={scale:xe,offsetX:Be,offsetY:ee};const te=m.canvas;te.style.width="100%",te.style.height="100%",te.style.display="block"};v=G,c.current=G,G(),x=new ResizeObserver(()=>G()),x.observe(w),window.addEventListener("resize",G)})(),()=>{y=!0,x&&x.disconnect(),v&&window.removeEventListener("resize",v),b&&e.current&&e.current.destroy(!0),e.current=null,t.current=null,s.current=null,o.current=null,a.current=null,u.current=null,c.current=null}},[r.enabled,r.containerRef]),{appRef:e,obstacleLayerRef:t,tokenLayerRef:s,pathLayerRef:o,speechLayerRef:a,viewportRef:u}}function u7(r){const e=String((r==null?void 0:r.category)??"").toLowerCase();return e==="wall"?9807270:e==="vegetation"?3066993:e==="structure"?12436423:15105570}function c7(r){Z.useEffect(()=>{const e=r.obstacleLayerRef.current;if(!e)return;e.removeChildren();const t=new Map;for(const s of r.obstacleTypes)t.set(s.id,s);for(const s of r.obstacles){const o=t.get(s.typeId)??null,a=bn(s.x,s.y),u=st,c=st*.5,h=[a.x,a.y-c/2,a.x+u/2,a.y,a.x,a.y+c/2,a.x-u/2,a.y],f=new ci;f.poly(h).fill({color:u7(o),alpha:.9}),f.poly(h).stroke({color:723730,width:2,alpha:.8});const m=s.maxHp>0?Math.max(0,Math.min(1,s.hp/s.maxHp)):1,y=Math.max(10,u*.42),v=4,x=a.x-y/2,b=a.y-c*.9;f.rect(x,b,y,v).fill({color:0,alpha:.55}),f.rect(x,b,y*m,v).fill({color:m>.5?3066993:m>.25?15844367:15158332,alpha:.85}),e.addChild(f)}},[r.obstacleLayerRef,r.obstacleTypes,r.obstacles])}function d7(r){Z.useEffect(()=>{const e=r.pathLayerRef.current;if(!e)return;e.clear();const t=r.effectSpecs.map(a=>{switch(a.kind){case"circle":return qp(a.id,r.player.x,r.player.y,a.radius??1);case"rectangle":return Wg(a.id,r.player.x,r.player.y,a.width??1,a.height??1);case"cone":return Kp(a.id,r.player.x,r.player.y,a.range??1,a.direction??"right");default:return{id:a.id,type:"circle",cells:[]}}});for(const a of t)for(const u of a.cells){const c=bn(u.x,u.y),h=st,f=st*.5,m=[c.x,c.y-f/2,c.x+h/2,c.y,c.x,c.y+f/2,c.x-h/2,c.y],y=a.type==="circle"?3447003:a.type==="rectangle"?3066993:15158332;e.poly(m).fill({color:y,alpha:.45})}if(r.showVisionDebug){const a=[r.player,...r.enemies];for(const u of a){const c=Xd(u);for(const h of c.cells){const f=bn(h.x,h.y),m=st,y=st*.5,v=[f.x,f.y-y/2,f.x+m/2,f.y,f.x,f.y+y/2,f.x-m/2,f.y],x=u.type==="player"?2719929:12597547;e.poly(v).fill({color:x,alpha:u.type==="player"?.25:.2})}}}const s=[r.player,...r.enemies];for(const a of s){const u=bn(a.x,a.y),c=st,h=st*.5,f=[u.x,u.y-h/2,u.x+c/2,u.y,u.x,u.y+h/2,u.x-c/2,u.y],m=a.type==="player"?3066993:15158332;e.poly(f).fill({color:m,alpha:.2})}if(r.selectedTargetId){const a=r.enemies.find(u=>u.id===r.selectedTargetId);if(a){const u=bn(a.x,a.y),c=st,h=st*.5,f=[u.x,u.y-h/2,u.x+c/2,u.y,u.x,u.y+h/2,u.x-c/2,u.y];e.poly(f).fill({color:3447003,alpha:.6})}}if(r.selectedPath.length>0){const a=r.selectedPath[r.selectedPath.length-1],u=bn(a.x,a.y),c=st,h=st*.5,f=[u.x,u.y-h/2,u.x+c/2,u.y,u.x,u.y+h/2,u.x-c/2,u.y];e.poly(f).fill({color:15844367,alpha:.2})}for(const a of r.enemies){if(!a.plannedPath||a.plannedPath.length===0)continue;const u=a.plannedPath,c=u[0],h=bn(c.x,c.y);e.setStrokeStyle({width:3,color:15158332,alpha:.9}),e.moveTo(h.x,h.y);for(const f of u.slice(1)){const m=bn(f.x,f.y);e.lineTo(m.x,m.y)}e.stroke()}if(r.selectedPath.length===0)return;e.setStrokeStyle({width:6,color:15844367,alpha:1});const o=bn(r.player.x,r.player.y);e.moveTo(o.x,o.y);for(const a of r.selectedPath){const u=bn(a.x,a.y);e.lineTo(u.x,u.y)}e.stroke()},[r.pathLayerRef,r.player,r.enemies,r.selectedPath,r.effectSpecs,r.selectedTargetId,r.showVisionDebug])}function h7(r){Z.useEffect(()=>{const e=r.speechLayerRef.current;if(!e)return;e.removeChildren();const t=[r.player,...r.enemies],s=new Map(r.speechBubbles.map(f=>[f.tokenId,f])),o=6,a=140,u=st*1,c=[];for(const f of t){if(Yt(f))continue;const m=s.get(f.id);if(!m||!m.text.trim())continue;const y=bn(f.x,f.y),v=new pn,x=new ci;x.beginFill(16777215,.92);const b=new Z9(m.text,{fontFamily:"Arial",fontSize:11,fill:0,align:"center",wordWrap:!0,wordWrapWidth:a-10}),S=Math.min(a,b.width+10),w=b.height+8;x.drawRoundedRect(-S/2,-w,S,w,7),x.endFill(),b.x=-b.width/2,b.y=-w+4,v.addChild(x),v.addChild(b);const A=y.x+st*.05,E=y.y-u;v.x=A,v.y=E,e.addChild(v),c.push({x:A-S/2,y:E-w,width:S,height:w,view:v})}c.sort((f,m)=>f.y-m.y);const h=[];for(const f of c){let m=f.y,y=0;const v=(b,S,w)=>{const A=b.x,E=b.y,P=b.x+b.width,M=b.y+b.height,D=S,z=w,L=S+f.width,G=w+f.height;return A<L&&P>D&&E<G&&M>z};for(;y<20;){const b=h.find(S=>v(S,f.x,m));if(!b)break;m=b.y-f.height-o,y+=1}const x=m-f.y;x!==0&&(f.view.y+=x,f.y=m),h.push(f)}},[r.speechLayerRef,r.player,r.enemies,r.speechBubbles])}function f7(r){Z.useEffect(()=>{const e=r.tokenLayerRef.current;if(!e)return;e.removeChildren();const t=[r.player,...r.enemies];for(const s of t){const o=new pn;if(!Yt(s)){const h=new ci;h.beginFill(0,.4),h.drawEllipse(0,0,st*.4,st*.15),h.endFill(),o.addChild(h)}const a=s.type==="player"?Cm:Am,u=Vs.from(a);u.anchor.set(.5,1),u.width=st*.9,u.height=st*.9,Yt(s)?(u.rotation=Math.PI/2,u.alpha=.7):(u.rotation=0,u.alpha=1),o.addChild(u);const c=bn(s.x,s.y);o.x=c.x+st*.05,o.y=c.y,e.addChild(o)}},[r.tokenLayerRef,r.player,r.enemies])}function p7(r){return C.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",background:"#0b0b12",color:"#f5f5f5",fontFamily:"system-ui, sans-serif",padding:16,boxSizing:"border-box"},children:[C.jsx("h1",{style:{marginBottom:8},children:"Prparation du combat"}),C.jsx("p",{style:{marginBottom:16,fontSize:13,maxWidth:480,textAlign:"center"},children:"Configurez le combat avant de lancer la grille : nombre d'ennemis, puis dmarrez pour effectuer les jets d'initiative et entrer en mode tour par tour."}),C.jsxs("div",{style:{padding:16,borderRadius:8,background:"#141421",border:"1px solid #333",minWidth:260,display:"flex",flexDirection:"column",gap:12},children:[C.jsxs("label",{style:{fontSize:13,display:"flex",flexDirection:"column",gap:6},children:["Contexte de la battle map :",C.jsx("textarea",{value:r.mapPrompt,onChange:e=>r.onChangeMapPrompt(e.target.value),placeholder:"Ex: Un donjon humide: une salle, un couloir, une porte verrouille, des piliers. Ennemis en embuscade au fond.",rows:4,style:{resize:"vertical",minHeight:84,background:"#0f0f19",color:"#f5f5f5",border:"1px solid #333",borderRadius:6,padding:"8px 10px",fontSize:12,lineHeight:1.35}})]}),C.jsxs("label",{style:{fontSize:13},children:["Nombre d'ennemis :",C.jsx("input",{type:"number",min:1,max:8,value:r.configEnemyCount,onChange:e=>r.onChangeEnemyCount(Math.max(1,Math.min(8,Number(e.target.value)||1))),style:{marginLeft:8,width:60,background:"#0f0f19",color:"#f5f5f5",border:"1px solid #333",borderRadius:4,padding:"2px 4px"}})]}),C.jsxs("p",{style:{fontSize:11,color:"#b0b8c4",margin:0},children:["Taille de la carte : actuellement fixe (",r.gridCols," x ",r.gridRows,"). Un redimensionnement dynamique demandera une refonte de boardConfig.ts."]}),C.jsx("button",{type:"button",onClick:()=>{if(r.enemyTypeCount===0){r.onNoEnemyTypes();return}r.onStartCombat()},style:{marginTop:8,padding:"6px 12px",background:"#2ecc71",color:"#0b0b12",border:"none",borderRadius:4,cursor:"pointer",fontWeight:600,fontSize:13},children:"Lancer le combat"})]})]})}function m7(r){return C.jsxs("section",{style:{padding:"8px 12px",background:"#141421",borderRadius:8,border:"1px solid #333"},children:[C.jsx("h2",{style:{margin:"0 0 8px"},children:"tat du combat"}),C.jsxs("div",{children:[C.jsx("strong",{children:"Round :"})," ",r.round," | ",C.jsx("strong",{children:"Phase :"})," ",r.phase==="player"?"Joueur":"Ennemis"]}),C.jsxs("div",{style:{fontSize:12,marginTop:4},children:[C.jsx("strong",{children:"Initiative PJ :"})," ",r.playerInitiative??"en cours..."]}),C.jsxs("div",{children:[C.jsx("strong",{children:"Nom :"})," ",r.sampleCharacter.nom.nomcomplet]}),C.jsxs("div",{children:[C.jsx("strong",{children:"Niveau :"})," ",r.sampleCharacter.niveauGlobal," |"," ",C.jsx("strong",{children:"Classe :"})," ",r.sampleCharacter.classe[1].classeId]}),C.jsxs("div",{children:[C.jsx("strong",{children:"PV :"})," ",r.player.hp," / ",r.player.maxHp]}),C.jsxs("div",{children:[C.jsx("strong",{children:"CA :"})," ",r.sampleCharacter.CA]}),C.jsxs("div",{style:{marginTop:8},children:[C.jsx("strong",{children:"Caracs :"})," FOR ",r.sampleCharacter.caracs.force.FOR," | DEX"," ",r.sampleCharacter.caracs.dexterite.DEX," | CON"," ",r.sampleCharacter.caracs.constitution.CON]}),C.jsxs("div",{style:{marginTop:8,fontSize:12},children:[C.jsx("strong",{children:"Trajectoire :"})," ",r.selectedPath.length===0?"aucune":`(${r.player.x}, ${r.player.y}) -> `+r.selectedPath.map(e=>`(${e.x}, ${e.y})`).join(" -> ")]}),C.jsxs("div",{style:{marginTop:8,fontSize:11,opacity:.85},children:[C.jsx("strong",{children:"IA ennemis (debug) :"}),C.jsxs("div",{children:["Dernier appel :"," ",r.aiLastState?`round ${r.aiLastState.round}, phase ${r.aiLastState.phase}`:"aucun"]}),C.jsxs("div",{children:["Dcisions reues :"," ",r.aiLastIntents===null?"n/a":`${r.aiLastIntents.length} (fallback: ${r.aiUsedFallback?"oui":"non"})`]}),r.aiLastError&&C.jsxs("div",{children:["Erreur : ",r.aiLastError]})]})]})}function g7(r){const{enemies:e,player:t,validatedAction:s}=r;return C.jsxs("section",{style:{padding:"8px 12px",background:"#151524",borderRadius:8,border:"1px solid #333",display:"flex",flexDirection:"column",gap:8},children:[C.jsx("h2",{style:{margin:"0 0 4px"},children:"Ennemis"}),C.jsx("p",{style:{margin:0,fontSize:12,opacity:.85},children:"Chaque ennemi est une entit propre. Capacits IA : dplacement, attaque au contact, attente si aucune option."}),C.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,maxHeight:"180px",overflowY:"auto",paddingRight:4},children:e.map(o=>{var c;const a=r.revealedEnemyIds.has(o.id),u=o.enemyTypeLabel??o.enemyTypeId??"inconnu";return C.jsxs("div",{style:{background:"#0f0f19",border:"1px solid #2a2a3a",borderRadius:8,padding:"8px 10px",display:"flex",flexDirection:"column",gap:6},children:[C.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[C.jsx("strong",{style:{color:"#f5f5f5"},children:o.id}),C.jsxs("span",{style:{fontSize:12,color:"#b0b8c4"},children:["(",o.x,",",o.y,") |"," ",a?C.jsxs(C.Fragment,{children:["PV ",o.hp," / ",o.maxHp," ",o.aiRole?`(role: ${o.aiRole})`:""]}):"etat inconnu"]})]}),C.jsxs("div",{style:{fontSize:12,color:"rgba(255,255,255,0.78)"},children:["Nature : ",a?u:"inconnu"]}),C.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:r.capabilities.map(h=>C.jsx("span",{style:{background:h.color,color:"#0b0b12",borderRadius:4,padding:"2px 6px",fontSize:11,fontWeight:700},children:h.action.toUpperCase()},`${o.id}-${h.action}`))}),C.jsxs("div",{style:{fontSize:12,color:"#d0d6e0"},children:["Ce qu'il peut faire : ",r.capabilities.map(h=>h.label).join(" | ")]}),s&&((c=s.targeting)==null?void 0:c.target)==="enemy"&&(()=>{const h=r.validateEnemyTargetForAction(s,o,t,[t,...e]),f=h.ok,m=r.selectedTargetId===o.id;return C.jsx("button",{type:"button",onClick:()=>{if(!f){r.onLog(h.reason||`Cible ${o.id} invalide pour ${s.name}.`);return}r.onSelectTargetId(o.id),r.onSetTargetMode("none"),r.onLog(`Cible selectionnee: ${o.id}.`)},disabled:!f,style:{marginTop:6,alignSelf:"flex-start",padding:"4px 8px",fontSize:11,borderRadius:4,border:"none",cursor:f?"pointer":"default",background:f?"#3498db":"#555",color:"#fff",opacity:m?1:.9},children:m?"Cible actuelle":"Cibler avec l'action valide"})})(),C.jsxs("div",{style:{fontSize:12,color:"#9cb2ff"},children:["Dernire dcision IA : ",r.describeEnemyLastDecision(o.id)]})]},o.id)})})]})}function y7(r){return C.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.75)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:C.jsxs("div",{style:{background:"#141421",borderRadius:12,border:"1px solid #f1c40f",padding:"24px 32px",maxWidth:360,textAlign:"center",boxShadow:"0 0 24px rgba(0,0,0,0.6)"},children:[C.jsx("h2",{style:{margin:"0 0 8px"},children:"Game Over"}),C.jsx("p",{style:{fontSize:13,margin:"0 0 16px"},children:"Le hros est tomb et aucun alli n'est en mesure de continuer."}),C.jsx("button",{type:"button",onClick:r.onRestart,style:{padding:"6px 12px",background:"#e67e22",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:13,fontWeight:600},children:"Recommencer le combat"})]})})}function x7(r){return C.jsxs("div",{style:{marginBottom:8,padding:"6px 10px",background:"#111322",borderRadius:8,border:"1px solid #333",display:"flex",flexDirection:"column",gap:4,maxWidth:"100%"},children:[C.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[C.jsxs("span",{style:{fontSize:12,color:"#b0b8c4"},children:["Ordre d'initiative (round ",r.round,")"]}),r.activeEntry&&C.jsxs("span",{style:{fontSize:11,color:"#f1c40f"},children:["Tour actuel :"," ",r.activeEntry.kind==="player"?"Joueur":r.activeEntry.id]})]}),C.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",overflowX:"auto",paddingBottom:2},children:r.timelineEntries.map(e=>{const t=r.activeEntry&&e.id===r.activeEntry.id&&e.kind===r.activeEntry.kind,s=e.kind==="player",o=Ud(s?"player":"enemy"),a=e.kind==="player"?r.player:r.enemies.find(h=>h.id===e.id)||null,u=a?Yt(a):!1,c=s?{svg:o,label:"PJ"}:{svg:o,label:e.id};return C.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:4,borderRadius:6,border:t?"2px solid #f1c40f":"1px solid #333",background:u?"#111118":t?"#1b1b30":"#101020",minWidth:48},children:[C.jsx("img",{src:c.svg,alt:c.label,style:{width:32,height:32,objectFit:"contain",filter:u?"grayscale(1)":s?"none":"grayscale(0.2)"}}),C.jsx("span",{style:{fontSize:10,marginTop:2,color:u?"#777a8a":"#d0d6e0",whiteSpace:"nowrap",textDecoration:u?"line-through":"none"},children:c.label}),C.jsxs("span",{style:{fontSize:9,color:"#9aa0b5"},children:["Init ",e.initiative]})]},`${e.kind}-${e.id}`)})})]})}function v7(r){return C.jsxs("div",{style:{padding:"10px 12px",background:"linear-gradient(180deg, rgba(38, 28, 16, 0.92), rgba(16, 12, 8, 0.92))",borderRadius:14,border:"1px solid rgba(255,255,255,0.10)",boxShadow:"0 16px 50px rgba(0,0,0,0.45)",display:"flex",flexDirection:"column",gap:4,maxWidth:"100%",height:170,fontFamily:'"Iowan Old Style", "Palatino Linotype", Palatino, Garamond, "Times New Roman", serif'},children:[C.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[C.jsx("span",{style:{fontSize:13,color:"rgba(255,255,255,0.82)",fontWeight:700},children:"Chronique du tour"}),C.jsxs("span",{style:{fontSize:12,color:"rgba(255,255,255,0.65)"},children:["Round ",r.round]})]}),C.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2,flex:"1 1 auto",minHeight:0,overflowY:"auto",paddingRight:4},children:[r.narrativeLog.length===0&&C.jsx("span",{style:{fontSize:12,color:"rgba(255,255,255,0.65)"},children:"En attente d'actions pour raconter le tour..."}),r.narrativeLog.slice(0,20).map((e,t)=>C.jsxs("span",{style:{fontSize:13,color:"rgba(255,255,255,0.88)"},children:[" ",e]},t))]})]})}function _7(r){var s,o,a,u;const e=r.selectedAction,t=r.selectedAvailability;return C.jsxs("section",{style:{padding:"8px 12px",background:"#141421",borderRadius:8,border:"1px solid #333",display:"flex",flexDirection:"column",gap:8},children:[C.jsx("h2",{style:{margin:"0 0 4px"},children:"Actions dtailles"}),C.jsxs("p",{style:{margin:0,fontSize:12,opacity:.85},children:["Source: ",C.jsx("code",{children:"action-game/actions/index.json"}),". Liste charge et vrifie localement (phase, distance)."]}),C.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[C.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,maxHeight:"180px",overflowY:"auto",paddingRight:4},children:[r.actions.map(c=>{const h=r.computeActionAvailability(c),f=(e==null?void 0:e.id)===c.id,m=c.actionCost.actionType==="action"?"#8e44ad":c.actionCost.actionType==="bonus"?"#27ae60":c.actionCost.actionType==="reaction"?"#e67e22":"#2980b9",y=f?"#6c5ce7":"#2a2a3a";return C.jsxs("button",{type:"button",onClick:()=>r.onSelectActionId(c.id),style:{textAlign:"left",background:f?"#1e1e2f":"#0f0f19",color:"#f5f5f5",border:`1px solid ${y}`,borderRadius:6,padding:"8px 10px",cursor:"pointer"},children:[C.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginBottom:4,alignItems:"center"},children:[C.jsx("span",{style:{fontWeight:600},children:c.name}),C.jsx("span",{style:{fontSize:11,padding:"2px 6px",borderRadius:4,background:m,color:"#fff"},children:c.actionCost.actionType})]}),C.jsx("div",{style:{fontSize:12,opacity:.9},children:c.summary||c.category}),C.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginTop:4,fontSize:11,alignItems:"center"},children:[C.jsx("span",{style:{color:h.enabled?"#2ecc71":"#e74c3c"},children:h.enabled?"Disponible":h.reasons[0]||"Bloque"}),C.jsx("span",{style:{color:"#9aa0b5"},children:r.describeRange(c.targeting)}),C.jsx("span",{style:{color:"#9aa0b5"},children:r.describeUsage(c.usage)})]})]},c.id)}),r.actions.length===0&&C.jsx("div",{style:{fontSize:12,opacity:.8},children:"Aucune action charge pour le moment."})]}),e&&C.jsxs("div",{style:{borderTop:"1px solid #2a2a3a",paddingTop:8,display:"flex",flexDirection:"column",gap:6},children:[C.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap",fontSize:11},children:[C.jsx("span",{style:{background:"#2d2d40",color:"#d0d4f7",padding:"2px 6px",borderRadius:4},children:e.category}),(s=e.tags)==null?void 0:s.slice(0,4).map(c=>C.jsx("span",{style:{background:"#1f2a38",color:"#9bb0d6",padding:"2px 6px",borderRadius:4},children:c},c))]}),C.jsx("div",{style:{fontSize:12},children:e.summary||"Pas de rsum."}),C.jsxs("div",{style:{fontSize:12},children:[C.jsx("strong",{children:"Cot:"})," ",e.actionCost.actionType," | Mouvement"," ",e.actionCost.movementCost]}),C.jsxs("div",{style:{fontSize:12},children:[C.jsx("strong",{children:"Porte:"})," ",r.describeRange(e.targeting)]}),C.jsxs("div",{style:{fontSize:12},children:[C.jsx("strong",{children:"Usage:"})," ",r.describeUsage(e.usage)]}),C.jsxs("div",{style:{fontSize:12},children:[C.jsx("strong",{children:"Conditions:"}),C.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:4},children:[e.conditions.length===0&&C.jsx("span",{style:{color:"#9aa0b5"},children:"Aucune condition."}),e.conditions.map((c,h)=>C.jsxs("div",{style:{color:"#cfd3ec"},children:[r.conditionLabel(c),c.reason?` - ${c.reason}`:""]},`${c.type}-${h}`)),t&&C.jsxs("div",{style:{color:t.enabled?"#2ecc71":"#e74c3c"},children:["tat:"," ",t.enabled?"OK pour ce tour":t.reasons.join(" | ")||"Bloqu",t.details.length>0&&C.jsx("div",{style:{color:"#9aa0b5",marginTop:2},children:t.details.join(" / ")})]})]})]}),C.jsxs("div",{style:{fontSize:12},children:[C.jsx("strong",{children:"Effets:"}),C.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:4},children:e.effects.map((c,h)=>C.jsx("div",{style:{color:"#cfd3ec"},children:r.effectLabel(c)},`${c.type}-${h}`))})]}),C.jsxs("div",{style:{fontSize:12},children:[C.jsx("strong",{children:"Hints IA:"})," ",((o=e.aiHints)==null?void 0:o.priority)||"n/a",C.jsxs("div",{style:{color:"#9aa0b5"},children:["Success: ",((a=e.aiHints)==null?void 0:a.successLog)||"n/a"]}),C.jsxs("div",{style:{color:"#9aa0b5"},children:["Failure: ",((u=e.aiHints)==null?void 0:u.failureLog)||"n/a"]})]}),C.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[C.jsx("button",{type:"button",onClick:()=>r.onPreviewActionArea(e),style:{padding:"4px 8px",background:"#2980b9",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Prvisualiser"}),C.jsx("button",{type:"button",onClick:()=>r.onValidateAction(e),disabled:!(t!=null&&t.enabled),style:{padding:"4px 8px",background:t!=null&&t.enabled?"#2ecc71":"#555",color:"#fff",border:"none",borderRadius:4,cursor:t!=null&&t.enabled?"pointer":"default",fontSize:12},children:"Valider l'action"})]})]})]})]})}function w7(r){var e,t,s,o,a,u;return C.jsxs("section",{style:{padding:"8px 12px",background:"#141421",borderRadius:8,border:"1px solid #333",display:"flex",flexDirection:"column",gap:8},children:[C.jsx("h2",{style:{margin:"0 0 4px"},children:"Jets de ds"}),C.jsx("p",{style:{margin:0,fontSize:12,opacity:.85},children:"Choisir une action, la valider, puis lancer le jet de touche et/ou de dgts. Mode auto: enchane touche + dgts."}),C.jsxs("div",{style:{fontSize:12},children:["Action valide :"," ",r.validatedAction?`${r.validatedAction.name} (${r.validatedAction.id})`:"aucune (valider une action d'abord)"]}),C.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:["normal","advantage","disadvantage"].map(c=>C.jsx("button",{type:"button",onClick:()=>r.onSetAdvantageMode(c),style:{padding:"4px 8px",background:r.advantageMode===c?"#8e44ad":"#2c2c3a",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:c},c))}),C.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[C.jsx("button",{type:"button",onClick:r.onRollAttack,disabled:!((e=r.validatedAction)!=null&&e.attack),style:{padding:"4px 8px",background:(t=r.validatedAction)!=null&&t.attack?"#2980b9":"#555",color:"#fff",border:"none",borderRadius:4,cursor:(s=r.validatedAction)!=null&&s.attack?"pointer":"default",fontSize:12},children:"Lancer jet de touche"}),C.jsx("button",{type:"button",onClick:r.onRollDamage,disabled:!((o=r.validatedAction)!=null&&o.damage),style:{padding:"4px 8px",background:(a=r.validatedAction)!=null&&a.damage?"#27ae60":"#555",color:"#fff",border:"none",borderRadius:4,cursor:(u=r.validatedAction)!=null&&u.damage?"pointer":"default",fontSize:12},children:"Lancer dgts"}),C.jsx("button",{type:"button",onClick:r.onAutoResolve,style:{padding:"4px 8px",background:"#9b59b6",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Mode auto (touche + dgts)"})]}),C.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[C.jsxs("div",{style:{background:"#101020",borderRadius:6,padding:8,border:"1px solid #26263a"},children:[C.jsx("div",{style:{fontWeight:600,marginBottom:4,fontSize:12},children:"Jet de touche"}),r.attackRoll?C.jsxs("div",{style:{fontSize:12,lineHeight:1.4},children:["d20: ",r.attackRoll.d20.rolls.join(" / "),"  ",r.attackRoll.d20.total," | bonus"," ",r.attackRoll.bonus," | total ",r.attackRoll.total," ",r.attackRoll.isCrit?"(critique)":""]}):C.jsx("div",{style:{fontSize:12,opacity:.7},children:"Pas encore lanc."})]}),C.jsxs("div",{style:{background:"#101020",borderRadius:6,padding:8,border:"1px solid #26263a"},children:[C.jsx("div",{style:{fontWeight:600,marginBottom:4,fontSize:12},children:"Jet de dgts"}),r.damageRoll?C.jsxs("div",{style:{fontSize:12,lineHeight:1.4},children:["Ds:"," ",r.damageRoll.dice.length?r.damageRoll.dice.map(c=>c.rolls.join("+")).join(" | "):"-"," ","| mod ",r.damageRoll.flatModifier," | total ",r.damageRoll.total," ",r.damageRoll.isCrit?"(critique)":""]}):C.jsx("div",{style:{fontSize:12,opacity:.7},children:"Pas encore lanc."})]})]}),C.jsxs("div",{style:{fontSize:12},children:[C.jsx("strong",{children:"Logs des jets:"}),C.jsxs("div",{style:{marginTop:4,display:"flex",flexDirection:"column",gap:2},children:[r.diceLogs.map((c,h)=>C.jsxs("div",{style:{color:"#dfe6ff"},children:["- ",c]},h)),r.diceLogs.length===0&&C.jsx("div",{style:{color:"#9aa0b5"},children:"Aucun jet enregistr."})]})]})]})}function b7(r){return C.jsxs("section",{style:{padding:"8px 12px",background:"#141421",borderRadius:8,border:"1px solid #333",display:"flex",flexDirection:"column",gap:8},children:[C.jsx("h2",{style:{margin:"0 0 4px"},children:"Zones d'effet (demo)"}),C.jsxs("p",{style:{margin:0,fontSize:12},children:["Ces boutons utilisent les helpers de ",C.jsx("code",{children:"boardEffects.ts"})," pour dessiner des zones en coordonnes de grille autour du joueur."]}),C.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginTop:8},children:[C.jsx("button",{type:"button",onClick:r.onShowCircle,style:{padding:"4px 8px",background:"#2980b9",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Cercle R=2"}),C.jsx("button",{type:"button",onClick:r.onShowRectangle,style:{padding:"4px 8px",background:"#27ae60",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Rectangle 3x3"}),C.jsx("button",{type:"button",onClick:r.onShowCone,style:{padding:"4px 8px",background:"#c0392b",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Cne porte 4"}),C.jsx("button",{type:"button",onClick:r.onToggleVisionDebug,style:{padding:"4px 8px",background:r.showVisionDebug?"#f1c40f":"#555",color:"#0b0b12",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:r.showVisionDebug?"Masquer vision":"Afficher vision"}),C.jsx("button",{type:"button",onClick:r.onClear,style:{padding:"4px 8px",background:"#7f8c8d",color:"#fff",border:"none",borderRadius:4,cursor:"pointer",fontSize:12},children:"Effacer zones"})]})]})}function S7(r){return C.jsxs("section",{style:{padding:"8px 12px",background:"#141421",borderRadius:8,border:"1px solid #333",flex:"1 1 auto",display:"flex",flexDirection:"column"},children:[C.jsx("h2",{style:{margin:"0 0 8px"},children:"Log"}),C.jsx("div",{style:{flex:"1 1 auto",overflowY:"auto",fontSize:12,lineHeight:1.4},children:r.log.map((e,t)=>C.jsxs("div",{children:["- ",e]},t))})]})}function ra(r,e){return{x:Math.cos(e)*r,y:Math.sin(e)*r}}function Gp(r,e,t,s,o){const a=ra(r,t);return`A ${r} ${r} 0 ${s} ${o} ${a.x} ${a.y}`}function k7(r,e,t,s){const o=Math.abs(s-t)>=Math.PI*2-1e-6,a=s-t,u=o||Math.abs(a)>Math.PI?1:0,c=a>=0?1:0,h=c===1?0:1,f=ra(e,t),m=ra(r,s),y=ra(r,t);return[`M ${f.x} ${f.y}`,Gp(e,t,s,u,c),`L ${m.x} ${m.y}`,Gp(r,s,t,u,h),`L ${y.x} ${y.y}`,"Z"].join(" ")}function C7(r){if(!r.open)return null;const e=r.size??240,t=e/2,s=t,o=Math.max(44,Math.floor(s*.42)),a=o-6,u=Math.max(1,r.items.length),c=Math.PI*2/u,h=-Math.PI/2,f=r.centerLabel??"Annuler",m=r.onCenterClick??r.onClose,y=typeof r.sliceOpacity=="number"?r.sliceOpacity:1,v=typeof r.centerOpacity=="number"?r.centerOpacity:1;return C.jsx("div",{style:{position:"absolute",left:r.anchorX,top:r.anchorY,width:e,height:e,transform:"translate(-50%, -50%)",zIndex:50,pointerEvents:"auto",userSelect:"none"},onMouseDown:x=>{x.preventDefault(),x.stopPropagation()},onClick:x=>{x.preventDefault(),x.stopPropagation()},children:C.jsxs("svg",{width:e,height:e,viewBox:`${-t} ${-t} ${e} ${e}`,children:[C.jsx("defs",{children:C.jsx("filter",{id:"wheelShadow",x:"-30%",y:"-30%",width:"160%",height:"160%",children:C.jsx("feDropShadow",{dx:"0",dy:"10",stdDeviation:"14",floodOpacity:"0.35"})})}),C.jsxs("g",{filter:"url(#wheelShadow)",children:[r.items.map((x,b)=>{const S=h+b*c,w=h+(b+1)*c,A=(S+w)/2,E=ra((o+s)/2,A),P=k7(o,s,S,w),M=!!x.disabled,D=M&&x.disabledReason?x.disabledReason:M?"Indisponible":void 0;return C.jsxs("g",{children:[C.jsx("path",{d:P,fill:M?"rgba(90, 90, 100, 0.75)":x.color,stroke:"rgba(255,255,255,0.22)",strokeWidth:1,style:{cursor:M?"not-allowed":"pointer",transition:"filter 120ms ease, opacity 120ms ease"},opacity:(M?.55:.95)*Math.max(0,Math.min(1,y)),onClick:z=>{var L;z.preventDefault(),z.stopPropagation(),!M&&((L=x.onSelect)==null||L.call(x))},children:D?C.jsx("title",{children:D}):null}),C.jsx("text",{x:E.x,y:E.y,textAnchor:"middle",dominantBaseline:"middle",style:{fill:M?"rgba(255,255,255,0.6)":"rgba(255,255,255,0.92)",fontSize:12,fontWeight:700,letterSpacing:.2,pointerEvents:"none"},children:x.label})]},x.id)}),C.jsx("circle",{cx:0,cy:0,r:a,fill:"rgba(10,10,16,0.92)",stroke:"rgba(255,255,255,0.18)",strokeWidth:1,opacity:Math.max(0,Math.min(1,v)),style:{cursor:"pointer"},onClick:x=>{x.preventDefault(),x.stopPropagation(),m()}}),C.jsx("text",{x:0,y:0,textAnchor:"middle",dominantBaseline:"middle",style:{fill:"rgba(255,255,255,0.9)",fontSize:12,fontWeight:800,pointerEvents:"none"},children:f})]})]})})}function A7(r){const e=r.toLowerCase();return e==="attack"?"Attaque":e==="movement"?"Mouvement":e==="support"?"Support":e==="defense"?"Defense":e==="item"?"Objet":e==="reaction"?"Reaction":r}function T7(r){const e=r.toLowerCase();return e==="attack"?"#e74c3c":e==="movement"?"#2ecc71":e==="support"?"#3498db":e==="defense"?"#9b59b6":e==="item"?"#f1c40f":e==="reaction"?"#e67e22":"#7f8c8d"}function P7(r){const[e,t]=Z.useState("root"),[s,o]=Z.useState(null),a=r.actions.length>7,u=Z.useMemo(()=>{const m=new Set;for(const y of r.actions)m.add(y.category);return Array.from(m).sort((y,v)=>y.localeCompare(v))},[r.actions]);Z.useEffect(()=>{r.open||(t("root"),o(null))},[r.open]);const c=Z.useMemo(()=>{if(e==="categories")return[{id:"all",label:"Toutes",color:"#34495e",onSelect:()=>{o(null),t("actions")}},...u.map(x=>({id:`cat-${x}`,label:A7(x),color:T7(x),onSelect:()=>{o(x),t("actions")}}))];if(e==="actions")return(s?r.actions.filter(x=>x.category===s):r.actions).map(x=>{const S=r.computeActionAvailability(x).enabled;return{id:`action-${x.id}`,label:x.name,color:S?"#2ecc71":"#e74c3c",onSelect:()=>{r.onPickAction(x),t("root"),o(null)}}});if(e==="inspect"){const v=r.canInteractWithBoard&&r.hasCell,x=r.canInteractWithBoard?r.hasCell?"Indisponible":"Aucune case":"Tour joueur requis";return[{id:"inspect-cell",label:"Inspecter (10)",color:"#3498db",disabled:!v,disabledReason:x,onSelect:()=>{r.onInspectCell(),t("root")}},{id:"look",label:"Tourner regard",color:"#1abc9c",disabled:!v,disabledReason:x,onSelect:()=>{r.onLook(),t("root")}}]}const m=r.canInteractWithBoard,y=r.selectedPathLength>0;return[{id:"move",label:"Deplacer",color:"#2ecc71",disabled:!m,disabledReason:"Tour joueur requis",onSelect:r.onEnterMoveMode},{id:"action",label:"Action",color:"#e74c3c",disabled:!r.canInteractWithBoard,disabledReason:"Tour joueur requis",onSelect:()=>{if(a){t("categories");return}t("actions")}},{id:"validate-move",label:"Valider",color:"#f1c40f",disabled:!r.canInteractWithBoard||!y,disabledReason:y?"Tour joueur requis":"Aucun trajet",onSelect:r.onValidateMove},{id:"reset-move",label:"Annuler trajet",color:"#e67e22",disabled:!r.canInteractWithBoard||!y,disabledReason:y?"Tour joueur requis":"Aucun trajet",onSelect:r.onResetMove},{id:"inspect",label:"Inspecter",color:"#3498db",disabled:!r.hasCell||!r.canInteractWithBoard,disabledReason:r.canInteractWithBoard?"Aucune case":"Tour joueur requis",onSelect:()=>t("inspect")},{id:"interact",label:"Interagir",color:"#9b59b6",disabled:!r.canInteractWithBoard,disabledReason:"Tour joueur requis",onSelect:r.onInteract},{id:"hide",label:"Se cacher",color:"#34495e",disabled:!r.canInteractWithBoard,disabledReason:"Tour joueur requis",onSelect:r.onHide},{id:"end-turn",label:"Fin tour",color:"#ff7f50",disabled:!r.canInteractWithBoard||r.isResolvingEnemies,disabledReason:r.isResolvingEnemies?"Tour des ennemis en cours":"Tour joueur requis",onSelect:r.onEndTurn}]},[u,r,s,a,e]),{centerLabel:h,onCenterClick:f}=Z.useMemo(()=>e==="root"?{centerLabel:"Annuler",onCenterClick:r.onClose}:e==="categories"?{centerLabel:"Retour",onCenterClick:()=>t("root")}:e==="inspect"?{centerLabel:"Retour",onCenterClick:()=>t("root")}:e==="actions"&&a?{centerLabel:"Retour",onCenterClick:()=>t("categories")}:{centerLabel:"Retour",onCenterClick:()=>t("root")},[r.onClose,a,e]);return C.jsx(C7,{open:r.open,anchorX:r.anchorX,anchorY:r.anchorY,items:c,onClose:r.onClose,size:r.size,centerLabel:h,onCenterClick:f,sliceOpacity:.65,centerOpacity:.6})}function Vl(r,e,t){return Math.max(e,Math.min(t,r))}function M7(r){return r==="action"?"#8e44ad":r==="bonus"?"#27ae60":r==="reaction"?"#e67e22":"#2980b9"}function E7(r){var x,b,S,w,A,E,P;const e=Z.useRef(null),[t,s]=Z.useState({left:16,top:16}),o=Z.useRef(null),a=Z.useRef(!1),[u,c]=Z.useState(!1),h=r.action,f=r.availability,m=f?!f.enabled:!1;Z.useLayoutEffect(()=>{if(!r.open||a.current)return;const M=e.current;if(!M)return;const D=M.parentElement;if(!D)return;const z=D.getBoundingClientRect(),L=M.getBoundingClientRect(),G=r.anchorX+18,H=r.anchorY+18,W=Vl(G,8,Math.max(8,z.width-L.width-8)),Y=Vl(H,8,Math.max(8,z.height-L.height-8));s({left:W,top:Y})},[r.anchorX,r.anchorY,r.open,h==null?void 0:h.id]),Z.useEffect(()=>{r.open&&(a.current=!1)},[r.open,h==null?void 0:h.id]),Z.useEffect(()=>{if(!u)return;const M=z=>{const L=e.current,G=o.current;if(!L||!G)return;const H=L.parentElement;if(!H)return;const W=H.getBoundingClientRect(),Y=L.getBoundingClientRect(),ge=z.clientX-G.startClientX,K=z.clientY-G.startClientY,xe=G.startLeft+ge,Be=G.startTop+K,ee=Vl(xe,8,Math.max(8,W.width-Y.width-8)),te=Vl(Be,8,Math.max(8,W.height-Y.height-8));a.current=!0,s({left:ee,top:te})},D=()=>{c(!1),o.current=null};return window.addEventListener("pointermove",M),window.addEventListener("pointerup",D,{once:!0}),()=>{window.removeEventListener("pointermove",M)}},[u]);const v=!!(((x=h==null?void 0:h.targeting)==null?void 0:x.target)==="enemy");return!r.open||!h?null:C.jsxs("div",{ref:e,onMouseDown:M=>M.stopPropagation(),style:{position:"absolute",left:t.left,top:t.top,zIndex:60,width:360,maxWidth:"min(92vw, 420px)",background:"rgba(10, 10, 16, 0.92)",border:"1px solid rgba(255,255,255,0.14)",borderRadius:12,padding:12,boxShadow:"0 18px 60px rgba(0,0,0,0.55)",backdropFilter:"blur(8px)"},children:[C.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10,alignItems:"flex-start"},children:[C.jsxs("div",{onPointerDown:M=>{M.button!==0||!e.current||(M.preventDefault(),M.stopPropagation(),o.current={startClientX:M.clientX,startClientY:M.clientY,startLeft:t.left,startTop:t.top},c(!0))},style:{minWidth:0,flex:"1 1 auto",cursor:u?"grabbing":"grab",userSelect:"none"},title:"Glisser pour deplacer",children:[C.jsx("div",{style:{fontSize:13,fontWeight:900,color:"#fff"},children:h.name}),C.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:6},children:[C.jsx("span",{style:{fontSize:11,padding:"2px 6px",borderRadius:6,background:M7(h.actionCost.actionType),color:"#fff",fontWeight:800},children:h.actionCost.actionType}),C.jsx("span",{style:{fontSize:11,padding:"2px 6px",borderRadius:6,background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.12)",color:"rgba(255,255,255,0.85)",fontWeight:700},children:h.category}),C.jsx("span",{style:{fontSize:11,padding:"2px 6px",borderRadius:6,background:m?"rgba(231,76,60,0.25)":"rgba(46,204,113,0.18)",border:`1px solid ${m?"rgba(231,76,60,0.55)":"rgba(46,204,113,0.45)"}`,color:m?"#ffb2aa":"#bdf6d2",fontWeight:800},children:f?f.enabled?"Disponible":"Bloquee":"Etat inconnu"})]})]}),C.jsx("button",{type:"button",onClick:()=>{r.onClose()},style:{width:32,height:32,borderRadius:10,border:"1px solid rgba(255,255,255,0.14)",background:"rgba(255,255,255,0.06)",color:"rgba(255,255,255,0.85)",cursor:"pointer",fontWeight:900,flex:"0 0 auto"},title:"Fermer",children:""})]}),C.jsx("div",{style:{marginTop:10,fontSize:12,color:"rgba(255,255,255,0.82)"},children:h.summary||"Aucun resume."}),f&&!f.enabled&&C.jsxs("div",{style:{marginTop:10},children:[C.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#ffb2aa"},children:"Pourquoi c'est bloque"}),C.jsx("ul",{style:{margin:"6px 0 0",paddingLeft:18,color:"rgba(255,255,255,0.85)",fontSize:12},children:f.reasons.map((M,D)=>C.jsx("li",{children:M},D))})]}),C.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[r.stage==="draft"&&C.jsx("button",{type:"button",onClick:()=>{r.onValidateAction(h)},disabled:!!(f&&!f.enabled),style:{padding:"6px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:f!=null&&f.enabled?"#2ecc71":"rgba(90, 90, 100, 0.55)",color:f!=null&&f.enabled?"#0b0b12":"rgba(255,255,255,0.75)",cursor:f!=null&&f.enabled?"pointer":"not-allowed",fontSize:12,fontWeight:900},title:f!=null&&f.enabled?"Valider l'action":"Action indisponible",children:"Valider"}),r.stage==="active"&&C.jsx("span",{style:{fontSize:12,color:"rgba(255,255,255,0.70)"},children:"Action validee: suivez les etapes ci-dessous."})]}),v&&C.jsxs("div",{style:{marginTop:12},children:[C.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,alignItems:"center"},children:[C.jsx("div",{style:{fontSize:12,fontWeight:900,color:"#fff"},children:"Cible"}),C.jsx("button",{type:"button",onClick:()=>{r.stage==="active"&&r.onSetTargetMode("selecting")},disabled:r.stage!=="active",style:{padding:"4px 8px",borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:r.stage==="active"?"rgba(255,255,255,0.06)":"rgba(90, 90, 100, 0.35)",color:"#fff",cursor:r.stage==="active"?"pointer":"not-allowed",fontSize:12,fontWeight:800},children:"Selectionner cible"})]}),C.jsxs("div",{style:{marginTop:6,fontSize:12,color:"rgba(255,255,255,0.80)"},children:["Cible selectionnee:"," ",C.jsx("strong",{children:r.selectedTargetId?r.selectedTargetId:"aucune"}),r.targetMode==="selecting"&&r.stage==="active"&&C.jsx("span",{style:{marginLeft:8,color:"#cfd3ff"},children:"(clique un ennemi)"})]}),r.stage!=="active"&&C.jsx("div",{style:{marginTop:6,fontSize:12,color:"rgba(255,255,255,0.70)"},children:"Validez l'action pour pouvoir selectionner une cible sur la grille."})]}),r.stage==="active"&&C.jsxs("div",{style:{marginTop:12},children:[C.jsx("div",{style:{fontSize:12,fontWeight:900,color:"#fff",marginBottom:6},children:"Jets"}),C.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:["normal","advantage","disadvantage"].map(M=>C.jsx("button",{type:"button",onClick:()=>r.onSetAdvantageMode(M),style:{padding:"4px 8px",background:r.advantageMode===M?"#8e44ad":"rgba(255,255,255,0.06)",color:"#fff",border:"1px solid rgba(255,255,255,0.12)",borderRadius:10,cursor:"pointer",fontSize:12,fontWeight:800},children:M},M))}),C.jsxs("div",{style:{marginTop:8,display:"flex",gap:8,flexWrap:"wrap"},children:[C.jsx("button",{type:"button",onClick:r.onRollAttack,disabled:!((b=r.validatedAction)!=null&&b.attack),style:{padding:"6px 10px",background:(S=r.validatedAction)!=null&&S.attack?"#2980b9":"rgba(90, 90, 100, 0.55)",color:"#fff",border:"1px solid rgba(255,255,255,0.12)",borderRadius:10,cursor:(w=r.validatedAction)!=null&&w.attack?"pointer":"not-allowed",fontSize:12,fontWeight:900},children:"Jet de touche"}),C.jsx("button",{type:"button",onClick:r.onRollDamage,disabled:!((A=r.validatedAction)!=null&&A.damage),style:{padding:"6px 10px",background:(E=r.validatedAction)!=null&&E.damage?"#27ae60":"rgba(90, 90, 100, 0.55)",color:"#fff",border:"1px solid rgba(255,255,255,0.12)",borderRadius:10,cursor:(P=r.validatedAction)!=null&&P.damage?"pointer":"not-allowed",fontSize:12,fontWeight:900},children:"Degats"}),C.jsx("button",{type:"button",onClick:r.onAutoResolve,style:{padding:"6px 10px",background:"#9b59b6",color:"#fff",border:"1px solid rgba(255,255,255,0.12)",borderRadius:10,cursor:"pointer",fontSize:12,fontWeight:900},children:"Auto"})]}),C.jsxs("div",{style:{marginTop:10,display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[C.jsxs("div",{style:{padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.04)"},children:[C.jsx("div",{style:{fontSize:11,fontWeight:900,color:"rgba(255,255,255,0.85)"},children:"Touche"}),C.jsx("div",{style:{fontSize:12,color:"rgba(255,255,255,0.85)",marginTop:4},children:r.attackRoll?`${r.attackRoll.total}${r.attackRoll.isCrit?" (crit)":""}`:"-"})]}),C.jsxs("div",{style:{padding:8,borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.04)"},children:[C.jsx("div",{style:{fontSize:11,fontWeight:900,color:"rgba(255,255,255,0.85)"},children:"Degats"}),C.jsx("div",{style:{fontSize:12,color:"rgba(255,255,255,0.85)",marginTop:4},children:r.damageRoll?`${r.damageRoll.total}${r.damageRoll.isCrit?" (crit)":""}`:"-"})]})]}),r.diceLogs.length>0&&C.jsxs("div",{style:{marginTop:10},children:[C.jsx("div",{style:{fontSize:11,fontWeight:900,color:"rgba(255,255,255,0.75)"},children:"Derniers jets"}),C.jsx("div",{style:{marginTop:4,display:"flex",flexDirection:"column",gap:3},children:r.diceLogs.slice(-4).map((M,D)=>C.jsxs("div",{style:{fontSize:11,color:"rgba(255,255,255,0.78)"},children:["- ",M]},D))})]})]})]})}function R7(r){var y;const e=Z.useMemo(()=>r.tabs.filter(v=>!v.hidden),[r.tabs]),t=r.defaultTabId??((y=e[0])==null?void 0:y.id)??"tab",s=r.collapsible??!0,o=r.collapsedByDefault??!0,[a,u]=Z.useState(o&&s?null:t);Z.useEffect(()=>{a!==null&&(e.some(v=>v.id===a)||u(t))},[a,t,e]);const c=a?e.find(v=>v.id===a):void 0,h=r.expandedHeight??320,f=r.collapsedHeight??52,m=a!==null;return C.jsxs("div",{style:{flex:`0 0 ${m?h:f}px`,display:"flex",flexDirection:"column",minHeight:0,background:"rgba(12, 12, 18, 0.9)",border:"1px solid rgba(255,255,255,0.10)",borderRadius:14,boxShadow:"0 18px 60px rgba(0,0,0,0.45)"},children:[C.jsx("div",{style:{display:"flex",gap:8,padding:"10px 10px 0 10px",flexWrap:"wrap"},children:e.map(v=>{const x=v.id===a;return C.jsx("button",{type:"button",onClick:()=>{if(!s){u(v.id);return}u(b=>b===v.id?null:v.id)},style:{padding:"8px 10px",borderRadius:10,border:"1px solid rgba(255,255,255,0.12)",background:x?"rgba(255,255,255,0.10)":"rgba(255,255,255,0.05)",color:x?"#fff":"rgba(255,255,255,0.75)",cursor:"pointer",fontSize:12,fontWeight:700},children:v.label},v.id)})}),m&&C.jsx("div",{style:{padding:10,minHeight:0,flex:"1 1 auto",overflow:"hidden"},children:C.jsx("div",{style:{width:"100%",height:"100%",overflow:"auto",paddingRight:4},children:c==null?void 0:c.content})})]})}const I7={"./melee-strike.json":f3,"./dash.json":C3,"./second-wind.json":F3,"./throw-dagger.json":Q3,"./enemy-move.json":ux,"./enemy-melee-strike.json":Sx,"./enemy-bow-shot.json":Fx},L7={"./brute.json":l2,"./archer.json":v2,"./assassin.json":E2,"./ghost.json":N2};function $7(){const r=Array.isArray(k1.types)?k1.types:[],e=[];for(const t of r){const s=L7[t];s?e.push(s):console.warn("[enemy-types] Type path missing in bundle:",t)}return e.length===0&&console.warn("[enemy-types] No enemy types loaded from index.json"),e}function z7(r,e,t){const{x:s,y:o}=t,a=e.baseStats;return{id:`enemy-${r+1}`,type:"enemy",enemyTypeId:e.id,enemyTypeLabel:e.label,aiRole:e.aiRole,actionIds:Array.isArray(e.actions)?e.actions:null,speechProfile:e.speechProfile??null,moveRange:a.moveRange,attackDamage:a.attackDamage,attackRange:typeof a.attackRange=="number"?a.attackRange:1,maxAttacksPerTurn:typeof a.maxAttacksPerTurn=="number"?a.maxAttacksPerTurn:1,armorClass:a.armorClass,movementProfile:e.movement?e.movement:{type:"ground",speed:e.baseStats.moveRange,canPassThroughWalls:!1,canPassThroughEntities:!1,canStopOnOccupiedTile:!1},facing:"left",visionProfile:e.vision?e.vision:{shape:"cone",range:5},x:s,y:o,hp:a.hp,maxHp:a.hp}}const j7=[{action:"move",label:"Se deplacer jusqu'a 3 cases (Manhattan)",color:"#2ecc71"},{action:"attack",label:"Attaque le joueur a distance 1 (2 degats)",color:"#e74c3c"},{action:"wait",label:"Attend si aucune action viable",color:"#7f8c8d"}],F7=()=>{const r=Z.useRef(null),e=Z.useRef(!1),t=Z.useRef(null),[s,o]=Z.useState([]),[a,u]=Z.useState([]),[c,h]=Z.useState([]),[f,m]=Z.useState({id:"player-1",type:"player",x:0,y:Math.floor(ur/2),facing:"right",visionProfile:{shape:"cone",range:5},hp:kr.pvActuels,maxHp:kr.pvMax}),[y,v]=Z.useState([]),[x,b]=Z.useState([]),[S,w]=Z.useState([]),[A,E]=Z.useState([]),[P,M]=Z.useState("player"),[D,z]=Z.useState(1),[L,G]=Z.useState(!1),[H,W]=Z.useState(!1),[Y,ge]=Z.useState(null),[K,xe]=Z.useState([]),[Be,ee]=Z.useState(0),[te,re]=Z.useState(!1),[ne,ie]=Z.useState(3),[j,V]=Z.useState(""),Se=.5,Pe=2.5,Re=.1,[ke,We]=Z.useState(1),[Fe,Xe]=Z.useState({x:0,y:0}),[vt,kn]=Z.useState(!1),Dt=Z.useRef(null),{obstacleLayerRef:en,tokenLayerRef:mn,pathLayerRef:Cn,speechLayerRef:Ki,viewportRef:Ir}=l7({enabled:te,containerRef:r,zoom:ke,panX:Fe.x,panY:Fe.y}),[hi,Qi]=Z.useState([]),[An,Lr]=Z.useState([]),[Qs,Zi]=Z.useState(null),[Ji,fa]=Z.useState(null),[es,ts]=Z.useState("normal"),[tn,ns]=Z.useState(null),[$r,Zn]=Z.useState(null),[pa,ma]=Z.useState([]),[ga,Zs]=Z.useState(!1),[zr,fi]=Z.useState({usedAction:!1,usedBonus:!1}),[jr,pi]=Z.useState({turn:{},encounter:{}}),[rs,dr]=Z.useState({"bandolier:dagger":3}),[hr,is]=Z.useState(5),[Lt,mi]=Z.useState([]),[kt,Fr]=Z.useState(null),[Br,Tn]=Z.useState("none"),[Pn,nn]=Z.useState("idle"),[gi,ya]=Z.useState(()=>new Set),[ss,yi]=Z.useState(()=>new Set),[Ue,os]=Z.useState(null),[$t,Js]=Z.useState(null),[fu,Ot]=Z.useState([]),[eo,xa]=Z.useState(!1),[pu,va]=Z.useState(null),[mu,gu]=Z.useState(null),[as,_a]=Z.useState(null),[yu,lt]=Z.useState(null),[wa,fr]=Z.useState(!1),[Nt,ls]=Z.useState(!1);c7({obstacleLayerRef:en,obstacleTypes:S,obstacles:A}),f7({tokenLayerRef:mn,player:f,enemies:x}),h7({speechLayerRef:Ki,player:f,enemies:x,speechBubbles:c}),d7({pathLayerRef:Cn,player:f,enemies:x,selectedPath:Lt,effectSpecs:fu,selectedTargetId:kt,showVisionDebug:eo});const to=10;function qt(){os(k=>k?{...k,open:!1}:null)}function xi(k,$){return`${k},${$}`}const ut=Z.useMemo(()=>Zy(S,A),[S,A]);function ba(k,$){return`${$??"default"}:${k}`}function rn(k,$){const B=ba(k,$);return typeof rs[B]=="number"?rs[B]:0}Z.useEffect(()=>{(P!=="player"||Nt)&&(nn("idle"),qt())},[P,Nt]),Z.useEffect(()=>{const k=$=>{if($.key==="Escape"){if(Ue!=null&&Ue.open){qt();return}if(Br==="selecting"){Tn("none");return}Pn!=="idle"&&nn("idle")}};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[Ue==null?void 0:Ue.open,Pn,Br]);function xu(k){var B,U;if(wa)return"Fallback local : action engine";if(as===null)return"IA non appelee pour l'instant";const $=as.find(se=>se.enemyId===k);return $?((B=$.target)==null?void 0:B.kind)==="cell"?`${$.actionId} -> (${$.target.x}, ${$.target.y})`:((U=$.target)==null?void 0:U.kind)==="token"?`${$.actionId} -> ${$.target.tokenId}`:$.actionId:"Aucun intent recu pour cet ennemi"}function vu(){if(y.length===0){ae("Aucun type d'ennemi charge (enemyTypes). Impossible de generer le combat.");return}const k=Yy({prompt:j,grid:{cols:Tr,rows:ur},enemyCount:ne,enemyTypes:y,obstacleTypes:S});ae(k.summary),m(B=>({...B,x:k.playerStart.x,y:k.playerStart.y})),E(k.obstacles);const $=k.enemySpawns.map((B,U)=>z7(U,B.enemyType,B.position));b($),ya(new Set),yi(new Set),z(1),W(!1),xe([]),ee(0),re(!0),pi({turn:{},encounter:{}}),fi({usedAction:!1,usedBonus:!1}),dr({"bandolier:dagger":3}),is(5)}function no(){if(!H||K.length===0)return null;const k=Be>=0&&Be<K.length?Be:0;return K[k]??null}function us(){if(!H||K.length===0)return{entry:null,willWrap:!1};const k=(Be+1)%K.length;return{entry:K[k]??null,willWrap:k===0}}function Dr(){K.length!==0&&ee(k=>{const $=(k+1)%K.length;return $===0&&z(B=>B+1),$})}function vi(){if(H)return;const k=kr.caracs.dexterite.modDEX??0,$=()=>Math.floor(Math.random()*20)+1,B=$(),U=B+k,se=[];se.push({id:f.id,kind:"player",initiative:U});const Ie=x.map(ye=>{const he=$();return se.push({id:ye.id,kind:"enemy",initiative:he}),{...ye,initiative:he}});ge(U),b(Ie),se.sort((ye,Ce)=>Ce.initiative-ye.initiative),xe(se),ee(0),W(!0);const le=se[0];le&&(le.kind==="player"?ae(`Initiative: Joueur ${U} (d20=${B}, mod=${k})  le joueur commence.`):ae(`Initiative: Joueur ${U} (d20=${B}, mod=${k})  ${le.id} commence (initiative ${le.initiative}).`))}function ae(k){o($=>[k,...$].slice(0,12))}function Sa(k){u($=>[k,...$].slice(0,20))}function cs(k){ma($=>[k,...$].slice(0,6)),ae(k)}function ro(k,$){const B=($??"").trim();B&&h(U=>[...U.filter(Ie=>Ie.tokenId!==k),{tokenId:k,text:B,updatedAtRound:D}])}function ka(k){h($=>$.filter(B=>B.tokenId!==k))}function _i(k){const $=(k??"").trim();$&&(t.current!==null&&(window.clearTimeout(t.current),t.current=null),h(B=>[...B.filter(se=>se.tokenId!==f.id),{tokenId:f.id,text:$,updatedAtRound:D}]),t.current=window.setTimeout(()=>{h(B=>B.filter(U=>U.tokenId!==f.id))},2600))}function Or(k,$,B){const U=[{id:$.id,kind:"player",label:"Heros",aiRole:null,enemyTypeId:null,x:$.x,y:$.y,hp:$.hp,maxHp:$.maxHp},...B.map(se=>({id:se.id,kind:"enemy",label:se.enemyTypeLabel||se.enemyTypeId||se.id,aiRole:se.aiRole??null,enemyTypeId:se.enemyTypeId??null,x:se.x,y:se.y,hp:se.hp,maxHp:se.maxHp}))];return{round:D,phase:k,grid:{cols:Tr,rows:ur},actors:U}}function _u(k){return Or(k,f,x)}Z.useEffect(()=>{const k=$7();v(k)},[]),Z.useEffect(()=>{const k=Ny();w(k)},[]),Z.useEffect(()=>{te&&!H&&x.length>0&&vi()},[te,H,x.length]),Z.useEffect(()=>{h(k=>k.filter($=>$.tokenId===f.id||x.some(B=>B.id===$.tokenId&&B.hp>0)))},[x,f.id]),Z.useEffect(()=>{const k=Array.isArray(T1.actions)?T1.actions:[],$=[];for(const U of k){const se=I7[U];se?$.push(se):console.warn("[actions] Action path missing in bundle:",U)}$.length===0&&console.warn("[actions] No actions loaded from index.json"),Qi($);const B=$.filter(U=>!(U.tags||[]).includes("enemy"));Lr(B),Zi(B.length?B[0].id:null)},[]),Z.useEffect(()=>{if(!te||!H)return;const k=no();if(k){if(k.kind==="player"){M("player"),fi({usedAction:!1,usedBonus:!1}),pi($=>({...$,turn:{}})),is(5),Zs(!1),ns(null),Zn(null),e.current=!1,Yx(D,_u("player")),_n({round:D,phase:"player",kind:"turn_start",actorId:f.id,actorKind:"player",summary:`Debut du tour du heros (round ${D}).`});return}L||(M("enemies"),bu(k.id))}},[te,H,K,Be,L]);function wi(){if(x.length===0)return null;let k=null;for(const $ of x){const B=ai(f,$);(k===null||B<k)&&(k=B)}return k}function Ge(k,$,B,U){if($.type!=="enemy")return{ok:!1,reason:"La cible selectionnee n'est pas un ennemi."};if($.hp<=0)return{ok:!1,reason:"La cible est deja a terre."};const se=k.targeting;if(!se||se.target!=="enemy")return{ok:!1,reason:"Cette action ne cible pas un ennemi."};const Ie=ai(B,$),le=se.range;if(le){if(typeof le.min=="number"&&Ie<le.min)return{ok:!1,reason:`Cible trop proche pour ${k.name} (distance ${Ie}, min ${le.min}).`};if(typeof le.max=="number"&&Ie>le.max)return{ok:!1,reason:`Cible hors portee pour ${k.name} (distance ${Ie}, max ${le.max}).`}}for(const ye of k.conditions||[]){if(ye.type==="distance_max"&&typeof ye.max=="number"&&Ie>ye.max)return{ok:!1,reason:ye.reason||`Distance cible > ${ye.max}.`};if(ye.type==="distance_between"){const Ce=typeof ye.min=="number"?ye.min:typeof(le==null?void 0:le.min)=="number"?le.min:null,he=typeof ye.max=="number"?ye.max:typeof(le==null?void 0:le.max)=="number"?le.max:null;if(Ce!==null&&Ie<Ce)return{ok:!1,reason:ye.reason||`Distance cible < ${Ce}.`};if(he!==null&&Ie>he)return{ok:!1,reason:ye.reason||`Distance cible > ${he}.`}}if(ye.type==="target_alive"&&$.hp<=0)return{ok:!1,reason:ye.reason||"La cible doit avoir des PV restants."}}if(se.requiresLos){if(!eu(B,$,U,ut.vision))return{ok:!1,reason:"Cible hors du champ de vision ou derriere un obstacle (ligne de vue requise)."};if(!ia({x:B.x,y:B.y},{x:$.x,y:$.y},ut.attacks))return{ok:!1,reason:"Trajectoire bloquee (obstacle entre l'attaquant et la cible)."}}return{ok:!0}}function Nr(k){var he,Ve,Ae,Me,De,Ee;const $=[],B=[];P!=="player"&&$.push("Action bloquee pendant le tour des ennemis.");const U=(he=k.actionCost)==null?void 0:he.actionType;U==="action"&&zr.usedAction&&$.push("Action principale deja utilisee ce tour."),U==="bonus"&&zr.usedBonus&&$.push("Action bonus deja utilisee ce tour.");const se=typeof jr.turn[k.id]=="number"?jr.turn[k.id]:0,Ie=typeof jr.encounter[k.id]=="number"?jr.encounter[k.id]:0;typeof((Ve=k.usage)==null?void 0:Ve.perTurn)=="number"&&(B.push(`Usages/tour: ${se}/${k.usage.perTurn}`),se>=k.usage.perTurn&&$.push("Limite d'usage atteinte pour ce tour.")),typeof((Ae=k.usage)==null?void 0:Ae.perEncounter)=="number"&&(B.push(`Usages/rencontre: ${Ie}/${k.usage.perEncounter}`),Ie>=k.usage.perEncounter&&$.push("Limite d'usage atteinte pour la rencontre."));const le=(Me=k.usage)==null?void 0:Me.resource;if(le!=null&&le.name&&typeof le.min=="number"){const de=rn(le.name,le.pool);if(de<le.min){const _e=le.pool?` (${le.pool})`:"";$.push(`Ressource insuffisante: ${le.name}${_e} (${de}/${le.min}).`)}}const ye=(De=k.targeting)==null?void 0:De.target,Ce=(Ee=k.targeting)==null?void 0:Ee.range;if(ye==="enemy"){const de=wi();de===null?$.push("Aucune cible ennemie presente."):(B.push(`Distance mini ennemie: ${de}`),typeof(Ce==null?void 0:Ce.min)=="number"&&de<Ce.min&&$.push(`Trop proche (< ${Ce.min}).`),typeof(Ce==null?void 0:Ce.max)=="number"&&de>Ce.max&&$.push(`Hors portee (> ${Ce.max}).`))}for(const de of k.conditions||[]){if(de.type==="phase"&&de.mustBe&&de.mustBe!==P&&$.push(de.reason||"Phase incorrecte."),de.type==="stat_below_percent"&&de.who==="self"&&de.stat==="hp"){const _e=Math.max(1,f.maxHp||1),tt=f.hp/_e;typeof de.percentMax=="number"&&tt>=de.percentMax&&$.push(de.reason||`PV trop hauts (>= ${Math.round(de.percentMax*100)}%).`)}if(de.type==="distance_max"&&ye==="enemy"){const _e=wi();_e!==null&&typeof de.max=="number"&&_e>de.max&&$.push(de.reason||`Distance > ${de.max}.`)}if(de.type==="distance_between"&&ye==="enemy"){const _e=wi();_e!==null&&(typeof de.min=="number"&&_e<de.min&&$.push(de.reason||`Distance < ${de.min}.`),typeof de.max=="number"&&_e>de.max&&$.push(de.reason||`Distance > ${de.max}.`))}if(de.type==="resource_at_least"&&de.resource){const _e=typeof de.pool=="string"?de.pool:void 0,tt=rn(String(de.resource),_e),Oe=typeof de.value=="number"?de.value:1;if(tt<Oe){const Qe=_e?` (${_e})`:"";$.push(de.reason||`Ressource insuffisante: ${de.resource}${Qe} (${tt}/${Oe}).`)}}}return{enabled:$.length===0,reasons:$,details:B}}function Ca(k){var Ie,le,ye,Ce,he,Ve;const $=Number(kr.niveauGlobal||1),B=Number(((le=(Ie=kr.caracs)==null?void 0:Ie.force)==null?void 0:le.modFOR)||0),U=Number(((Ce=(ye=kr.caracs)==null?void 0:ye.dexterite)==null?void 0:Ce.modDEX)||0),se=Number(((Ve=(he=kr.caracs)==null?void 0:he.constitution)==null?void 0:Ve.modCON)||0);return k.replace(/\s+/g,"").replace(/niveau/gi,String($)).replace(/modFOR/gi,String(B)).replace(/modDEX/gi,String(U)).replace(/modCON/gi,String(se))}function io(k){var B;const $=[];if(k.perTurn&&$.push(`${k.perTurn}/tour`),k.perEncounter&&$.push(`${k.perEncounter}/rencontre`),(B=k.resource)!=null&&B.name){const U=k.resource.pool?` (${k.resource.pool})`:"";$.push(`Ressource: ${k.resource.name}${U}`)}return $.length?$.join(" | "):"Libre"}function Aa(k){const{range:$,target:B}=k;return $.shape==="self"?"Portee: soi-meme":$.min===$.max?`Portee: ${$.max} (${B})`:`Portee: ${$.min}-${$.max} (${B})`}function Ta(k){switch(k.type){case"phase":return`Phase requise: ${k.mustBe??"?"}`;case"distance_max":return`Distance <= ${k.max??"?"}`;case"distance_between":return`Distance ${k.min??0}-${k.max??"?"}`;case"stat_below_percent":return`Stat ${k.stat} < ${Math.round((k.percentMax??0)*100)}%`;case"target_alive":return"Cible doit etre vivante";case"resource_at_least":return`Ressource ${k.resource??"?"} >= ${k.value??"?"}`;default:return k.reason||k.type}}function Pa(k){switch(k.type){case"damage":return`Degats ${k.damageType??""} (${k.formula??"?"})`;case"heal":return`Soin (${k.formula??"?"})`;case"status":return`Etat: ${k.status??"?"} (${k.duration??"?"} tour)`;case"temp_hp":return`PV temporaires: ${k.amount??"?"}`;case"move":return`Deplacement +${k.maxSteps??"?"} (${k.direction??"direction libre"})`;case"resource_spend":return`Consomme ${k.amount??1} ${k.resource??"ressource"}`;case"modify_path_limit":return`+${k.delta??"?"} cases de mouvement ce tour`;default:return k.type}}function so(k){var U;const $=(U=k.targeting)==null?void 0:U.range;if(!$)return;const B=`preview-${k.id}`;if($.shape==="rectangle"){Ot([{id:B,kind:"rectangle",width:Math.max(1,$.max),height:Math.max(1,$.max)}]),ae(`Previsualisation rectangle pour ${k.name}.`);return}if($.shape==="cone"){Ot([{id:B,kind:"cone",range:Math.max(1,$.max),direction:"right"}]),ae(`Previsualisation cone (direction droite) pour ${k.name}.`);return}Ot([{id:B,kind:"circle",radius:Math.max(1,$.max)}]),ae(`Previsualisation de portee pour ${k.name}.`)}function bi(k){var le,ye,Ce;const $=(le=k.actionCost)==null?void 0:le.actionType,B=$==="action",U=$==="bonus";if(B&&zr.usedAction){ae(`Action ${k.name} refusee: action principale deja utilisee ce tour.`);return}if(U&&zr.usedBonus){ae(`Action ${k.name} refusee: action bonus deja utilisee ce tour.`);return}const se=Nr(k);if(!se.enabled){ae(`Action ${k.name} bloque: ${se.reasons.join(" | ")}`);return}pi(he=>({turn:{...he.turn,[k.id]:(he.turn[k.id]??0)+1},encounter:{...he.encounter,[k.id]:(he.encounter[k.id]??0)+1}}));for(const he of k.effects||[]){if(he.type==="modify_path_limit"&&typeof he.delta=="number"&&(is(Ve=>Math.max(1,Ve+he.delta)),typeof he.delta=="number"&&ae(`Mouvement: limite de trajet modifiee (${he.delta>=0?"+":""}${he.delta}).`)),he.type==="resource_spend"&&he.resource){const Ve=typeof he.pool=="string"?he.pool:null,Ae=typeof he.amount=="number"?he.amount:1,Me=ba(String(he.resource),Ve);dr(De=>({...De,[Me]:Math.max(0,(De[Me]??0)-Ae)}))}if(he.type==="heal"&&typeof he.formula=="string"){const Ve=Ca(he.formula),Ae=kd(Ve,{isCrit:!1,critRule:"double-dice"}),Me=typeof he.min=="number"?he.min:null,De=Me!==null?Math.max(Me,Ae.total):Ae.total;m(Ee=>({...Ee,hp:Math.min(Ee.maxHp,Ee.hp+De)})),cs(`Soin (${k.name}) : ${Ve} -> +${De} PV`)}he.type==="log"&&typeof he.message=="string"&&ae(he.message)}fa(k.id),ns(null),Zn(null),Zs(!1),fi(he=>({usedAction:he.usedAction||B,usedBonus:he.usedBonus||U}));const Ie=((ye=k.aiHints)==null?void 0:ye.successLog)||"Action validee. Prets pour les jets.";ae(`${k.name}: ${Ie}`),((Ce=k.targeting)==null?void 0:Ce.target)==="enemy"?(Tn("selecting"),Fr(null),ae("Selection de cible: cliquez sur un ennemi sur la grille ou dans la liste.")):(Tn("none"),Fr(null))}function sn(){return Ji&&An.find(k=>k.id===Ji)||null}function Jn(k){return k?k.attack||k.damage||k.skillCheck?!0:(k.effects||[]).some(B=>typeof B.formula=="string"&&B.formula.trim().length>0):!1}function Mn(){var le,ye;if(Nt||Yt(f))return;const k=sn();if(!k){ae("Aucune action validee pour lancer un jet.");return}if(!k.attack){ae("Cette action ne requiert pas de jet de touche.");return}if(ga){ae("Jet de touche deja effectue pour cette action ce tour. Validez une nouvelle action ou terminez le tour.");return}let $=null;if(((le=k.targeting)==null?void 0:le.target)==="enemy"){if(!kt){ae("Aucune cible ennemie selectionnee pour cette action. Selectionnez une cible avant le jet.");return}const Ce=x.find(he=>he.id===kt);if(!Ce){ae("Cible ennemie introuvable ou deja vaincue.");return}$=typeof Ce.armorClass=="number"?Ce.armorClass:null}const B=Zp(k.attack.bonus,es,k.attack.critRange??20);ns(B),Zs(!0),Zn(null);const U=B.mode==="normal"?`${B.d20.total}`:`${B.d20.rolls.join(" / ")} -> ${B.d20.total}`,se=((ye=k.targeting)==null?void 0:ye.target)==="enemy"&&kt?` sur ${kt}`:"",Ie=`Jet de touche (${k.name})${se} : ${U} + ${B.bonus} = ${B.total}`;if($!==null){const he=B.total>=$||B.isCrit?`TOUCHE (CA ${$})${B.isCrit?" (critique!)":""}`:`RATE (CA ${$})`;cs(`${Ie} -> ${he}`)}else cs(`${Ie}${B.isCrit?" (critique!)":""}`)}function er(){var Ce,he,Ve;if(Nt||Yt(f))return;const k=sn();if(!k){ae("Aucune action validee pour lancer un jet.");return}if(!k.damage){ae("Cette action ne requiert pas de jet de degats.");return}if(k.attack&&!tn){ae("Un jet de touche est requis avant les degats pour cette action.");return}let $=null,B=null;if(((Ce=k.targeting)==null?void 0:Ce.target)==="enemy"){if(!kt){ae("Aucune cible ennemie selectionnee pour cette action. Selectionnez une cible avant le jet de degats.");return}if($=x.findIndex(Me=>Me.id===kt),$===-1){ae("Cible ennemie introuvable ou deja vaincue.");return}const Ae=x[$];B=typeof Ae.armorClass=="number"?Ae.armorClass:null}const U=!!(tn!=null&&tn.isCrit);if(B!==null&&k.attack&&tn){const Ae=tn.total;if(!(Ae>=B||tn.isCrit)){const De=((he=k.targeting)==null?void 0:he.target)==="enemy"&&kt?` sur ${kt}`:"";ae(`L'attaque (${k.name})${De} a manque la cible (CA ${B}). Pas de degats.`),kt&&_n({round:D,phase:P,kind:"player_attack",actorId:f.id,actorKind:"player",targetId:kt,targetKind:"enemy",summary:`Le heros attaque ${kt} (${k.name}) mais manque (CA ${B}).`,data:{actionId:k.id,attackTotal:Ae,targetArmorClass:B,hit:!1}});return}}const se=kd(k.damage.formula,{isCrit:U,critRule:k.damage.critRule});Zn(se);const Ie=se.dice.map(Ae=>Ae.rolls.join("+")).join(" | "),le=se.total,ye=((Ve=k.targeting)==null?void 0:Ve.target)==="enemy"&&kt?` sur ${kt}`:"";cs(`Degats (${k.name})${ye} : ${Ie||"0"} + ${se.flatModifier} = ${le}${U?" (critique)":""}`),typeof $=="number"&&$>=0&&b(Ae=>{if($===null||$<0||$>=Ae.length)return Ae;const Me=[...Ae],De={...Me[$]},Ee=De.hp;return De.hp=Math.max(0,De.hp-le),Me[$]=De,_n({round:D,phase:P,kind:"player_attack",actorId:f.id,actorKind:"player",targetId:De.id,targetKind:"enemy",summary:`Le heros frappe ${De.id} et inflige ${le} degats (PV ${Ee} -> ${De.hp}).`,data:{actionId:k.id,damage:le,isCrit:U,targetHpBefore:Ee,targetHpAfter:De.hp}}),De.hp<=0&&Ee>0&&_n({round:D,phase:P,kind:"death",actorId:De.id,actorKind:"enemy",summary:`${De.id} s'effondre, hors de combat.`,targetId:De.id,targetKind:"enemy",data:{killedBy:f.id}}),Me})}function Wr(){const k=sn();if(!k){ae("Aucune action validee pour lancer un jet.");return}if(!k.attack){ae("Mode auto: pas de jet de touche necessaire."),k.damage&&er();return}Mn(),setTimeout(()=>{k.damage&&er()},50)}function tr(k){if(P!=="player"||Nt||Yt(f))return;const $=r.current;if(!$)return;const B=$.querySelector("canvas");if(!B)return;const U=B.getBoundingClientRect(),se=k.clientX-U.left,Ie=k.clientY-U.top,le=Ir.current;if(!le)return;const ye=(se-le.offsetX)/le.scale,Ce=(Ie-le.offsetY)/le.scale;if(ye<0||Ce<0||ye>Qo||Ce>Yl)return;const{x:he,y:Ve}=Ng(ye,Ce),Ae=he,Me=Ve;if(!Er(Ae,Me))return;if(Br==="selecting"){const Ee=[f,...x],de=Ml({x:Ae,y:Me},Ee);if(!de||de.type!=="enemy"){ae(`Pas d'ennemi sur (${Ae}, ${Me}).`);return}const _e=sn();if(!_e){ae("Aucune action validee pour selectionner une cible.");return}const tt=Ge(_e,de,f,[f,...x]);if(!tt.ok){ae(tt.reason||"Cette cible n'est pas valide pour cette action.");return}Fr(de.id),Tn("none"),ae(`Cible selectionnee: ${de.id}.`);return}if(Pn==="inspect-select"){const Ee=ai(f,{x:Ae,y:Me});if(Ee>to){ae(`Inspection: case hors portee (${Ee} > ${to}).`);return}if(!qg(f,{x:Ae,y:Me},ut.vision)){ae("Inspection: la case n'est pas dans votre champ de vision.");return}yi(tt=>{const Oe=new Set(tt);return Oe.add(xi(Ae,Me)),Oe});const de=[f,...x],_e=Ml({x:Ae,y:Me},de);if(!_e){ae(`Inspection: case (${Ae}, ${Me}) -> sol.`),_i(`Inspection (${Ae},${Me}) : sol.`),nn("idle");return}if(_e.type==="enemy"){ya(Wt=>{const wt=new Set(Wt);return wt.add(_e.id),wt});const tt=_e.enemyTypeLabel??_e.enemyTypeId??"inconnu",Oe=_e.aiRole??"inconnu",Qe=`Inspection (${Ae},${Me}) : ${tt}
Etat: PV ${_e.hp}/${_e.maxHp}
Role: ${Oe}`;ae(`Inspection: ennemi (${_e.id}) -> nature: ${tt}, etat: PV ${_e.hp}/${_e.maxHp}, role: ${Oe}.`),_i(Qe)}else{const tt=`Inspection (${Ae},${Me}) : joueur
Etat: PV ${_e.hp}/${_e.maxHp}`;ae(`Inspection: joueur (${_e.id}) -> etat: PV ${_e.hp}/${_e.maxHp}.`),_i(tt)}nn("idle");return}if(Pn==="look-select"){const Ee=Kg(f,{x:Ae,y:Me});Si(Ee),nn("idle");return}if(Pn!=="moving"){const Ee=[f,...x],de=Ml({x:Ae,y:Me},Ee)??null;os({open:!0,anchorX:se,anchorY:Ie,cell:{x:Ae,y:Me},token:de});return}if(((Ee,de)=>x.some(_e=>_e.hp>0&&_e.x===Ee&&_e.y===de))(Ae,Me)){ae(`Case (${Ae}, ${Me}) occupee par un ennemi : impossible de s'y deplacer.`);return}if(ut.movement.has(xi(Ae,Me))){ae(`Case (${Ae}, ${Me}) bloquee par un obstacle.`);return}mi(Ee=>{const de=Math.max(1,hr),_e=[...Ee];if(_e.length>=de)return ae(`Limite de ${de} cases atteinte pour ce tour.`),_e;const tt=_e.length>0?_e[_e.length-1]:{x:f.x,y:f.y};if(tt.x===Ae&&tt.y===Me)return _e;const Oe=de-_e.length,Qe={...f,x:tt.x,y:tt.y},Wt=[Qe,...x],wt=ql(Qe,{x:Ae,y:Me},Wt,{maxDistance:Math.max(0,Oe),allowTargetOccupied:!1,blockedCells:ut.movement});if(wt.length<=1)return ae("Aucun chemin valide vers cette case (bloque par obstacle ou entites)."),_e;const Tt=wt.slice(1);return ae(`Trajectoire: +${Tt.length} case(s) vers (${Ae}, ${Me}).`),_e.concat(Tt)})}function Ma(){if(P!=="player"||Nt||Yt(f)||Lt.length===0)return;const k=Lt[Lt.length-1],$={x:f.x,y:f.y};m(B=>({...B,x:k.x,y:k.y})),ae(`Deplacement valide vers (${k.x}, ${k.y}) via ${Lt.length} etape(s).`),_n({round:D,phase:"player",kind:"move",actorId:f.id,actorKind:"player",summary:`Le heros se deplace de (${$.x}, ${$.y}) vers (${k.x}, ${k.y}).`,data:{from:$,to:{x:k.x,y:k.y},steps:Lt.length}}),mi([]),nn("idle"),qt()}function oo(){P==="player"&&(Nt||(mi([]),ae("Trajectoire reinitialisee.")))}function Si(k){P==="player"&&(Nt||(m($=>({...$,facing:k})),ae(`Orientation du joueur mise a jour: ${k}.`)))}function wu(){const k={id:f.id,x:f.x,y:f.y,hp:f.hp,maxHp:f.maxHp},$=x.map(B=>({id:B.id,x:B.x,y:B.y,hp:B.hp,maxHp:B.maxHp,type:B.enemyTypeId,aiRole:B.aiRole??null,moveRange:B.moveRange??null,attackDamage:B.attackDamage??null,attackRange:B.attackRange??null,maxAttacksPerTurn:B.maxAttacksPerTurn??null,actionIds:B.actionIds??null}));return{round:D,phase:P,grid:{cols:Tr,rows:ur},player:k,enemies:$,actionsCatalog:hi.map(B=>{var U,se,Ie,le,ye,Ce,he,Ve;return{id:B.id,name:B.name,category:String(B.category??""),targeting:{target:String(((U=B.targeting)==null?void 0:U.target)??""),range:{min:Number(((Ie=(se=B.targeting)==null?void 0:se.range)==null?void 0:Ie.min)??0),max:Number(((ye=(le=B.targeting)==null?void 0:le.range)==null?void 0:ye.max)??0),shape:String(((he=(Ce=B.targeting)==null?void 0:Ce.range)==null?void 0:he.shape)??"")},requiresLos:!!((Ve=B.targeting)!=null&&Ve.requiresLos)}}})}}function Ea(k){const $=new Set(x.map(U=>U.id)),B=[];for(const U of k){if(!U||typeof U!="object"||typeof U.enemyId!="string"||!$.has(U.enemyId)||typeof U.actionId!="string"||!U.actionId.trim())continue;const se=U.target;let Ie={kind:"none"};se&&typeof se=="object"&&(se.kind==="token"&&typeof se.tokenId=="string"?Ie={kind:"token",tokenId:se.tokenId}:se.kind==="cell"&&typeof se.x=="number"&&typeof se.y=="number"&&(Ie={kind:"cell",x:se.x,y:se.y}));const le=U.advantageMode,ye=le==="advantage"||le==="disadvantage"?le:"normal";B.push({enemyId:U.enemyId,actionId:U.actionId.trim(),target:Ie,advantageMode:ye})}return B}async function ds(k){console.log("[enemy-ai] Envoi etat au backend:",k),va(k),lt(null),fr(!1);try{const $=await fetch("/api/enemy-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)});if(!$.ok)throw new Error(`HTTP ${$.status}`);const B=await $.json();if(!B.intents||!Array.isArray(B.intents))throw new Error("Reponse backend invalide (intents manquant).");const U=Ea(B.intents);return _a(U),U.length===0&&fr(!0),U}catch($){return lt($ instanceof Error?$.message:String($??"unknown")),_a(null),fr(!0),[]}}async function Ra(k,$,B){const U=B.find(Ee=>Ee.id===k);if(!U||Yt(U))return;const se=[$,...B],Ie=Qp(U,se,ut.vision),le=Ie.filter(Ee=>Ee.type==="enemy"&&Ee.id!==k&&!Yt(Ee)).map(Ee=>Ee.id),ye=Ie.filter(Ee=>Ee.type==="player"&&!Yt(Ee)).map(Ee=>Ee.id),Ce=S1(U,$,se,ut.vision),he=ai(U,$),Ve=U.maxHp>0?U.hp/U.maxHp:0,Ae={language:"fr",maxLines:2,enemyId:k,enemyTypeId:U.enemyTypeId??null,aiRole:U.aiRole??null,speechProfile:U.speechProfile??null,perception:{canSeePlayer:Ce,distanceToPlayer:Number.isFinite(he)?he:null,hpRatio:Number.isFinite(Ve)?Ve:0,alliesVisible:le,enemiesVisible:ye,lastKnownPlayerPos:Ce?{x:$.x,y:$.y}:null},priorSpeechesThisRound:qx(),selfLastSpeech:Kx(k),recentEvents:Qx(16)},De=((await t5(Ae)).line??"").trim();if(!De){ka(k);return}ro(k,De),Xx(k,De)}async function bu(k){var De,Ee,de,_e,tt;G(!0),mi([]),Ot([]);const $=x.map(Oe=>({...Oe}));let B={...f};const U=$.find(Oe=>Oe.id===k);if(!U||Yt(U)){G(!1),Dr();return}const se=wu(),le=(await ds(se)).filter(Oe=>Oe.enemyId===k),ye=[B,...$],Ce=Array.isArray(U.actionIds)&&U.actionIds.length?U.actionIds:["enemy-move","enemy-melee-strike"],he=Oe=>hi.find(Qe=>Qe.id===Oe)??null,Ve=(Oe,Qe,Wt)=>{const wt=he(Oe);if(!wt)return{ok:!1,reason:`Action inconnue: ${Oe}`};if(!Ce.includes(Oe))return{ok:!1,reason:`Action non autorisee pour ${U.id}: ${Oe}`};const Tt=Gx(wt,{round:D,phase:"enemies",actor:U,player:B,enemies:$,blockedMovementCells:ut.movement,blockedVisionCells:ut.vision,blockedAttackCells:ut.attacks,sampleCharacter:kr,onLog:ae,emitEvent:nt=>{_n({round:D,phase:"enemies",kind:nt.kind,actorId:nt.actorId,actorKind:nt.actorKind,targetId:nt.targetId??null,targetKind:nt.targetKind??null,summary:nt.summary,data:nt.data??{}})}},Qe,{advantageMode:Wt});if(!Tt.ok||!Tt.playerAfter||!Tt.enemiesAfter)return{ok:!1,reason:Tt.reason||"Echec de resolution."};B=Tt.playerAfter;for(let nt=0;nt<$.length;nt++)$[nt]=Tt.enemiesAfter[nt]??$[nt];return{ok:!0,action:wt}};let Ae=!1;if(le.length>0){const Oe=le[0],Qe=Oe.target;let Wt={kind:"none"};if(Qe.kind==="token"){const Tt=ye.find(nt=>nt.id===Qe.tokenId)??null;Tt&&(Wt={kind:"token",token:Tt})}else Qe.kind==="cell"&&(Wt={kind:"cell",x:Qe.x,y:Qe.y});const wt=Ve(Oe.actionId,Wt,Oe.advantageMode);wt.ok?fr(!1):(Ae=!0,ae(`${U.id}: intent IA invalide (${wt.reason}).`))}else Ae=!0;if(Ae)if(fr(!0),!S1(U,B,ye,ut.vision))ae(`${U.id} ne voit pas le joueur et reste en alerte.`);else{const Qe=ai(U,B),Wt=Ce.includes("enemy-bow-shot"),wt=Ce.includes("enemy-melee-strike"),Tt=Ce.includes("enemy-move"),nt=typeof U.moveRange=="number"?U.moveRange:3,mr=U.aiRole==="archer",Cu=mr?3:1,Au=mr?2:0;let En=!1;const $a=()=>{let ze=null,ct=-1;for(let Pt=-nt;Pt<=nt;Pt++)for(let nr=-nt;nr<=nt;nr++){const po=Math.abs(Pt)+Math.abs(nr);if(po===0||po>nt)continue;const Ti=U.x+Pt,Pi=U.y+nr;if(!Er(Ti,Pi)||Ml({x:Ti,y:Pi},ye))continue;const mo=ai({x:Ti,y:Pi},B);mo>ct&&(ct=mo,ze={x:Ti,y:Pi})}return ze};if(!En&&B.hp>0&&mr&&Wt){const ze=he("enemy-bow-shot"),ct=((Ee=(De=ze==null?void 0:ze.targeting)==null?void 0:De.range)==null?void 0:Ee.min)??2,Pt=((_e=(de=ze==null?void 0:ze.targeting)==null?void 0:de.range)==null?void 0:_e.max)??6;if(Qe>=ct&&Qe<=Pt){const nr=Ve("enemy-bow-shot",{kind:"token",token:B});nr.ok&&(_n({round:D,phase:"enemies",kind:"enemy_attack",actorId:U.id,actorKind:"enemy",targetId:B.id,targetKind:"player",summary:`${U.id} tire a distance (${nr.action.name}).`,data:{actionId:nr.action.id,fallback:!0}}),En=!0)}}if(!En&&B.hp>0&&mr&&Tt&&Qe<=Au){const ze=$a();if(ze){const ct={x:U.x,y:U.y},Pt=Ve("enemy-move",{kind:"cell",x:ze.x,y:ze.y});Pt.ok&&(_n({round:D,phase:"enemies",kind:"move",actorId:U.id,actorKind:"enemy",summary:`${U.id} recule de (${ct.x}, ${ct.y}) vers (${ze.x}, ${ze.y}).`,data:{from:ct,to:ze,fallback:!0,actionId:Pt.action.id}}),En=!0)}}if(!En&&B.hp>0&&!mr&&wt&&Qe<=1){const ze=Ve("enemy-melee-strike",{kind:"token",token:B});ze.ok&&(_n({round:D,phase:"enemies",kind:"enemy_attack",actorId:U.id,actorKind:"enemy",targetId:B.id,targetKind:"player",summary:`${U.id} attaque au contact (${ze.action.name}).`,data:{actionId:ze.action.id,fallback:!0}}),En=!0)}if(!En&&B.hp>0&&Tt){let ze=null;if(mr)if(Qe>Cu){const ct=ql(U,{x:B.x,y:B.y},ye,{maxDistance:nt,allowTargetOccupied:!1,blockedCells:ut.movement});ct.length&&(ze=ct[ct.length-1])}else ze=$a();else{const ct=ql(U,{x:B.x,y:B.y},ye,{maxDistance:nt,allowTargetOccupied:!1,blockedCells:ut.movement});ct.length&&(ze=ct[ct.length-1])}if(ze){const ct={x:U.x,y:U.y},Pt=Ve("enemy-move",{kind:"cell",x:ze.x,y:ze.y});Pt.ok&&(_n({round:D,phase:"enemies",kind:"move",actorId:U.id,actorKind:"enemy",summary:`${U.id} se deplace de (${ct.x}, ${ct.y}) vers (${ze.x}, ${ze.y}).`,data:{from:ct,to:ze,fallback:!0,actionId:Pt.action.id}}),En=!0)}}if(!En&&B.hp>0&&mr&&wt&&Qe<=1){const ze=Ve("enemy-melee-strike",{kind:"token",token:B});ze.ok&&(_n({round:D,phase:"enemies",kind:"enemy_attack",actorId:U.id,actorKind:"enemy",targetId:B.id,targetKind:"player",summary:`${U.id} attaque au contact (${ze.action.name}).`,data:{actionId:ze.action.id,fallback:!0}}),En=!0)}}m(B),b($);try{await Ra(k,B,$)}catch{}const Me=us();if(e.current&&((tt=Me.entry)==null?void 0:tt.kind)==="player")try{const Oe=Or("player",B,$),Qe=Zx({focusActorId:B.id??null,stateEnd:Oe});if(Qe){const Wt=await e5(Qe),wt=(Wt.error||Wt.summary||"").trim();wt&&Sa(wt)}}catch{Sa("IA non fonctionnel.")}finally{Jx(),e.current=!1}G(!1),Dr()}function ki(){if(Nt)return;const k=no();!k||k.kind!=="player"||(ae(`Fin du tour joueur (round ${D}).`),e.current=!0,_n({round:D,phase:"player",kind:"turn_end",actorId:f.id,actorKind:"player",summary:`Fin du tour du heros (round ${D}).`}),Dr())}function Ci(){Ot([{id:"demo-circle",kind:"circle",radius:2}]),ae("Zone d'effet: cercle (rayon 2) autour du joueur.")}function Hr(){Ot([{id:"demo-rect",kind:"rectangle",width:3,height:3}]),ae("Zone d'effet: rectangle 3x3 centre sur le joueur.")}function hs(){Ot([{id:"demo-cone",kind:"cone",range:4,direction:"right"}]),ae("Zone d'effet: cone vers la droite (portee 4).")}function Su(){Ot([]),ae("Zones d'effet effacees.")}Z.useEffect(()=>{Nt||f.hp<=0&&([f,...x].some($=>$.type==="player"&&!Yt($))||ls(!0))},[f,x,Nt]);const ao=An.find(k=>k.id===Qs)||An[0]||null,lo=ao?Nr(ao):null,pr=sn(),uo=Jn(pr),Ur=$t&&An.find(k=>k.id===$t.actionId)||null,gn=Ur?Nr(Ur):null,co=($t==null?void 0:$t.stage)==="active"&&Ur&&Ji===Ur.id?{enabled:!0,reasons:[],details:(gn==null?void 0:gn.details)??[]}:gn,fs=no(),Ia=K;if(!te)return C.jsx(p7,{configEnemyCount:ne,enemyTypeCount:y.length,gridCols:Tr,gridRows:ur,mapPrompt:j,onChangeMapPrompt:V,onChangeEnemyCount:ie,onNoEnemyTypes:()=>ae("Aucun type d'ennemi charge (enemyTypes). Impossible de generer le combat."),onStartCombat:vu});const Gr=P==="player"&&!Nt&&!Yt(f);function ps(k){const $=(Ue==null?void 0:Ue.anchorX)??0,B=(Ue==null?void 0:Ue.anchorY)??0;Zi(k.id),Js({anchorX:$,anchorY:B,actionId:k.id,stage:"draft"}),qt()}function La(){Js(null),Tn("none")}function Kt(k){bi(k),Js($=>$&&{...$,actionId:k.id,stage:"active"})}function Vr(){Gr&&(Tn("none"),nn("inspect-select"),qt(),ae(`Inspection: cliquez sur une case VISIBLE (portee ${to}) pour reveler nature / etat / role.`))}function ho(){Gr&&(Tn("none"),nn("look-select"),qt(),ae("Tourner le regard: cliquez sur une case pour orienter le champ de vision."))}function Ai(){const k=Ue==null?void 0:Ue.cell;ae(k?`Interagir: (a integrer) sur (${k.x}, ${k.y}).`:"Interagir: (a integrer)."),qt()}function ku(){ae("Se cacher: (a integrer)."),qt()}const fo=[{id:"combat",label:"Combat",content:C.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"flex-start"},children:[C.jsx("div",{style:{flex:"1 1 340px",minWidth:340},children:C.jsx(m7,{round:D,phase:P,playerInitiative:Y,player:f,selectedPath:Lt,sampleCharacter:kr,aiLastState:pu,aiLastIntents:as,aiUsedFallback:wa,aiLastError:yu})}),C.jsx("div",{style:{flex:"1 1 340px",minWidth:340},children:C.jsx(g7,{enemies:x,player:f,revealedEnemyIds:gi,capabilities:j7,validatedAction:pr,selectedTargetId:kt,describeEnemyLastDecision:xu,validateEnemyTargetForAction:Ge,onSelectTargetId:Fr,onSetTargetMode:Tn,onLog:ae})}),C.jsx("div",{style:{flex:"1 1 340px",minWidth:340},children:C.jsx(_7,{actions:An,selectedAction:ao,selectedAvailability:lo,computeActionAvailability:Nr,onSelectActionId:Zi,describeRange:Aa,describeUsage:io,conditionLabel:Ta,effectLabel:Pa,onPreviewActionArea:so,onValidateAction:bi})}),uo&&C.jsx("div",{style:{flex:"1 1 340px",minWidth:340},children:C.jsx(w7,{validatedAction:pr,advantageMode:es,onSetAdvantageMode:ts,onRollAttack:Mn,onRollDamage:er,onAutoResolve:Wr,attackRoll:tn,damageRoll:$r,diceLogs:pa})})]})},{id:"effects",label:"Effets",content:C.jsx("div",{style:{maxWidth:520},children:C.jsx(b7,{showVisionDebug:eo,onShowCircle:Ci,onShowRectangle:Hr,onShowCone:hs,onToggleVisionDebug:()=>xa(k=>!k),onClear:Su})})},{id:"logs",label:"Logs",content:C.jsx(S7,{log:s})}];return C.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",height:"100vh",overflow:"hidden",background:"#0b0b12",color:"#f5f5f5",fontFamily:"system-ui, sans-serif",padding:"16px",boxSizing:"border-box",position:"relative"},children:[Nt&&C.jsx(y7,{onRestart:()=>window.location.reload()}),C.jsxs("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"flex-start",gap:10,minHeight:0,overflow:"hidden"},children:[C.jsx("div",{style:{flex:"0 0 auto",padding:"10px 12px",borderRadius:14,background:"rgba(12,12,18,0.88)",border:"1px solid rgba(255,255,255,0.10)",boxShadow:"0 18px 60px rgba(0,0,0,0.35)"},children:C.jsx(x7,{round:D,timelineEntries:Ia,activeEntry:fs,player:f,enemies:x})}),C.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",padding:"0 4px"},children:[C.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[C.jsx("span",{style:{fontSize:18,fontWeight:900,letterSpacing:.4},children:"Mini Donjon"}),C.jsx("span",{style:{fontSize:12,color:"rgba(255,255,255,0.70)"},children:"Clic gauche: roue d'actions  Deplacer: clics successifs (max 5)"})]}),C.jsx("span",{style:{fontSize:12,color:"rgba(255,255,255,0.65)"},children:P==="player"?"Tour joueur":"Tour ennemis"})]}),C.jsx("div",{style:{flex:"1 1 auto",minHeight:0,borderRadius:18,padding:10,background:"radial-gradient(1200px 500px at 40% 0%, rgba(120,90,40,0.20), rgba(12,12,18,0.92))",border:"1px solid rgba(255,255,255,0.12)",boxShadow:"0 25px 90px rgba(0,0,0,0.55)",overflow:"visible"},children:C.jsxs("div",{ref:r,onClick:tr,onContextMenu:k=>{k.preventDefault()},onMouseDown:k=>{k.button===2&&(k.preventDefault(),k.stopPropagation(),kn(!0),Dt.current={x:k.clientX,y:k.clientY})},onMouseMove:k=>{if(!vt)return;const $=Dt.current;if(!$)return;const B=k.clientX-$.x,U=k.clientY-$.y;B===0&&U===0||(Dt.current={x:k.clientX,y:k.clientY},Xe(se=>({x:se.x+B,y:se.y+U})))},onMouseUp:k=>{k.button===2&&(kn(!1),Dt.current=null)},onMouseLeave:()=>{kn(!1),Dt.current=null},style:{width:"100%",height:"100%",minHeight:0,borderRadius:14,border:"1px solid rgba(255,255,255,0.10)",background:"#05050a",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",overflow:"visible",cursor:vt?"grabbing":"default"},children:[C.jsxs("div",{onMouseDown:k=>k.stopPropagation(),style:{position:"absolute",right:12,top:12,zIndex:45,display:"flex",flexDirection:"column",gap:6,padding:8,borderRadius:12,background:"rgba(10, 10, 16, 0.72)",border:"1px solid rgba(255,255,255,0.14)",backdropFilter:"blur(6px)",boxShadow:"0 14px 40px rgba(0,0,0,0.35)"},children:[C.jsx("button",{type:"button",onClick:()=>We(k=>tu(Math.round((k+Re)*10)/10,Se,Pe)),disabled:ke>=Pe-1e-6,style:{width:34,height:34,borderRadius:10,border:"1px solid rgba(255,255,255,0.14)",background:ke>=Pe-1e-6?"rgba(80,80,90,0.55)":"rgba(255,255,255,0.08)",color:"#fff",cursor:ke>=Pe-1e-6?"default":"pointer",fontSize:18,fontWeight:800,lineHeight:1},title:"Zoom +",children:"+"}),C.jsxs("div",{style:{textAlign:"center",fontSize:12,color:"rgba(255,255,255,0.75)",fontWeight:700},title:"Niveau de zoom",children:[Math.round(ke*100),"%"]}),C.jsx("button",{type:"button",onClick:()=>We(k=>tu(Math.round((k-Re)*10)/10,Se,Pe)),disabled:ke<=Se+1e-6,style:{width:34,height:34,borderRadius:10,border:"1px solid rgba(255,255,255,0.14)",background:ke<=Se+1e-6?"rgba(80,80,90,0.55)":"rgba(255,255,255,0.08)",color:"#fff",cursor:ke<=Se+1e-6?"default":"pointer",fontSize:22,fontWeight:800,lineHeight:1},title:"Zoom -",children:""}),C.jsx("button",{type:"button",onClick:()=>We(1),disabled:Math.abs(ke-1)<1e-6,style:{marginTop:4,width:34,height:28,borderRadius:10,border:"1px solid rgba(255,255,255,0.14)",background:Math.abs(ke-1)<1e-6?"rgba(80,80,90,0.55)":"rgba(255,255,255,0.06)",color:"rgba(255,255,255,0.85)",cursor:Math.abs(ke-1)<1e-6?"default":"pointer",fontSize:11,fontWeight:800},title:"Reset zoom",children:"1"})]}),C.jsx(P7,{open:!!(Ue!=null&&Ue.open),anchorX:(Ue==null?void 0:Ue.anchorX)??0,anchorY:(Ue==null?void 0:Ue.anchorY)??0,size:240,canInteractWithBoard:Gr,hasCell:!!(Ue!=null&&Ue.cell),selectedPathLength:Lt.length,isResolvingEnemies:L,actions:An,computeActionAvailability:Nr,onClose:qt,onEnterMoveMode:()=>{nn("moving"),qt(),ae(`Mode deplacement active: cliquez sur des cases pour tracer un trajet (max ${hr}).`)},onValidateMove:Ma,onResetMove:()=>{oo(),qt()},onInspectCell:Vr,onLook:ho,onInteract:Ai,onHide:ku,onEndTurn:()=>{ki(),qt()},onPickAction:ps}),C.jsx(E7,{open:!!$t,anchorX:($t==null?void 0:$t.anchorX)??0,anchorY:($t==null?void 0:$t.anchorY)??0,stage:($t==null?void 0:$t.stage)??"draft",action:Ur,availability:co,player:f,enemies:x,validatedAction:pr,targetMode:Br,selectedTargetId:kt,onSelectTargetId:Fr,onSetTargetMode:Tn,advantageMode:es,onSetAdvantageMode:ts,onRollAttack:Mn,onRollDamage:er,onAutoResolve:Wr,attackRoll:tn,damageRoll:$r,diceLogs:pa,onValidateAction:Kt,onClose:La}),Pn==="moving"&&C.jsxs("div",{onMouseDown:k=>k.stopPropagation(),style:{position:"absolute",left:10,bottom:10,zIndex:40,display:"flex",gap:8,padding:"8px 10px",borderRadius:10,background:"rgba(10, 10, 16, 0.75)",border:"1px solid rgba(255,255,255,0.14)",backdropFilter:"blur(6px)",boxShadow:"0 14px 40px rgba(0,0,0,0.35)"},children:[C.jsx("span",{style:{fontSize:12,alignSelf:"center",color:"#cfd3ff"},children:"Mode deplacement"}),C.jsx("button",{type:"button",onClick:()=>nn("idle"),style:{padding:"4px 8px",background:"#34495e",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:12},children:"Quitter"}),C.jsx("button",{type:"button",onClick:oo,disabled:Lt.length===0,style:{padding:"4px 8px",background:Lt.length?"#e67e22":"#555",color:"#fff",border:"none",borderRadius:6,cursor:Lt.length?"pointer":"default",fontSize:12},children:"Annuler"}),C.jsx("button",{type:"button",onClick:Ma,disabled:Lt.length===0,style:{padding:"4px 8px",background:Lt.length?"#2ecc71":"#555",color:"#fff",border:"none",borderRadius:6,cursor:Lt.length?"pointer":"default",fontSize:12,fontWeight:600},children:"Valider"})]})]})}),C.jsx(v7,{round:D,narrativeLog:a})]}),C.jsx(R7,{tabs:fo,defaultTabId:"combat",collapsible:!0,collapsedByDefault:!0,collapsedHeight:52,expandedHeight:320})]})},B7=document.getElementById("root");Dg.createRoot(B7).render(C.jsx(F7,{}));export{X5 as $,V0 as A,fn as B,pn as C,et as D,ve as E,y0 as F,uu as G,U1 as H,Vs as I,y8 as J,A8 as K,ha as L,je as M,xt as N,ht as O,Xt as P,U8 as Q,$d as R,Jd as S,jl as T,Ed as U,V1 as V,od as W,Y1 as X,K5 as Y,Us as Z,St as _,$0 as a,f0 as a0,Y0 as a1,$e as a2,Ke as a3,q8 as a4,v6 as a5,h6 as a6,B6 as a7,O6 as a8,G6 as a9,Y6 as aa,X6 as ab,lm as ac,lp as ad,op as ae,$p as af,cr as ag,q4 as ah,ot as ai,ci as aj,y5 as ak,ca as al,Up as am,dm as an,qn as b,u6 as c,la as d,Bt as e,ap as f,o6 as g,Ql as h,Zd as i,H0 as j,k0 as k,Kn as l,B0 as m,da as n,F6 as o,D6 as p,H6 as q,R5 as r,V6 as s,Ne as t,g5 as u,q6 as v,at as w,Dn as x,c0 as y,Xn as z};
