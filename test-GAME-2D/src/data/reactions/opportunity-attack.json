{
  "id": "opportunity-attack",
  "name": "Opportunity Attack",
  "summary": "Strike a hostile that leaves your reach.",
  "uiMessage": "Vous avez subi une attaque d opportunite.",
  "uiMessageMiss": "Vous avez evite une attaque d opportunite.",
  "trigger": {
    "event": "movement.leave_reach",
    "source": "hostile"
  },
  "conditions": [
    {
      "type": "ACTOR_ALIVE",
      "reason": "Reactor must be alive."
    },
    {
      "type": "REACTION_AVAILABLE",
      "reason": "Reaction already used."
    },
    {
      "type": "TARGET_VISIBLE",
      "reason": "Target not visible."
    }
  ],
  "action": {
    "id": "reaction-opportunity-attack",
    "name": "Opportunity Attack",
    "summary": "Melee strike triggered by a fleeing target.",
    "category": "reaction",
    "actionCost": {
      "actionType": "reaction",
      "movementCost": 0
    },
    "targeting": {
      "target": "hostile",
      "range": {
        "min": 0,
        "max": 1.5,
        "shape": "SPHERE"
      },
      "maxTargets": 1,
      "requiresLos": true
    },
    "usage": {
      "perTurn": 1,
      "perEncounter": null,
      "resource": null
    },
    "conditions": [
      {
        "type": "TARGET_ALIVE",
        "target": "primary",
        "reason": "Target must be alive."
      }
    ],
    "attack": {
      "bonus": 5,
      "critRange": 20
    },
    "damage": {
      "formula": "1d4 + modFOR",
      "critRule": "double-dice",
      "damageType": "SLASHING"
    },
    "resolution": {
      "kind": "ATTACK_ROLL",
      "bonus": 5,
      "critRange": 20,
      "critRule": "double-dice"
    },
    "ops": {
      "onHit": [
        {
          "op": "DealDamage",
          "target": "primary",
          "formula": "1d4 + modFOR",
          "damageType": "SLASHING"
        },
        {
          "op": "DealDamage",
          "target": "primary",
          "formula": "1d4 + modFOR",
          "damageType": "SLASHING"
        }
      ],
      "onResolve": [
        {
          "op": "LogEvent",
          "message": "Opportunity attack triggered."
        }
      ]
    },
    "tags": [
      "reaction",
      "melee",
      "opportunity"
    ]
  },
  "tags": [
    "reaction"
  ]
}



